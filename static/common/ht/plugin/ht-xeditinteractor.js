!function(S,B,D){"use strict";var L="ht",r=S[L],U=r.Default,E=r.graph,j=U.getInternal(),b=j.ui(),G=b.NodeUI.prototype,C=b.ShapeUI.prototype,Z=E.GraphView,X=Z.prototype,$=b.EdgeUI.prototype,P=r.Node,h=r.Shape,d=r.Edge,_=r.Group,Q=U.isTouchable,e=U.preventDefault,k=S.setTimeout,q=U.grow,N=U.isDragging,R=U.getDistance,w=null,T=r.List,y="undefined"!=typeof Float32Array?Float32Array:Array,V=Math,s=V.PI,v="Crossing",g="No Crossing",a=s/2,O=2*s,z=V.atan2,f=V.sqrt,p=V.pow,F=V.sin,x=V.cos,W=V.min,J=V.max,K=V.abs,c=V.ceil,A=V.round,M=U.unionPoint,m=U.unionRect,H=U.containsPoint,n=U.clone,t="rgb(52, 152, 219)",I="red",l={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},u={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var T=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],j=0;j<T.length;j++){var n=T[j];n=0===j%2?n/400*u.width:n/100*u.height,T[j]=n}return u.width>120&&(T[4]=u.width-26,T[6]=u.width-40,T[10]=u.width-40,T[12]=u.width-26,T[18]=33),T}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},o={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:t,rotation:.61},{type:"circle",rect:[200,120,70,70],background:t,rotation:.61},{type:"circle",rect:[200,220,70,70],background:t,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:t},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:t}]},i={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:I,rotation:.61}]},Y={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:t},{type:"circle",rect:[0,210,90,90],background:t},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:t}]},Lm={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:I},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:I}]},sh={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:t}]},Uh={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:I}]},Kg={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},No={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},oi=function(K){var m=K.touches[0];return m?m:K.changedTouches[0]},Ml=function(d,l,C,S){return z(S-l,C-d)},Tc=function(q,I){return{x:q.x*I,y:q.y*I}},tn=function(r,F){r.each(function(t){return r.isSelected(t)?F(t):void 0})},Wl=function(w,L){w.reverseEach(function(Y){return w.isSelected(Y)?L(Y):void 0})},bq=function(w,e,c){var _,C,t,m,Q,D=this,l=e,r=D.gv;if(w instanceof h){t=w.getSegments();var V=r.getDataUI(w);Q=V._55O.$15l,t&&t.size()||(t=ii(Q)),w.isClosePath()&&t.indexOf(5)<0&&(t=new T(t._as),t.add(5)),_=Uk(w,V,l),C=Q[_]}else{var Z=r.getDataUI(w);Q=Th(Z,w.s("edge.points")),t=w.s("edge.segments"),t&&t.size()||(t=ii(Q)),Q=Q._as,_=Uk(w,Z,l),C=Q[_]}if(t&&(m=t.get(l)),2===m||1===m||5===m){var s=Q[_+1];5===m&&(s=Q[0]);var u=jj(C,c,s);return u}return c},hq=function(x,f,X,S){var y=f/2,r=X/2,$=qc(x,-y,-r,S),g=qc(x,y,-r,S),u=qc(x,-y,r,S),p=qc(x,y,r,S),c=qc(x,0,-r,S),i=qc(x,y,0,S),N=qc(x,0,r,S),a=qc(x,-y,0,S);return[$,g,u,p,c,i,N,a]},jj=function(g,P,k){var T={x:P.x-g.x,y:P.y-g.y},N={x:k.x-g.x,y:k.y-g.y},L=f(p(k.x-g.x,2)+p(k.y-g.y,2)),W={x:N.x/L,y:N.y/L},x=T.x*W.x+T.y*W.y,S={x:W.x*x,y:W.y*x};return{x:g.x+S.x,y:g.y+S.y}},qc=function(R,w,v,i){var I=x(i)*w-F(i)*v,m=F(i)*w+x(i)*v;return R?{x:R.x+I,y:R.y+m}:{x:I,y:m}},Wq=function(g,B){return B>2*g?g:B/2},ki=function(a,T,K,J){var M=R(a,T);return K=J?W(K,M):Wq(K,M),M?K/=M:K=0,{x:a.x+(T.x-a.x)*K,y:a.y+(T.y-a.y)*K}},qb=function(R,W){var p,d,e=R.gv,E=R._data,P=E._40I,m=E._41I,X=E.s("edge.offset"),G=E.s("edge.source.position"),t=E.s("edge.target.position"),Q=E.s("edge.source.offset.x"),c=E.s("edge.source.offset.y"),H=E.s("edge.target.offset.x"),s=E.s("edge.target.offset.y"),b=E.s("edge.source.anchor.x"),N=E.s("edge.source.anchor.y"),B=E.s("edge.target.anchor.x"),I=E.s("edge.target.anchor.y");if(W?(p=j.getEdgeAgentPosition(e,P,G,Q,c,b,N),d=j.getEdgeAgentPosition(e,m,t,H,s,B,I)):(p=j.getEdgeAgentPosition(e,P,G,0,0,b,N),d=j.getEdgeAgentPosition(e,m,t,0,0,B,I)),"points"===E.s("edge.type")&&X&&!E.s("edge.center")&&p){var D=E.s("edge.points")||new T,o=D.size(),$=ki(p,o?D.get(0):d,X,o),O=ki(d,o?D.get(o-1):p,X,o);p=$,d=O}return[p,d]},Th=function($,q,U){var p=$._78o,O=$._data,b=O.s("edge.type"),V=[p.sourcePoint,p.targetPoint];return"points"===b?U&&(V=qb($)):V=p.center?b?U?qb($):qb($,!0):U?qb($):[p.c1,p.c2]:U?qb($):qb($,!0),q=new T(q?q._as:w),q.add(V[0],0),q.add(V[1]),q},Vl=function(K){return K=new T(K._as),K.removeAt(0),K.removeAt(K.size()-1),K},ii=function(b){b._as||(b=new T(b));var Z=new T;Z.add(1);for(var h=1;h<b.size();h++)Z.add(2);return Z},$h=function(b,S){return{x:(b.x+S.x)/2,y:(b.y+S.y)/2}},dp=function(E,g){return{x:E.x+1*(g.x-E.x)/4,y:E.y+1*(g.y-E.y)/4}},os=function(w,s){return{x:w.x+3*(s.x-w.x)/4,y:w.y+3*(s.y-w.y)/4}},Tp=function(s,U,L,O){var T=U.x+U.width/2,I=U.y+U.height/2,Q=f(T*T+I*I),m=z(I,T)+L;return{x:O.x+Q*x(m),y:O.y+Q*F(m)}},Nk=X.validateImpl,Xj=X.isRectEditable,Mp=X.isPointEditable,Jf=X._42,mn=C._79o,$j=$._79o,$e=C._48O,Ul=C._47O,Eh=G._48O,Rg=G._80o,Mg=C._80o,iq=G.getSelectWidth,ap=G._47O,cc=$._47O,ro=X.isEditable,Fj=["northwest","north","northeast","east","southeast","south","southwest","west"],Um=function(Q,b,a,G,T,x,H,i,t,v){var f=Q.x,X=Q.y,d=Q.width,g=Q.height,R={x:f+d/2,y:X+g/2};G=G||0,b=qc(R,b.x-R.x,b.y-R.y,-G),H&&!i&&(b.x+=t,b.y+=v);var S=.01;if("northwest"===a?(b.x+T>f+d-S&&(b.x=f+d-T-S),b.y+T>X+g-S&&(b.y=X+g-T-S),Q=M(b,{x:f+d,y:X+g})):"north"===a?(b.y+T>X+g-S&&(b.y=X+g-T-S),Q=M({x:f,y:b.y},{x:f+d,y:X+g})):"northeast"===a?(b.x<f+T+S&&(b.x=f+T+S),b.y+T>X+g-S&&(b.y=X+g-T-S),Q=M({x:f,y:b.y},{x:b.x,y:X+g})):"west"===a?(b.x+T>f+d-S&&(b.x=f+d-T-S),Q=M({x:b.x,y:X},{x:f+d,y:X+g})):"east"===a?(b.x<f+T+S&&(b.x=f+T+S),Q=M({x:f,y:X},{x:b.x,y:X+g})):"southwest"===a?(b.x+T>f+d-S&&(b.x=f+d-T-S),b.y<X+T+S&&(b.y=X+T+S),Q=M({x:b.x,y:X},{x:f+d,y:b.y})):"south"===a?(b.y<X+T+S&&(b.y=X+T+S),Q=M({x:f,y:X},{x:f+d,y:b.y})):"southeast"===a&&(b.x<f+T+S&&(b.x=f+T+S),b.y<X+T+S&&(b.y=X+T+S),Q=M({x:f,y:X},b)),"keepRatio"===x&&(!H&&i||H&&!i)&&("northeast"===a||"southeast"===a||"northwest"===a||"southwest"===a)){var K=Q.width,r=Q.height,B=K/d,z=r/g,o=W(B,z);Q.width=d*o,Q.height=g*o,"northeast"===a?Q.y=X+(g-Q.height):"northwest"===a?(Q.y=X+(g-Q.height),Q.x=f+(d-Q.width)):"southwest"===a&&(Q.x=f+(d-Q.width))}Q.x-=R.x,Q.y-=R.y;var m=Tp(w,Q,G,R);return Q.x=m.x-Q.width/2,Q.y=m.y-Q.height/2,Q},Ck=function(t,$,E,Q){var Z=t.getRotation(),W=$,l=W.x,F=W.y,O=W.width,k=W.height,R={x:l+W.width/2,y:F+W.height/2};Q=qc(R,Q.x-R.x,Q.y-R.y,-Z),"northwest"===E?W=M(Q,{x:l+O,y:F+k}):"north"===E?W=M({x:l,y:Q.y},{x:l+O,y:F+k}):"northeast"===E?W=M({x:l,y:Q.y},{x:Q.x,y:F+k}):"west"===E?W=M({x:Q.x,y:F},{x:l+O,y:F+k}):"east"===E?W=M({x:l,y:F},{x:Q.x,y:F+k}):"southwest"===E?W=M({x:Q.x,y:F},{x:l+O,y:Q.y}):"south"===E?W=M({x:l,y:F},{x:l+O,y:Q.y}):"southeast"===E&&(W=M({x:l,y:F},Q)),t.setRect(W),W.x-=R.x,W.y-=R.y;var K=Tp(t,W,Z,R);t.p(K.x,K.y)},qq=function(W,B,V,J,g,a,f,y){var N=w;a?(N=qc(w,g.x-B.x,g.y-B.y,-V),N.x-=f.x,N.y-=f.y):N=qc(w,g.x-B.x,g.y-B.y,0);var h={x:B.x+N.x,y:B.y+N.y};y&&(h=y(h.x,h.y)),h.e=W.getPoints().get(J).e,W.setPoint(J,h);var s=W.getWidth(),K=W.getHeight(),e=W.p().x-s/2,F=W.p().y-K/2;e-=B.x,F-=B.y;var j=Tp(W,{x:e,y:F,width:s,height:K},V,B);W.p(j.x,j.y)},Uk=function(J,p,o){var j,K;if(J instanceof h?(j=J.getPoints(),K=J.getSegments()):J instanceof d&&"points"===J.s("edge.type")&&(j=J.s("edge.points"),K=J.s("edge.segments"),j=Th(p,j)),K&&K.size()||(K=ii(j)),J instanceof h&&J.isClosePath()&&K.indexOf(5)<0&&(K=new T(K._as),K.add(5)),K)for(var S=-1,e=0;e<K.size();e++){if(e===o)return S;var w=K.get(e);1===w?S+=1:2===w?S+=1:3===w?S+=2:4===w&&(S+=3)}},im=function(Z,y,H){var J,$;if(Z instanceof h?(J=Z.getPoints(),$=Z.getSegments()):Z instanceof d&&"points"===Z.s("edge.type")&&(J=Z.s("edge.points"),$=Z.s("edge.segments"),J=Th(y,J)),$&&$.size()||($=ii(J)),$)for(var e=-1,Q=0;Q<$.size();Q++){var L=$.get(Q);if(1===L?e+=1:2===L?e+=1:3===L?e+=2:4===L&&(e+=3),e===H)return Q}},Wf=function(q,o){var c=[q[0]-o[0],q[1]-o[1],q[2]-o[2]];return c},tl=function(){var d=new y(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},sj=function(o,N){var e=o[0],K=o[1],S=o[2];return o[0]=N[0]*e+N[4]*K+N[8]*S+N[12],o[1]=N[1]*e+N[5]*K+N[9]*S+N[13],o[2]=N[2]*e+N[6]*K+N[10]*S+N[14],o},$c=function(V,I){if(I){var b=F(I),C=x(I),n=V[0],E=V[1],i=V[2],e=V[3],R=V[8],K=V[9],P=V[10],u=V[11];V[0]=n*C-R*b,V[1]=E*C-K*b,V[2]=i*C-P*b,V[3]=e*C-u*b,V[8]=n*b+R*C,V[9]=E*b+K*C,V[10]=i*b+P*C,V[11]=e*b+u*C}},on=function(G,l){for(var A=G.s("grid.row.count"),E=G.s("grid.column.count"),h=0;A>h;h++)for(var Z=0;E>Z;Z++){var m=G.getCellRect(h,Z);if(H(m,l))return{rowIndex:h,columnIndex:Z,rect:m,grid:G}}return null},Pr=function($,X,Z,t,N,L){var C={},F=Z-$,Y=t-X,n=V.sqrt(F*F+Y*Y),q=F/n,_=Y/n,u=(-$+N)*q+(-X+L)*_;return 0>=u?(C.x=$,C.y=X):u>=n?(C.x=Z,C.y=t):(C.x=$+u*q,C.y=X+u*_),F=N-C.x,Y=L-C.y,C.z=V.sqrt(F*F+Y*Y),C},Fq=function(u,l){var F,B,p,f,e,L,$,y,q=u.getPoints(),d=u.getSegments(),r=u.p(),G=u.getRotation();if(!d||!(d.indexOf(3)>0||d.indexOf(4)>0)){for(y=0;y<=q.size()-1;y++)if(y===q.size()-1?(e=q.get(0),f=q.get(y)):(f=q.get(y),e=q.get(y+1)),f=qc(r,f.x-r.x,f.y-r.y,G),e=qc(r,e.x-r.x,e.y-r.y,G),L=Pr(f.x,f.y,e.x,e.y,l.x,l.y),$=L.z,$<(u.s("shape.border.width")||10)){B=f,p=e,F=y;break}if(F!=w){var k=Pr(B.x,B.y,p.x,p.y,l.x,l.y),g=R(B,k);return{attachIndex:F,attachOffset:g}}}},es=function(W){for(var j=W._data,I=j.p(),V=j.getRotation(),$=j.getPoints(),G=w,f=[],H=0;H<$.size();H++)G=$.get(H),f.push(qc(I,G.x-I.x,G.y-I.y,V));W._55O.$15l=f};U.setImage("xeditinteractor_parentIcon",o),U.setImage("xeditinteractor_hostIcon",i),U.setImage("xeditinteractor_edgeIcon",Y),U.setImage("xeditinteractor_removeIcon",Lm),U.setImage("xeditinteractor_sourceIcon",sh),U.setImage("xeditinteractor_targetIcon",Uh),U.setImage("xeditinteractor_elevationIcon",Kg),U.setImage("xeditinteractor_tallIcon",No),X._editPointSize=Q?24:9,X._edgeHelpers=["parent","remove","source","target"],X._leftTopHelpers=["parent"],X._rightTopHelpers=["host"],X._leftBottomHelpers=["edge"],X._rightBottomHelpers=["remove"],Fj=Fj.concat(Fj).concat(Fj),$._79o=function(){var z=this,k=z.gv,n=k.getZoom(),B=k._editInteractor,N=$j.call(z);if(!N)return null;var U=qb(z,!0),F=U[0],e=U[1],c={x:N.x,y:N.y,width:N.width,height:N.height},T=M(F,e);if(B instanceof E.XEditInteractor){c=m(c,T);var r=z._55O,j=k.getEditPointSize()/n+2,H=0;r&&r._43O&&(H+=j/2,q(c,H))}return c},$._47O=function($){var g=this,O=g.gv,v=O._editInteractor;v instanceof E.XEditInteractor||cc.call(g,$)},$.rectIntersects=function(V){var W=this,R=W._data,O=W.gv,q=O.getZoom(),b=W._55O,A=O._editInteractor;if(A instanceof E.XEditInteractor&&O.isEditable(R)&&b&&b._43O&&"points"===R.s("edge.type")){var Y=R.s("edge.points"),s=R.s("edge.segments");Y=Th(W,Y),s&&s.size()||(s=ii(Y)),Y=Y._as;var e=!1,H=Q?5:1,i=V.x+H,r=V.y+H,m={x:i,y:r};if(A._edge===R&&A._hoverSegmentIndex>=0){var n=O._editInteractor._hoverSegmentIndex,l=s.get(n),I=Uk(R,W,n),f=w;if(I!=w&&I>=0){var h=Y[I],c=O.getSegmentHoverWidth()/q;if(2===l||1===l){var p=Y[I+1];f=uq(new hp(h.x,h.y),new hp(p.x,p.y),new hp(m.x-c,m.y-c),new hp(m.x+2*c,m.y+2*c)),f.$62l===v&&(e=!0)}else if(3===l){var $=Y[I+1],p=Y[I+2];f=Qj(new hp(h.x,h.y),new hp($.x,$.y),new hp(p.x,p.y),new hp(m.x-c,m.y-c),new hp(m.x+2*c,m.y+2*c)),f.$62l===v&&(e=!0)}else if(4===l){var t=Y[I+1],S=Y[I+2];p=Y[I+3],f=Uq(new hp(h.x,h.y),new hp(t.x,t.y),new hp(S.x,S.y),new hp(p.x,p.y),new hp(m.x-c,m.y-c),new hp(m.x+2*c,m.y+2*c)),f.$62l===v&&(e=!0)}}}if(e)return!0}return w},C._47O=function(B){var T=this,i=T.gv,S=i._editInteractor;S instanceof E.XEditInteractor||Ul.call(T,B)},C.rectIntersects=function(N){var D=this,I=D._data,U=D.gv,c=U.getZoom(),_=D._55O,f=U._editInteractor;if(f instanceof E.XEditInteractor&&U.isEditable(I)&&_&&_._43O){var g=_.$15l,x=!1,q=Q?5:1,b=N.x+q,R=N.y+q,r={x:b,y:R};if(g&&g.length===I.getPoints().size()||(es(D),g=_.$15l),f._shape===I&&f._hoverSegmentIndex>=0){var p=I.getSegments();p&&p.size()||(p=ii(g));var A=U._editInteractor._hoverSegmentIndex,F=p.get(A),o=Uk(I,D,A),m=w;if(o!=w&&o>=0){var P=g[o],e=U.getSegmentHoverWidth()/c;if(2===F||1===F){var s=g[o+1];m=uq(new hp(P.x,P.y),new hp(s.x,s.y),new hp(r.x-e,r.y-e),new hp(r.x+2*e,r.y+2*e)),m.$62l===v&&(x=!0)}else if(3===F){var d=g[o+1],s=g[o+2];m=Qj(new hp(P.x,P.y),new hp(d.x,d.y),new hp(s.x,s.y),new hp(r.x-e,r.y-e),new hp(r.x+2*e,r.y+2*e)),m.$62l===v&&(x=!0)}else if(4===F){var T=g[o+1],K=g[o+2];s=g[o+3],m=Uq(new hp(P.x,P.y),new hp(T.x,T.y),new hp(K.x,K.y),new hp(s.x,s.y),new hp(r.x-e,r.y-e),new hp(r.x+2*e,r.y+2*e)),m.$62l===v&&(x=!0)}}}if(x)return!0}return w},C._48O=function(){var s=this,W=s.gv,$=W._editInteractor;$ instanceof E.XEditInteractor?(G._48O.call(s),s._55O._43O&&es(s)):$e.call(s)},C._79o=function(){var p=this,l=p.gv,X=l.getZoom(),s=l._editInteractor,e=mn.call(p);if(e){var o={x:e.x,y:e.y,width:e.width,height:e.height};if(s instanceof E.XEditInteractor){var c=p._55O,K=l.getEditPointSize()/X+2,N=0;c&&c._43O&&(N+=K/2,q(o,N))}return o}},G._47O=function(y){var j=this,p=j.gv,L=p._editInteractor;if(L instanceof E.XEditInteractor);else{var i=j._55O;i&&i._98o&&ap.call(j,y)}},G.getSelectWidth=function(){var a=this,q=a.gv,$=q._editInteractor,C=a._data;return q.isEditable(C)&&$ instanceof E.XEditInteractor?0:iq.call(a)},G._80o=function(V){var Y=this,i=Y.gv._editInteractor;if(Rg.call(Y,V),i&&i._debug){V.save(),V.beginPath(),V.lineWidth=1,V.strokeStyle="green";var v=Y._79o();v&&(V.rect(v.x,v.y,v.width,v.height),V.stroke()),V.restore()}},C._80o=function(K){var q=this,z=q.gv._editInteractor;if(Mg.call(q,K),z&&z._debug){K.save(),K.beginPath(),K.lineWidth=1,K.strokeStyle="green";var T=q._79o();K.rect(T.x,T.y,T.width,T.height),K.stroke(),K.restore()}},G._48O=function(){var B=this,k=B.gv,v=B._data,Y=k._editInteractor,Q=B._55O,h=v.p(),F=v.getRotation();if(Y instanceof E.XEditInteractor){if(Q._42O){var q=hq(h,v.getWidth(),v.getHeight(),F),i=q[0],G=q[1],V=q[2],r=q[3],d=q[4],t=q[5],o=q[6],_=q[7];Q.$45l=[i,d,G,t,r,o,V,_]}}else Eh.call(B)},X.getResizeMode=function(){return this.$25l||"normal"},X.setResizeMode=function(U){var o=this.$25l;this.$25l=U,this.fp("resizeMode",o,U)},X.getSnapAngle=function(){return this.$26l||Math.PI/36},X.setSnapAngle=function(J){var e=this.$26l;this.$26l=J,this.fp("snapAngle",e,J)},X.getSnapSpacing=function(){return this.$27l},X.setSnapSpacing=function(Q){var v=this.$27l;this.$27l=Q,this.fp("snapSpacing",v,Q)},X.getPointSnapSpacing=function(){return this._pointSnapSpacing},X.setPointSnapSpacing=function(A){var m=this._pointSnapSpacing;this._pointSnapSpacing=A,this.fp("pointSnapSpacing",m,A)},X.setHelperEditableFunc=function(v){var m=this._helperEditableFunc;this._helperEditableFunc=v,this.fp("helperEditableFunc",m,v)},X.getHelperEditableFunc=function(){return this._helperEditableFunc},X.setLeftTopHelpers=function(C){var g=this._leftTopHelpers;this._leftTopHelpers=C,this.fp("leftTopHelpers",g,C)},X.getLeftTopHelpers=function(){return this._leftTopHelpers},X.setLeftTopHelpersAlign=function(Y){var P=this._leftTopHelpersAlign;this._leftTopHelpersAlign=Y,this.fp("leftTopHelpersAlign",P,Y)},X.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},X.setRightTopHelpers=function(H){var E=this._rightTopHelpers;this._rightTopHelpers=H,this.fp("rightTopHelpers",E,H)},X.getRightTopHelpers=function(){return this._rightTopHelpers},X.setRightTopHelpersAlign=function(B){var m=this._rightTopHelpersAlign;this._rightTopHelpersAlign=B,this.fp("rightTopHelpersAlign",m,B)},X.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},X.setLeftBottomHelpers=function(Z){var N=this._leftBottomHelpers;this._leftBottomHelpers=Z,this.fp("leftBottomHelpers",N,Z)},X.getLeftBottomHelpers=function(){return this._leftBottomHelpers},X.setLeftBottomHelpersAlign=function(S){var z=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=S,this.fp("leftBottomHelpersAlign",z,S)},X.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},X.setRightBottomHelpers=function(J){var o=this._rightBottomHelpers;this._rightBottomHelpers=J,this.fp("rightBottomHelpers",o,J)},X.getRightBottomHelpers=function(){return this._rightBottomHelpers},X.setRightBottomHelpersAlign=function(x){var f=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=x,this.fp("rightBottomHelpersAlign",f,x)},X.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},X.setEdgeHelpers=function(e){var x=this._edgeHelpers;this._edgeHelpers=e,this.fp("edgeHelpers",x,e)},X.getEdgeHelpers=function(){return this._edgeHelpers},X.isHelperEditable=function(r,W){return r instanceof d&&("host"===W||"edge"===W||"elevation"===W||"tall"===W)?!1:r instanceof P&&("source"===W||"target"===W)?!1:"pointElevation"===W?this._helperEditableFunc?this._helperEditableFunc(r,W):!1:this._helperEditableFunc?this._helperEditableFunc(r,W):!0},X.getEditHelperSize=function(){return this._editHelperSize||(Q?28:16)},X.setEditHelperSize=function(L){var u=this._editHelperSize;this._editHelperSize=L,this.fp("editHelperSize",u,L)},X.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},X.setEditRectBorderColor=function(g){var s=this.$28l;this.$28l=g,this.fp("editRectBorderColor",s,g)},X.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},X.setNodeBorderColor=function(Z){var v=this.$29l;this.$29l=Z,this.fp("nodeBorderColor",v,Z)},X.getEditRectBorderStyle=function(){return this.$30l||"dashed"},X.setEditRectBorderStyle=function(v){var q=this.$30l;this.$30l=v,this.fp("editRectBorderStyle",q,v)},X.getControlPointBackground=function(){return this.$31l||"#ff0"},X.setControlPointBackground=function(V){var E=this.$31l;this.$31l=V,this.fp("controlPointBackground",E,V)},X.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},X.setControlPointBorderColor=function($){var C=this.$32l;this.$32l=$,this.fp("controlPointBorderColor",C,$)},X.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},X.setJoinPointBackground=function(u){var N=this.$33l;this.$33l=u,this.fp("joinPointBackground",N,u)},X.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},X.setJoinPointBorderColor=function(p){var e=this.$34l;this.$34l=p,this.fp("joinPointBorderColor",e,p)},X.getDirectionLineColor=function(){return this.$35l||"#888"},X.setDirectionLineColor=function(s){var v=this.$35l;this.$35l=s,this.fp("directionLineColor",v,s)},X.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},X.setSegmentHoverColor=function(Y){var $=this.$36l;this.$36l=Y,this.fp("segmentHoverColor",$,Y)},X.getSegmentHoverWidth=function(){return this.$22l||(Q?16:8)},X.setSegmentHoverWidth=function(q){var b=this.$22l;this.$22l=q,this.fp("segmentHoverWidth",b,q)},X.getSnapPointBorderColor=function(){return this.$38l||"#f00"},X.setSnapPointBorderColor=function(K){var L=this.$38l;this.$38l=K,this.fp("snapPointBorderColor",L,K)},X.getEditRectPadding=function(){return this.$39l!=w?this.$39l:6},X.setEditRectPadding=function(E){var P=this.$39l;this.$39l=E,this.fp("editRectPading",P,E)},X.isRectEditable=function(Q){var M=this,N=M._editInteractor;return N instanceof E.XEditInteractor?M._rectEditableFunc?M._rectEditableFunc(Q):!0:Xj.call(M,Q)},X.isPointEditable=function(n){var D=this,C=D._editInteractor;return C instanceof E.XEditInteractor?D._pointEditableFunc?D._pointEditableFunc(n):!0:Mp.call(D,n)},X.validateImpl=function(){var $=this,l=$.$14l,R=$._editInteractor;if(l){var h=$.getWidth(),F=$.getHeight();(h!==l.clientWidth||F!==l.clientHeight)&&(R&&(R._68I=1),j.setCanvas(l,h,F),$._32I=1)}Nk.call(this)},X.isEditable=function(p){var J=ro.call(this,p),m=this._editInteractor;if(m instanceof E.XEditInteractor&&p instanceof d){if(!p.s("2d.editable"))return!1;var r=this.getEditableFunc();J=r?r(p):!0}return J},X._42=function(x,M){var P=this,Q=P._editInteractor;Jf.call(P,x,M),Q instanceof E.XEditInteractor&&Q._68I&&Q._42()},X.isSnapPoint=function(){return!0};var Ln=function(v){arguments.length>0&&this.$58l(v)},Wn=Ln.prototype;Wn.$58l=function(h){this.$62l=h,this.points=new Array},Wn.$56l=function(S){this.points.push(S)},Wn.$57l=function(m){this.points=this.points.concat(m)};var hp=function(Y,g){arguments.length>0&&this.$58l(Y,g)},bm=hp.prototype;bm.$58l=function(H,l){this.x=H,this.y=l},bm.add=function(Z){return new hp(this.x+Z.x,this.y+Z.y)},bm.addEquals=function(q){return this.x+=q.x,this.y+=q.y,this},bm.$55l=function(S){return new hp(this.x*S,this.y*S)},bm.eq=function(c){return this.x==c.x&&this.y==c.y},bm.lt=function(I){return this.x<I.x&&this.y<I.y},bm.lte=function(i){return this.x<=i.x&&this.y<=i.y},bm.gt=function(o){return this.x>o.x&&this.y>o.y},bm.gte=function(a){return this.x>=a.x&&this.y>=a.y},bm.lerp=function(g,r){return new hp(this.x+(g.x-this.x)*r,this.y+(g.y-this.y)*r)},bm.distanceFrom=function(j){var P=this.x-j.x,l=this.y-j.y;return f(P*P+l*l)},bm.min=function(e){return new hp(W(this.x,e.x),W(this.y,e.y))},bm.max=function(O){return new hp(J(this.x,O.x),J(this.y,O.y))},bm.toString=function(){return this.x+","+this.y};var Vq=function(){this.$58l(arguments)},Mm=Vq.prototype;Vq.TO=1e-6,Vq.AC=6,Mm.$58l=function(B){this.co=new Array;for(var V=B.length-1;V>=0;V--)this.co.push(B[V])},Mm.$55l=function(Y){for(var H=new Vq,U=0;U<=this.$50l()+Y.$50l();U++)H.co.push(0);for(var U=0;U<=this.$50l();U++)for(var M=0;M<=Y.$50l();M++)H.co[U+M]+=this.co[U]*Y.co[M];return H},Mm.$59l=function(){for(var g=this.$50l();g>=0&&K(this.co[g])<=Vq.TO;g--)this.co.pop()},Mm.$50l=function(){return this.co.length-1},Mm.$51l=function(){var z;switch(this.$59l(),this.$50l()){case 0:z=new Array;break;case 1:z=this.$52l();break;case 2:z=this.$53l();break;case 3:z=this.$54l();break;case 4:z=this.$63l();break;default:z=new Array}return z},Mm.$52l=function(){var J=new Array,C=this.co[1];return 0!=C&&J.push(-this.co[0]/C),J},Mm.$53l=function(){var R=new Array;if(2==this.$50l()){var d=this.co[2],U=this.co[1]/d,H=this.co[0]/d,i=U*U-4*H;if(i>0){var I=f(i);R.push(.5*(-U+I)),R.push(.5*(-U-I))}else 0==i&&R.push(.5*-U)}return R},Mm.$63l=function(){var O=new Array;if(4==this.$50l()){var p=this.co[4],e=this.co[3]/p,L=this.co[2]/p,u=this.co[1]/p,Z=this.co[0]/p,E=new Vq(1,-L,e*u-4*Z,-e*e*Z+4*L*Z-u*u).$54l(),k=E[0],w=e*e/4-L+k;if(K(w)<=Vq.TO&&(w=0),w>0){var U=f(w),F=3*e*e/4-U*U-2*L,$=(4*e*L-8*u-e*e*e)/(4*U),b=F+$,D=F-$;if(K(b)<=Vq.TO&&(b=0),K(D)<=Vq.TO&&(D=0),b>=0){var c=f(b);O.push(-e/4+(U+c)/2),O.push(-e/4+(U-c)/2)}if(D>=0){var c=f(D);O.push(-e/4+(c-U)/2),O.push(-e/4-(c+U)/2)}}else if(0>w);else{var $=k*k-4*Z;if($>=-Vq.TO){if(0>$&&($=0),$=2*f($),F=3*e*e/4-2*L,F+$>=Vq.TO){var n=f(F+$);O.push(-e/4+n/2),O.push(-e/4-n/2)}if(F-$>=Vq.TO){var n=f(F-$);O.push(-e/4+n/2),O.push(-e/4-n/2)}}}}return O},Mm.$54l=function(){var Q=new Array;if(3==this.$50l()){var k=this.co[3],c=this.co[2]/k,m=this.co[1]/k,q=this.co[0]/k,G=(3*m-c*c)/3,o=(2*c*c*c-9*m*c+27*q)/27,J=c/3,v=o*o/4+G*G*G/27,T=o/2;if(K(v)<=Vq.TO&&(v=0),v>0){var h,j,y=f(v);h=-T+y,j=h>=0?p(h,1/3):-p(-h,1/3),h=-T-y,h>=0?j+=p(h,1/3):j-=p(-h,1/3),Q.push(j-J)}else if(0>v){var n=f(-G/3),B=z(f(-v),-T)/3,N=x(B),O=F(B),H=f(3);Q.push(2*n*N-J),Q.push(-n*(N+H*O)-J),Q.push(-n*(N-H*O)-J)}else{var h;h=T>=0?-p(T,1/3):p(-T,1/3),Q.push(2*h-J),Q.push(-h-J)}}return Q};var qr=function(Z,R){arguments.length>0&&this.$58l(Z,R)},te=qr.prototype;te.$58l=function(B,H){this.x=B,this.y=H},te.length=function(){return f(this.x*this.x+this.y*this.y)},te.$60l=function(L){return this.x*L.x+this.y*L.y};var sb=function(U,S,I,t){var c,x=(t.x-I.x)*(U.y-I.y)-(t.y-I.y)*(U.x-I.x),d=(S.x-U.x)*(U.y-I.y)-(S.y-U.y)*(U.x-I.x),u=(t.y-I.y)*(S.x-U.x)-(t.x-I.x)*(S.y-U.y);if(0!=u){var $=x/u,m=d/u;$>=0&&1>=$&&m>=0&&1>=m?(c=new Ln(v),c.points.push(new hp(U.x+$*(S.x-U.x),U.y+$*(S.y-U.y)))):c=new Ln(g)}else c=0==x||0==d?new Ln("C"):new Ln("P");return c},ao=function(I,R,b,G,u){var s,Z,$,L,w,N,q,h=G.min(u),z=G.max(u),T=new Ln(g);s=R.$55l(-2),$=I.add(s.add(b)),s=I.$55l(-2),Z=R.$55l(2),L=s.add(Z),w=new hp(I.x,I.y),q=new qr(G.y-u.y,u.x-G.x),N=G.x*u.y-u.x*G.y;for(var B=new Vq(q.$60l($),q.$60l(L),q.$60l(w)+N).$51l(),K=0;K<B.length;K++){var H=B[K];if(H>=0&&1>=H){var y=I.lerp(R,H),S=R.lerp(b,H),p=y.lerp(S,H);G.x==u.x?h.y<=p.y&&p.y<=z.y&&(T.$62l=v,T.$56l(p)):G.y==u.y?h.x<=p.x&&p.x<=z.x&&(T.$62l=v,T.$56l(p)):p.gte(h)&&p.lte(z)&&(T.$62l=v,T.$56l(p))}}return T},Qj=function(n,e,O,p,B){var D=p.min(B),V=p.max(B),P=new hp(V.x,D.y),K=new hp(D.x,V.y),R=ao(n,e,O,D,P),N=ao(n,e,O,P,V),Y=ao(n,e,O,V,K),A=ao(n,e,O,K,D),X=new Ln(g);return X.$57l(R.points),X.$57l(N.points),X.$57l(Y.points),X.$57l(A.points),X.points.length>0&&(X.$62l=v),X},xd=function(z,r,w,N,J,s){var X,q,Q,j,F,D,$,S,c,o,l=J.min(s),V=J.max(s),I=new Ln(g);X=z.$55l(-1),q=r.$55l(3),Q=w.$55l(-3),j=X.add(q.add(Q.add(N))),F=new qr(j.x,j.y),X=z.$55l(3),q=r.$55l(-6),Q=w.$55l(3),j=X.add(q.add(Q)),D=new qr(j.x,j.y),X=z.$55l(-3),q=r.$55l(3),Q=X.add(q),$=new qr(Q.x,Q.y),S=new qr(z.x,z.y),o=new qr(J.y-s.y,s.x-J.x),c=J.x*s.y-s.x*J.y;for(var n=new Vq(o.$60l(F),o.$60l(D),o.$60l($),o.$60l(S)+c).$51l(),b=0;b<n.length;b++){var H=n[b];if(H>=0&&1>=H){var Y=z.lerp(r,H),R=r.lerp(w,H),T=w.lerp(N,H),t=Y.lerp(R,H),p=R.lerp(T,H),f=t.lerp(p,H);J.x==s.x?l.y<=f.y&&f.y<=V.y&&(I.$62l=v,I.$56l(f)):J.y==s.y?l.x<=f.x&&f.x<=V.x&&(I.$62l=v,I.$56l(f)):f.gte(l)&&f.lte(V)&&(I.$62l=v,I.$56l(f))}}return I},Uq=function(n,H,x,e,F,w){var T=F.min(w),B=F.max(w),t=new hp(B.x,T.y),p=new hp(T.x,B.y),c=xd(n,H,x,e,T,t),P=xd(n,H,x,e,t,B),J=xd(n,H,x,e,B,p),l=xd(n,H,x,e,p,T),N=new Ln(g);return N.$57l(c.points),N.$57l(P.points),N.$57l(J.points),N.$57l(l.points),N.points.length>0&&(N.$62l=v),N},uq=function($,q,Q,z){var N=Q.min(z),f=Q.max(z),O=new hp(f.x,N.y),s=new hp(N.x,f.y),b=sb(N,O,$,q),P=sb(O,f,$,q),k=sb(f,s,$,q),e=sb(s,N,$,q),F=new Ln(g);return F.$57l(b.points),F.$57l(P.points),F.$57l(k.points),F.$57l(e.points),F.points.length>0&&(F.$62l=v),F},gc=E.XEditInteractor=function(R){var l=this,p=l._view=document.createElement("canvas");p.className="editCanvas",p.style.position="absolute",gc.superClass.constructor.call(l,R)};U.def(gc,E.Interactor,{ms_edit:1,setUp:function(){var f=this,V=f.gv,i=V.getView(),j=f._view;gc.superClass.setUp.call(f),V.setEditInteractor(f),V.$14l=j,V._79O?i.insertBefore(j,V._79O):i.appendChild(j);var u=f.$49l=f.$11l.bind(f);V.dm().md(u),V.sm().ms(u),V.mp(u)},tearDown:function(){var D=this,T=D.gv,z=T.getView(),o=D.$49l;gc.superClass.tearDown.call(D),T.setEditInteractor(w),T.$14l=w,z.removeChild(D._view),T.dm().umd(o),T.sm().ums(o),T.ump(o)},clear:function(){var T=this,C=T.gv;delete T._hoverSegmentIndex,delete T._edge,delete T._shape,delete C._editing,delete T.$10l,delete T.$13l,delete T.$9l,delete T._removePointIndex,delete T._lp,T.$12l="",delete T.$40l,delete T.$67l,delete T.$72l,delete T.$73l,delete T.$75l,delete T.$1l,delete T.$3l,delete T.$2l,delete T.$92l,delete T.$93l,delete T.$94l,T.clearDragging()},handle_keydown:function(K){this.$48l!==K.shiftKey&&(this.$48l=K.shiftKey,this.handle_mousemove(K,D,!0))},handle_keyup:function(l){this.$48l!==l.shiftKey&&(this.$48l=l.shiftKey,this.handle_mousemove(l,D,!0))},handle_touchstart:function(k){this.handle_mousemove(k),this.handle_mousedown(k)},handle_mousedown:function(r){e(r);var p=this,m=p.$13l,V=p.gv,D=V.dm(),z=V.sm(),h=V.getZoom(),X=V.lp(r),o=U.isDoubleClick(r),v=U.isLeftButton(r),W=p.$7l,Y=p._shape,Z=p._hoverSegmentIndex,g=p._edge,y=p.$87l,A=p.$88l,M=function(){p._68I||y===p.$87l&&A===p.$88l||p.$43l()};if(7!==p.$67l&&(delete p.$87l,delete p.$88l),v&&(Y||g)&&Z>=0&&o&&(Y&&z.contains(Y)||g&&z.contains(g))){var f=bq.call(p,Y||g,Z,X);return p.addShapePoint(Y||g,Z,f),k(function(){p.handle_mousemove(r)},40),void 0}if(v&&(Y||g)&&p._removePointIndex>=0&&o)return p.removeShapePoint(),p.$5l=1,k(function(){p.handle_mousemove(r)},40),void 0;if(!v||!V._editing)return M(),void 0;if(Y&&m>=0){var $=Y.getPoints().get(m),j=Y.p(),u=qc(j,$.x-j.x,$.y-j.y,-W+Y.getRotation());E=qc(j,X.x-j.x,X.y-j.y,-W),p.$24l={x:E.x-u.x,y:E.y-u.y},p.startDragging(r),D.beginTransaction(),p.fi({kind:"beginEditPoint",event:r,data:Y,index:m}),p.$88l=m,p.$87l=Y}else if(p.$10l){var q=V.sm().getSelection(),s=p.$6l,Q=p.$1l={},T=p.$3l={},K=p.$16l[l[p.$10l]],L={x:s.x,y:s.y},S={x:s.x+s.width/2,y:s.y+s.height/2};p.$24l={x:X.x-K.x/h,y:X.y-K.y/h},p.$2l=n(p.$8l),p.$4l=n(s),q.each(function(F){if(F instanceof P){var I=F.p(),$=F.getWidth(),g=F.getHeight(),y=qc(S,I.x-S.x,I.y-S.y,-W);Q[F.getId()]={x:I.x-$/2,y:I.y-g/2,width:$,height:g},T[F.getId()]={x:(y.x-L.x)/s.width,y:(y.y-L.y)/s.height}}}),p.startDragging(r),D.beginTransaction(),p.fi({kind:"beginEditRect",event:r,direction:p.$10l})}else if(g&&m>=0){var C=Th(V.getDataUI(g),g.s("edge.points")),$=C.get(m);p.$24l={x:X.x-$.x,y:X.y-$.y},p.startDragging(r),D.beginTransaction(),p.fi({kind:"beginEditPoint",event:r,data:g,index:m}),p.$88l=m,p.$87l=g}else if(p.$40l){var s=p.$6l,S={x:s.x+s.width/2,y:s.y+s.height/2},x=n(p.$23l);x.x/=h,x.y/=h;var b=qc(S,x.x-S.x,x.y-S.y,-W),E=qc(S,X.x-S.x,X.y-S.y,-W);p.$24l={x:E.x-b.x,y:E.y-b.y},p.startDragging(r),D.beginTransaction(),p.fi({kind:"beginEditRotation",event:r,data:p._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(p.$67l)>=0){var I=p.$67l;(7===I||8===I||9===I)&&D.beginTransaction(),p.startDragging(r)}else if(p.$71l&&o&&p.$79l(p.$71l,X)){var F=z.toSelection();D.beginTransaction(),F.each(function(y){D.remove(y)}),D.endTransaction()}M()},$11l:function(){var G=this,s=G.gv;s._editing&&(G.$13l==w||G._shape==w&&G._edge==w)&&(G.$73l==w||1!==G.$67l&&5!==G.$67l&&6!==G.$67l)||(G.$5l=1),G._68I=1},$46l:function(q){var l=this,v=l.gv,g=v.lp(q),o=[];return Wl(v,function(u){var O=v.getDataUI(u);if(O){var s=O._79o();H(s,g)&&o.push(u)}}),o},$47l:function(a){var x=this,H=x.$13l,_=x.gv.dm();x.$10l?(x.fi({kind:"endEditRect",event:a,direction:x.$10l}),_.endTransaction()):x._shape&&H>=0?(x.fi({kind:"endEditPoint",event:a,data:x._shape,index:H}),_.endTransaction()):x._edge&&H>=0?(x.fi({kind:"endEditPoint",event:a,data:x._edge,index:H}),_.endTransaction()):x.$23l&&x.$40l&&(x.fi({kind:"endEditRotation",event:a}),_.endTransaction())},handleWindowTouchEnd:function(L){this.handleWindowMouseUp(L)},handleWindowMouseUp:function(c){var F=this,q=F.gv,U=q.dm(),a=F._shape,b=F._edge,$=F.$13l,E=F.$40l,m=F.$9l,f=F.$10l,k=F.$67l;if((a||b)&&$>=0&&m>=0){var A,u;if(a){var i=a.p(),C=a.getRotation();A=a.getPoints(),u=A.get(m),qq(a,i,C,$,u,!1)}else if(A=Th(q.getDataUI(b),b.s("edge.points"),!0),u=A.get(m),0===$){var j=A.get(0);b.s("edge.source.offset.x",u.x-j.x),b.s("edge.source.offset.y",u.y-j.y)}else if($===A.size()-1){var Z=A.get(A.size()-1);b.s("edge.target.offset.x",u.x-Z.x),b.s("edge.target.offset.y",u.y-Z.y)}else"points"===b.s("edge.type")&&(A.set($,u),b.s("edge.points",Vl(A)))}F.$47l(c);var p=F.$73l;1===k?(U.beginTransaction(),p?q.sm().each(function(f){if(f.setHost&&q.isHelperEditable(f,"host")){f.setHost(p);
var X=F.$75l,l=F.$74l;X&&(f.s("attach.row.index",X.rowIndex),f.s("attach.column.index",X.columnIndex)),l&&(f.s("attach.index",l.attachIndex),f.s("attach.offset",l.attachOffset),f.s("attach.offset.relative",!1),f.s("attach.offset.opposite",!1))}}):q.sm().each(function(r){r.setHost&&q.isHelperEditable(r,"host")&&(r.setHost(w),r.s("attach.row.index",D),r.s("attach.column.index",D),r.s("attach.index",D),r.s("attach.offset",D),r.s("attach.offset.relative",!1),r.s("attach.offset.opposite",!1))}),U.endTransaction()):2===k?(U.beginTransaction(),p?q.sm().each(function(Z){Z.setParent&&q.isHelperEditable(Z,"parent")&&Z.setParent(p)}):q.sm().each(function(x){x.setParent&&q.isHelperEditable(x,"parent")&&x.setParent(w)}),U.endTransaction()):3===k?p&&(U.beginTransaction(),q.sm().each(function(m){if(q.isHelperEditable(m,"edge")&&m instanceof P&&p instanceof P){var b=new r.Edge;U.add(b),b.setSource(m),b.setTarget(p),F.onEdgeCreated&&F.onEdgeCreated(c,b)}}),U.endTransaction()):5===k||6===k?p&&(U.beginTransaction(),q.sm().each(function(c){c instanceof d&&p instanceof P&&(5===k&&q.isHelperEditable(c,"source")?c.setSource(p):6===k&&q.isHelperEditable(c,"source")&&c.setTarget(p))}),U.endTransaction()):(7===k||8===k||9===k)&&U.endTransaction(),(f||E)&&F.$43l(!0),Q?(F.clear(),delete F.$64l,F._68I||F.$43l()):(F.handle_mousemove(c,!0),k&&!F._68I&&F.$43l())},handleWindowTouchMove:function(S){this.handleWindowMouseMove(S)},handleWindowMouseMove:function(p){this._78I(p)},handle_mousemove:function(z,A,W){if(!this._pause){if(!W){var F=Q?oi(z):z;this.$61l={clientX:F.clientX,clientY:F.clientY}}if(A===!0||!N()){var J=this,T=J.gv,u=!1,M=w;J.clear(),T.sm().size()>0&&(M=T.lp(W?J.$61l:z),u=J._79I(z,M)),u&&(T._editing=1),J.$12l!==J.$65l&&(J.$65l=J.$12l,J.setCursor(J.$12l)),J.$40l!==J.$64l&&(J.$64l=J.$40l,J._68I||J.$43l()),J._hoverSegmentIndex!==J.$66l&&(J.$66l=J._hoverSegmentIndex,J._68I||J.$43l())}}},_78I:function(i){this.autoScroll(i);var c=this,V=c.gv,e=V.lp(i),n=V.getZoom(),u=c.$13l;if((c._shape||c._edge)&&u>=0){var I,Y,H,o=c._shape,D=c._edge,T=c.$24l,p=V.getPointSnapSpacing(),E=function(T,D){return p==w||isNaN(p)?{x:T,y:D}:{x:A(T/p)*p,y:A(D/p)*p}};if(o){I=o.getPoints();var F=o.p(),l=o.getRotation(),v=0;Y=qc(F,e.x-F.x,e.y-F.y,-l),qq(o,F,l,u,e,!0,T,E),c.fi({kind:"betweenEditPoint",event:i,data:o,index:u})}else if(D){I=Th(V.getDataUI(D),D.s("edge.points"),!0),e.x-=T.x,e.y-=T.y,Y=e;var N,J,q=D.s("edge.offset"),S=I.size(),r=S>2;if(0===u){var Q=I.get(0);q&&(Q=ki(Q,I.get(1),-q,r),e=ki(e,I.get(1),-q,r)),N=e.x-Q.x,J=e.y-Q.y,H=E(N,J),D.s("edge.source.offset.x",H.x),D.s("edge.source.offset.y",H.y)}else if(u===S-1){var M=I.get(S-1);q&&(M=ki(M,I.get(S-2),-q,r),e=ki(e,I.get(S-2),-q,r)),N=e.x-M.x,J=e.y-M.y,H=E(N,J),D.s("edge.target.offset.x",H.x),D.s("edge.target.offset.y",H.y)}else"points"===D.s("edge.type")&&(H=E(e.x,e.y),H.e=I.get(u).e,I.set(u,H),D.s("edge.points",Vl(I)));c.fi({kind:"betweenEditPoint",event:i,data:D,index:u})}if(delete c.$9l,V.isSnapPoint(o)||V.isSnapPoint(D))for(v=0;v<I.size();v++)if(v!==u){var $=I.get(v);if(R($,Y)<V.getEditPointSize()/n){c.$9l=v;break}}}else if(c.$10l){var T=c.$24l;e.x-=T.x,e.y-=T.y;var b=V.sm().getSelection(),Z=c.$1l,y=c.$7l,B=c.$10l,L=c.$4l,g=c.$2l,X=V.getEditRectPadding()/n,G=2*X,W=V.getSnapSpacing(),C=W!=w&&!isNaN(W),x=Um(g,e,B,y,2*X,V.getResizeMode(),C,!0),t=c.$6l;if(C){var j=x.width-G,m=x.height-G,_=A(j/W)*W,$p=A(m/W)*W,$e=_-j,Nb=$p-m;("west"===B||"northwest"===B||"southwest"===B)&&($e=-$e),("north"===B||"northwest"===B||"northeast"===B)&&(Nb=-Nb),x=Um(g,e,B,y,2*X,V.getResizeMode(),C,!1,$e,Nb)}c.$8l=x,t.x=x.x+X,t.y=x.y+X,t.width=x.width-G,t.height=x.height-G;var dc=x.x+x.width/2,Io=x.y+x.height/2,qr=t.x,ad=t.y,Tf=t.width/L.width,cg=t.height/L.height;b.each(function(i){if(i instanceof P&&V.isEditable(i)&&V.isRectEditable(i)){var F=Z[i.getId()],v=c.$3l[i.getId()],w={x:F.x+F.width/2,y:F.y+F.height/2},O=0,G=0,m=B,E=180*K(y-i.getRotation())/s;"northeast"===B?E>=315||45>E?(O=F.width*Tf+F.x,G=F.height*(1-cg)+F.y,m="northeast"):E>=45&&135>E?(O=F.width*(1-cg)+F.x,G=F.height*(1-Tf)+F.y,m="northwest"):E>=135&&225>E?(O=F.width*(1-Tf)+F.x,G=F.height*cg+F.y,m="southwest"):(O=F.width*cg+F.x,G=F.height*Tf+F.y,m="southeast"):"north"===B?E>=315||45>E?(G=F.height*(1-cg)+F.y,m="north"):E>=45&&135>E?(O=F.width*(1-cg)+F.x,m="west"):E>=135&&225>E?(G=F.height*cg+F.y,m="south"):(O=F.width*cg+F.x,m="east"):"northwest"===B?E>=315||45>E?(O=F.width*(1-Tf)+F.x,G=F.height*(1-cg)+F.y,m="northwest"):E>=45&&135>E?(O=F.width*(1-cg)+F.x,G=F.height*Tf+F.y,m="southwest"):E>=135&&225>E?(O=F.width*Tf+F.x,G=F.height*cg+F.y,m="southeast"):(O=F.width*cg+F.x,G=F.height*(1-Tf)+F.y,m="northeast"):"west"===B?E>=315||45>E?(O=F.width*(1-Tf)+F.x,m="west"):E>=45&&135>E?(G=F.height*Tf+F.y,m="south"):E>=135&&225>E?(O=F.width*Tf+F.x,m="east"):(G=F.height*(1-Tf)+F.y,m="north"):"southwest"===B?E>=315||45>E?(O=F.width*(1-Tf)+F.x,G=F.height*cg+F.y,m="southwest"):E>=45&&135>E?(O=F.width*cg+F.x,G=F.height*Tf+F.y,m="southeast"):E>=135&&225>E?(O=F.width*Tf+F.x,G=F.height*(1-cg)+F.y,m="northeast"):(O=F.width*(1-cg)+F.x,G=F.height*(1-Tf)+F.y,m="northwest"):"east"===B?E>=315||45>E?(O=F.width*Tf+F.x,m="east"):E>=45&&135>E?(G=F.height*(1-Tf)+F.y,m="north"):E>=135&&225>E?(O=F.width*(1-Tf)+F.x,m="west"):(G=F.height*Tf+F.y,m="south"):"south"===B?E>=315||45>E?(G=F.height*cg+F.y,m="south"):E>=45&&135>E?(O=F.width*cg+F.x,m="east"):E>=135&&225>E?(G=F.height*(1-cg)+F.y,m="north"):(O=F.width*(1-cg)+F.x,m="west"):"southeast"===B&&(E>=315||45>E?(O=F.width*Tf+F.x,G=F.height*cg+F.y,m="southeast"):E>=45&&135>E?(O=F.width*cg+F.x,G=F.height*(1-Tf)+F.y,m="northeast"):E>=135&&225>E?(O=F.width*(1-Tf)+F.x,G=F.height*(1-cg)+F.y,m="northwest"):(O=F.width*(1-cg)+F.x,G=F.height*Tf+F.y,m="southwest"));var l=qc(w,O-w.x,G-w.y,i.getRotation());Ck(i,F,m,{x:l.x,y:l.y});var x=qr+t.width*v.x,_=ad+t.height*v.y,X={x:x,y:_};X=qc({x:dc,y:Io},X.x-dc,X.y-Io,y),i.p(X.x,X.y)}}),c.fi({kind:"betweenEditRect",event:i,direction:B})}else if(c.$23l&&c.$40l){var Ne=c.$8l,zk=Ne.width,Jj=Ne.height,F={x:Ne.x+zk/2,y:Ne.y+Jj/2},T=c.$24l,bc=c.$23l,lq=bc.x/n-F.x,Sf=bc.y/n-F.y,lg=f(lq*lq+Sf*Sf),Kn=Math.asin(T.x/lg),$i=V.sm().getSelection(),wb=a+z(e.y-F.y,e.x-F.x)-Kn,Wk=V.getSnapAngle(),wb=A(wb/Wk)*Wk;0>wb&&(wb+=O);var wp=wb-c.$7l,Go=[F.x,0,F.y];$i.each(function(H){if(V.isEditable(H)&&V.isRotationEditable(H)&&V.isVisible(H)){var S=Wf(H.p3(),Go),x=tl();$c(x,-wp),H.setRotation(H.getRotation()+wp),sj(S,x),H.p3(Go[0]+S[0],Go[1]+S[1],Go[2]+S[2])}}),c.$7l=wb,c.fi({kind:"betweenEditRotation",event:i})}else if([1,2,3,5,6].indexOf(c.$67l)>=0)c.$72l=i,c.$78l||(c.$78l=1,k(function(){U.isDragging()&&c.$43l(),delete c.$78l},12));else if(7===c.$67l){if(c.$87l instanceof h){var o=c.$87l,vr=c.$88l,Zb=U.clone(o.getPoints().get(vr)),iq=e.y-Zb.y;Zb.e||(Zb.e=0),c.$92l||(c.$92l=Zb.e),Zb.e=c.$92l-iq,o.setPoint(vr,Zb)}else if(c.$87l instanceof d){var D=c.$87l,vr=c.$88l,I=Th(V.getDataUI(D),D.s("edge.points")),Zb=I.get(vr),iq=e.y-Zb.y;Zb.e||(Zb.e=0),c.$92l||(c.$92l=Zb.e),Zb.e=c.$92l-iq,I.set(vr,Zb),D.s("edge.points",Vl(I))}}else if(8===c.$67l){var $i=V.sm().getSelection(),eo=c.$93l;eo||(eo=c.$93l={}),$i.each(function(G){if(G.p3){var q=G.p3(),R=eo[G.getId()];R==w&&(R=eo[G.getId()]=q[1]),G.p3([q[0],R-(e.y-c.$90l.y/n),q[2]])}})}else if(9===c.$67l){var $i=V.sm().getSelection(),Fh=c.$94l;Fh||(Fh=c.$94l={}),$i.each(function(d){if(d.s3){var L=d.s3(),S=Fh[d.getId()];S==w&&(S=Fh[d.getId()]=L[1]);var K=S-(e.y-c.$91l.y/n);0>K&&(K=.01),d.s3([L[0],K,L[2]])}})}},$79l:function(F,u){var V=this,J=V.gv,x=J.getZoom(),q=J.getEditHelperSize(),a=F.x/x,p=F.y/x,z=q/x,O=z/2;return H({x:a-O,y:p-O,width:z,height:z},u)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(N,o){for(var R=this,b=R.gv,Q=b.getZoom(),F=b.getEditPointSize(),t=F/Q,P=t/2,w=R.$46l(N),T=0;T<w.length;T++){var C,J,x=w[T],D=b.getDataUI(x);if(D&&D._55O){var W=D._55O;if(W._43O&&x instanceof d){if(C=x.s("edge.points"),C=Th(D,C),J=x.s("edge.segments"),J&&J.size()||(J=ii(C)),R.$42l(x,o,C._as,J,"edge"))return!0;if("points"===x.s("edge.type")&&R.$41l(x,o,C._as,J,"edge"))return}if(W._43O&&x instanceof h&&W.$15l&&W.$15l.length===x.getPoints().size()){if(C=W.$15l,J=x.getSegments(),J&&J.size()||(J=ii(C)),R.$42l(x,o,C,J,"shape"))return!0;if(R.$41l(x,o,C,J,"shape"))return}}}if(R.$16l){var C,G=R.$16l,X=G[3].x-G[7].x,Z=G[3].y-G[7].y,K=f(X*X+Z*Z),s=G[1].x-G[5].x,m=G[1].y-G[5].y,V=f(s*s+m*m),I={x:o.x*Q,y:o.y*Q};if(R._80I(I,0,G[0],"northwest",K,V)||R._80I(I,1,G[1],"north",K,V)||R._80I(I,2,G[2],"northeast",K,V)||R._80I(I,7,G[7],"west",K,V)||R._80I(I,3,G[3],"east",K,V)||R._80I(I,6,G[6],"southwest",K,V)||R._80I(I,5,G[5],"south",K,V)||R._80I(I,4,G[4],"southeast",K,V))return!0}if(R.$23l){var v=R.$23l,p=v.x/Q,E=v.y/Q;if(H({x:p-P,y:E-P,width:t,height:t},o))return R.$40l=1,R.$12l=R.getHelperCursor("rotation")||"crosshair",!0}return R.$68l&&R.$79l(R.$68l,o)?(R.$67l=1,R.$12l=R.getHelperCursor("host")||"crosshair",!0):R.$69l&&R.$79l(R.$69l,o)?(R.$67l=2,R.$12l=R.getHelperCursor("parent")||"crosshair",!0):R.$70l&&R.$79l(R.$70l,o)?(R.$67l=3,R.$12l=R.getHelperCursor("edge")||"crosshair",!0):R.$71l&&R.$79l(R.$71l,o)?(R.$67l=4,R.$12l=R.getHelperCursor("remove")||"crosshair",!0):R.$82l&&R.$79l(R.$82l,o)?(R.$67l=5,R.$12l=R.getHelperCursor("source")||"crosshair",!0):R.$83l&&R.$79l(R.$83l,o)?(R.$67l=6,R.$12l=R.getHelperCursor("target")||"crosshair",!0):R._pointElevationHelperPoint&&R.$79l(R._pointElevationHelperPoint,o)?(R.$67l=7,R.$12l=R.getHelperCursor("pointElevation")||"crosshair",!0):R.$90l&&R.$79l(R.$90l,o)?(R.$67l=8,R.$12l=R.getHelperCursor("elevation")||"crosshair",!0):R.$91l&&R.$79l(R.$91l,o)?(R.$67l=9,R.$12l=R.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(Y,B,Q,v,e,J){var X=this,q=X.gv,l=q.getEditPointSize(),U=l/2,L=q.sm(),c=q.isDirectionEditable;if(c&&1===L.size()){var K=L.ld();if(c=c.bind(q),K instanceof P){if(!c(K,v))return!1;if("east"===v){if(c(K,"northeast")&&c(K,"southeast")&&2*l>=J)return!1}else if("west"===v){if(c(K,"northwest")&&c(K,"southwest")&&2*l>=J)return!1}else if("north"===v){if(c(K,"northwest")&&c(K,"northeast")&&2*l>=e)return!1}else if("south"===v&&c(K,"southwest")&&c(K,"southeast")&&2*l>=e)return!1}}else{if(2*l>=e&&("north"===v||"south"===v))return!1;if(2*l>=J&&("east"===v||"west"===v))return!1}if(H({x:Q.x-U,y:Q.y-U,width:l,height:l},Y)){if(X.$10l!==v){var $=180*X.$7l/s,t="";$>=337.5||22.5>$?t="north":$>=22.5&&67.5>$?t="northeast":$>=67.5&&112.5>$?t="east":$>=112.5&&157.5>$?t="southeast":$>=157.5&&202.5>$?t="south":$>=202.5&&247.5>$?t="southwest":$>=247.5&&292.5>$?t="west":$>=292.5&&337.5>$&&(t="northwest");var f=Fj.indexOf(t),t=Fj[B-(1-f)+8];switch(t){case"northwest":X.$12l="nwse-resize";break;case"northeast":X.$12l="nesw-resize";break;case"southwest":X.$12l="nesw-resize";break;case"southeast":X.$12l="nwse-resize";break;case"north":X.$12l="ns-resize";break;case"east":X.$12l="ew-resize";break;case"south":X.$12l="ns-resize";break;case"west":X.$12l="ew-resize"}X.$10l=v}return!0}return!1},$42l:function(M,F,x,Z,g){var C,n=this,K=n.gv,G=K.getEditPointSize(),N=G/K.getZoom(),p=-1,b={x:F.x,y:F.y,width:0,height:0},m=function(A){"shape"===g?n._shape=M:n._edge=M,n._removePointIndex=A},r=function(Q){"shape"===g?n._shape=M:n._edge=M,n.$13l=Q,n.$12l="crosshair"};for(q(b,N/2),p=x.length-1,C=Z.size()-1;C>=0;C--){var t=Z.get(C);if(1===t||2===t)p-=1;else if(3===t){var W=x[p-1];if(H(b,W))return r(p-1),!0;p-=2}else if(4===t){var S=x[p-1],L=x[p-2];if(H(b,S))return r(p-1),!0;if(H(b,L))return r(p-2),!0;p-=3}}for(p=x.length-1,C=Z.size()-1;C>=0;C--){var t=Z.get(C),h=x[p];if(H(b,h))return m(p),r(p),!0;1===t||2===t?p-=1:3===t?p-=2:4===t&&(p-=3)}return!1},$41l:function(r,z,j,M,y){var X=this,d=X.gv,W=-1,U=0,i={x:z.x,y:z.y,width:0,height:0},N=function(E,q){X._hoverSegmentIndex=q,X._lp=z,"shape"===y?X._shape=r:X._edge=r};for(q(i,d.getSegmentHoverWidth()/2/d.getZoom()),r instanceof h&&r.isClosePath()&&M.indexOf(5)<0&&(M=new T(M._as),M.add(5));U<M.size();U++){var C=M.get(U);if(1===C){var F=j[W],c=j[W+1];if(F){var l=uq(new hp(F.x,F.y),new hp(c.x,c.y),new hp(i.x,i.y),new hp(i.x+i.width,i.y+i.height));if(l.$62l===v&&l.points.length>0)return N(l,U),!0}W+=1}else if(2===C){var F=j[W],c=j[W+1],l=uq(new hp(F.x,F.y),new hp(c.x,c.y),new hp(i.x,i.y),new hp(i.x+i.width,i.y+i.height));if(l.$62l===v&&l.points.length>0)return N(l,U),!0;W+=1}else if(3===C){var F=j[W],u=j[W+1],L=j[W+2],l=Qj(new hp(F.x,F.y),new hp(u.x,u.y),new hp(L.x,L.y),new hp(i.x,i.y),new hp(i.x+i.width,i.y+i.height));if(l.$62l===v)return N(l,U),!0;W+=2}else if(4===C){var F=j[W],_=j[W+1],g=j[W+2],L=j[W+3],l=Uq(new hp(F.x,F.y),new hp(_.x,_.y),new hp(g.x,g.y),new hp(L.x,L.y),new hp(i.x,i.y),new hp(i.x+i.width,i.y+i.height));if(l.$62l===v)return N(l,U),!0;W+=3}else if(5===C){var F=j[W],c=j[0];if(F){var l=uq(new hp(F.x,F.y),new hp(c.x,c.y),new hp(i.x,i.y),new hp(i.x+i.width,i.y+i.height));if(l.$62l===v&&l.points.length>0)return N(l,U),!0}}}return!1},addShapePoint:function(G,E,e){var $=this,n=$.gv,M=n.dm();if(M.beginTransaction(),0===arguments.length&&(G=$._shape||$._edge,E=$._hoverSegmentIndex,e=$._lp),G instanceof h||G instanceof d){var k=Uk(G,n.getDataUI(G),E);if(!isNaN(E)&&e&&!isNaN(k)){var C=e;if(G instanceof h){var L=G.p(),U=G.getRotation(),H=G.toSegments();H&&H.size()||(H=ii(G.getPoints())),G.isClosePath()&&H.indexOf(5)<0&&(H=new T(H._as),H.add(5));var D=H.get(E),J="addPoint",F="removePointAt";if(2===D||1===D){var Q={x:C.x,y:C.y};H.add(D,E),Q=qc(L,Q.x-L.x,Q.y-L.y,-U),G[J](Q,k+1)}else if(3===D){var l=G.getPoints(),Y=l.get(k),f=l.get(k+2),Q={x:C.x,y:C.y};Q=qc(L,Q.x-L.x,Q.y-L.y,-U);var K=$h(Y,Q),i=$h(Q,f);H.removeAt(E),H.add(3,E),H.add(3,E),G.setPoint(k+1,Q),G[J](i,k+2),G[J](K,k+1)}else if(4===D){var l=G.getPoints(),Y=l.get(k),f=l.get(k+3),Q={x:C.x,y:C.y};Q=qc(L,Q.x-L.x,Q.y-L.y,-U);var K=dp(Y,Q),i=os(Y,Q),P=dp(Q,f),A=os(Q,f);H.removeAt(E),H.add(4,E),H.add(4,E),G[F](k+1),G[F](k+1),G[J](Q,k+1),G[J](A,k+2),G[J](P,k+2),G[J](i,k+1),G[J](K,k+1)}else if(5===D){var Q={x:C.x,y:C.y};H.add(2,E),Q=qc(L,Q.x-L.x,Q.y-L.y,-U),G[J](Q,k+1)}G.isClosePath()&&H.remove(5),G.setSegments(H);var O=G.getWidth(),j=G.getHeight(),V=G.p().x-O/2,g=G.p().y-j/2;V-=L.x,g-=L.y;var N=Tp(G,{x:V,y:g,width:O,height:j},U,L);G.p(N.x,N.y)}else if(G instanceof d){if("points"!==G.s("edge.type"))return M.endTransaction(),void 0;var l=G.s("edge.points");H=G.s("edge.segments"),l=Th(n.getDataUI(G),l),H&&H.size()||(H=ii(l)),H=new T(H._as.slice(0)),l=new T(l._as.slice(0));var D=H.get(E);if(2===D||1===D){var Q={x:C.x,y:C.y};H.add(D,E),l.add(Q,k+1)}else if(3===D){var Y=l.get(k),f=l.get(k+2),Q={x:C.x,y:C.y},K=$h(Y,Q),i=$h(Q,f);H.removeAt(E),H.add(3,E),H.add(3,E),l.set(k+1,Q),l.add(i,k+2),l.add(K,k+1)}else if(4===D){var Y=l.get(k),f=l.get(k+3),Q={x:C.x,y:C.y},K=dp(Y,Q),i=os(Y,Q),P=dp(Q,f),A=os(Q,f);H.removeAt(E),H.add(4,E),H.add(4,E),l.removeAt(k+1),l.removeAt(k+1),l.add(Q,k+1),l.add(A,k+2),l.add(P,k+2),l.add(i,k+1),l.add(K,k+1)}G.s("edge.points",Vl(l)),G.s("edge.segments",H)}}}M.endTransaction()},removeShapePoint:function(N,A){var Q=this,W="removeAt",t=Q.gv,D=t.dm();if(D.beginTransaction(),0===arguments.length&&(N=Q._shape||Q._edge,A=Q._removePointIndex),A>=0&&(N instanceof h||N instanceof d)){var f=im(N,Q.gv.getDataUI(N),A),w=A;if(N instanceof h){var U=N.p(),s=N.toSegments();s&&s.size()||(s=ii(N.getPoints()));var k=s.get(f),x="removePointAt";if(1===k&&0===w)if(N.getPoints().size()>1){var X=s.get(f+1);s[W](f+1),3===X?N[x](w+1):4===X&&(N[x](w+2),N[x](w+1)),N[x](w)}else N.dm().remove(N);else 2===k||1===k?(s[W](f),N[x](w)):3===k?(s[W](f),N[x](w),N[x](w-1)):4===k&&(s[W](f),N[x](w),N[x](w-1),N[x](w-2));N.setSegments(s);var J=N.getWidth(),j=N.getHeight(),Z=N.p().x-J/2,q=N.p().y-j/2;Z-=U.x,q-=U.y;var n=Tp(N,{x:Z,y:q,width:J,height:j},N.getRotation(),U);N.p(n.x,n.y)}else if(N instanceof d){if("points"!==N.s("edge.type"))return D.endTransaction(),void 0;var L=N.s("edge.points");if(s=N.s("edge.segments"),L&&(L=Th(Q.gv.getDataUI(N),L),s&&s.size()||(s=ii(L))),0===A||A===L.size()-1)return D.endTransaction(),void 0;s=new T(s._as.slice(0)),L=new T(L._as.slice(0));var k=s.get(f);2===k||1===k?(s[W](f),L[W](w)):3===k?(s[W](f),L[W](w),L[W](w-1)):4===k&&(s[W](f),L[W](w),L[W](w-1),L[W](w-2)),N.s("edge.segments",s),N.s("edge.points",Vl(L))}}D.endTransaction()},changeShapeSegment:function(f,D,n){var P=this,$=P.gv,F=$.dm();if(F.beginTransaction(),1!==arguments.length||isNaN(f)||(n=f,f=P._shape||P._edge,D=P._hoverSegmentIndex),f instanceof h||f instanceof d){var H=Uk(f,P.gv.getDataUI(f),D);if(!isNaN(D)&&!isNaN(H))if(f instanceof h){var Y=f.p(),J=f.toSegments();J&&J.size()||(J=ii(f.getPoints()));var q=J.get(D),w=f.toPoints();if(1===n||2===n)1===q||2===q?J.set(D,n):3===q?(J.set(D,n),w.removeAt(H+1)):4===q&&(J.set(D,n),w.removeAt(H+1),w.removeAt(H+1));else if(3===n){var B=function(){var d=w.get(H),o=w.get(H+1),F=$h(d,o);J.set(D,3),w.add(F,H+1)};2===q||1===q?B():4===q&&(w.removeAt(H+1),w.removeAt(H+1),B())}else if(4===n){var g=function(){var U=w.get(H),I=w.get(H+1),C=dp(U,I),b=os(U,I);J.set(D,4),w.add(C,H+1),w.add(b,H+2)};2===q||1===q?g():3===q&&(w.removeAt(H+1),g())}f.setSegments(J),f.setPoints(w);var W=f.getWidth(),V=f.getHeight(),Q=f.p().x-W/2,t=f.p().y-V/2;Q-=Y.x,t-=Y.y;var m=new Tp(f,{x:Q,y:t,width:W,height:V},f.getRotation(),Y);f.p(m.x,m.y)}else if(f instanceof d){if("points"!==f.s("edge.type"))return F.endTransaction(),void 0;var w=f.s("edge.points");J=f.s("edge.segments"),w&&(w=Th(P.gv.getDataUI(f),w),J&&J.size()||(J=ii(w))),J=new T(J._as.slice(0)),w=new T(w._as.slice(0));var q=J.get(D);if(1===n||2===n)1===q||2===q?J.set(D,n):3===q?(J.set(D,n),w.removeAt(H+1)):4===q&&(J.set(D,n),w.removeAt(H+1),w.removeAt(H+1));else if(3===n){var B=function(){var E=w.get(H),N=w.get(H+1),r=$h(E,N);J.set(D,3),w.add(r,H+1)};2===q||1===q?B():4===q&&(w.removeAt(H+1),w.removeAt(H+1),B())}else if(4===n){var g=function(){var j=w.get(H),z=w.get(H+1),d=dp(j,z),O=os(j,z);J.set(D,4),w.add(d,H+1),w.add(O,H+2)};2===q||1===q?g():3===q&&(w.removeAt(H+1),g())}f.s("edge.points",Vl(w)),f.s("edge.segments",J)}}F.endTransaction()},getDefaultSegments:function(U){var k=this.gv,p=k.getDataUI(U);if(U instanceof d){var F=U.s("edge.points");return F=Th(p,F),ii(F)}if(U instanceof h){var F=U.getPoints(),o=U.getSegments();return o&&o.size()>0?o:ii(F)}},$43l:function(x){var h=this;x&&(h.$5l=1),h._68I=1,h._42()},_42:function(){var R=this;if(R._68I){delete R._68I;var A=R.gv,Q=R.$5l,k=A.getZoom(),Z=A.getEditPointSize(),J=Z/2,H=new T,Y=R._view,g=R._edge,D=R._shape,$=Y.getContext("2d"),B=A.tx(),y=A.ty(),b=w,S=A.getEditPointBackground(),W=A.getControlPointBackground(),p=A.getControlPointBorderColor(),E=A.getEditPointBorderColor(),K=A.getEditRectBorderColor(),C=A.getDirectionLineColor(),L=A.getSegmentHoverColor(),v=A.getSnapPointBorderColor(),G=A.getJoinPointBackground(),X=A.getJoinPointBorderColor(),N=A.getSegmentHoverWidth(),l=[5,5],V=A.getEditRectBorderStyle();tn(A,function(w){A.isSelected(w)&&A.isVisible(w)&&H.add(w)}),$.clearRect(0,0,c(Y.width),c(Y.height)),$.save(),j.translateAndScale($,B,y,1);var F=w,s={x:0,y:0,width:0,height:0},z=0,i=0,x=0,o=0,e=0,a=0,Zb=0,Ob=0,Tf=0,js=0,Rh=[];if(Q?(delete R.$6l,delete R.$8l,delete R.$7l,delete R.$16l,delete R.$23l):(F=R.$6l,b=R.$7l),delete R.$68l,delete R.$69l,delete R.$71l,delete R.$70l,delete R.$82l,delete R.$83l,delete R._pointElevationHelperPoint,delete R.$90l,delete R.$91l,delete R.$75l,delete R.$74l,H.each(function(D){var d=A.getDataUI(D);if(d){var G=d._55O;if(A.isEditable(D))G._56O&&D instanceof P&&i++,Rh.push(D),G._42O&&D instanceof P&&z++,A.isHelperEditable(D,"host")&&o++,A.isHelperEditable(D,"parent")&&x++,A.isHelperEditable(D,"remove")&&e++,A.isHelperEditable(D,"edge")&&a++,A.isHelperEditable(D,"source")&&Zb++,A.isHelperEditable(D,"target")&&Ob++,A.isHelperEditable(D,"elevation")&&Tf++,A.isHelperEditable(D,"tall")&&js++;else if(D instanceof _&&D.isExpanded()){var M=!0,T=A.getEditableFunc();T&&(M=T(D)),M&&(A.isHelperEditable(D,"host")&&o++,A.isHelperEditable(D,"parent")&&x++,A.isHelperEditable(D,"remove")&&e++,A.isHelperEditable(D,"edge")&&a++,A.isHelperEditable(D,"source")&&Zb++,A.isHelperEditable(D,"target")&&Ob++,A.isHelperEditable(D,"elevation")&&Tf++,A.isHelperEditable(D,"tall")&&js++,Rh.push(D))}}}),$.beginPath(),$.lineWidth=1,$.strokeStyle=A.getNodeBorderColor(),Rh.forEach(function(E){var y=A.getDataUI(E),V=y._55O;if(Q)if(b==w&&(b=E instanceof d?0:E instanceof _&&E.isExpanded()?0:E.getRotation(),R.$7l=b),F==w){var S,o,q;if(E instanceof _&&E.isExpanded()||E instanceof d){var Y=A.getDataUIBounds(E);o=Y.width,q=Y.height,S={x:Y.x+o/2,y:Y.y+q/2}}else S=E.p(),o=E.getWidth(),q=E.getHeight();F={x:S.x,y:S.y,width:0,height:0},s.x=S.x-o/2,s.y=S.y-q/2,s.width=o,s.height=q,F=m(F,s)}else{var S,o,q,p,H=F.x+F.width/2,c=F.y+F.height/2,v={x:H,y:c};if(E instanceof _&&E.isExpanded()||E instanceof d){p=0;var Y=A.getDataUIBounds(E);o=Y.width,q=Y.height,S={x:Y.x+o/2,y:Y.y+q/2}}else S=E.p(),o=E.getWidth(),q=E.getHeight(),p=E.getRotation();var i={x:S.x-o/2,y:S.y-q/2,width:o,height:q},B={x:i.x,y:i.y},t={x:i.x+i.width,y:i.y},r={x:i.x,y:i.y+i.height},l={x:i.x+i.width,y:i.y+i.height},B=qc(S,B.x-S.x,B.y-S.y,p),r=qc(S,r.x-S.x,r.y-S.y,p),l=qc(S,l.x-S.x,l.y-S.y,p),t=qc(S,t.x-S.x,t.y-S.y,p),h=-b,a=qc(v,B.x-v.x,B.y-v.y,h),W=qc(v,t.x-v.x,t.y-v.y,h),K=qc(v,r.x-v.x,r.y-v.y,h),T=qc(v,l.x-v.x,l.y-v.y,h),O=M([a,W,K,T]);F=m(F,O),F.x-=H,F.y-=c;var N=Tp(w,F,b,v);F.x=N.x-F.width/2,F.y=N.y-F.height/2}if(z>1&&A.isEditable(E)&&A.isRectEditable(E)&&E instanceof P){var Z=E.getRect(),u=V.$45l,D=Tc(u[0],k),X=Tc(u[2],k),j=Tc(u[4],k),L=Tc(u[6],k);E.getRotation()?($.moveTo(D.x,D.y),$.lineTo(X.x,X.y),$.lineTo(j.x,j.y),$.lineTo(L.x,L.y),$.lineTo(D.x,D.y)):$.rect(Z.x*k,Z.y*k,Z.width*k,Z.height*k)}}),$.stroke(),F){R.$6l=n(F),q(F,A.getEditRectPadding()/k);var Tk={x:F.x+F.width/2,y:F.y+F.height/2},sb=hq(Tk,F.width,F.height,b),Ec=sb[0],dq=sb[1],gp=sb[2],gl=sb[3],es=sb[4],ge=sb[5],jl=sb[6],Dm=sb[7];if(Ec=Tc(sb[0],k),dq=Tc(sb[1],k),gp=Tc(sb[2],k),gl=Tc(sb[3],k),es=Tc(sb[4],k),ge=Tc(sb[5],k),jl=Tc(sb[6],k),Dm=Tc(sb[7],k),R.$8l=F,z>0&&(R.$16l=[Ec,es,dq,ge,gl,jl,gp,Dm],$.beginPath(),$.lineWidth=1,$.strokeStyle=K,"dashed"===V&&$.setLineDash&&$.setLineDash(l),$.moveTo(Ec.x,Ec.y),$.lineTo(dq.x,dq.y),$.lineTo(gl.x,gl.y),$.lineTo(gp.x,gp.y),$.lineTo(Ec.x,Ec.y),$.stroke(),"dashed"===V&&$.setLineDash&&$.setLineDash([])),$.beginPath(),$.lineWidth=1,$.fillStyle=S,$.strokeStyle=E,z>0){var fh=ge.x-Dm.x,sh=ge.y-Dm.y,rf=f(fh*fh+sh*sh),kr=es.x-jl.x,Jm=es.y-jl.y,dc=f(kr*kr+Jm*Jm),no=2*Z;if(A.isDirectionEditable&&1===Rh.length){var kd=Rh[0],so=A.getDataUI(kd),rl=so._55O,Wm=A.isDirectionEditable.bind(A);if(rl._42O){var Ye,Nf,am,Ac;Wm(kd,"northwest")&&(Ye=!0,$.rect(Ec.x-J,Ec.y-J,Z,Z)),Wm(kd,"northeast")&&(Nf=!0,$.rect(dq.x-J,dq.y-J,Z,Z)),Wm(kd,"southwest")&&(am=!0,$.rect(gp.x-J,gp.y-J,Z,Z)),Wm(kd,"southeast")&&(Ac=!0,$.rect(gl.x-J,gl.y-J,Z,Z)),Wm(kd,"north")&&(Ye&&Nf?rf>no&&$.rect(es.x-J,es.y-J,Z,Z):$.rect(es.x-J,es.y-J,Z,Z)),Wm(kd,"south")&&(Ac&&am?rf>no&&$.rect(jl.x-J,jl.y-J,Z,Z):$.rect(jl.x-J,jl.y-J,Z,Z)),Wm(kd,"west")&&(am&&Ye?dc>no&&$.rect(Dm.x-J,Dm.y-J,Z,Z):$.rect(Dm.x-J,Dm.y-J,Z,Z)),Wm(kd,"east")&&(Ac&&Nf?dc>no&&$.rect(ge.x-J,ge.y-J,Z,Z):$.rect(ge.x-J,ge.y-J,Z,Z))}}else rf>no&&($.rect(es.x-J,es.y-J,Z,Z),$.rect(jl.x-J,jl.y-J,Z,Z)),dc>no&&($.rect(ge.x-J,ge.y-J,Z,Z),$.rect(Dm.x-J,Dm.y-J,Z,Z)),$.rect(Ec.x-J,Ec.y-J,Z,Z),$.rect(dq.x-J,dq.y-J,Z,Z),$.rect(gp.x-J,gp.y-J,Z,Z),$.rect(gl.x-J,gl.y-J,Z,Z)}if(i>0){var Uj=R.$23l=qc(es,0,2*-Z,b);$.moveTo(Uj.x+J,Uj.y),$.arc(Uj.x,Uj.y,J,0,O,!1)}$.fill(),$.stroke(),R.$40l&&R.$44l($,F,b);var Ip,ml,hd=A.getLeftTopHelpers(),Ql=A.getRightTopHelpers(),gc=A.getLeftBottomHelpers(),qr=A.getRightBottomHelpers(),zp=A.getEdgeHelpers(),yh=A.getEditHelperSize(),Np=yh/2,Do=function(D,i,n,W){"leftTop"===i?(Ip=F.x*k-yh-J-("h"===W?n*(yh+J):0)-1,ml=F.y*k-yh-J-("v"===W?n*(yh+J):0)-1):"rightTop"===i?(Ip=(F.x+F.width)*k+J+("h"===W?n*(yh+J):0)+1,ml=F.y*k-yh-J-("v"===W?n*(yh+J):0)-1):"leftBottom"===i?(Ip=F.x*k-yh-J-("h"===W?n*(yh+J):0)-1,ml=(F.y+F.height)*k+J+("v"===W?n*(yh+J):0)+1):"rightBottom"===i&&(Ip=(F.x+F.width)*k+J+("h"===W?n*(yh+J):0)+1,ml=(F.y+F.height)*k+J+("v"===W?n*(yh+J):0)+1);var r=Ip+Np,V=ml+Np,l=(F.x+F.width/2)*k,Z=(F.y+F.height/2)*k,y=qc({x:l,y:Z},r-l,V-Z,b);if("host"===D){if(o>0)return R.$77l($,b,y),!0}else if("edge"===D){if(a>0)return R.$80l($,b,y),!0}else if("remove"===D){if(e>0)return Rh&&1===Rh.length&&Rh[0]instanceof d?R.$81l($,b,{x:l+yh/2+5,y:Z}):R.$81l($,b,y),!0}else if("parent"===D){if(x>0)return Rh&&1===Rh.length&&Rh[0]instanceof d?R.$76l($,b,{x:l-yh/2-5,y:Z}):R.$76l($,b,y),!0}else if("elevation"===D){if(Tf>0)return R.$85l($,b,y),!0}else if("tall"===D){if(js>0)return R.$86l($,b,y),!0}else if("source"===D||"target"===D){var w=Rh[0],H=A.getDataUI(w),v=qb(H,!0),T=v[0],c=v[1];if(Zb&&"source"===D)return R.$84l($,F,T,!0,w.isLooped(),i,n,W),!0;if(Ob&&"target"===D)return R.$84l($,F,c,!1,w.isLooped(),i,n,W),!0}};if(hd&&hd.length>0){var Yk=0;hd.forEach(function(R){Do(R,"leftTop",Yk,A.getLeftTopHelpersAlign()||"h")&&Yk++})}if(Ql&&Ql.length>0){var Yk=0;Ql.forEach(function(s){Do(s,"rightTop",Yk,A.getRightTopHelpersAlign()||"h")&&Yk++})}if(gc&&gc.length>0){var Yk=0;gc.forEach(function(N){Do(N,"leftBottom",Yk,A.getLeftBottomHelpersAlign()||"h")&&Yk++})}if(qr&&qr.length>0){var Yk=0;qr.forEach(function(n){Do(n,"rightBottom",Yk,A.getRightBottomHelpersAlign()||"h")&&Yk++})}if(zp&&zp.length>0&&((Zb||Ob)&&Rh&&1===Rh.length&&Rh[0]instanceof d?!0:!1)){var Yk=0;zp.forEach(function(V){Do(V,"edge",Yk,"h")&&Yk++})}if(R.$72l){var Yb,Wi=R.$67l,bp=R.$68l,kh=R.$69l,Jo=(R.$71l,R.$70l),Zr=R.$82l,xe=R.$83l;if(1===Wi?Yb=bp:2===Wi?Yb=kh:3===Wi?Yb=Jo:5===Wi?Yb=Zr:6===Wi&&(Yb=xe),Yb){var Up=A.lp(R.$72l),lo=A.getDataAt(R.$72l);if(lo&&lo instanceof P){var qk,Bd,Bm;if(R.$73l=lo,1===Wi)if(lo instanceof r.Grid)qk=R.$75l=on(lo,Up);else if(lo instanceof r.Shape){Bm=R.$74l=Fq(lo,Up);var Sc=lo.getPoints();if(Bm){var el=Bm.attachIndex,xk=Uk(lo,A.getDataUI(lo),el)+1,Eb=xk+1>=Sc.size()?0:xk+1,Yd=Sc.get(xk),Tl=Sc.get(Eb),Op=lo.p(),_i=lo.getRotation();Yd=qc(Op,Yd.x-Op.x,Yd.y-Op.y,_i),Tl=qc(Op,Tl.x-Op.x,Tl.y-Op.y,_i),$.beginPath(),$.strokeStyle=L,$.lineWidth=N,$.moveTo(Yd.x*k,Yd.y*k),$.lineTo(Tl.x*k,Tl.y*k),$.stroke()}}qk?Bd=qk.rect:(Bd=U.clone(A.getDataUIBounds(lo)),U.grow(Bd,2)),$.beginPath(),$.rect(Bd.x*k,Bd.y*k,Bd.width*k,Bd.height*k),$.strokeStyle=1===Wi||4===Wi||6===Wi?I:t,$.lineWidth=2,$.setLineDash&&$.setLineDash([8,8]),$.stroke()}else delete R.$73l;Up.x=Up.x*k,Up.y=Up.y*k;var Km=Ml(Yb.x,Yb.y,Up.x,Up.y),Ck=qc(Yb,Up.x-Yb.x,Up.y-Yb.y,-Km),sq=Ck.x-Yb.x;$.save(),$.translate(Yb.x,Yb.y),$.rotate(Km),u.width=sq,u.height=40;var Dj=t;(1===Wi||4===Wi||6===Wi)&&(Dj=I),u.comps[0].gradientColor=Dj,U.drawImage($,u,0,-20,sq,40),$.restore()}}}if(H.each(function(i){var U=A.getDataUI(i);if(U){var B,I,b=U._55O,E=U._78o;if(b&&b._43O&&i instanceof h?(B=b.$15l,I=i.getSegments(),I&&I.size()||(I=ii(B)),i.isClosePath()&&I.indexOf(5)<0&&(I=new T(I._as),I.add(5))):b&&E&&b._43O&&(B=i.s("edge.points"),I=i.s("edge.segments"),B=Th(U,B),I&&I.size()||(I=ii(B)),B&&(B=B._as)),B&&I){var M=0,o=I.size(),j=R._hoverSegmentIndex;B=B.slice(0);for(var d=0;d<B.length;d++)B[d]=Tc(B[d],k);$.beginPath(),$.strokeStyle=C,$.lineWidth=1,M=0;for(var d=0;o>d;d++){var e=I.get(d);if(1===e||2===e)M++;else if(3===e){var q=B[M-1],Y=B[M],r=B[M+1];$.moveTo(q.x,q.y),$.lineTo(Y.x,Y.y),$.lineTo(r.x,r.y),M+=2}else if(4===e){var q=B[M-1],t=B[M],x=B[M+1],r=B[M+2];$.moveTo(q.x,q.y),$.lineTo(t.x,t.y),$.moveTo(x.x,x.y),$.lineTo(r.x,r.y),M+=3}}if($.stroke(),D===i||g===i&&"points"===g.s("edge.type")){$.beginPath(),M=0,$.strokeStyle=L,$.lineWidth=N;for(var d=0;o>d;d++){var e=I.get(d);if(1===e||2===e){if(j===d){var q=B[M-1],r=B[M];$.moveTo(q.x,q.y),$.lineTo(r.x,r.y);break}M++}else if(3===e){if(j===d){var q=B[M-1],Y=B[M],r=B[M+1];$.moveTo(q.x,q.y),$.quadraticCurveTo(Y.x,Y.y,r.x,r.y);break}M+=2}else if(4===e){if(j===d){var q=B[M-1],t=B[M],x=B[M+1],r=B[M+2];$.moveTo(q.x,q.y),$.bezierCurveTo(t.x,t.y,x.x,x.y,r.x,r.y);break}M+=3}else if(5===e&&j===d){var q=B[M-1],r=B[0];$.moveTo(q.x,q.y),$.lineTo(r.x,r.y);break}}$.stroke()}$.beginPath(),M=0,$.strokeStyle=X,$.lineWidth=1,$.fillStyle=G;for(var d=0;o>d;d++){var e=I.get(d);if(1===e||2===e){var r=B[M];$.moveTo(r.x+J,r.y),$.arc(r.x,r.y,J,0,O,!0),M++}else if(3===e){var r=B[M+1];$.moveTo(r.x+J,r.y),$.arc(r.x,r.y,J,0,O,!0),M+=2}else if(4===e){var r=B[M+2];$.moveTo(r.x+J,r.y),$.arc(r.x,r.y,J,0,O,!0),M+=3}}$.fill(),$.stroke(),$.beginPath(),M=0,$.strokeStyle=p,$.lineWidth=1,$.fillStyle=W;for(var d=0;o>d;d++){var e=I.get(d);if(1===e||2===e)M++;else if(3===e){var Y=B[M];$.moveTo(Y.x+J,Y.y),$.arc(Y.x,Y.y,J,0,O,!0),M+=2}else if(4===e){var t=B[M],x=B[M+1];$.moveTo(t.x+J,t.y),$.arc(t.x,t.y,J,0,O,!0),$.moveTo(x.x+J,x.y),$.arc(x.x,x.y,J,0,O,!0),M+=3}}if($.fill(),$.stroke(),$.beginPath(),M=0,$.strokeStyle=v,$.lineWidth=2,(D===i||g===i)&&R.$9l!=w){var r=B[R.$9l];$.moveTo(r.x+J,r.y),$.arc(r.x,r.y,J,0,O,!0),$.stroke()}}}}),R.$87l&&A.sm().contains(R.$87l)){var Gd,Yj=R.$87l,er=R.$88l,yh=A.getEditHelperSize(),Np=yh/2;if(A.isHelperEditable(Yj,"pointElevation"))if(Yj instanceof h){var bi=Yj.getPosition();Gd=U.clone(Yj.getPoints().get(er)),Gd=qc({x:bi.x,y:bi.y},Gd.x-bi.x,Gd.y-bi.y,Yj.getRotation()),Gd.x*=k,Gd.y*=k,$.translate(Gd.x,Gd.y),U.drawImage($,U.getImage("xeditinteractor_elevationIcon"),Np,-Np,yh,yh),$.translate(-Gd.x,-Gd.y),R._pointElevationHelperPoint={x:Gd.x+yh,y:Gd.y}}else if(Yj instanceof d){var Df=Th(A.getDataUI(Yj),Yj.s("edge.points")),Gd=U.clone(Df.get(er));Gd.x*=k,Gd.y*=k,$.translate(Gd.x,Gd.y),U.drawImage($,U.getImage("xeditinteractor_elevationIcon"),Np,-Np,yh,yh),$.translate(-Gd.x,-Gd.y),R._pointElevationHelperPoint={x:Gd.x+yh,y:Gd.y}}}$.restore(),R.$5l=0}},$89l:function(l,T,V,H){l.save();var q=this,n=q.gv,K=n.getEditHelperSize(),a=K/2;l.beginPath(),l.translate(V.x,V.y),l.rotate(T),U.drawImage(l,H,-a,-a,K,K),l.restore()},$85l:function(D,Q,W){var C=this;C.$90l=W,C.$89l(D,Q,W,U.getImage("xeditinteractor_elevationIcon"))},$86l:function(s,g,K){var Z=this;Z.$91l=K,Z.$89l(s,g,K,U.getImage("xeditinteractor_tallIcon"))},$77l:function(x,k,J){var N=this;N.$68l=J,N.$89l(x,k,J,U.getImage("xeditinteractor_hostIcon"))},$80l:function(z,Y,p){var r=this;r.$70l=p,r.$89l(z,Y,p,U.getImage("xeditinteractor_edgeIcon"))},$81l:function(k,m,f){var T=this;T.$71l=f,T.$89l(k,m,f,U.getImage("xeditinteractor_removeIcon"))},$76l:function(J,K,h){var Z=this;Z.$69l=h,Z.$89l(J,K,h,U.getImage("xeditinteractor_parentIcon"))},$84l:function(o,r,P,W,s){var e,G=this,E=G.gv,n=E.getZoom(),F=E.getEditHelperSize(),d=F/2;P.x*=n,P.y*=n,s&&(W?P.x-=d+5:P.x+=d+5),P.y-=F-2,W?(G.$82l=P,e=U.getImage("xeditinteractor_sourceIcon")):(G.$83l=P,e=U.getImage("xeditinteractor_targetIcon")),o.beginPath(),o.translate(P.x,P.y),U.drawImage(o,e,-d,-d,F,F),o.translate(-P.x,-P.y)},$44l:function(T,M,z){T.save();var H=this.gv.getZoom(),I=f(p(M.width,2)+p(M.height,2))/2*H+10,S=I,y=S+8,Y=S+18,t=z,O=M.x+M.width/2,l=M.y+M.height/2;T.translate(O*H,l*H),T.beginPath(),T.strokeStyle="rgb(150, 150, 150)";for(var h=0,U=0,$=0,D=0,b=0,u=0;360>u;u++)h=u*s/180,0===u%5&&(U=x(h)*S,$=F(h)*S,D=x(h)*y,b=F(h)*y,T.moveTo(U,$),T.lineTo(D,b)),0===u%45&&(U=x(h)*S,$=F(h)*S,D=x(h)*Y,b=F(h)*Y,T.moveTo(U,$),T.lineTo(D,b));T.stroke(),T.beginPath(),T.rotate(-a),T.beginPath(),T.fillStyle="rgba(255, 0, 0, 0.1)",T.strokeStyle="rgb(157, 157, 157)",T.moveTo(0,0),T.arc(0,0,Y,0,z,!1),T.fill(),T.beginPath(),T.moveTo(0+Y,0),T.arc(0,0,Y,0,z,!1),T.stroke(),T.rotate(a),T.font="bold 12px Verdana, Arial";var N=20*F(t),c=20*x(t),v=A(180*t/s)+"°";T.textAlign="center",T.textBaseline="middle",T.beginPath();var K=T.measureText("365.°").width;T.fillStyle="white",T.rect(N-K/2,-c-10,K,20),T.fill(),T.beginPath(),T.fillStyle="rgb(79,79,79)",T.fillText(v,N,-c),T.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);