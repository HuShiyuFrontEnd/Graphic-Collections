!function(p,m,z){"use strict";var q="ht";if(!p[q]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),p.performance&&p.performance.now||function(){var m=Date.now();p.performance||(p.performance={}),p.performance.now=function(){return Date.now()-m}}();for(var u=Date.now(),r=16,j=["ms","moz","webkit","o"],Q=0;Q<j.length&&!p.requestAnimationFrame;++Q)p.requestAnimationFrame=p[j[Q]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[j[Q]+"CancelAnimationFrame"]||p[j[Q]+"CancelRequestAnimationFrame"];p.requestAnimationFrame||(p.requestAnimationFrame=function(c){var J=Date.now(),F=r+u-J;return 0>F&&(F=0),u=J,p.setTimeout(function(){u=Date.now(),c(performance.now())},F)}),p.cancelAnimationFrame||(p.cancelAnimationFrame=function(H){return p.clearTimeout(H)}),m.assign===z&&(m.assign=function(C){if(C===z||null===C)throw new TypeError("Cannot convert undefined or null to object");for(var h=m(C),K=1;K<arguments.length;K++){var a=arguments[K];if(a!==z&&null!==a)for(var n in a)m.prototype.hasOwnProperty.call(a,n)&&(h[n]=a[n])}return h})}();var I=p.document,G=null,K=p[q]={},e=p[q+"config"],V=K.Default=e&&e.Default||{},r=K.Style=e&&e.Style||{},v=K.Attr=e&&e.Attr||{},M=K.Color=e&&e.Color||{},A=K.IsGetter=e&&e.IsGetter||{};!function(){var a=!1;try{var e=m.defineProperty({},"passive",{get:function(){a=!0}});p.addEventListener("test",e,e),p.removeEventListener("test",e,e)}catch(I){a=!1}V.passiveSupported=a}();var L,k,h,U,i=V.passiveSupported,f=V.eventListenerOptionsFalse=i?{passive:!1,capture:!1}:!1,w=V.eventListenerOptionsTrue=i?{passive:!1,capture:!0}:!0,P=Math,a=P.round,y=P.floor,j=P.ceil,H=P.sqrt,W=P.max,$=P.min,D=P.abs,F=P.cos,t=P.acos,s=P.sin,c=P.pow,S=P.asin,C=P.PI,O=2*C,Y=C/2,g=P.tan,x=P.atan2,Z=P.random,B=P.log,J=!1,n=!1,_=p.parseInt||global.parseInt,d="2018-11-01",R=p.navigator?p.navigator.platform.indexOf("Win")>-1:!1,Q=function(V){return V*V},o=p.setTimeout,N=p.clearTimeout,l=p.location,T=p.navigator?p.navigator.userAgent.toLowerCase():"",E=function(w){return w.test(T)},b=E(/msie/),u=E(/msie/)||E(/trident/),X=E(/msie 10/),$o=E(/edge/),yr=E(/firefox/),Ic=E(/mac/),Ai=V.isTouchable===z?R?!1:I?"ontouchend"in I:!1:V.isTouchable,Ll="default",nf="single",cq="multiple",Gb="front",Cb="back",kh="left",tq="right",Wj="top",Eh="bottom",Ng="center",Gd="eye",El="middle",xf="east",jk="west",ef="north",Jg="none",un="px",km="absolute",iq="border",zs="triangle",zn="rect",Xe="circle",Te="cylinder",nh="shape",hf="items",Hg="normal",fk="remove",Bd="clear",zp="width",dd="height",gc="ingroup",Pr="check",qe="uncheck",kc="radio",Bm="radioOn",Lo="radioOff",Wp="points",sg="values",sj="series",Yg="body",Fo="label",Or="label2",qs="note",Kn="note2",bs="icons",fp="labelFont",Yc="labelColor",Jb="labelSelectColor",pk="note.expanded",hk="note2.expanded",Nh="edge.expanded",id="edge.points",Oe="edge.type",Yd="rotation",Db="hidden",Re="visible",$b="tuv",_b="no",om="draw",ks="select",Km="currentSubGraph",Uh="selectBackground",hl="autoMakeVisible",xq="autoHideScrollBar",jm="scrollBarColor",os="scrollBarSize",wm="indent",Cj="rowHeight",Bl="columnLineColor",Vg="rowLineColor",jc="columnLineVisible",Pc="rowLineVisible",Kg="visibleFunc",Hm="expandIcon",Hk="collapseIcon",Ke="checkMode",Oo="sortFunc",zb="editable",wo="batchEditable",hg="tristate",Ag="asc",qf="desc",Hr="position",zc="elevation",Bn="children",Tg="translateX",oh="translateY",Ob="dataModel",Mh="maxSize",mm="shape3d",Pk="shape3d.resolution",Qn="shape3d.visible",xg="shape3d.from.visible",Nn="shape3d.to.visible",Mq="shape3d.top.visible",Fg="shape3d.bottom.visible",bp="repeat.uv.length",bb="serializeValue",Eg="deserializeValue",Bb="centerUniform",Bk="uniform",wb="rgba(255,255,255,0)",lc="style",bh="attr",pr="field",ue="string",Dc="boolean",ii="color",ek="int",Fq="number",Nm="ew-resize",uh="ns-resize",Dg="pointer",po="auto",Eo="mousedown",md="mousemove",Vo="mouseup",kq="mouseout",Xc="touchstart",Lk="touchmove",Xi="touchend",Bo="keydown",Jf="keyup",Ej=["DOMMouseScroll","mousewheel"],so=yr?Ej[0]:Ej[1],Sf=Ai?[Xc,Lk,Xi,Bo,Jf,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Bo,Jf,"keypress","input",Eo,md,Vo,kq,so,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Fi=G,Ui=G,$g=G,wd=Vo.length,He=function(){$g&&(N($g.timeout),$g=G)},ok=function(){$g&&oj($g.e,$g.info)};p.addEventListener&&(Ai||(p.addEventListener(kq,function(){He()},f),p.addEventListener(so,function(){um()},f)),p.addEventListener(Jf,function(r){91===r.keyCode?Yr={}:delete Yr[r.keyCode]},w),p.addEventListener(Bo,function(r){Yr[r.keyCode]=!0},w),p.addEventListener("blur",function(){Yr={}},f));var Kk,fi,Em,ge=0,gj=G,Ae=function(d,j){var s=o(function(){delete gj[s],Oc(gj)&&(gj=G),d()},j);return s},pb=G,Ec=G,Xg={},Ze={},Zo={},en={},oq={},Yr={},No={},$j={},rp={},Ib={},Zj=/.json$/,kg=/^data:image\/svg\+xml/,Dq={},_o=[],Er={},vo=G,lh=G,ts=function(){},dm=function(){throw"Oops!"},ie=[0,0,0],ps=[0,0,0,0],ai={x:0,y:0,width:0,height:0},zh=G,ho=G,If=G,mc=function(K){ho&&!K._72O&&(If||(If={}),If[K._72O=Jn()]=K),Kk!=G?ls()<.05&&U&&!fi&&(df=He):df=Rk},Ue=function(R,K,C,v){ho||(ho={});var t=ho[R];if(t){if(t.url===K)return;t.image?(t.image.onload=ts,t.image.onerror=ts):t.request&&(t.request.onload=ts,t.request.onerror=ts)}if(Zj.test(K)){var N=new We;if(ho[R]={request:N,url:K},K=V.beforeLoadURL(K),K.data){var n=V.parse(K.data);rk(R,n),V.handleImageLoaded(R,n)}else{N.onload=function(P){if(200===this.status||0===this.status){var y=V.parse(P.target.response||P.target.responseText);rk(R,y),V.handleImageLoaded(R,y)}else rk(R,V.handleUnfoundImage(R,K)||G)},N.onerror=function(){rk(R,V.handleUnfoundImage(R,K)||G)};var B={};B.url=encodeURI(K),B.sync=!1,N.send(B)}}else{var n=new Image;ho[R]={image:n,url:K},/^data:image/.test(K)||(K=V.beforeLoadURL(K),K=V.appendTimeStamp(K),K=encodeURI(K),n.crossOrigin=V.crossOrigin),V.convertImageSrc(K,function(b){u&&(K.toLowerCase().indexOf(".svg")>0||kg.test(K))?(I.body.appendChild(n),n.style.visibility="hidden",n.onload=function(){o(function(){if(C&&(n.width=C),v&&(n.height=v),!n.width||!n.height){var K=n.width||n.clientWidth,w=n.height||n.clientHeight;n.width=K,n.height=w}V.handleImageLoaded(R,n),rk(R,n),I.body.removeChild(n),n.style.visibility=""},180)},n.onerror=function(){rk(R,V.handleUnfoundImage(R,K)||G),I.body.removeChild(n),n.style.visibility=""}):(n.onload=function(){C&&(n.width=C),v&&(n.height=v),V.handleImageLoaded(R,n),rk(R,n)},n.onerror=function(){rk(R,V.handleUnfoundImage(R,K)||G)}),n.src=b})}},rk=function(B,s){if(Ze[B]=s,delete ho[B],Oc(ho)&&(ho=G,If)){for(var A in If){var o=If[A];o._2O&&(o._2O={}),o.invalidateAll&&o.invalidateAll(z,"imageLoaded",B),o.redraw&&o.redraw(),o.iv(),delete o._72O}If=G}if(s&&If)for(var A in If){var o=If[A];o.invalidateAll&&o.invalidateAll(z,"imageLoading",B),o.redraw&&o.redraw(),o.iv()}},Un=function(){return B=P&&Date,function(){return p.performance&&p.performance.now?p.performance.now():Date.now()}}(),En=function(h,l){l?N(h):p.cancelAnimationFrame(h)},Cl=function(C,A,T){return{width:C,height:A,comps:Ul(T)?T:[T]}},Pj=function($,z){return{type:Xe,rect:[$,z,1.6,1.6],borderWidth:1,borderColor:zg,gradient:yk,gradientColor:$h,background:zg}},pp=function(j,i){return Cl(16,16,{type:zs,rect:[4,4,10,8],background:j,rotation:i?1.57:3.14})},mp=function(n,v){return Cl(16,16,{type:zs,rect:[4,4,8,7],background:n,rotation:v?3.14:0})},yj=function(o){var $=o._orientation;return"horizontal"===$||"h"===$},Ef=function(Q){var w=G||4,g=G||1,q=G||1;0>w?w=0:w>.25&&(w=.25);var t,p,l,N,a,T,X,M=.5,f=[],j=[],y=[],c=O/q,r=O/g,d=M-w;for(p=0;g>=p;p++)for(N=-C+p*r,T=F(N),a=s(N),t=0;q>=t;t++)l=t*c,X=d+w*T,f.push(F(l)*X,a*w,-s(l)*X),(k=Q)&&j.push(t/q,1-p/g);for(p=0;g>p;p++){var U=p*(q+1),e=(p+1)*(q+1);for(t=0;q>t;t++)y.push(U+t,e+t+1,e+t,U+t,U+t+1,e+t+1),Oh.z=vf.z=Q}},jo=function(T){var M=2,s=0;for(var I in T)I.length===M&&_(I,32)===ri&&(vo=lh=T[I]),s++;return s},jd=function(t,D,S,u){return S||(S=Ai?5:3,S/=u||1),{x:t-S,y:D-S,width:2*S,height:2*S}},Ap=function(Y,N,R,Q){var k=this;N||(N=Ai?5:3,R=20,Q=20);var W={x:Y,y:N,width:R,height:Q};if(R)for(var S=0;R>S;S++)if(3===R)Q=20;else for(var v=0;Q>v;v++)k=p?p:R;var q={x:C,y:2*C};if(Wn(W,q)){var K=dd[0]+Wj[0]+Bd[1]+(Ag.length-1);Fd[Gd]=k[K],k[K]=yc[Gd]}},Lc=function(D){return(/ble$/.test(D)||/ed$/.test(D)||A[D]?"is":"get")+D.charAt(0).toUpperCase()+D.slice(1)},yc=function(e){return"set"+e.charAt(0).toUpperCase()+e.slice(1)},ed=function(k){return typeof k===ue||k instanceof String},Mj=function(G){return typeof G===Fq},Rk=function(Q){return typeof Q===Dc},ag=function(x){return x&&"object"==typeof x},em=function(o){return"function"==typeof o},Ul=function(d){return d instanceof Array},mb=function(k){return k instanceof fl},Th=function(G){return Ul(G)?new fl(G):G},gp=function(n){return n instanceof hi},Zc=function(A){return A instanceof $c},nk=function(E){return E instanceof gq},Nj=function(q,T){if(!(q instanceof K.Group))return!1;if(!T)return q.isExpanded();var B=T.getDataUI(q);return B&&B._88I?!0:!1},nr=function(B){return B instanceof Ro},aq=function(f){return f&&"IFRAME"===f.tagName},Ti=function(t){return t==G||V.numberDigits==G?t:parseFloat(t.toFixed(V.numberDigits))},ml=function(n,s,X){var r,M=s.length;if(X)for(var L=0;X>L;L++)if(3===M)n.push(s[0]),n.push(s[1]),n.push(s[2]);else for(r=0;M>r;r++)n.push(s[r]);else if(3===M)n.push(s[0]),n.push(s[1]),n.push(s[2]);else for(r=0;M>r;r++)n.push(s[r])},Jm=function(g){return g?ag(g)?g:{}:!1},Sm=function(b,u,J){var a,k=ag(b)?b:b.prototype;for(a in u)J&&k[a]!==z||(k[a]=u[a]);return b},Lj=function(W){return String.fromCharCode(W)},Sq=function(e){for(var O,H=0,y="";H<e.length;H++)O=e[e.length-1-H],"%"===O?O="'":"a"===O?O='"':"]"===O&&(O="\\"),y+=Lj(O.charCodeAt(0)-1);return y},Dr=function(Y,k,K){Y.superClass.constructor.apply(k,K)},Oc=function(i){for(var E in i)return!1;return!0},wr=function(A){return A?0===A.length:!0},Hn=function(){var e="";return[qe[0],Vg[0],Fo[0]].forEach(function(y){e+=yc(y).slice(3)}),Bk=I&&I[e]||Bb,function(f,J){return f===J?!0:f.x===J.x&&f.y===J.y&&f.width===J.width&&f.height===J.height}}(),xh=function(m,$,e){return $>m?$:m>e?e:m},nb=function(c){return 0>c?-1:c>0?1:0},ls=function(){var o=1e4*s(wd++);return o-y(o)},Sk=function(z,u,w){return Tm(z.x,z.y,u.x,u.y,w.x,w.y,w.x+w.width,w.y,!0)||Tm(z.x,z.y,u.x,u.y,w.x+w.width,w.y,w.x+w.width,w.y+w.height,!0)||Tm(z.x,z.y,u.x,u.y,w.x+w.width,w.y+w.height,w.x,w.y+w.height,!0)||Tm(z.x,z.y,u.x,u.y,w.x,w.y+w.height,w.x,w.y,!0)},Tm=function(w,U,r,t,v,q,s,i,O){var B=(s-v)*(U-q)-(i-q)*(w-v),M=(i-q)*(r-w)-(s-v)*(t-U);if(0!==M){var l=B/M,n=w+l*(r-w),h=U+l*(t-U);return O&&(n+Mm<$(w,r)||n-Mm>W(w,r)||n+Mm<$(v,s)||n-Mm>W(v,s)||h+Mm<$(U,t)||h-Mm>W(U,t)||h+Mm<$(q,i)||h-Mm>W(q,i))?G:[n,h]}return G},Yq=function(G,L,n){if(G&&n)if(L){if(L===lc)return G.getStyle(n);if(L===bh)return G.getAttr(n);if(L===pr)return G[n]}else if(n=Lc(n),G[n])return G[n]();return z},cb=function(W,J,x,Z){if(W&&x)if(J){if(J===lc)W.s(x,Z);else if(J===bh)W.a(x,Z);else if(J===pr){var I=W[x];W[x]=Z,W.fp("f:"+x,I,Z)}}else x=yc(x),W[x]&&W[x](Z)},Ij=function(P,G,c){return G&&"top"!==G?"bottom"===G?{x:P.x,y:P.y,width:P.width,height:P.height*c}:"right"===G?{x:P.x,y:P.y,width:P.width*c,height:P.height}:"left"===G?{x:P.x+P.width*(1-c),y:P.y,width:P.width*c,height:P.height}:void 0:{x:P.x,y:P.y+P.height*(1-c),width:P.width,height:P.height*c}},Ye=function(K,f,$,V,G){f&&Ig(K,$,V,1,G,f)},Bh=function(Y,A,y,D){var j=1-Y;return j*j*A+2*Y*j*y+Y*Y*D},Oh=function(e,x,D,P,o){var t=1-e;return t*t*t*x+3*t*t*e*D+3*t*e*e*P+e*e*e*o},Di=function(g){var c,Z,i,K,q=0;return g.forEach(function(y){if(c=y.length,c>0)for(Z=y[0],K=1;c>K;K++)i=y[K],q+=Li(Z,i),Z=i}),q},Gc=function(m,r,i){var G="__"+m,S=function(q){i.disabled||i["handle_"+m](q)};i[G]||(i[G]=S,r.addEventListener(m,S,f))},Jo=function(M,g,r){var j="__"+M,y=r[j];y&&(g.removeEventListener(M,y,f),delete r[j])},ns=function(p,i){var H="_"+i;p[Lc(i)]=function(){return this[H]},p[yc(i)]=function($){var Q=this[H];this[H]=$,this.fp(i,Q,$)}},ws=function(C){return m.create(C)},fc=function(Y){if(!Y.element){var T,R;(T=Y.textField)?R=Wd(ee.TextField,T):(T=Y.textArea)?R=Wd(ee.TextArea,T):(T=Y.button)?R=Wd(ee.Button,T):(T=Y.comboBox)?R=Wd(ee.ComboBox,T):(T=Y.checkBox)?R=Wd(ee.CheckBox,T):(T=Y.radioButton)?R=Wd(ee.RadioButton,T):(T=Y.slider)?R=Wd(ee.Slider,T):(T=Y.colorPicker)?R=Wd(ee.ColorPicker,T):(T=Y.image)&&(R=Wd(ee.Image,T)),R&&(Y.element=R)}},yn=function(w,p){var b=Rm(w);return b._ht=p,b},Rm=function(R,u){var p=I.createElement("div"),E=p.style;return p.tabIndex=-1,p.onkeydown=Jd,E.msTouchAction=Jg,Yk(p,G,0),Ai&&E.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",G),R&&(E.overflow=Db),u&&Mk(u,p),p},$p=function(O,Q){var n=I.createElement("canvas"),J=n.style;return J.msTouchAction=Jg,Q||(J.pointerEvents=Jg),Yk(n,G,0),O&&Mk(O,n),n},Yk=function(n,L,V){var Q=n.style;Q.border=L?L+" solid 1px":0,Q.outline=0,Q.padding=V?"0 "+V+un:0,_r(n)},_r=function(o){var f=o.style;f.position=km,f.margin=0,f.setProperty("box-sizing","border-box",G),f.setProperty("-moz-box-sizing","border-box",G)},Hp=function(j,Y,a,q){q||(q=Hd),Y!=G&&(j.width=Y*q,j.style.width=Y+un),a!=G&&(j.height=a*q,j.style.height=a+un)},Mk=function(h,J,z){h.appendChild(J),z&&(J.style.position=km)},Id=function(E,f){f.split||(f+="");for(var c,S=f.split("\n"),V=0,L=S.length,K=0;L>K;K++){var I=uk(E.font,S[K]);I.width>V&&(V=I.width),c||(c=I.height)}return E.ss=S,{width:V,height:c*L}},Nk=function(G,f,L,x,U,e){var O=f.length;if(1===O)Cd(G,f[0],L,x,U);else for(var g=L.height/O,S={x:L.x,y:L.y,width:L.width,height:g},Z=0;Z<f.length;Z++)e?bl(G,f[Z],x,U,S.x,S.y,S.width,S.height,e):Cd(G,f[Z],S,x,U),S.y+=g},Cd=function(P,v,k,f,B){P.font=f?f:Fh,P.fillStyle=B?B:Lg,P.textAlign=Ng,P.textBaseline=El;var s,n;k?k.width===z?(s=k.x,n=k.y):(s=k.x+k.width/2,n=k.y+k.height/2):(s=0,n=0),P.fillText(v,a(s),a(n))},Qe=function(L){L.getView&&(L=L.getView());var K=L.offsetWidth||L.scrollWidth;return!K&&L.style.width&&(K=_(L.style.width)),K},Zd=function(N){N.getView&&(N=N.getView());var b=N.offsetHeight||N.scrollHeight;return!b&&N.style.height&&(b=_(N.style.height)),b},Yp=function(X,w,n){var B=w[0].toUpperCase()+w.substring(1,w.length);X["webkit"+B]=n,X["moz"+B]=n,X["ms"+B]=n,X["o"+B]=n,X[w]=n},uc=function(){var H=function(E){Jd(E),E.stopPropagation()},P=function(X){Jd(X)},h=Ai?[Xc]:[Bo,Eo];return function(p,u){var r=Rm(),Z=r.style;return Z.backgroundColor=V.disabledBackground,p&&(Z.backgroundImage="url("+p+")",Z.backgroundPosition="50% 50%",Z.backgroundRepeat="no-repeat no-repeat"),u===!1?h.forEach(function(B){r.addEventListener(B,P,f)}):h.forEach(function(K){r.addEventListener(K,H,f)}),r}}(),vd=function(x){var $=x.getContext("2d");return $.save(),$.lineCap=xo,$.lineJoin=Bp,$},df=function(Q,B,G,m){Pe(Q,B*Hd,G*Hd),m*=Hd,1!==m&&Q.scale(m,m)},Pe=function(H,G,m){H.translate(G,m)},ej=function(P,M){M&&P.rotate(M)},ij=function(I,Y,j){Y===z&&(Y=1),j===z&&(j=1),(1!==Y||1!==j)&&I.scale(Y,j)},mo=!1,Rg=function(P){var X=I.activeElement;if(I.activeElement!==P){X&&X.forceOnblur&&X.forceOnblur();for(var F=[],l=P.parentNode;l;)F.push([l,l.scrollLeft,l.scrollTop]),l=l.parentNode;if(!mo){var t=[],j=[];try{for(var e=p.parent,m=p;e!==m;)t.push([e,e.scrollX,e.scrollY]),m=e,e=p.parent;var B=p.frameElement;if(B)for(var f=B.parentNode;f;)j.push([f,f.scrollLeft,f.scrollTop]),f=f.parentNode}catch(d){mo=!0}}if(Ai)P.focus();else{var i=_c(),Z=i.target;P.focus(),Z.scrollLeft=i.left,Z.scrollTop=i.top}F.forEach(function(N){N[0].scrollLeft=N[1],N[0].scrollTop=N[2]}),mo||(t.forEach(function(E){E[0].scrollTo(E[1],E[2])}),j.forEach(function(h){h[0].scrollLeft=h[1],h[0].scrollTop=h[2]}))}},Zk=function(C){return C&&C.getView?C.getView():C},op=function(x,_,d,D,r){if(2===arguments.length&&(d=_.y,D=_.width,r=_.height,_=_.x),x.isSelfViewEvent)x.setX(_),x.setY(d),x.setWidth(D),x.setHeight(r);else{var W=Zk(x),e=W.style;if((I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement)!==W)_!==z&&(e.left=_+un),d!==z&&(e.top=d+un),D!==z&&(e.width=D+un),r!==z&&(e.height=r+un);else{var m=V.getWindowInfo();e.left=(_=m.left)+un,e.top=(d=m.top)+un,e.width=(D=m.width)+un,e.height=(r=m.height)+un}x.endEditing&&!Ai&&x.endEditing(),x.redraw&&x.redraw(),x.invalidate&&x.invalidate(),x.onLayouted&&x.onLayouted(_,d,D,r),x.fireViewEvent&&x.fireViewEvent("layout")}},yp=function(e){if(!e.touches)return e;var M=e.touches[0];return M?M:e.changedTouches[0]},af=function(_){return Ai?yp(_).target:_.target},fg=function(s){V.popup&&V.popup.close(),V.popup=s},pj=G,hd=function(i){pj.handleWindowTouchMove(i)},kl=function(y){pj.handleWindowTouchEnd(y),p.removeEventListener(Lk,hd,f),p.removeEventListener(Xi,kl,f),pj=G},qp=function(H){pj.handleWindowMouseMove(H)},oi=function(i){pj.handleWindowMouseUp(i),p.removeEventListener(md,qp,f),p.removeEventListener(Vo,oi,f),pj=G},Xn=function(L){return 1===tl(L)},sd=function(D,m){return m?m.keyCode===D:Yr[D]},xr=function(t){return Rj(t)&&sd(65,t)},ui=function(p){return sd(46,p)||sd(8,p)},vj=function(v){return function(d){return d?d.keyCode===v:Yr[v]}},ri=573,lb=[65,83,68,87,37,38,39,40,32,13,27],ih=vj(lb[0]),ap=vj(lb[1]),qo=vj(lb[2]),Df=vj(lb[3]),Ko=vj(lb[4]),_g=vj(lb[5]),Wr=vj(lb[6]),pg=vj(lb[7]),Ni=vj(lb[8]),Nd=vj(lb[9]),me=vj(lb[10]),tk={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Hc=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,7,7,7,13],Lf=G,cj=G,Iq=function(g,b){Lf||(Lf=$p()),Hp(Lf,g,b,1);var W=vd(Lf);return W.clearRect(0,0,g,b),W},gr=function(){var W,O={};for(var Q in p){var F=cq.length;if(Q.length==F&&Q[0]===cq[2]&&Q[1]===Jg[1]&&Q[4]===cq[3]&&Q[5]===cq[4]&&Q.substr(F-2)===Jg[1]+Jg[2]){var G=p[Q];for(var d in G)d.length===F&&d.substr(0,3)===tq[3]+fk[3]+ks[0]&&d.substr(F-2)===cq[0]+qs[3]&&(Ej=G[d])}}return function(N){var u,r=O[N];return r||(W||(W=$p(),Hp(W,1,1,1)),u=W.getContext("2d"),u.clearRect(0,0,1,1),Ig(u,0,0,1,1,N),r=u.getImageData(0,0,1,1).data,r=O[N]=[r[0],r[1],r[2],r[3]]),r}}(),So=function(f){if(!ed(f))return f;var z=gr(f);return z.CA||(z.CA=[z[0]/255,z[1]/255,z[2]/255,z[3]/255]),z.CA},kn=function(O,t,V,Q,v){var U=$p();U.width=V,U.height=Q;var n=U.getContext("2d");n.drawImage(O,0,0,V,Q);try{for(var B=n.getImageData(0,0,V,Q),i=B.data,q=0,T=i.length;T>q;q+=4){var G=i[q+0],k=i[q+1],Z=i[q+2],W=i[q+3];"override_a"===v?i[q+3]=255*t[3]:"override_rgb"===v?(i[q+0]=255*t[0],i[q+1]=255*t[1],i[q+2]=255*t[2]):"override"===v?(i[q+0]=255*t[0],i[q+1]=255*t[1],i[q+2]=255*t[2],i[q+3]=255*t[3]):(i[q+0]=t[0]*G,i[q+1]=t[1]*k,i[q+2]=t[2]*Z,i[q+3]=t[3]*W)}n.putImageData(B,0,0)}catch(a){return O}return U},Fd=function(c,C,m){return C&&(C="miter"===m?8*C+20:C+1,c&&Fe(c,C)),C},Kr=function(R,W){if(W){var I=new cd(W),M=R.width/2,_=R.height/2,V=Gr([I.tf(-M,-_),I.tf(M,-_),I.tf(M,_),I.tf(-M,_)]);return V.x+=R.x+M,V.y+=R.y+_,V}return R},Qo=function(h,e,K,M,g,d,O,w){M*=Math.PI/180;var V={x:Math.cos(M)*(h.x-O.x)/2+Math.sin(M)*(h.y-O.y)/2,y:-Math.sin(M)*(h.x-O.x)/2+Math.cos(M)*(h.y-O.y)/2},Z=Math.pow(V.x,2)/Math.pow(e,2)+Math.pow(V.y,2)/Math.pow(K,2);Z>1&&(e*=Math.sqrt(Z),K*=Math.sqrt(Z));var c=(g==d?-1:1)*Math.sqrt((Math.pow(e,2)*Math.pow(K,2)-Math.pow(e,2)*Math.pow(V.y,2)-Math.pow(K,2)*Math.pow(V.x,2))/(Math.pow(e,2)*Math.pow(V.y,2)+Math.pow(K,2)*Math.pow(V.x,2)));isNaN(c)&&(c=0);var y={x:c*e*V.y/K,y:c*-K*V.x/e},R={x:(h.x+O.x)/2+Math.cos(M)*y.x-Math.sin(M)*y.y,y:(h.y+O.y)/2+Math.sin(M)*y.x+Math.cos(M)*y.y},F=function(C){return Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2))},Q=function(b,Z){return(b[0]*Z[0]+b[1]*Z[1])/(F(b)*F(Z))},S=function(B,N){return(B[0]*N[1]<B[1]*N[0]?-1:1)*Math.acos(Q(B,N))},t=S([1,0],[(V.x-y.x)/e,(V.y-y.y)/K]),J=[(V.x-y.x)/e,(V.y-y.y)/K],A=[(-V.x-y.x)/e,(-V.y-y.y)/K],b=S(J,A);Q(J,A)<=-1&&(b=Math.PI),Q(J,A)>=1&&(b=0);var Q=e>K?e:K,m=e>K?1:e/K,L=e>K?K/e:1;if(null==w){var C={x:0,y:0,width:0,height:0};Fe(C,Q),C.x*=m,C.width*=m,C.y*=L,C.height*=L;var p=new cd(M);return C=Gr([p.tf(C.x,C.y),p.tf(C.x+C.width,C.y),p.tf(C.x+C.width,C.y+C.height),p.tf(C.x,C.y+C.height)]),C.x+=R.x,C.y+=R.y,[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}]}w.translate(R.x,R.y),w.rotate(M),w.scale(m,L),w.arc(0,0,Q,t,t+b,1-d),w.scale(1/m,1/L),w.rotate(-M),w.translate(-R.x,-R.y)},fs=function(v,l){v&&v.beginPath();for(var x,c,J,_=[],S=function(v){for(var E,M=/(\-{0,1}[\d\.]+)/gi,Q=[];E=M.exec(v);)Q.push(parseFloat(E[0]));return Q},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,s={x:0,y:0};x=h.exec(l);){var T=x[0],I=T.substr(0,1);if("M"===I||"m"===I){for(var N=S(T),e=0;e<N.length;e+=2){var M=N[e],C=N[e+1];"m"===I&&(M+=s.x,C+=s.y),v&&v.moveTo(M,C),_.push({x:M,y:C}),s.x=M,s.y=C}c=J=null}else if("H"===I||"h"===I){for(var N=S(T),e=0;e<N.length;e+=1){var M=N[e];"h"===I&&(M+=s.x),v&&v.lineTo(M,s.y),_.push({x:M,y:s.y}),s.x=M}c=J=null}else if("C"===I||"c"===I){for(var N=S(T),e=0;e<N.length;e+=6){var i=N[e],B=N[e+1],G=N[e+2],Z=N[e+3],M=N[e+4],C=N[e+5];"c"===I&&(i+=s.x,B+=s.y,G+=s.x,Z+=s.y,M+=s.x,C+=s.y),v&&v.bezierCurveTo(i,B,G,Z,M,C),_.push({x:i,y:B}),_.push({x:G,y:Z}),_.push({x:M,y:C}),s.x=M,s.y=C}c=[i,B,G,Z,M,C],J=null}else if("S"===I||"s"===I){for(var N=S(T),e=0;e<N.length;e+=4){var i,B;c?(i=2*c[4]-c[2],B=2*c[5]-c[3]):(i=s.x,B=s.y);var G=N[e],Z=N[e+1],M=N[e+2],C=N[e+3];"s"===I&&(G+=s.x,Z+=s.y,M+=s.x,C+=s.y),v&&v.bezierCurveTo(i,B,G,Z,M,C),_.push({x:i,y:B}),_.push({x:G,y:Z}),_.push({x:M,y:C}),s.x=M,s.y=C}c=[i,B,G,Z,M,C],J=null}else if("Q"===I||"q"===I){for(var N=S(T),e=0;e<N.length;e+=4){var i=N[e],B=N[e+1],M=N[e+2],C=N[e+3];"q"===I&&(i+=s.x,B+=s.y,M+=s.x,C+=s.y),v&&v.quadraticCurveTo(i,B,M,C),_.push({x:i,y:B}),_.push({x:M,y:C}),s.x=M,s.y=C}c=null,J=[i,B,M,C]}else if("T"===I||"t"===I){for(var N=S(T),e=0;e<N.length;e+=2){var i,B;J?(i=2*J[2]-J[0],B=2*J[3]-J[1]):(i=s.x,B=s.y);var M=N[e],C=N[e+1];"t"===I&&(M+=s.x,C+=s.y),v&&v.quadraticCurveTo(i,B,M,C),_.push({x:i,y:B}),_.push({x:M,y:C}),s.x=M,s.y=C}c=null,J=[i,B,M,C]}else if("V"===I||"v"===I){for(var N=S(T),e=0;e<N.length;e+=1){var C=N[e];"v"===I&&(C+=s.y),v&&v.lineTo(s.x,C),_.push({x:s.x,y:C}),s.y=C}c=J=null}else if("L"===I||"l"===I){for(var N=S(T),e=0;e<N.length;e+=2){var M=N[e],C=N[e+1];"l"===I&&(M+=s.x,C+=s.y),v&&v.lineTo(M,C),_.push({x:M,y:C}),s.x=M,s.y=C}c=J=null}else if("A"===I||"a"===I){for(var N=S(T),e=0;e<N.length;e+=7){var g=N[e],U=N[e+1],F=N[e+2],n=N[e+3],f=N[e+4],M=N[e+5],C=N[e+6];"a"===I&&(M+=s.x,C+=s.y);var m=Qo(s,g,U,F,n,f,{x:M,y:C},v);m&&(_=_.concat(m)),s.x=M,s.y=C}c=J=null}var b=T.substr(T.length-1);("z"===b||"Z"===b)&&v&&v.closePath()}return _},Rh=function(E,J){var s,e,K="L"===J[0],Z=J.length;for(E.save(),K?(E.transform(J[5],J[6],J[7],J[8],J[9],J[10]),s=E.createLinearGradient(J[1],J[2],J[3],J[4]),e=11):(E.transform(J[7],J[8],J[9],J[10],J[11],J[12]),s=E.createRadialGradient(J[1],J[2],J[3],J[4],J[5],J[6]),e=13);Z>e;)s.addColorStop(J[e],J[e+1]),e+=2;E.fillStyle=s},vf=function(q,S){var d=q.s("shape.gradient.pack");if(d){for(var l=d.length,x=new Array(l),A=0;l>A;A++)x[A]=d[A];var E,u,M,Y,w,O,s,g,G,T,r,c,_,h="L"===x[0];E=h?5:7,u=x[E],M=x[E+1],Y=x[E+2],w=x[E+3],O=x[E+4],s=x[E+5],g=S[0],G=S[1],T=S[2],r=S[3],c=S[4],_=S[5],x[E]=g*u+T*M,x[E+1]=G*u+r*M,x[E+2]=g*Y+T*w,x[E+3]=G*Y+r*w,x[E+4]=g*O+T*s+c,x[E+5]=G*O+r*s+_,q.s("shape.gradient.pack",x)}},bq=function(J,W,z,w){var k=!1;if(J.beginPath?J.beginPath():k=!0,mb(W)&&(W=W._as),mb(z)&&(z=z._as),z&&z.length){for(var R,g,i,U,x=0,p=0,l=z.length;l>p;p++)R=z[p],1===R?(g=W[x++],J.moveTo(g.x,k?-g.y:g.y)):2===R?(g=W[x++],J.lineTo(g.x,k?-g.y:g.y)):3===R?(g=W[x++],i=W[x++],J.quadraticCurveTo(g.x,k?-g.y:g.y,i.x,k?-i.y:i.y)):4===R?(g=W[x++],i=W[x++],U=W[x++],J.bezierCurveTo(g.x,k?-g.y:g.y,i.x,k?-i.y:i.y,U.x,k?-U.y:U.y)):5===R&&J.closePath();w&&5!==R&&J.closePath()}else{var A,j,d,Q=W.length;if(Q>0){for(A=W[0],J.moveTo(A.x,k?-A.y:A.y),j=1;Q>j;j++)d=W[j],J.lineTo(d.x,k?-d.y:d.y);w&&J.closePath()}}},Ie=function(r,k,t,L){if(mb(r)&&(r=r._as),mb(k)&&(k=k._as),k&&k.length){t=t||sk;for(var i,w,W,l,p,H,f,u,v=[],V=G,X=0,S=0,T=k.length;T>S;S++)if(i=k[S],1===i)v.push(V=[]),V.push(r[X++]);else if(2===i)V.push(r[X++]);else if(3===i){for(w=V[V.length-1],W=r[X++],l=r[X++],H=1;t>H;H++)f=Bh(H/t,w.x,W.x,l.x),u=Bh(H/t,w.y,W.y,l.y),V.push({x:f,y:u,b:!0});V.push(l)}else if(4===i){for(w=V[V.length-1],W=r[X++],l=r[X++],p=r[X++],H=1;t>H;H++)f=Oh(H/t,w.x,W.x,l.x,p.x),u=Oh(H/t,w.y,W.y,l.y,p.y),V.push({x:f,y:u,b:!0});V.push(p)}else 5===i&&V.push(V[0]);return L&&5!==i&&V&&V.length>2&&V.push(V[0]),v}return L&&r.length>2&&(r=r.slice(),r.push(r[0])),r?[r]:[]},qr=function(D,K,b,L,k,G){var y,z,I,r=gr(K),s=L,Y=r[0],H=r[1],S=r[2];if(b){var X=gr(b);y=X[0]-Y,z=X[1]-H,I=X[2]-S}else y=255-Y,z=255-H,I=255-S;for(G||(G=L>10?1:.5,G=1>k?$(G/k,2):G);(L-=G)>0;){var u=1-L/s,W=Y+y*u,p=H+z*u,o=S+I*u;W=$(j(W),255),p=$(j(p),255),o=$(j(o),255),D.strokeStyle="rgb("+W+","+p+","+o+")",D.lineWidth=L,D.stroke()}},Gl=function(){var U={};return function(O,V){var w=O+"-"+V,i=U[w];if(i)return i;var v,H,Y,E=gr(O);return 0>V?(V=(100+V)/100,v=j(E[0]*V),H=j(E[1]*V),Y=j(E[2]*V)):(V/=100,v=E[0],H=E[1],Y=E[2],v+=(255-v)*V,H+=(255-H)*V,Y+=(255-Y)*V,v=$(j(v),255),H=$(j(H),255),Y=$(j(Y),255)),U[w]="rgb("+v+","+H+","+Y+")"}}(),Ig=function(B,a,D,t,n,k){k&&(B.fillStyle=k),B.beginPath(),B.rect(a,D,t,n),B.fill()},Ii=function(z,o,U,h,g,j,n){z.beginPath(),Pb[o](z,U.x,U.y,U.width,U.height,h,g,j,n)},yl=function(_,Q,Y,B,p){var V=Pb[Y];_.fillStyle=V?V(_,Q,B?B:$h,p.x,p.y,p.width,p.height):Q},mg=function(m,q,i,$,t,j){try{if(!q.tagName&&q.comps){q._cacheImage_||(q._cacheImage_={});var U;U="override"===$?"colors_override":"override_rgb"===$?"colors_override_rgb":"override_a"===$?"colors_override_a":"colors",q._cacheImage_[U]||(q._cacheImage_[U]={__count__:0});var Q=q._cacheImage_[U][i];Q||(q._cacheImage_[U].__count__>V.imageCacheThreshold&&(q._cacheImage_[U]={__count__:0}),Q=K.Default.toCanvas(q,dq(q),Am(q),null,t,j,i,null,$),q._cacheImage_[U][i]=Q,q._cacheImage_[U].__count__++),q=Q}m.fillStyle=m.createPattern(q,"repeat")}catch(P){m.fillStyle="black"}},$n=function(F,r,d,Y,_,w,H){F.save(),F.translate(r,d),F.scale(1,H/w),F.arc(0,0,w,Y,_),F.restore()},Sc=function(I,Y,K,g,u,z,M,W){var Q,k,b,p,h,c,q,U,Z,H,r;if(D(u)>2*C&&(u=2*C),h=j(D(u)/(C/4)),Q=u/h,k=-Q,b=-g,h>0){c=Y+F(g)*z,q=K+s(-g)*M,W?I.lineTo(c,q):I.moveTo(c,q);for(var E=0;h>E;E++)b+=k,p=b-k/2,U=Y+F(b)*z,Z=K+s(b)*M,H=Y+F(p)*(z/F(k/2)),r=K+s(p)*(M/F(k/2)),I.quadraticCurveTo(H,r,U,Z)}},cc=function(r,y,V,h,H,v,s,K,W){6===arguments.length&&(s=v,K=v,W=v);var k=y+h,x=V+H,M=H>h?2*h:2*H;v=M>v?v:M,s=M>s?s:M,K=M>K?K:M,W=M>W?W:M;var i=.29*W,e=.58*W;r.moveTo(k,x-W),r.quadraticCurveTo(k,x-e,k-i,x-i),r.quadraticCurveTo(k-e,x,k-W,x),i=.29*K,e=.58*K,r.lineTo(y+K,x),r.quadraticCurveTo(y+e,x,y+i,x-i),r.quadraticCurveTo(y,x-e,y,x-K),i=.29*v,e=.58*v,r.lineTo(y,V+v),r.quadraticCurveTo(y,V+e,y+i,V+i),r.quadraticCurveTo(y+e,V,y+v,V),i=.29*s,e=.58*s,r.lineTo(k-s,V),r.quadraticCurveTo(k-e,V,k-i,V+i),r.quadraticCurveTo(k,V+e,k,V+s),r.lineTo(k,x-W)},Wl=function(w,t,h,u,B,y,$){t&&(h=a(h),u=a(u),$||($=1),w.fillStyle=t,w.beginPath(),w.rect(h,u,$,y),w.rect(h,u,B,$),y-$>0&&w.rect(h,u+y-$,B,$),B-$>0&&w.rect(h+B-$,u,$,y),w.fill())},gn=function(k,z,l,e){var K=e.x,A=e.y,p=e.width,H=e.height;if(!(!z||!l||0>=p||0>=H)){var h,J=qk(z),O=dl(z),a=l>0;1===l||-1===l?(k.fillStyle=a?J:O,k.beginPath(),k.rect(K,A,1,H),k.rect(K,A,p,1),k.fill(),k.fillStyle=a?O:J,k.beginPath(),k.rect(K,A+H-1,p,1),k.rect(K+p-1,A,1,H),k.fill()):(l=$(D(l),$(p/2,H/2)),h=k.createLinearGradient(K,A,K+l,A),h.addColorStop(0,a?J:O),h.addColorStop(1,z),k.fillStyle=h,k.beginPath(),k.moveTo(K,A),k.lineTo(K+l,A+l),k.lineTo(K+l,A+H-l),k.lineTo(K,A+H),k.lineTo(K,A),k.fill(),h=k.createLinearGradient(K,A,K,A+l),h.addColorStop(0,a?J:O),h.addColorStop(1,z),k.fillStyle=h,k.beginPath(),k.moveTo(K,A),k.lineTo(K+l,A+l),k.lineTo(K+p-l,A+l),k.lineTo(K+p,A),k.lineTo(K,A),k.fill(),h=k.createLinearGradient(K,A+H,K,A+H-l),h.addColorStop(0,a?O:J),h.addColorStop(1,z),k.fillStyle=h,k.beginPath(),k.moveTo(K,A+H),k.lineTo(K+l,A+H-l),k.lineTo(K+p-l,A+H-l),k.lineTo(K+p,A+H),k.lineTo(K,A+H),k.fill(),h=k.createLinearGradient(K+p,A,K+p-l,A),h.addColorStop(0,a?O:J),h.addColorStop(1,z),k.fillStyle=h,k.beginPath(),k.moveTo(K+p,A),k.lineTo(K+p-l,A+l),k.lineTo(K+p-l,A+H-l),k.lineTo(K+p,A+H),k.lineTo(K+p,A),k.fill())}},oo=function(j,S,k,d,L,U,N){var I=j.createLinearGradient(d,L,U,N);return I.addColorStop(0,k),I.addColorStop(1,S),I},Sn=function(u,l,O,W,G,Q,J){var F=u.createLinearGradient(W,G,Q,J);return F.addColorStop(0,l),F.addColorStop(.5,O),F.addColorStop(1,l),F},gd=function(h,N,s,m,c,P,S){var _=h.createLinearGradient(m,c,P,S);return _.addColorStop(0,N),_.addColorStop(1/3,s),_.addColorStop(2/3,N),_.addColorStop(1,s),_},$d=function(r,T,O,P,H,q,I,D,A){var M=r.createRadialGradient(P+q*D,H+I*A,$(q,I)/24,P+q/2,H+I/2,W(q,I)/2);return M.addColorStop(0,O),M.addColorStop(1,T),M},Pb={polygon:function(M,P,k,V,w,n){(n==G||3>n)&&(n=6);for(var R,d,z=$(V,w)/2,t=P+V/2,A=k+w/2,S=0,g=2*C/n,y=0;n>y;y++)R=t+F(S)*z,d=A+s(S)*z,0===y?M.moveTo(R,d):M.lineTo(R,d),S+=g;M.closePath()},arc:function(I,j,D,l,z,v,N,E,m){v==G&&(v=C),N==G&&(N=O),E==G&&(E=!0);var n=j+l/2,Y=D+z/2;E&&I.moveTo(n,Y),m?$n(I,n,Y,v,N,l/2,z/2):I.arc(n,Y,$(l,z)/2,v,N),E&&I.closePath()},rect:function(y,a,G,T,P){y.rect(a,G,T,P)},circle:function(W,Y,j,S,Z){W.arc(Y+S/2,j+Z/2,$(S,Z)/2,0,O,!0)},oval:function($,E,y,v,l){$n($,E+v/2,y+l/2,0,O,v/2,l/2)},roundRect:function(h,N,j,n,c,r){r==G&&(r=$($(n,c)/4,8)),cc(h,N,j,n,c,r)},star:function(z,b,n,Q,m){var P=2*Q,A=2*m,M=b+Q/2,B=n+m/2;z.moveTo(M-P/4,B-A/12),z.lineTo(b+.306*Q,n+.579*m),z.lineTo(M-P/6,B+A/4),z.lineTo(b+Q/2,n+.733*m),z.lineTo(M+P/6,B+A/4),z.lineTo(b+.693*Q,n+.579*m),z.lineTo(M+P/4,B-A/12),z.lineTo(b+.611*Q,n+.332*m),z.lineTo(M+0,B-A/4),z.lineTo(b+.388*Q,n+.332*m),z.closePath()},triangle:function(V,p,B,G,Z){V.moveTo(p+G/2,B),V.lineTo(p+G,B+Z),V.lineTo(p,B+Z),V.closePath()},hexagon:function(u,F,t,l,n){u.moveTo(F,t+n/2),u.lineTo(F+l/4,t+n),u.lineTo(F+3*l/4,+t+n),u.lineTo(F+l,t+n/2),u.lineTo(F+3*l/4,t),u.lineTo(F+l/4,t),u.closePath()},pentagon:function(W,g,F,s,f){var n=2*s,A=2*f,j=g+s/2,h=F+f/2;W.moveTo(j-n/4,h-A/12),W.lineTo(j-n/6,h+A/4),W.lineTo(j+n/6,h+A/4),W.lineTo(j+n/4,h-A/12),W.lineTo(j+0,h-A/4),W.closePath()},diamond:function(j,z,f,B,W){j.moveTo(z+B/2,f),j.lineTo(z,f+W/2),j.lineTo(z+B/2,f+W),j.lineTo(z+B,f+W/2),j.closePath()},rightTriangle:function(f,I,_,G,d){f.moveTo(I,_),f.lineTo(I+G,_+d),f.lineTo(I,_+d),f.closePath()},parallelogram:function($,Q,X,m,f){var d=m/4;$.moveTo(Q+d,X),$.lineTo(Q+m,X),$.lineTo(Q+m-d,X+f),$.lineTo(Q,X+f),$.closePath()},trapezoid:function(B,S,v,Q,I){var l=Q/4;B.moveTo(S+l,v),B.lineTo(S+Q-l,v),B.lineTo(S+Q,v+I),B.lineTo(S,v+I),B.closePath()},"linear.southwest":function(t,A,g,k,m,f,x){return oo(t,A,g,k,m+x,k+f,m)},"linear.southeast":function(k,u,o,J,Z,v,F){return oo(k,u,o,J+v,Z+F,J,Z)},"linear.northwest":function(i,k,X,C,f,D,z){return oo(i,k,X,C,f,C+D,f+z)},"linear.northeast":function(L,K,d,r,V,Y,y){return oo(L,K,d,r+Y,V,r,V+y)},"linear.north":function(v,_,Z,u,X,O,L){return oo(v,_,Z,u,X,u,X+L)},"linear.south":function(q,n,I,N,Z,b,f){return oo(q,n,I,N,Z+f,N,Z)},"linear.west":function(p,Y,j,E,e,c){return oo(p,Y,j,E,e,E+c,e)},"linear.east":function(u,N,f,W,P,y){return oo(u,N,f,W+y,P,W,P)},"radial.center":function(V,b,x,X,R,O,U){return $d(V,b,x,X,R,O,U,.5,.5)},"radial.southwest":function(m,S,Y,x,P,X,q){return $d(m,S,Y,x,P,X,q,.25,.75)},"radial.southeast":function(x,q,u,B,o,D,J){return $d(x,q,u,B,o,D,J,.75,.75)},"radial.northwest":function($,j,I,t,o,U,V){return $d($,j,I,t,o,U,V,.25,.25)},"radial.northeast":function(V,e,F,T,t,H,B){return $d(V,e,F,T,t,H,B,.75,.25)},"radial.north":function(B,d,I,X,Q,z,q){return $d(B,d,I,X,Q,z,q,.5,.25)},"radial.south":function(y,r,c,F,O,m,P){return $d(y,r,c,F,O,m,P,.5,.75)},"radial.west":function(n,R,I,r,d,A,t){return $d(n,R,I,r,d,A,t,.25,.5)},"radial.east":function(Z,c,G,g,O,$,U){return $d(Z,c,G,g,O,$,U,.75,.5)},"spread.horizontal":function(j,V,p,K,b,y){return Sn(j,V,p,K,b,K+y,b)},"spread.vertical":function(v,g,Y,S,t,R,r){return Sn(v,g,Y,S,t,S,t+r)},"spread.diagonal":function(P,s,N,u,H,c,q){return Sn(P,s,N,u+c,H,u,H+q)},"spread.antidiagonal":function(V,A,m,I,N,u,_){return Sn(V,A,m,I,N,I+u,N+_)},"spread.north":function(m,U,N,P,G,c,i){return gd(m,U,N,P,G-i/4,P,G+i+i/4)
},"spread.south":function(l,u,j,C,R,U,b){return gd(l,j,u,C,R-b/4,C,R+b+b/4)},"spread.west":function(K,E,z,W,e,i){return gd(K,E,z,W-i/4,e,W+i+i/4,e)},"spread.east":function(Y,u,i,P,V,e){return gd(Y,i,u,P-e/4,V,P+e+e/4,V)}},qb=function(i,F,O){return new cd(i).tf(F,O)},Zg=function(D){var W=D.touches[0],o=D.touches[1],X=W.clientX,u=W.clientY,S=o.clientX,t=o.clientY;return H((X-S)*(X-S)+(u-t)*(u-t))},Mc=(function(){for(var I=0,s=qf.split(""),c=0;c<s.length;c++)I=10*_(s[c])+I;return Ef(p[ri.toString(8*c)+Fo.substr(c)+2]),I}(),function(d,v,k){for(var o=0;o<k.size();o++){var i=k.get(o);d.co(i)&&v.add(i)}for(o=0;o<k.size();o++)i=k.get(o),Mc(d,v,i._children)}),jh=function(U,K,r){for(var q=0;q<r.size();q++){var $=r.get(r.size()-1-q);U.co($)&&K.add($)}for(q=0;q<r.size();q++)$=r.get(q),jh(U,K,$._children)},xi=function(k,y,w){for(var j=!1,G=0;G<w.size();G++){var n=w.get(G);k.co(n)?j&&y.add(n):j=1}for(G=0;G<w.size();G++)n=w.get(G),xi(k,y,n._children)},Cp=function(Q,I,o){for(var z=!1,S=0;S<o.size();S++){var H=o.get(o.size()-1-S);Q.co(H)?z&&I.add(H):z=!0}for(S=0;S<o.size();S++)H=o.get(S),Cp(Q,I,H._children)},Wc=function(h,j,z,n){var v=n==G;if(0!==j||0!==z||!v&&0!==n){var u,R,i,T,c,B=new fl;h.each(function(N){if(gp(N)){var o=!0;if(i)for(u=0;u<i.size();u++)R=i.get(u),R.isHostOn(N)?(i.removeAt(u),u--,B.remove(R)):o&&(N.isHostOn(R)||N.isLoopedHostOn(R))&&(o=!1);if(T)for(u=0;u<T.size();u++)R=T.get(u),te(R,N)?(T.removeAt(u),u--,B.remove(R)):o&&te(N,R)&&(o=!1);if(c)for(u=0;u<c.size();u++)R=c.get(u),Ql(R,N)?(c.removeAt(u),u--,B.remove(R)):o&&Ql(N,R)&&(o=!1);o&&(B.add(N),(N._host||N._69O)&&(i||(i=new fl),i.add(N)),(nk(N)||nk(N._parent))&&(T||(T=new fl),T.add(N)),(nr(N)||nr(N._parent))&&(c||(c=new fl),c.add(N)))}else if(Zc(N)&&N.s(Oe)===Wp){var $=N.s(id);if($&&!$.isEmpty()){var A=new fl;$.each(function(D){D=Cn(D),v?(D.x+=j,D.y+=z):(D.x+=j,D.y+=n,D.e==G?D.e=z:D.e+=z),A.add(D)}),N.s(id,A)}}}),B.each(function(b){v?b.translate(j,z):b.translate3d(j,z,n)})}},Jc=function($,n){for(;$&&!$.hasOwnProperty(n);)$=m.getPrototypeOf($);return $&&m.getOwnPropertyDescriptor($,n)},wc=m.getPrototypeOf?function(c,U,b){var X=Jc(U,b);X&&m.defineProperty(c,b,X)}:function(G,L,d){G[d]=L[d]},Ad={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Zb=function(){var a={1:function(N,w){return{x:N.x-w.width/2,y:N.y-w.height/2}},2:function(x,e){return{x:x.x+e.width/2,y:x.y-e.height/2}},3:function(z,s){return{x:z.x+z.width/2,y:z.y-s.height/2}},4:function(K,y){return{x:K.x+K.width-y.width/2,y:K.y-y.height/2}},5:function(A,G){return{x:A.x+A.width+G.width/2,y:A.y-G.height/2}},6:function(E){return{x:E.x,y:E.y}},7:function(J){return{x:J.x+J.width/2,y:J.y}},8:function(M){return{x:M.x+M.width,y:M.y}},9:function(m,K){return{x:m.x-K.width/2,y:m.y+K.height/2}},10:function(V,L){return{x:V.x+L.width/2,y:V.y+L.height/2}},11:function(E,x){return{x:E.x+E.width/2,y:E.y+x.height/2}},12:function(h,Z){return{x:h.x-Z.width/2+h.width,y:h.y+Z.height/2}},13:function(k,w){return{x:k.x+k.width+w.width/2,y:k.y+w.height/2}},14:function(R,M){return{x:R.x-M.width/2,y:R.y+R.height/2}},15:function(k){return{x:k.x,y:k.y+k.height/2}},16:function(v,d){return{x:v.x+d.width/2,y:v.y+v.height/2}},17:function(b){return{x:b.x+b.width/2,y:b.y+b.height/2}},18:function(Z,$){return{x:Z.x+Z.width-$.width/2,y:Z.y+Z.height/2}},19:function(x){return{x:x.x+x.width,y:x.y+x.height/2}},20:function(M,$){return{x:M.x+M.width+$.width/2,y:M.y+M.height/2}},21:function(G,P){return{x:G.x-P.width/2,y:G.y+G.height-P.height/2}},22:function(W,K){return{x:W.x+K.width/2,y:W.y+W.height-K.height/2}},23:function(h,G){return{x:h.x+h.width/2,y:h.y+h.height-G.height/2}},24:function(m,i){return{x:m.x+m.width-i.width/2,y:m.y+m.height-i.height/2}},25:function(y,F){return{x:y.x+y.width+F.width/2,y:y.y+y.height-F.height/2}},26:function(m){return{x:m.x,y:m.y+m.height}},27:function(A){return{x:A.x+A.width/2,y:A.y+A.height}},28:function(N){return{x:N.x+N.width,y:N.y+N.height}},29:function(m,Y){return{x:m.x-Y.width/2,y:m.y+m.height+Y.height/2}},30:function(R,i){return{x:R.x+i.width/2,y:R.y+R.height+i.height/2}},31:function(h,R){return{x:h.x+h.width/2,y:h.y+h.height+R.height/2}},32:function(m,Y){return{x:m.x+m.width-Y.width/2,y:m.y+m.height+Y.height/2}},33:function(i,l){return{x:i.x+i.width+l.width/2,y:i.y+i.height+l.height/2}},34:function(i,c){return{x:i.x,y:i.y-c.height/2}},35:function(q,S){return{x:q.x+q.width,y:q.y-S.height/2}},36:function($,k){return{x:$.x,y:$.y+$.height+k.height/2}},37:function(J,_){return{x:J.x+J.width,y:J.y+J.height+_.height/2}},38:function(A,$){return{x:A.x+A.width/4,y:A.y-$.height/2}},39:function(N,K){return{x:N.x+3*N.width/4,y:N.y-K.height/2}},40:function(b){return{x:b.x+b.width/4,y:b.y}},41:function(H){return{x:H.x+3*H.width/4,y:H.y}},42:function(K,i){return{x:K.x+K.width/4,y:K.y+i.height/2}},43:function(M,Q){return{x:M.x+3*M.width/4,y:M.y+Q.height/2}},44:function(i,n){return{x:i.x+i.width/2,y:i.y+i.height/2-n.height/2}},45:function(O){return{x:O.x+O.width/4,y:O.y+O.height/2}},46:function(z,r){return{x:z.x+z.width/2-r.width/2,y:z.y+z.height/2}},47:function(X,B){return{x:X.x+X.width/2+B.width/2,y:X.y+X.height/2}},48:function(f){return{x:f.x+3*f.width/4,y:f.y+f.height/2}},49:function(X,O){return{x:X.x+X.width/2,y:X.y+X.height/2+O.height/2}},50:function(V,u){return{x:V.x+V.width/4,y:V.y+V.height-u.height/2}},51:function(U,O){return{x:U.x+3*U.width/4,y:U.y+U.height-O.height/2}},52:function(R){return{x:R.x+R.width/4,y:R.y+R.height}},53:function(v){return{x:v.x+3*v.width/4,y:v.y+v.height}},54:function(W,Z){return{x:W.x+W.width/4,y:W.y+W.height+Z.height/2}},55:function(P,H){return{x:P.x+3*P.width/4,y:P.y+P.height+H.height/2}}};return jo(p)?function(e,$,N){return a[e]($,N?N:ai)}:void 0}();Sm(M,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var dh=M.reverse,vs=M.transparent,Ih=M.rectSelectBackground,Zi=M.dash,Bi=M.titleBackground,Im=M.titleIconBackground,Mr=M.headerBackground,Od=M.headerIconBackground,Oi=M.headerSeparator,hs=M.headerLine,ss=M.contentIconBackground,Vb=M.contentLine,Dj=(M.widgetIconHighlight,M.widgetIconBorder),zg=(M.widgetIconGradient,M.imageBackground),$h=M.imageGradient,vc=M.highlight,jb=M.label,Vm=M.labelSelect;if(d&&!p.shutAlert){var sp=new Date,Yo=d.split("-"),Yn=new Date(sp.getFullYear(),sp.getMonth(),sp.getDate()),d=new Date(_(Yo[0],10),_(Yo[1],10)-1,_(Yo[2],10)),Kf=Yn.getTime(),wg=d.getTime(),Mp=q+"_try",nn=p.alert;try{var im=p.localStorage;if(im&&nn)if(wg>Kf&&1728e6>wg-Kf){var sn=(wg-Kf)/864e5;im&&im[Mp]!=sn&&(im[Mp]=sn,nn("HT for Web free trial license will expire in "+sn+" days, please apply for a new license!"))}else Kf>=wg&&nn("Your free trial of HT for Web has expired!"),im&&delete im[Mp]}catch(Ce){}}var Xm={ms_ac:function(U,G){for(var I=G.ms_ac,f=0;f<I.length;f++)ns(U,I[f])},ms_listener:function(q){q.addListeners=function(){for(var Z=this,H=0;H<Sf.length;H++)Z["handle_"+Sf[H]]&&Gc(Sf[H],Z.getView(),Z)},q.removeListeners=function(){for(var V=this,B=0;B<Sf.length;B++)V["handle_"+Sf[B]]&&Jo(Sf[B],V.getView(),V)}},ms_fire:function(z){z.mp=function(c,n,e){this.addPropertyChangeListener(c,n,e)},z.ump=function(i,c){this.removePropertyChangeListener(i,c)},z.fp=function(g,G,b,I,q){return this.firePropertyChange(g,G,b,I,q)},z.addPropertyChangeListener=function(l,N,i){var j=this;j._62I||(j._62I=new Ne),j._62I.add(l,N,i)},z.removePropertyChangeListener=function(d,w){this._62I&&this._62I.remove(d,w)},z.firePropertyChange=function(H,G,n,B,i){if(B){if(B(G,n))return!1}else if(G===n)return!1;var S=this,U=i||{};return U.property=H,U.oldValue=G,U.newValue=n,U.source=S,U.data=S,S._62I&&S._62I.fire(U),S.onPropertyChanged&&S.onPropertyChanged(U),!0}},ms_attr:function(i){i.a=function(l,t){var M=this;if(2===arguments.length)M.setAttr(l,t);else{if(!ag(l))return M.getAttr(l);for(var U in l)M.setAttr(U,l[U])}return M},i.getAttr=function(L,Q){if(Q===z&&(Q=1),this._attrObject&&L in this._attrObject)return this._attrObject[L];if(this.getImage){var S=this.getImage();if(ed(S)&&(S=Ze[S]),ag(S)&&"dataBindings"in S)for(var A=S.dataBindings,_=A.length-1;_>=0;_--){var m=A[_];if(m.attr===L){if("defaultValue"in m)return m.defaultValue;break}}}return Q?v[L]:z},i.setAttr=function(D,O){var F=this;F._attrObject||(F._attrObject={});var E=F._attrObject[D];O===z?delete F._attrObject[D]:F._attrObject[D]=O,F.fp&&F.fp("a:"+D,E,O)&&F.onAttrChanged&&F.onAttrChanged(D,E,O)},i.getSerializableAttrs=function(){var u,J={};for(u in this._attrObject)J[u]=1;return J}},ms_bnb:function(j){j.getBodyColor=function(h){return h.s("body.color")},j.getBorderColor=function(e){return e.s("border.color")}},_51o:function(Z){Z.mi=function(A,Z,o){this.addInteractorListener(A,Z,o)},Z.umi=function(O,c){this.removeInteractorListener(O,c)},Z.fi=function(Z){this.fireInteractorEvent(Z)},Z.addInteractorListener=function(W,a,j){var D=this;D._63I||(D._63I=new Ne),D._63I.add(W,a,j)},Z.removeInteractorListener=function(H,$){this._63I.remove(H,$)},Z.fireInteractorEvent=function(J){this._63I&&this._63I.fire(J)},Z.setInteractors=function(U){var m=this,y=m._interactors;y&&y.each(function(J){J.tearDown()}),Ul(U)&&(U=new fl(U)),m._interactors=U,U&&U.each(function(I){I.setUp()}),m.fp("interactors",y,U),m.invalidateSelection()},Z.getInteractors=function(){return this._interactors}},_49o:function(C){C._44O=G,C._45O=G,C.getTopPainters=function(){return this._44O},C.getBottomPainters=function(){return this._45O},C.addTopPainter=function(C){var v=this;v._44O||(v._44O=new fl),v._44O.contains(C)||(v._44O.add(C),v.redraw&&v.redraw())},C.removeTopPainter=function(S){var L=this;L._44O&&(L._44O.remove(S),L.redraw&&L.redraw())},C.addBottomPainter=function(Z){var b=this;b._45O||(b._45O=new fl),b._45O.contains(Z)||(b._45O.add(Z),b.redraw&&b.redraw())},C.removeBottomPainter=function(N){var y=this;y._45O&&(y._45O.remove(N),y.redraw&&y.redraw())},C._93db=function(o,W){var s=this;s._45O&&s._45O.each(function(V){V.draw?V.draw(o,W):V.call(s,o,W)})},C._92db=function(q,W){var I=this;I._44O&&I._44O.each(function(Y){Y.draw?Y.draw(q,W):Y.call(I,q,W)})}},ms_sm:function(d){d.sm=function(){return this.getSelectionModel()},d.setSelectableFunc=function(v){this.sm().setFilterFunc(v)},d.getSelectableFunc=function(){return this.sm().getFilterFunc()},d.getSelectionModel=function(){var j=this;return j._selectionModel?j._selectionModel:j.dm().sm()},d.isSelectionModelShared=function(){return!this._selectionModel},d.setSelectionModelShared=function(m){var o=this,g=!o._selectionModel,d=o.handleSelectionChange,i=o.dm();g!==m&&(o.invalidateSelection&&o.invalidateSelection(),m?(i.sm().ms(d,o),o._selectionModel.ums(d,o),o._selectionModel.dispose(),o._selectionModel=G):(i.sm().ums(d,o),o._selectionModel=new vi(i),o._selectionModel.ms(d,o)),o.onSelectionModelSharedChanged(),o.fp("selectionModelShared",g,m))},d.onSelectionModelSharedChanged=function(){var u=this;u.redraw(),u.invalidateSelection&&u.invalidateSelection()},d.removeSelection=function(){var P=this.dm();P.beginTransaction(),this.sm().toSelection().each(P.remove,P),P.endTransaction()},d.selectAll=function(){var Z=this;Z.sm().ss(Z.dm().toDatas(function(x){return Z.isVisible(x)&&Z.isSelectable(x)}))},d.isSelected=function(i){return this.sm().co(i)},d.isSelectedById=function(h){var G=this.dm().getDataById(h);return G?this.isSelected(G):!1},d.isSelectable=function(l){return this.sm().isSelectable(l)}},ms_tx:function(K){K._64I=0,K._65O=0,K.isScrollable=function(){return this.getWidth()<this._64I},K._40o=function(){return this.isScrollable()},K.getLogicalPoint=function(o){return ch(o,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},K.tx=function(j){return j===z?this.getTranslateX():(this.setTranslateX(j),void 0)},K.getTranslateX=function(){return this._65O},K.setTranslateX=function(i){var F=this,g=F.getWidth()-F._64I;g>i&&(i=g),i>0&&(i=0),i=a(i);var j=F._65O;F._65O=i,F.fp(Tg,j,i)}},ms_ty:function(Q){Q._23Q=0,Q._66O=0,Q._41o=function(){return this.getHeight()<this._23Q},Q.getLogicalPoint=function(s){return ch(s,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Q.ty=function(o){return o===z?this.getTranslateY():(this.setTranslateY(o),void 0)},Q.getTranslateY=function(){return this._66O},Q.setTranslateY=function(e){var n=this,Z=n.getHeight()-n._23Q;Z>e&&(e=Z),e>0&&(e=0),e=a(e);var R=n._66O;n._66O=e,n.fp(oh,R,e)}},ms_txy:function(Y){Y._65O=0,Y._66O=0,Y.tx=function(F){return F===z?this.getTranslateX():(this.setTranslateX(F),void 0)},Y.ty=function(B){return B===z?this.getTranslateY():(this.setTranslateY(B),void 0)},Y.onTranslateEnded=function(){},Y.setTranslate=function(E,Y,e){var R=this;if(e=Jm(e)){R._65I&&R._65I.stop(!0);var d=R.tx(),P=R.ty();e.action=function(k){R.setTranslate(d+(E-d)*k,P+(Y-P)*k)},e._37o=function(){delete R._66I,delete R._65I,R.onTranslateEnded()},R._66I=1,R._65I=Gg(e)}else R.tx(E),R.ty(Y)},Y.getTranslateX=function(){return this._65O},Y.setTranslateX=function(X){var o=this;X=o.adjustTranslateX(X);var H=o._65O;o._65O=X,o.fp(Tg,H,X)},Y.getTranslateY=function(){return this._66O},Y.setTranslateY=function(e){var $=this;e=$.adjustTranslateY(e);var x=$._66O;$._66O=e,$.fp(oh,x,e)},Y.adjustTranslateX=function(H){return a(H)},Y.adjustTranslateY=function(n){return a(n)},Y.translate=function(o,y,V){this.setTranslate(this.tx()+o,this.ty()+y,V)},Y.getLogicalPoint=function(F){var p=this;return ch(F,this._canvas||p._view,p.tx(),p.ty())}},ms_dm:function(w){w.dm=function(X){return X?(this.setDataModel(X),void 0):this.getDataModel()},w.getDataModel=function(){return this._dataModel}},ms_lp:function(k){k.lp=function(n){return this.getLogicalPoint(n)}},ms_v:function(d){d._disabled=!1,d.setDisabled=function(M,P){var U=this,D=U._disabled;D!==M&&(D&&(Nl(U._63O),delete U._63O),M&&(Mk(U._view,U._63O=uc(P)),U.iv()),U._disabled=M,U.fp("disabled",D,M))},d.isDisabled=function(){return this._disabled},d.getDisabledDiv=function(){return this._63O},d.getView=function(){return this._view},d.addToDOM=function(x){var G=this,l=G.getView(),F=l.style;x=x||I.body,x.appendChild(l),F.left="0",F.right="0",F.top="0",F.bottom="0",p.addEventListener("resize",function(){G.iv()},f),G.iv()},d.getWidth=function(){return this._view.clientWidth},d.getHeight=function(){return this._view.clientHeight},d.setWidth=function(Y){var I=this;I._view.style.width=Y+un,I.iv(),I.fp&&I.fp(zp,G,Y)},d.setHeight=function(V){var x=this;x._view.style.height=V+un,x.iv(),x.fp&&x.fp(dd,G,V)},d.setFocus=function(u){var L=this,B=L._currentEditor;return u&&B&&(B.getView&&(B=B.getView()),B.contains(u.target))?!1:(Rg(L._view),L.endEditing&&L.endEditing(),L.fireViewEvent("focus"),!0)},d.iv=function(f){this.invalidate(f)},d.invalidate=function(y){var a=this;a._68I||(a._68I=1,ln(a.validate,a,G,y),a.onInvalidated&&a.onInvalidated(),a.fireViewEvent("invalidate"))},d.validate=function(){var p=this,t=p._view;if(p._68I&&(delete p._68I,t.parentNode))if(0===t.offsetWidth&&0===t.offsetHeight&&p._67I!==G)p._67I===z&&(p._67I=V.reinvalidateCount),p._67I>0?p._67I--:p._67I=G,p.iv();else{p.fireViewEvent("beginValidate"),p.validateImpl(),p.onValidated&&p.onValidated(),p.fireViewEvent("validate");var Q=p._63O;Q&&(t.lastChild!==Q&&(Nl(Q),Mk(t,Q)),op(Q,0,0,p.getWidth(),p.getHeight())),mc(p),Tf(p),Qm(p)}},d.layout=function(p,P,J,e){1===arguments.length?op(this,p):op(this,p,P,J,e)},d.addViewListener=function(N,f,v){var W=this;W._67O||(W._67O=new Ne),W._67O.add(N,f,v)},d.removeViewListener=function(S,f){this._67O.remove(S,f)},d.fireViewEvent=function(N){var K=this;K._67O&&(ed(N)&&(N={kind:N}),K._67O.fire(N)),V.viewListener&&V.viewListener(K,N)}},ms_tip:function(p){p.setToolTipEnabled=function(z){var F=this;z?Ai||F._13o||(F.enableToolTip(),F.fp("toolTipEnabled",!1,!0)):F._13o&&(F.disableToolTip(),F.fp("toolTipEnabled",!0,!1))},p.isToolTipEnabled=function(){return!!this._13o},p.enableToolTip=function(){var R=this;Ai||R._13o||(R._13o=function(q){var O=R.getToolTip(q);O!=G?V.toolTipContinual&&V.isToolTipShowing()?oj(q,O):(um(),$g={timeout:o(ok,ro),e:q,info:O}):um()},R.getView().addEventListener(md,R._13o,f),R.getView().addEventListener("mouseleave",V.hideToolTip,f))},p.disableToolTip=function(){var K=this;K._13o&&(K.getView().removeEventListener(md,K._13o,f),K.getView().removeEventListener("mouseleave",V.hideToolTip,f),delete K._13o)},p.getToolTip=function(l){var h=this;if(h.getDataAt){var T=h.getDataAt(l);return T?T.getToolTip():G}return h.getValue?h.getValue():void 0}},_52o:function(M){M._zoom=1,M._29I=ai,M.zoomIn=function(z,u){this.setZoom(this._zoom*yd,z,u)},M.zoomOut=function(K,C){this.setZoom(this._zoom/yd,K,C)},M.zoomReset=function(E,O){this.setZoom(1,E,O)},M.scrollZoomIn=function(A){this.setZoom(this._zoom*eh,G,A)},M.scrollZoomOut=function(h){this.setZoom(this._zoom/eh,G,h)},M.pinchZoomIn=function(Y){this.setZoom(this._zoom*si,G,Y)},M.pinchZoomOut=function(e){this.setZoom(this._zoom/si,G,e)},M.adjustZoom=function(C){return vq>C?vq:C>Qi?Qi:C},M.getZoom=function(){return this._zoom},M.setZoom=function(t,m,l){var R=this;if(m=Jm(m)){R._14o&&R._14o.stop(!0);var i=R._zoom;m.action=function(r){R._96O(i+(t-i)*r,l)},m._37o=function(){delete R._zooming,delete R._14o,R.onZoomEnded()},R._zooming=1,R._14o=Gg(m)}else R._96O(t,l)},M._96O=function(n,F){var m=this;if(n=m.adjustZoom(n),n!==m._zoom){m.validate();var l=m._29I,y=m._zoom;0!==l.width&&0!==l.height&&(F=F?F:{x:l.x+l.width/2,y:l.y+l.height/2},m.tx((F.x-l.x)*y-F.x*n),m.ty((F.y-l.y)*y-F.y*n)),m._zoom=n,m.fp("zoom",y,n)}}}};Sm(V,{numberDigits:5,crossOrigin:"",baseZIndex:z,isTouchable:Ai,devicePixelRatio:p.devicePixelRatio?p.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:M.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return pj},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:Ai?20:1,animDuration:200,animEasing:function($){return $*$},labelColor:jb,labelSelectColor:Vm,labelFont:(Ai?"15":"12")+"px arial, sans-serif",widgetIndent:Ai?30:20,widgetRowHeight:Ai?30:20,widgetHeaderHeight:Ai?32:22,widgetTitleHeight:Ai?34:24,scrollBarColor:vs,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ai?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Sk,intersectionLineLine:Tm,isEnter:Nd,isEsc:me,isDelete:ui,isSpace:Ni,isLeft:Ko,isUp:_g,isRight:Wr,isDown:pg,getTarget:af,isString:ed,isNumber:Mj,isBoolean:Rk,isArray:Ul,isSelectAll:xr,isFunction:em,isObject:ag,getPropertyValue:Yq,setPropertyValue:cb,addMethod:Sm,getVersion:function(){return"6.2.6"},appendToScreen:function(g){g=g.getView?g.getView():g,(I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement||I.body).appendChild(g)},toggleFullscreen:function(M){var p=M.getView();if(I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement)I.exitFullscreen?I.exitFullscreen():I.msExitFullscreen?I.msExitFullscreen():I.mozCancelFullScreen?I.mozCancelFullScreen():I.webkitExitFullscreen&&I.webkitExitFullscreen();else{var _=!0;if(M.isSelfViewEvent){var n=M.getX(),H=M.getY(),b=M.getWidth(),y=M.getHeight(),m=p.style.background;m||(p.style.background="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var c=setInterval(function(){if(p!==(I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement))clearInterval(c),M.setX(n),M.setY(H),M.setWidth(b),M.setHeight(y),M._fullscreen=!1,p.style.background=m,M.iv();else{var t=K.Default.getWindowInfo();(_||t.width!==M.getWidth()||t.height!==M.getHeight())&&(M.setX(t.left),M.setY(t.top),M.setWidth(t.width),M.setHeight(t.height),M._fullscreen=!0,M.iv(),_=!1)}},500)}else{var q=p.style.left,u=p.style.top,b=p.style.width,y=p.style.height,m=p.style.background;m||(p.style.background="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var c=setInterval(function(){if(p!==(I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement))clearInterval(c),p.style.left=q,p.style.top=u,p.style.width=b,p.style.height=y,p.style.background=m,M.iv();else{var L=K.Default.getWindowInfo();(_||L.width!==M.getWidth()||L.height!==M.getHeight())&&(op(M),_=!1)}},500)}}},appendTimeStamp:function(V){return V},setCompType:function(W,G){em(G)||ag(G)?No[W]=G:no(W)},getCompType:function(C){var r=No[C];return r===z&&Zj.test(C)&&no(C),r},getCompTypeMap:function(){return No},drawCompType:function(g,a,K,e,Z,J){g(a,K,e,Z,J)},numberListener:function(){var v={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(Z){var i=Z.keyCode;v[i]||65===i&&V.isCtrlDown(Z)||86===i&&V.isCtrlDown(Z)||67===i&&V.isCtrlDown(Z)||88===i&&V.isCtrlDown(Z)||i>=35&&40>=i||(Z.shiftKey||48>i||i>57)&&(96>i||i>105)&&Z.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(m){var $=m.target.tagName;("DIV"===$||"CANVAS"===$)&&!(V.ignoreKeyCodes.indexOf(m.keyCode)>=0)&&("keydown"!==m.type||Ko(m)||Wr(m)||_g(m)||pg(m)||ui(m)||65===m.keyCode&&(m.metaKey||m.ctrlKey))&&(m.preventDefault(),m.preventManipulation&&m.preventManipulation())},getWindowInfo:function(){var m=I.documentElement,K=m&&(m.scrollLeft||m.scrollTop)?m:I.body;return{target:K,left:K.scrollLeft,top:K.scrollTop,width:p.innerWidth||K.clientWidth,height:p.innerHeight||K.clientHeight}},isDragging:function(){return!!pj},isLeftButton:function(R){return Ai?!0:0===R.button},isInput:function(I){if(!I)return!1;var M=I.tagName;return"INPUT"===M||"TEXTAREA"===M||"SELECT"===M},getTouchCount:function(C){return Ai?C.touches.length:1},isDoubleClick:function(){function W(z){z.details=0,z.timeout=null,z.lastPoint=null}var s={};return pb=new B,Ec=pb.getTime(),function(f){if(f.touches&&f.touches.length>1)return!1;var K=f.button==G?"":f.button,b=f.type+K,c=b+"_isDoubleClick",X=s[b];if(X||(X=s[b]={details:0,timeout:null,lastPoint:null}),f[c]===z){f[c]=!0;var q=Ac(f);X.timeout&&(N(X.timeout),X.timeout=null),X.lastPoint&&Li(X.lastPoint,q)>V.doubleClickRange&&W(X),X.lastPoint=q,X.details++,X.timeout=o(function(){W(this)}.bind(X),500)}return 2===X.details}}(),isShiftDown:function(_){return _?_.shiftKey:Yr["16"]},isCtrlDown:function(N){return N?Ic?N.metaKey:N.ctrlKey:Ic?Yr["91"]:Yr["17"]},getClientPoint:function(Z){return Ai&&(Z=yp(Z)),{x:Z.clientX,y:Z.clientY}},isMouseEvent:function(y){return y instanceof MouseEvent||0===y.type.indexOf("mouse")},getTargetElement:function(f){if(V.isMouseEvent(f)||!I.elementFromPoint)return f.target;var T=Qk(f);return I.elementFromPoint(T.x,T.y)},getPagePoint:function(N){return Ai&&(N=yp(N)),{x:N.pageX,y:N.pageY}},createObject:function(G,E){var l=new G;for(var U in E){var D=E[U];if(em(D))l[U]=D;else if(0===U.indexOf("s:"))l.s(U.substr(2),E[U]);else if(0===U.indexOf("a:"))l.a(U.substr(2),E[U]);else{var c=yc(U),D=E[U];l[c]?(l[c](D),"setToolTip"===c&&l.enableToolTip&&l.enableToolTip()):l[U]=D}}return l},setImage:function(p,E,v,Z){var s=arguments.length;4===s?Ue(p,Z,E,v):2===s?ed(E)?Ue(p,E):Ze[p]=E:1===s&&Ue(p,p)},getImage:function(L,K,P){var e;if(L==G)return G;if(ag(L)?e=L:(e=Ze[L],L&&e===z&&(ho&&ho[L]||Ue(L,L))),K&&e&&e.tagName){var y;y="override"===P?"colors_override":"override_rgb"===P?"colors_override_rgb":"override_a"===P?"colors_override_a":"colors",e[y]||(e[y]={__count__:0});var j=e[y][K];return j||(e[y].__count__>V.imageCacheThreshold&&(e[y]={__count__:0}),j=kn(e,So(K),e.width,e.height,P),e[y][K]=j,e[y].__count__++),j}return e},isImageComplete:function(p,L,o){var _=ag(p)?p:Ze[p];if(!_)return!1;if(_.tagName)return _.complete;for(var U,p,j,m=_.comps,f=!0,O=0,D=m.length;D>O;O++)if(U=m[O],j=U.type,"image"===U.type){p=U.name,p&&p.func&&(p=Qb(p,L));var r=Se(p,L,o);if(!r){f=!1;break}}else if(Zj.test(j)&&V.getCompType(j)===z){f=!1;break}return f},getId:function(){var V=1;return function(){return++V}}(),callLater:function(X,U,Y,K){var M=function(){X.apply(U,Y)};return K?o(M,K):p.requestAnimationFrame(M)},clone:function(x){if(null==x||"object"!=typeof x)return x;if(x instanceof Date){var v=new Date;return v.setTime(x.getTime()),v}if(x instanceof Array){for(var v=[],s=0,g=x.length;g>s;s++)v[s]=Cn(x[s]);return v}if(x instanceof fl){for(var v=new fl,s=0,g=x.length;g>s;s++)v.set(s,Cn(x.get(s)));return v}if(x instanceof wf)return x;if(x instanceof m){var v={};for(var U in x)x.hasOwnProperty(U)&&(v[U]=Cn(x[U]));return v}return x},callWhenLoaded:function(c,k){k=k||100;var G=Ae(c,k);gj||(gj={}),gj[G]={tick:G,cb:c,delay:k}},beforeLoadURL:function(U){if(gj){var b={};for(var X in gj){var w=gj[X];N(w.tick);var S=Ae(w.cb,w.delay);b[S]={tick:S,delay:w.delay,cb:w.cb}}gj=b}return V.convertURL?V.convertURL(U):U},convertURL:function(Y){return Y},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(f,Y){if(f===Y)return 0;if(f==G&&Y!=G)return 1;if(f!=G&&Y==G)return-1;if(f==G&&Y==G)return 0;var B,A=typeof f,i=typeof Y;return A===ue&&i===ue?B=f.localeCompare(Y):A===Fq&&i===Fq&&(B=f-Y),B===z&&(B=(""+f).localeCompare(""+Y)),B>0?1:0>B?-1:0},getClassMap:function(){return Xg},getClass:function(B){if(ed(B)){var I,y=Xg[B];if(!y){I=B.split("."),y=p;for(var e=0;e<I.length;e++)y=y[I[e]];Xg[B]=y}return y}return B},def:function(e,X,M){var W,R,z,B=function(){};if(B.prototype=X.prototype,W=new B,ed(e)){if(Xg[e])throw"'"+e+"' already defined";z=ah(e),W.getClassName=function(){return e}}else z=e;if(W.constructor=z,W.getClass=function(){return z},W.getSuperClass=function(){return X},M)for(R in M)Xm[R]&&Xm.hasOwnProperty(R)?Xm[R](W,M):wc(W,M,R);z.prototype=W,z.superClass=X.prototype},startAnim:function(){var F=function(o){o.duration&&(o.startTime=Un()),o.timeId=ln(o.tick,G,G,o.interval)};return function(K){return K=Cn(K),K.easing=K.easing||V.animEasing,K.duration||K.frames||(K.duration=V.animDuration),K.t=0,K.duration?K.interval=0:(K.frame=0,K.interval=K.interval||10),K.tick=function(){if(K.duration){var L=(Un()-K.startTime)/K.duration;L>1&&(L=1),K.t=L,K.action(K.easing(L),L),1===L?K.stop():K._isPaused||(K.timeId=ln(K.tick))}else K.frame++,L=K.t=K.frame/K.frames,K.action(K.easing(L),L),K.frame<K.frames?K._isPaused||(K.timeId=ln(K.tick,G,G,K.interval)):K.stop()},K.resume=function(){K._isPaused&&(delete K._isPaused,K.duration?K.t<1&&(K.startTime=Un()-K.duration*K.t,K.timeId=ln(K.tick)):K.frame<K.frames&&(K.timeId=ln(K.tick,G,G,K.interval)))},K.pause=function(){K._isPaused=!0},K.isPaused=function(){return this._isPaused},K.stop=function(g){K.isRunning()&&(K.duration?K.t<1&&g&&(K.t=1,K.action(K.easing(1),1)):K.frame<K.frames&&g&&(K.frame=K.frames,K.action(K.easing(1),1)),K._37o&&K._37o(),K.finishFunc&&K.finishFunc(),En(K.timeId,!K.duration),delete K.timeId)},K.isRunning=function(){return K.timeId!=G},K.delay?ln(F,G,[K],K.delay):F(K),K}}(),getTextSize:function(){var x={},J=I?$p().getContext("2d"):G;return function(E,r){J.font=E?E:Fh;var S=x[J.font];return S||(S=2*J.measureText("e").width+4,x[J.font]=S),{width:J.measureText(r).width+4,height:S}}}(),drawText:function(R,K,F,X,w,s,g,m,y,P){if(K!=G){var b=uk(F,K),V={};V.y=P&&P!==El?P===Wj?s+b.height/2:s+m-b.height/2:s+m/2,V.x=y&&y!==kh?y===tq?w+g-b.width/2:w+g/2:w+b.width/2,Cd(R,K,V,F,X)}},getDistance:function(_,g){var r=_.length;return g?3===r?H(Q(_[0]-g[0])+Q(_[1]-g[1])+Q(_[2]-g[2])):2===r?H(Q(_[0]-g[0])+Q(_[1]-g[1])):_.z===z?H(Q(g.x-_.x)+Q(g.y-_.y)):H(Q(g.x-_.x)+Q(g.y-_.y)+Q(g.z-_.z)):3===r?H(Q(_[0])+Q(_[1])+Q(_[2])):2===r?H(Q(_[0])+Q(_[1])):void 0},brighter:function(z,e){return 0>e&&(e=-e),Gl(z,e?e:40)},darker:function(p,f){return f>0&&(f=-f),Gl(p,f?f:-40)},unionPoint:function(P,o){if(!P)return G;if(2===arguments.length)return P&&o?{x:$(P.x,o.x),y:$(P.y,o.y),width:D(P.x-o.x),height:D(P.y-o.y)}:G;var l=P;if(l._as&&(l=l._as),l.length===z)return G;var x=l.length;if(0>=x)return G;for(var m=1,J=l[0],s={x:J.x,y:J.y,width:0,height:0};x>m;m++){J=l[m];var U=$(s.x,J.x),K=W(s.x+s.width,J.x),A=$(s.y,J.y),d=W(s.y+s.height,J.y);s.x=U,s.y=A,s.width=K-U,s.height=d-A}return s},unionRect:function(a,f){if(a&&!f)return Cn(a);if(!a&&f)return Cn(f);if(a&&f){var C={x:$(a.x,f.x),y:$(a.y,f.y)};return C.width=W(a.x+a.width,f.x+f.width)-C.x,C.height=W(a.y+a.height,f.y+f.height)-C.y,C}return G},containsPoint:function(J,Z,L,T){if(T!=G&&1!==T){var V=J.x+J.width/2,l=J.y+J.height/2;J={x:V-J.width/2*T,y:l-J.height/2*T,width:J.width*T,height:J.height*T}}if(L){var p=J.width/2,A=J.height/2,r=s(-L),u=F(-L),Y=Z.x-J.x-p,D=Z.y-J.y-A;return Z={x:u*Y-r*D,y:r*Y+u*D},Wn({x:-p,y:-A,width:J.width,height:J.height},Z)}return!(!J||Z.x<J.x||Z.y<J.y||Z.x>J.x+J.width||Z.y>J.y+J.height)},containsRect:function(K,L){if(!K||!L)return!1;var o=L.x,m=L.y,Q=L.width,y=L.height,E=K.width,h=K.height;if(0>(E|h|Q|y))return!1;var u=K.x,J=K.y;if(u>o||J>m)return!1;if(E+=u,Q+=o,o>=Q){if(E>=u||Q>E)return!1}else if(E>=u&&Q>E)return!1;if(h+=J,y+=m,m>=y){if(h>=J||y>h)return!1}else if(h>=J&&y>h)return!1;return!0},intersectsRect:function(C,i){if(!C||!i)return!1;var c=i.width,d=i.height,P=C.width,g=C.height;if(0>=P||0>=g||0>=c||0>=d)return!1;var R=i.x,y=i.y,N=C.x,w=C.y;return P+=N,g+=w,c+=R,d+=y,P>R&&g>y&&c>N&&d>w},intersection:function(j,u){if(!j||!u)return G;var m=u.x,P=u.y,q=j.x,i=j.y,x=m,o=P,F=q,V=i;return x+=u.width,o+=u.height,F+=j.width,V+=j.height,q>m&&(m=q),i>P&&(P=i),x>F&&(x=F),o>V&&(o=V),x-=m,o-=P,0>=x||0>=o?G:{x:m,y:P,width:x,height:o}},grow:function(j,N,A){A===z&&(A=N),j.x-=N,j.y-=A,j.width=j.width+2*N,j.height=j.height+2*A},getScreenPoint:function(n,D,x,T,$,i,c){var Q,E,V=x.getBoundingClientRect(),l=n*(i||1)+V.left-x.scrollLeft+(T||0),U=D*(c||1)+V.top-x.scrollTop+($||0),H={x:l,y:U};return(Q=x.parentElement)&&(E=Q.maxtrixAppend)?E.applyInverse(H,{}):H},getLogicalPoint:function(N,K,B,h,O,n){var k,$,x=K.getBoundingClientRect();N.target?(Rj(N)?Ic?Yr["91"]=!0:Yr["17"]=!0:Ic?Yr["91"]=!1:Yr["17"]=!1,Yr["16"]=lm(N)?!0:!1,N=Ai?yp(N):N,k=N.clientX,$=N.clientY):(k=N.x,$=N.y);var P,e;if((P=K.parentElement)&&(e=P.maxtrixAppend)){var I=e.apply({x:k,y:$},{});return I.x=(I.x+K.scrollLeft-(B||0))/(O||1),I.y=(I.y+K.scrollTop-(h||0))/(n||1),I}return{x:(k-x.left+K.scrollLeft-(B||0))/(O||1),y:($-x.top+K.scrollTop-(h||0))/(n||1)}},removeHTML:function(){var V;return function(Z){return Z&&Z.getView&&(Z=Z.getView()),Z&&Z.parentNode?V===Z?!0:(V=Z,Z.parentNode.removeChild(Z),V=G,!0):!1}}(),getToolTipDiv:function(){if(!Fi){Fi=Rm(),Ui=Rm();var Q=Fi.style;V.baseZIndex!=G&&(Q.zIndex=_(V.baseZIndex)+3+""),Q.whiteSpace="nowrap",Q.color=V.toolTipLabelColor,Q.background=V.toolTipBackground,Q.font=V.toolTipLabelFont,Q.padding="5px",Q.boxShadow="0px 0px 3px "+V.toolTipShadowColor}return Fi},isToolTipShowing:function(){return Fi&&Fi.parentNode?!0:Ui&&Ui.parentNode?!0:!1
},hideToolTip:function(){Nl(Fi),Nl(Ui),He()},showToolTip:function(R,U){if(!R||U==G)return um(),void 0;V.getToolTipDiv();var M,_;if(U.html?(U=U.html,M=Ui,Nl(Fi)):(M=Fi,Nl(Ui)),_=M.style,M.innerHTML=U,M.parentNode||K.Default.appendToScreen(M),R.target){R=Qk(R);var I=_c(),g=R.x,X=R.y,y=Ai?60:12;if(Ai){var u=M.getBoundingClientRect();_.left=g-u.width/2+un,_.top=X-u.height-y<I.top?X+y+un:X-u.height-y+un}else{_.left=g+y+un,_.top=X+y+un;var u=M.getBoundingClientRect();u.left+u.width>I.width&&(_.left=g-y-u.width+un),u.top+u.height>I.height&&(_.top=X-y-u.height+un),u.left<0&&(_.left=g+y+un),u.top<0&&(_.top=X+y+un)}}else _.left=R.x+un,_.top=R.y+un;He()},startDragging:function(n,s,E){E==z&&(E=!0),n!==pj&&(pj?E&&(Ai?pj.handleWindowTouchEnd(s):pj.handleWindowMouseUp(s)):Ai?(p.addEventListener(Lk,hd,f),p.addEventListener(Xi,kl,f)):(p.addEventListener(md,qp,f),p.addEventListener(Vo,oi,f)),pj=n)},getImageMap:function(){return Ze},toBoundaries:function(M,_,g,L){var Q=[];return Ie(M,_,g,L).forEach(function(t){var c=[];t.forEach(function(R){c.push(R.x,R.y)}),Q.push(c)}),Q},getCurrentKeyCodeMap:function(){return Yr},drawCenterImage:function(R,h,s,c,V,B,C,b){var y=dq(h,V,B),t=Am(h,V,B);Ar(R,h,a(s-y/2),a(c-t/2),y,t,V,B,C,b)},drawStretchImage:function(x,P,Q,t,F,J,E,V,b,G,y,C){var w,o=dq(P,V,b,J),N=Am(P,V,b,E);"uniform"===Q?(w=$(J/o,E/N),o*=w,N*=w,t+=a((J-o)/2),F+=a((E-N)/2),J=o,E=N):"centerUniform"===Q&&((o>J||N>E)&&(w=$(J/o,E/N),o*=w,N*=w),t+=a((J-o)/2),F+=a((E-N)/2),J=o,E=N);var q=x.interactiveInfo;if(q){var H;if(H="center"===Q?{x:t+J/2-o/2,y:F+E/2-N/2,width:o,height:N}:{x:t,y:F,width:J,height:E},q.rect){var Z=q.compInfos,K=Z.length;K&&(Z[K-1].rect.image=P)}else q.rect=H}if("center"===Q){var m=y!==!1&&(o>J||N>E);m&&(x.save(),x.beginPath(),x.rect(t,F,J,E),x.clip()),Ar(x,P,t+J/2-o/2,F+E/2-N/2,o,N,V,b,G,C),m&&x.restore()}else Ar(x,P,t,F,J,E,V,b,G,C)},toCanvas:function(e,D,b,V,K,N,m,o,l){e=tn(e,m),D=D||dq(e,K),b=b||Am(e,K);var B=$p(),G=vd(B);return o?(Hp(B,D,b,o),G.scale(o,o)):Hp(B,D,b,1),sm(G,e,V,0,0,D,b,K,N,m,l),e&&e.clampToEdge&&(B.clampToEdge=e.clampToEdge),G.restore(),B},createGradientImage:function(e,f,B,d){for(var G=["L",0,0,e,0,1,0,0,1,0,0],P=0,w=Math.min(f.length,B.length);w>P;P++)G.push(B[P],f[P]);var o=K.Default.toCanvas({width:e,height:e,clampToEdge:!0,comps:[{type:"shape",rotation:d||0,points:[0,0,e,0,e,e,0,e],background:"#ffffff",gradientPack:G}]});return o},createElement:function(k,n,R,y){var t=I.createElement(k);return Yk(t,n||M.widgetBorder,2),t.style.font=R?R:Fh,y!=G&&(t.value=y),V.onElementCreated&&V.onElementCreated(t),t},containedInView:function(C,F){var u=Zk(F).getBoundingClientRect();return Wn({x:u.left,y:u.top,width:u.width,height:u.height},Ac(C))},isIsolating:function(){return ge>0},setIsolating:function(Y){Y?ge++:ge--},getMSMap:function(){return Xm},stringify:function(X,q){var s=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var p=JSON.stringify(X,function(x,h){return"function"==typeof h?"__ht__"+(h.__ht__||h.toString()):Mj(h)?Ti(h):h},q==G?2:q);return Date.prototype.toJSON=s,p},parse:function(y){return ed(y)?JSON.parse(y,function(P,a){if(ed(a)){if("__ht__function"==a.substr(0,14)){var S=a.indexOf("{")+1,F=a.lastIndexOf("}"),I=a.indexOf("(")+1,h=a.indexOf(")");if(S&&F&&I&&h){var q=new Function(a.substring(I,h),a.substring(S,F));return q.__ht__=a.substr(6),q}}if("__ht__date"==a.substr(0,10))return new Date(_(a.substr(10)))}return a}):y},loadJS:function(W,f){f&&W.push(f);var d=W.shift();if(Ul(d))W=d.contact(W),V.loadJS(W);else if(em(d))d(),V.loadJS(W);else if(ed(d)){var h=I.createElement("script");h.onload=function(){V.loadJS(W)},h.setAttribute("src",d),I.getElementsByTagName("head")[0].appendChild(h)}else W.length&&V.loadJS(W)},toRoundedCorner:function(P,A){var U=P.size();if(0>=A)return{points:P};var L,h=new fl,G=new fl,O=P.get(0);h.add(O),G.add(1);for(var Y=1;U>Y;Y++)if(U>Y+1){var q=P.get(Y),c=P.get(Y+1),n=O.x,k=O.y,R=q.x,b=q.y,r=b-k,y=R-n,D=x(r,y);L=$(.99*Li(O,q),A),h.add({x:R-L*F(D),y:b-L*s(D)}),h.add(q),n=q.x,k=q.y,R=c.x,b=c.y,r=b-k,y=R-n,D=x(r,y),L=$(.99*Li(q,c),A),O={x:n+L*F(D),y:k+L*s(D)},h.add(O),G.addAll([2,3])}else h.add(P.get(Y)),G.add(2);return{points:h,segments:G}},toColorData:gr,setCanvas:Hp,createDiv:Rm,createDisabledDiv:uc,createView:yn,createCanvas:$p,appendChild:Mk,initContext:vd,checkLoadingImage:mc,translateAndScale:df,layout:op,getPosition:Zb,drawPoints:bq,drawRoundRect:cc,drawBorder:Wl,setFocus:Rg,getter:Lc,setter:yc,isEmptyObject:Oc},!0),Sm(A,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Qp=V.disabledOpacity,ro=V.toolTipDelay,Hd=V.devicePixelRatio,Bf=V.autoMakeVisible,cg=V.autoHideScrollBar,yk=V.imageGradient,oj=V.showToolTip,um=V.hideToolTip,li=V.dashPattern,xo=V.lineCap,Bp=V.lineJoin,Lg=V.labelColor,de=V.labelSelectColor,Fh=V.labelFont,vg=V.widgetIndent,rb=V.widgetRowHeight,wh=V.widgetHeaderHeight,ym=V.widgetTitleHeight,rc=V.scrollBarColor,Og=V.scrollBarSize,Gi=V.scrollBarTimeout,Bc=V.scrollBarMinLength,Um=V.scrollBarInteractiveSize,yd=V.zoomIncrement,eh=V.scrollZoomIncrement,si=V.pinchZoomIncrement,Qi=V.zoomMax,vq=V.zoomMin,Wd=V.createObject,Jd=V.preventDefault,dp=V.setImage,tn=V.getImage,Se=V.isImageComplete,Uo=V.drawCenterImage,sm=V.drawStretchImage,Jn=V.getId,ln=V.callLater,sb=V.sortFunc,Cn=V.clone,ah=V.getClass,Gg=V.startAnim,qk=V.brighter,dl=V.darker,bl=V.drawText,uk=V.getTextSize,Tl=V.isLeftButton,tl=V.getTouchCount,Rc=V.isDoubleClick,lm=V.isShiftDown,Rj=V.isCtrlDown,Ac=V.getClientPoint,Qk=V.getPagePoint,Li=V.getDistance,Gr=V.unionPoint,Fp=V.unionRect,Wn=V.containsPoint,_h=V.containsRect,Nb=V.intersectsRect,ph=V.intersection,_c=V.getWindowInfo,Fe=V.grow,ch=V.getLogicalPoint,Wf=V.getScreenPoint,Hl=V.startDragging,Nl=V.removeHTML,vn=V.createElement,sk=V.segmentResolution,to=V.shapeResolution,eo=V.shapeSide,ne=V.def,uj=function(f,G,s){ne(q+"."+f,G,s)},bm=function(L,a){L.childNodes.forEach(function(o){a(o),bm(o,a)})};Sm(V,{toolTipLabelColor:Lg,toolTipLabelFont:Fh,toolTipBackground:M.toolTipBackground,toolTipShadowColor:vs,drawBreakableText:Nk,setDevicePixelRatio:function(o){Hd=V.devicePixelRatio="number"==typeof o?o:p.devicePixelRatio,bm(I.body,function(e){var O=e._ht;O&&O._canvas&&(Hp(O._canvas,O.getWidth(),O.getHeight()),O.redraw?O.redraw():O.iv())})}},!0);var Mm=1e-6,sc="undefined"!=typeof Uint16Array?Uint16Array:Array,nj="undefined"!=typeof Float32Array?Float32Array:Array,bd=function(D,$,H){var p=[D[0]-$[0],D[1]-$[1],D[2]-$[2]];if(H){var Q=Li(p);Q>0&&(p[0]/=Q,p[1]/=Q,p[2]/=Q)}return p},cp=function(){var $="charCodeAt",k=2*(2*km.length+1);for(var Q in p)if(Q===q+kh[0]+un.length){var j=p[Q];if(!j)break;for(var w=j.length,_=0;w>_;_++)if(j[_][$](0)===k&&j[_+1]!=G&&j[_+1]===un[0]&&j[_+2]!=G&&j[_+2][$](0)===k){for(var H=_+3;w>H;H++)if(j[H][$](0)===k){if(0==j[H+1])for(var h,X=H+2;w>X;X++){if(j[X][$](0)===k){0==j[X-1]&&h&&(b=h.substr(0,h.length-1));break}h==G?h=j[X]:h+=j[X]}break}break}break}return function(s){return[-s[0],-s[1],-s[2]]}}(),Ao=function(O,X){return 3===O.length?O[0]*X[0]+O[1]*X[1]+O[2]*X[2]:O[0]*X[0]+O[1]*X[1]},Qh=function(){var P=new nj(16);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},gg=Qh(),Ve=function(V){var p=new nj(16);return p[0]=V[0],p[1]=V[1],p[2]=V[2],p[3]=V[3],p[4]=V[4],p[5]=V[5],p[6]=V[6],p[7]=V[7],p[8]=V[8],p[9]=V[9],p[10]=V[10],p[11]=V[11],p[12]=V[12],p[13]=V[13],p[14]=V[14],p[15]=V[15],p},ik=function(P,J){return P[0]=J[0],P[1]=J[1],P[2]=J[2],P[3]=J[3],P[4]=J[4],P[5]=J[5],P[6]=J[6],P[7]=J[7],P[8]=J[8],P[9]=J[9],P[10]=J[10],P[11]=J[11],P[12]=J[12],P[13]=J[13],P[14]=J[14],P[15]=J[15],P},bn=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},Kb=function(e,A){var w=e[0],I=e[1],B=e[2];return e[0]=A[0]*w+A[4]*I+A[8]*B+A[12],e[1]=A[1]*w+A[5]*I+A[9]*B+A[13],e[2]=A[2]*w+A[6]*I+A[10]*B+A[14],e},Ci=function(n,F){var i=n[0],K=n[1],$=n[2],o=n[3];return n[0]=F[0]*i+F[4]*K+F[8]*$+F[12]*o,n[1]=F[1]*i+F[5]*K+F[9]*$+F[13]*o,n[2]=F[2]*i+F[6]*K+F[10]*$+F[14]*o,n[3]=F[3]*i+F[7]*K+F[11]*$+F[15]*o,n},Tc=function(){var s,h,S,R,p=Lj(lb[1]+lb[7]),v=Lj(lb[0]+lb[3]-lb[10]),K=Lj(lb[8]+2),X=function(){return h=S.charAt(s),s+=1,h},t=function(){var l="";if(h===K)for(;X();){if(h===K)return X(),l;l+=h}else X()},Z=function(){for(;h&&" ">=h;)X()},F=function(){var j,J={};if(h===p){if(X(),Z(),h===v)return X(),J;for(;h;){if(j=t(),Z(),X(),J[j]=R(),Z(),h===v)return X(),J;X(),Z()}}};return R=function(){switch(Z(),h){case p:return F();default:return t()}},function(x){if(U={},x){var B;if(S=x,s=0,h=" ",B=R(),Z(),!h)return B}}}(),xn=function(G,Z){if(Z){var B=s(Z),n=F(Z),M=G[4],S=G[5],h=G[6],E=G[7],z=G[8],r=G[9],b=G[10],$=G[11];G[4]=M*n+z*B,G[5]=S*n+r*B,G[6]=h*n+b*B,G[7]=E*n+$*B,G[8]=z*n-M*B,G[9]=r*n-S*B,G[10]=b*n-h*B,G[11]=$*n-E*B}},fd=function(k,I){if(I){var h=s(I),v=F(I),r=k[0],n=k[1],q=k[2],m=k[3],l=k[8],G=k[9],L=k[10],$=k[11];k[0]=r*v-l*h,k[1]=n*v-G*h,k[2]=q*v-L*h,k[3]=m*v-$*h,k[8]=r*h+l*v,k[9]=n*h+G*v,k[10]=q*h+L*v,k[11]=m*h+$*v}},bj=function(J,Y){if(Y){var K=s(Y),Z=F(Y),m=J[0],B=J[1],v=J[2],c=J[3],E=J[4],x=J[5],r=J[6],R=J[7];J[0]=m*Z+E*K,J[1]=B*Z+x*K,J[2]=v*Z+r*K,J[3]=c*Z+R*K,J[4]=E*Z-m*K,J[5]=x*Z-B*K,J[6]=r*Z-v*K,J[7]=R*Z-c*K}},Tr=function(s,n,L){return Ki(G,L===!1?G:s.getFinalScale3d(),s.getFinalRotation3d(),s.getRotationMode(),s.p3(),G,n)},Ki=function(t,_,k,e,P,L,I){return L||(L=Qh()),P&&mr(L,P),le(L,k,e),I&&cr(L,L,I),_&&cf(L,_),t&&cr(L,L,t),L},up=function(Q,D,l){D=_(D),l=_(l);var s=this;s.g=Q,s._84O=D,s._85O=l,s._70I=!0,s.F=0,s._83O=D+l,s.pen={x:0,y:0}},kb="lineDashOffset",Zp="setLineDash",is=function(T){for(var g in T)1===g.length&&(kb=T[g]);return g?1:0},mf=function(W,p,H){return wr(p)?W:W[Zp]?(W[Zp](p),H&&(W.lineDashOffset=H),W):new up(W,p[0],p.length>1?p[1]:p[0])},tj=function(f,y){!wr(y)&&f[Zp]&&(f[Zp](_o),f.lineDashOffset=0)};if(ne(up,m,{_69I:6,moveTo:function(O,E){var q=this,j=q.pen;j.x=O,j.y=E,q.g.moveTo(O,E),q.start||(q.start={x:O,y:E})},lineTo:function(p,d){var m=this,V=m.pen,j=p-V.x,G=d-V.y,U=x(G,j),k=F(U),o=s(U),N=m._23O(V.x,V.y,p,d),Q=m._85O,W=m._84O,z=m._83O;if(m.F){if(m.F>N)return m._70I?m._72I(p,d):m.moveTo(p,d),m.F-=N,void 0;if(m._70I?m._72I(V.x+k*m.F,V.y+o*m.F):m.moveTo(V.x+k*m.F,V.y+o*m.F),N-=m.F,m.F=0,m._70I=!m._70I,!N)return}var i=y(N/z);if(i){for(var M=k*W,R=o*W,Y=k*Q,A=o*Q,f=0;i>f;f++)m._70I?(m._72I(V.x+M,V.y+R),m.moveTo(V.x+Y,V.y+A)):(m.moveTo(V.x+Y,V.y+A),m._72I(V.x+M,V.y+R));N-=z*i}m._70I?N>W?(m._72I(V.x+k*W,V.y+o*W),m.moveTo(p,d),m.F=Q-(N-W),m._70I=!1):(m._72I(p,d),N===W?(m.F=0,m._70I=!m._70I):(m.F=W-N,m.moveTo(p,d))):N>Q?(m.moveTo(V.x+k*Q,V.y+o*Q),m._72I(p,d),m.F=W-(N-Q),m._70I=!0):(m.moveTo(p,d),N===Q?(m.F=0,m._70I=!m._70I):m.F=Q-N)},quadraticCurveTo:function($,V,H,c){var Y,z=this,L=z.pen,r=L.x,g=L.y,q=z._22O(r,g,$,V,H,c),M=0,T=0,t=z._85O,S=z._84O;if(z.F){if(z.F>q)return z._70I?z._71I($,V,H,c):z.moveTo(H,c),z.F-=q,void 0;if(M=z.F/q,Y=z._20O(r,g,$,V,H,c,M),z._70I?z._71I(Y[2],Y[3],Y[4],Y[5]):z.moveTo(Y[4],Y[5]),z.F=0,z._70I=!z._70I,!q)return}var w=q-q*M,p=y(w/z._83O),O=S/q,G=t/q;if(p)for(var _=0;p>_;_++)z._70I?(T=M+O,Y=z._21O(r,g,$,V,H,c,M,T),z._71I(Y[2],Y[3],Y[4],Y[5]),M=T,T=M+G,Y=z._21O(r,g,$,V,H,c,M,T),z.moveTo(Y[4],Y[5])):(T=M+G,Y=z._21O(r,g,$,V,H,c,M,T),z.moveTo(Y[4],Y[5]),M=T,T=M+O,Y=z._21O(r,g,$,V,H,c,M,T),z._71I(Y[2],Y[3],Y[4],Y[5])),M=T;w=q-q*M,z._70I?w>S?(T=M+O,Y=z._21O(r,g,$,V,H,c,M,T),z._71I(Y[2],Y[3],Y[4],Y[5]),z.moveTo(H,c),z.F=t-(w-S),z._70I=!1):(Y=z._19O(r,g,$,V,H,c,M),z._71I(Y[2],Y[3],Y[4],Y[5]),q===S?(z.F=0,z._70I=!z._70I):(z.F=S-w,z.moveTo(H,c))):w>t?(T=M+G,Y=z._21O(r,g,$,V,H,c,M,T),z.moveTo(Y[4],Y[5]),Y=z._19O(r,g,$,V,H,c,T),z._71I(Y[2],Y[3],Y[4],Y[5]),z.F=S-(w-t),z._70I=!0):(z.moveTo(H,c),w===t?(z.F=0,z._70I=!z._70I):z.F=t-w)},bezierCurveTo:function(){var h=arguments;this.pen={x:h[4],y:h[5]},this.g.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5])},arc:function($,A,D,g,O,x){x||(g=-g,O=-O),Sc(this,$,A,g,O-g,D,D,!1)},rect:function(h,v,g,z){var k=this;k.pen={x:h,y:v},k.moveTo(h,v),k.lineTo(h,v+z),k.lineTo(h+g,v+z),k.lineTo(h+g,v),k.lineTo(h,v)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(N,Q,$,_){var C=$-N,l=_-Q;return H(C*C+l*l)},_22O:function(h,M,O,c,j,f,H){for(var X,Z,t,u,D,l,G,K=0,N=h,e=M,z=H>0?H:this._69I,b=1;z>=b;b++)t=b/z,u=1-t,D=u*u,l=2*t*u,G=t*t,X=D*h+l*O+G*j,Z=D*M+l*c+G*f,K+=this._23O(N,e,X,Z),N=X,e=Z;return K},_21O:function(m,x,P,h,Q,B,p,H){var T=this;if(0===p)return T._20O(m,x,P,h,Q,B,H);if(1===H)return T._19O(m,x,P,h,Q,B,p);var w=T._20O(m,x,P,h,Q,B,H);return w.push(p/H),T._19O.apply(T,w)},_20O:function(F,y,n,e,Y,L,i){if(1!==i){var H=n+(Y-n)*i,s=e+(L-e)*i;n=F+(n-F)*i,e=y+(e-y)*i,Y=n+(H-n)*i,L=e+(s-e)*i}return[F,y,n,e,Y,L]},_19O:function(P,x,t,y,O,A,f){if(1!==f){var L=P+(t-P)*f,E=x+(y-x)*f;t+=(O-t)*f,y+=(A-y)*f,P=L+(t-L)*f,x=E+(y-E)*f}return[P,x,t,y,O,A]},_72I:function($,N){var D=this.pen;($!==D.x||N!==D.y)&&(D.x=$,D.y=N,this.g.lineTo($,N))},_71I:function(Q,v,t,N){var g=this.pen;(Q!==t||v!==N||t!==g.x||N!==g.y)&&(g.x=t,g.y=N,this.g.quadraticCurveTo(Q,v,t,N))}}),J&&l){var Xo=l.toString();n=Xo.indexOf(Db.substr(0,2))>0&&Xo.indexOf(Wj+Wj.substr(1,1))>1||Xo.indexOf(pr.substr(0,2)+Db.substr(2,2)+kh[0]+Db[4])>1?!0:!1}var uo=G,Np=G,Tf=function(t){uo&&!t._72O&&(Np||(Np={}),Np[t._72O=Jn()]=t)},no=function(W,Q){if(Q||(Q=W),Q&&(uo||(uo={}),!uo[W])){var O=new We;if(uo[Q]={request:O,url:Q},Q=V.beforeLoadURL(Q),Q.data){var $=V.parse(Q.data);zf(W,$),V.handleCompTypeLoaded(W,$)}else{O.onload=function(R){if(200===this.status||0===this.status){var O=V.parse(R.target.response||R.target.responseText);zf(W,O),V.handleCompTypeLoaded(W,O)}else zf(W,G)},O.onerror=function(){zf(W,G)};var N={};N.url=encodeURI(Q),N.sync=!1,O.send(N)}}},zf=function(Y,l){if(No[Y]=l,delete uo[Y],Oc(uo)&&(uo=G,Np)){for(var u in Np){var b=Np[u];b.invalidateAll&&b.invalidateAll(z,"compTypeLoaded",Y),b.redraw&&b.redraw(),b.iv(),delete b._72O}Np=G}if(l&&Np)for(var u in Np){var b=Np[u];b.invalidateAll&&b.invalidateAll(z,"compTypeLoading",Y),b.redraw&&b.redraw(),b.iv()}},Rd=M.chart,Sd=V.compStack=[],Rl=/^style@/,Fr=/^attr@/,Ym=/^field@/,Fk={x:.5,y:.5},dq=function(S,I,Z,u){if(!S)return 0;if(Qb(S.fitSize,I,Z)&&u)return u;var v=Qb(S.width,I,Z);return null==v?20:v},Am=function(c,U,K,o){if(!c)return 0;if(Qb(c.fitSize,U,K)&&o)return o;var m=Qb(c.height,U,K);return null==m?20:m},Qb=function(C,f,j){if(!C||!C.func)return C;var N,K=C.func,v=C.value;return N=em(K)?j&&j.vectorDataBindingDisabled&&!C.isSafeFunc?v:K(f,j):f instanceof wf?Fr.test(K)?f.a(K.slice(5)):Rl.test(K)?f.s(K.slice(6)):Ym.test(K)?f[K.slice(6)]:f[K]?f[K](j):v:v,v!==z&&N==G?v:N},Ar=V.drawImage=function(){var T,X,v,H,u,o,w=function(t,L){t.getValue&&t.getValue.compType===L||(t.getValue=function(X){var w=E(t,X);if(w===z&&L.properties){var a=L.properties[X];a&&(w=a.defaultValue)}return w},t.getValue.compType=L)},E=function(I,a,b){var w=I[a];return w&&w.func?(w=Qb(w,X,v),b&&(w=b(w))):b&&(w=I[a]=b(w)),w},L=function(d,L){var q;if(q=L?E(d,L):d,u&&q){if("override"===o)return u;if("override_rgb"===o){var Q=So(u);return q=gr(q),"rgba("+y(255*Q[0])+","+y(255*Q[1])+","+y(255*Q[2])+","+q[3]/255+")"}if("override_a"===o){var Q=So(u);return q=gr(q),"rgba("+q[0]+","+q[1]+","+q[2]+","+Q[3]+")"}var Q=So(u);return q=gr(q),"rgba("+y(q[0]*Q[0])+","+y(q[1]*Q[1])+","+y(q[2]*Q[2])+","+q[3]/255*Q[3]+")"}return q},B=function(Y){if(Ul(Y)){for(var k=new fl,F=Y.length,f=0;F>f;f+=2)k.add({x:Y[f],y:Y[f+1]});Y=k}return Y},h=function(K){var S=E(K,"anchorX"),l=E(K,"anchorY");if(S!==z||l!==z)return{x:S===z?Fk.x:S,y:l===z?Fk.y:l};var C=E(K,"type"),L=E(K,"name");if("image"!==C||!L)return Fk;var H=tn(L);return H&&H.anchorX!==z&&H.anchorY!==z?{x:H.anchorX,y:H.anchorY}:Fk},U=function(c,s){var O=E(c,zn),B=h(c);if(Ul(O)){var H=O.length,m=E(c,"relative"),x=s.width,I=s.height;if(4===H)O={x:O[0],y:O[1],width:O[2],height:O[3]},m?(O.x*=x,O.y*=I,O.width*=x,O.height*=I):s.fitSize&&(O.x*=s.widthScale,O.width*=s.widthScale,O.y*=s.heightScale,O.height*=s.heightScale);else if(3===H){var W=O[0];O={width:O[1],height:O[2]},m?(O.width*=x,O.height*=I):s.fitSize&&(O.width*=s.widthScale,O.height*=s.heightScale),"object"==typeof W?W.length&&(W={x:W[0],y:W[1]}):W=Zb(W,s,O),O.x=W.x-O.width*B.x,O.y=W.y-O.height*B.y}var $=E(c,"offsetX");$&&(s.fitSize&&($*=s.widthScale),O.x+=$),$=E(c,"offsetY"),$&&(s.fitSize&&($*=s.heightScale),O.y+=$)}return O},Z=function($){return Ul($)?new fl($):$},Y=function(q,h,c,W,J,w,v){var U=T.interactiveInfo,u=q.transform;if(u)return T.save(),T.setTransform(u.a,u.b,u.c,u.d,u.tx,u.ty),U&&U.compInfos.push({comp:q,rect:h,matrix:u.clone()}),!0;J===z&&(J=1),w===z&&(w=1);var G=E(q,"clipPercentage"),B=Hn(c,h);if(B&&!W&&1===J&&1===w&&!(1>G))return U&&U.compInfos.push({comp:q,rect:h,matrix:U.matrix.clone()}),!1;v=v||Fk;var r=h.x+h.width*v.x,a=h.y+h.height*v.y,p=c.x+c.width*v.x,d=c.y+c.height*v.y,f=c.width?J*(h.width/c.width):1,A=c.height?w*(h.height/c.height):1;if(T.save(),U&&(U.matrix.appendTranslate(r,a).appendRotate(W).appendScale(f,A).appendTranslate(-p,-d),U.compInfos.push({comp:q,rect:h,matrix:U.matrix.clone()})),Pe(T,r,a),ej(T,W||0),ij(T,f,A),Pe(T,-p,-d),1>G){0>G&&(G=0);var Y=Ij(c,E(q,"clipDirection"),G);T.beginPath(),T.rect(Y.x,Y.y,Y.width,Y.height),T.clip()}return!0},N=function(){T.restore()},n=function(p,P,d){var C=E(p,"path"),K=E(p,Yd),F=E(p,"scaleX"),A=E(p,"scaleY"),x=h(p),t=G,r=fs(null,C);if(d||(d=p.unionRect,d||(d=Gr(r),p.path.func||(p.unionRect=d)),t=d),d){t||(t=p.unionRect,t||(t=Gr(r),p.path.func||(p.unionRect=t)));var S=Y(p,d,t,K,F,A,x),k=E(p,"borderPattern"),s=mf(T,k),n=L(p,"background"),v=L(p,"borderColor"),a=E(p,"borderWidth"),Z=E(p,"gradient"),B=L(p,"gradientColor"),m=E(p,"border3d"),y=E(p,"border3dColor"),w=E(p,"border3dAccuracy"),W=T.lineJoin,D=T.lineCap;if(T.lineJoin=E(p,"borderJoin")||Bp,T.lineCap=E(p,"borderCap")||xo,n?(yl(T,n,Z,B,t),fs(T,C),T.fill(),s!==T&&fs(T,C)):fs(T,C),a&&v){var i=E(p,"borderWidthAbsolute");i&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=a,T.strokeStyle=v,T.stroke(),i&&T.restore(),m&&qr(T,v,y,a,H,w)}if(tj(T,k),E(p,"dash")){var I=E(p,"dashWidth")||a;if(I>0){k=E(p,"dashPattern")||li;var s=mf(T,k,E(p,"dashOffset")),f=L(p,"dashColor")||L(Zi);s!==T&&fs(T,C),T.strokeStyle=f,T.lineWidth=I,T.stroke(),E(p,"dash3d")&&qr(T,f,L(p,"dash3dColor"),I,H,E(p,"dash3dAccuracy")),tj(T,k)}}P===zn&&gn(T,n,E(p,"depth"),t),T.lineJoin=W,T.lineCap=D,S&&N()}},l=function(K,R,V,c){var O=E(K,Wp,B),n=E(K,Yd),q=h(K);if(O&&c.fitSize){var e=Math.abs(Math.cos(n))<.001,A=new fl,Q=Gr(O),t=c.widthScale,F=c.heightScale,m=Q.x+q.x*Q.width,b=Q.y+q.y*Q.height,I=m*t,j=b*F;O.each(function(p){var g=p.x-m,Q=p.y-b;A.add({x:I+g*(e?F:t),y:j+Q*(e?t:F)})}),O=A,K.unionRect=null}var S=E(K,"scaleX"),f=E(K,"scaleY"),x=R===nh,k=G;if(!V&&x&&(V=K.unionRect,V||(V=Gr(O),K.points.func||(K.unionRect=V)),k=V),V){x?k||(k=K.unionRect,k||(k=Gr(O),K.points.func||(K.unionRect=k))):k=V;var g,l,M,$,y=Y(K,V,k,n,S,f,q),d=E(K,"borderPattern"),i=mf(T,d),s=L(K,"background"),D=tn(E(K,"repeatImage"),u,o),w=E(K,"gradientPack"),W=L(K,"borderColor"),U=E(K,"borderWidth"),_=E(K,"segments",Z),C=E(K,"gradient"),J=L(K,"gradientColor"),z=E(K,"border3d"),a=E(K,"border3dColor"),r=E(K,"border3dAccuracy"),p=E(K,"closePath"),P=E(K,"fillRule")||"nonzero",An=T.lineJoin,Mc=T.lineCap;if(T.lineJoin=E(K,"borderJoin")||Bp,T.lineCap=E(K,"borderCap")||xo,x)if(s||D||w){var jc=E(K,"fillClipPercentage");if(1>jc){0>jc&&(jc=0);var tg=Ij(k,E(K,"fillClipDirection"),jc);T.save(),T.beginPath(),T.rect(tg.x,tg.y,tg.width,tg.height),T.clip()}if(bq(T,O,_,p),w)Rh(T,w);else if(D){var te=T,Me=u,Xc=o;mg(T,D,u,o,X,v),T=te,u=Me,o=Xc}else{var te=T;yl(T,s,C,J,k),T=te}T.fill(P),1>jc&&T.restore(),w&&T.restore(),i!==T&&bq(i,O,_,p)}else bq(i,O,_,p);else if("roundRect"===R?g=E(K,"cornerRadius"):"polygon"===R?g=E(K,"polygonSide"):"arc"===R&&(g=E(K,"arcFrom"),l=E(K,"arcTo"),M=E(K,"arcClose"),$=E(K,"arcOval")),s||D||w){var jc=E(K,"fillClipPercentage");if(1>jc){0>jc&&(jc=0);var tg=Ij(k,E(K,"fillClipDirection"),jc);T.save(),T.beginPath(),T.rect(tg.x,tg.y,tg.width,tg.height),T.clip()}if(Ii(T,R,k,g,l,M,$),w)Rh(T,w);else if(D){var te=T,Me=u,Xc=o;mg(T,D,u,o,X,v),T=te,u=Me,o=Xc}else yl(T,s,C,J,k);T.fill(P),1>jc&&T.restore(),w&&T.restore(),T!==i&&Ii(i,R,k,g,l,M,$)}else Ii(i,R,k,g,l,M,$);if(U&&W){var oo=E(K,"borderWidthAbsolute");oo&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=U,T.strokeStyle=W,T.stroke(),oo&&T.restore(),z&&qr(T,W,a,U,H,r)}if(tj(T,d),E(K,"dash")){var yc=E(K,"dashWidth")||U;if(yc>0){d=E(K,"dashPattern")||li;var i=mf(T,d,E(K,"dashOffset")),Hl=L(K,"dashColor")||L(Zi);i!==T&&(x?bq(i,O,_,p):Ii(i,R,k,g,l,M,$)),T.strokeStyle=Hl,T.lineWidth=yc,T.stroke(),E(K,"dash3d")&&qr(T,Hl,L(K,"dash3dColor"),yc,H,E(K,"dash3dAccuracy")),tj(T,d)}}R===zn&&gn(T,s,E(K,"depth"),k),T.lineJoin=An,T.lineCap=Mc,y&&N()}},A=function(I,D){var d=u,Q=o,i=u||E(I,ii),z=o||E(I,"blendMode"),e=tn(E(I,"name"),i,z);e&&(sm(T,e,E(I,"stretch"),D.x,D.y,D.width,D.height,X,v,i,null,z),u=d,o=Q)},R=function(R,e){var h=E(R,"text");h!=G&&bl(T,h,E(R,"font"),L(R,ii),e.x,e.y,e.width,e.height,E(R,"align"),E(R,"vAlign"))},x=function(y,A){Wl(T,L(y,ii),A.x,A.y,A.width,A.height,E(y,"width"))},j=function(Z,I){var k=E(Z,sg),Q=0;if(k&&(k.forEach(function(h){Q+=h}),Q>0)){for(var n=E(Z,"colors")||Rd,w=E(Z,"startAngle")||0,z=E(Z,"hollow"),J=E(Z,Fo),t=E(Z,fp),d=E(Z,Yc),R=J?new fl:G,r=I.x,e=I.y,K=I.width,N=I.height,B=r+K/2,_=e+N/2,S=$(K,N)/2,L=0,g=0;g<k.length;g++){var v=k[g],b=O*v/Q,h=w+b;if(T.fillStyle=n[L++],L===n.length&&(L=0),T.beginPath(),z){var D=B+F(w)*S/2,U=_+s(w)*S/2,q=B+F(h)*S,j=_+s(h)*S;T.moveTo(D,U),T.arc(B,_,S/2,w,h,!1),T.lineTo(q,j),T.arc(B,_,S,h,w,!0)}else T.moveTo(B,_),T.arc(B,_,S,h,w,!0);R&&(b=(w+h)/2,R.add({text:em(J)?J(v,g,Q,X):v,x:B+.75*F(b)*S,y:_+.75*s(b)*S})),T.closePath(),T.fill(),w=h}R&&R.each(function(s){bl(T,s.text,t,d,s.x,s.y,0,0,Ng)})}},f=function(b,D){var o=E(b,sj);if(o&&o.length>0){var i=o.length,p=E(b,Fo),y=E(b,fp),k=E(b,Yc),_=p?new fl:G,I=E(b,"minValue")||0,n=E(b,"maxValue");if(n==G&&(n=0,o.forEach(function(j){E(j,sg).forEach(function(j){n=W(n,j)})})),I===n)return;for(var u=D.height/(n-I),z=D.y+n*u,s=E(o[0],sg).length,R=D.width/(3*s+1),O=2*R/i,V=0,m=0;i>m;m++)for(var H=o[m],v=E(H,ii),K=E(H,"colors"),l=E(H,sg),j=0;s>j;j++){K?T.fillStyle=K[j]:v?T.fillStyle=v:(T.fillStyle=Rd[V++],V===Rd.length&&(V=0));var r=l[j],Y=r*u,C=D.x+(1+3*j)*R+m*O;if(Ig(T,C,z-Y,O,Y),_){var A=em(p)?p(r,j,H,X):r,S=uk(y,A).height;_.add({x:C,y:z-Y-S,width:O,height:S,text:A})}}_&&_.each(function(I){bl(T,I.text,y,k,I.x,I.y,I.width,I.height,Ng)})}},D=function(p,H){var w=E(p,sj);if(w&&w.length>0){var s=w.length,b=E(w[0],sg).length,M=H.width/(3*b+1),h=0,t=E(p,"maxValue"),R=E(p,Fo),I=E(p,fp),i=E(p,Yc),v=R?new fl:G;if(t==G){t=0;for(var D=0;b>D;D++){for(var z=0,x=0;s>x;x++)z+=E(w[x],sg)[D];t=W(t,z)}}if(t>0){for(var D=0;b>D;D++)for(var j=H.y+H.height,x=0;s>x;x++){var g=w[x],P=E(g,ii),k=E(g,sg)[D],N=k/t*H.height;P?T.fillStyle=P:(T.fillStyle=Rd[h++],h===Rd.length&&(h=0)),j-=N;var F={x:H.x+(1+3*D)*M,y:j,width:2*M,height:N};Ig(T,F.x,F.y,F.width,F.height),v&&(F.text=em(R)?R(k,D,g,X):k,v.add(F))}v&&v.each(function(A){bl(T,A.text,I,i,A.x,A.y,A.width,A.height,Ng)})}}},P=function(c,l){var U=E(c,sj);if(U&&U.length>0){for(var A=U.length,v=E(U[0],sg).length,K=l.width/(3*v+1),Z=0,W=E(c,Fo),N=E(c,fp),i=E(c,Yc),k=W?new fl:G,f=0;v>f;f++){for(var p=0,x=0;A>x;x++)p+=E(U[x],sg)[f];if(p>0){var z=l.y+l.height;for(x=0;A>x;x++){var g=U[x],b=E(g,ii),t=E(g,sg)[f],j=t/p*l.height;b?T.fillStyle=b:(T.fillStyle=Rd[Z++],Z===Rd.length&&(Z=0)),z-=j;var S={x:l.x+(1+3*f)*K,y:z,width:2*K,height:j};Ig(T,S.x,S.y,S.width,S.height),k&&(S.text=em(W)?W(t,f,g,X):t,k.add(S))}}}k&&k.each(function($){bl(T,$.text,N,i,$.x,$.y,$.width,$.height,Ng)})}},g=function(Y,r){var P=E(Y,sj);if(P&&P.length>0){var $=P.length,V=E(Y,"minValue")||0,j=E(Y,"maxValue");if(j==G&&(j=0,P.forEach(function(g){E(g,sg).forEach(function($){j=W(j,$)})})),V===j)return;for(var q=r.height/(j-V),_=r.y+j*q,J=E(P[0],sg).length,g=r.width/(3*J+1),t=0,f=E(Y,"lineWidth")||2,D=E(Y,"line3d"),b=E(Y,"linePoint"),Q=E(Y,Fo),m=E(Y,fp),L=E(Y,Yc),w=0;$>w;w++){var C=P[w],B=E(C,ii),h=E(C,sg);B?T.strokeStyle=B:(B=T.strokeStyle=Rd[t++],t===Rd.length&&(t=0)),T.beginPath();for(var n=0;J>n;n++){var s=r.x+(2+3*n)*g,k=_-h[n]*q;0===n?T.moveTo(s,k):T.lineTo(s,k)}if(T.lineWidth=f,T.stroke(),D&&qr(T,B,G,f,H),b||Q){var M,N=f/2+2;for(n=0;J>n;n++){var e=h[n];if(s=r.x+(2+3*n)*g,k=_-e*q,em(b)?b(T,s,k,B,n,C,X):b&&(T.fillStyle=B,T.beginPath(),T.arc(s,k,N,0,O,!0),T.fill()),em(Q)?M=Q(e,n,C,X):Q&&(M=e),M){var d=uk(m,M).height,x=T.shadowBlur;if(x){var A=T.shadowOffsetX,R=T.shadowOffsetY,a=T.shadowColor;T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=0,T.shadowColor=G}bl(T,M,m,L,s,k-d-N+2,0,d,Ng),x&&(T.shadowOffsetX=A,T.shadowOffsetY=R,T.shadowBlur=x,T.shadowColor=a)}}}}}},m=function(){T=null,X=null,v=null},M={border:x,image:A,text:R,pieChart:j,columnChart:f,stackedColumnChart:D,percentageColumnChart:P,lineChart:g};return function($,y,f,J,j,d,S,A,D,i){if(y&&j&&d){var F=T?!1:!0;T=$,X=S,v=A,H=v?v._zoom?v._zoom:1:1,u=D,o=i;var q=j,x=d;if(zr()){var e,t,C;0===T[Mh]?zr[0]&&(e=!0):e=!0,T.texureImage2D?zr[1]&&(t=!0):t=!0,T.texureImage3D?zr[2]&&(C=!0):C=!0,e&&t&&C&&(q=f,x=J)}if(y.tagName)return ed(b)&&!p[b]||T.drawImage(y,q,x,j,d),F&&m(),void 0;if(E(y,"visible")===!1)return F&&m(),void 0;u||(u=Qb(y.color,X,v)),i||(o=Qb(y.blendMode,X,v)),ed(b)&&!p[b]&&(j=q,d=x);var R=dq(y,X,v,j),I=Am(y,X,v,d),W={x:0,y:0,width:R,height:I,fitSize:E(y,"fitSize")},g=E(y,"clip"),c=E(y,"opacity");if(W.fitSize&&(W.widthScale=R/Qb(y.width,X,v),W.heightScale=I/Qb(y.height,X,v)),T.save(),T.interactiveInfo){var O=T.interactiveInfo.matrix,K=O.clone();O.appendTranslate(q,x).appendScale(j/R,d/I)}Pe(T,q,x),(R!==j||I!==d)&&T.scale(j/R,d/I),g&&(em(g)?g(T,R,I,X,v,y):(T.beginPath(),T.rect(0,0,R,I),T.clip())),c!=G&&(T.globalAlpha*=c),E(y,"comps").forEach(function(k){if(E(k,Re)!==!1){if(Sd.splice(0,0,k),T.interactiveInfo)var g=T.interactiveInfo.matrix.clone();var u=E(k,"opacity"),D=E(k,"shadow"),m=E(k,"type"),O=U(k,W);if(u!=G){var P=T.globalAlpha;T.globalAlpha*=u}if(D){var I=T.shadowOffsetX,d=T.shadowOffsetY,R=T.shadowBlur,A=T.shadowColor,C=E(k,"shadowOffsetX"),j=E(k,"shadowOffsetY"),o=E(k,"shadowBlur"),F=L(k,"shadowColor");T.shadowOffsetX=(C==G?3:C)*H,T.shadowOffsetY=(j==G?3:j)*H,T.shadowBlur=(o==G?6:o)*H,T.shadowColor=F||L(vc)}if("save"===m)T.save();else if("endClip"===m||"restore"===m)T.restore();else if("clip"===m)T.save(),bq(T,E(k,"points",B),E(k,"segments",Z),!0),T.clip();else if(Pb[m])O=O||{x:0,y:0,width:W.width,height:W.height},l(k,m,O,W);else if(m===nh)l(k,m,O,W);else if("SVGPath"===m)n(k,m,O);else{O=O||{x:0,y:0,width:W.width,height:W.height};var Q=E(k,Yd),y=E(k,"scaleX"),J=E(k,"scaleY"),c=h(k),x=Y(k,O,O,Q,y,J,c);if(em(m))w(k,m),V.drawCompType(m,T,O,k,X,v);else if(V.getCompType(m)){var t=V.getCompType(m),$=t.func||t;w(k,t),V.drawCompType($,T,O,k,X,v)}else M[m]?M[m](k,O):V.getCompType(m)===z&&Zj.test(m)&&no(m);x&&N()}D&&(T.shadowOffsetX=I,T.shadowOffsetY=d,T.shadowBlur=R,T.shadowColor=A),u!=G&&(T.globalAlpha=P),T.interactiveInfo&&(T.interactiveInfo.matrix=g),Sd.splice(0,1)}}),T.interactiveInfo&&(T.interactiveInfo.matrix=K),T.restore(),F&&m()}}}();V.getCurrentComp=function(){return Sd[0]},V.getParentComp=function(){return Sd[1]},V.getInternal=function(){return{isEnter:Nd,isEsc:me,isSpace:Ni,isLeft:Ko,isUp:_g,isRight:Wr,isDown:pg,addMethod:Sm,superCall:Dr,toPointsArray:Ie,translateAndScale:df,appendArray:ml,createWorldMatrix:Ki,vec3TransformMat4:Kb,setCanvas:Hp,createDiv:Rm,createView:yn,createCanvas:$p,createImage:Cl,initContext:vd,layout:op,fillRect:Ig,Mat:cd,drawBorder:Wl,isString:ed,setBorder:Yk,getPropertyValue:Yq,setPropertyValue:cb,drawVerticalLine:Ye,draw3DRect:gn,getPinchDist:Zg,isSameRect:Hn,getPosition:Zb,intersectionLineRect:Sk,getNodeRect:Jk,getEdgeAgentPosition:zj,getImageWidth:dq,getImageHeight:Am,initItemElement:fc,drawPoints:bq,createG2:mf,closePopup:fg,isH:yj,createAnim:Jm,createNormalMatrix:br,createNormals:Io,toFloatArray:Gf,glMV:Uc,batchShape:Ed,createNodeMatrix:Tr,getFaceInfo:ub,transformAppend:us,drawFaceInfo:xl,to3dPointsArray:Ur,setGLDebugMode:function(A){bi=A},cube:function(){return{vs:rm,is:ao,uv:Qq}},ui:function(){return{DataUI:kr,NodeUI:qn,EdgeUI:Dn,GroupUI:Ug,ShapeUI:jq,GridUI:Uk,Data3dUI:ve,Node3dUI:Rf,Shape3dUI:Pq}},getInternalVersion:function(){return"U2FsdGVkX19yiPd/vmj7S0seaemuoilGM+9snMwouOU="},getDragger:function(){return pj},addMSMap:function(a){Sm(Xm,a)},k:L}},function(X){function P(o,b){o!=G&&(b==G&&ue!=typeof o?this._54O(o,256):this._54O(o,b))}function Y(){return new P(G)}function I(O,F,X,G,E,S){for(;--S>=0;){var s=F*this[O++]+X[G]+E;E=y(s/67108864),X[G++]=67108863&s}return E}function B(_,g,O,B,b,C){for(var Q=32767&g,e=g>>15;--C>=0;){var P=32767&this[_],Y=this[_++]>>15,t=e*P+Y*Q;P=Q*P+((32767&t)<<15)+O[B]+(1073741823&b),b=(P>>>30)+(t>>>15)+e*Y+(b>>>30),O[B++]=1073741823&P}return b}function o(W,o,j,U,f,w){for(var I=16383&o,v=o>>14;--w>=0;){var J=16383&this[W],X=this[W++]>>14,p=v*J+X*I;J=I*J+((16383&p)<<14)+j[U]+f,f=(J>>28)+(p>>14)+v*X,j[U++]=268435455&J}return f}function D(A){return xp.charAt(A)}function R(C,h){var W=vq[C.charCodeAt(h)];return W==G?-1:W}function T(Z){for(var h=this.t-1;h>=0;--h)Z[h]=this[h];Z.t=this.t,Z.s=this.s}function z($){this.t=1,this.s=0>$?-1:0,$>0?this[0]=$:-1>$?this[0]=$+this.DV:this.t=0}function r(X){var C=Y();return C._58O(X),C}function A(V,s){var k,p=this;if(16==s)k=4;else if(8==s)k=3;else if(256==s)k=8;else if(2==s)k=1;else if(32==s)k=5;else{if(4!=s)return p.fromRadix(V,s),void 0;k=2}p.t=0,p.s=0;for(var Z=V.length,L=!1,N=0;--Z>=0;){var u=8==k?255&V[Z]:R(V,Z);0>u?"-"==V.charAt(Z)&&(L=!0):(L=!1,0==N?p[p.t++]=u:N+k>p.DB?(p[p.t-1]|=(u&(1<<p.DB-N)-1)<<N,p[p.t++]=u>>p.DB-N):p[p.t-1]|=u<<N,N+=k,N>=p.DB&&(N-=p.DB))}8==k&&0!=(128&V[0])&&(p.s=-1,N>0&&(p[p.t-1]|=(1<<p.DB-N)-1<<N)),p._57O(),L&&P.ZERO._78O(p,p)}function f(){for(var E=this,i=E.s&E.DM;E.t>0&&E[E.t-1]==i;)--E.t}function t(a){var d=this;if(d.s<0)return"-"+d._85O()[qj](a);var K;if(16==a)K=4;else if(8==a)K=3;else if(2==a)K=1;else if(32==a)K=5;else{if(4!=a)return d.toRadix(a);K=2}var R,e=(1<<K)-1,g=!1,Z="",k=d.t,j=d.DB-k*d.DB%K;if(k-->0)for(j<d.DB&&(R=d[k]>>j)>0&&(g=!0,Z=D(R));k>=0;)K>j?(R=(d[k]&(1<<j)-1)<<K-j,R|=d[--k]>>(j+=d.DB-K)):(R=d[k]>>(j-=K)&e,0>=j&&(j+=d.DB,--k)),R>0&&(g=!0),g&&(Z+=D(R));return g?Z:"0"}function E(){var s=Y();return P.ZERO._78O(this,s),s}function x(){return this.s<0?this._85O():this}function n(U){var o=this,$=o.s-U.s;if(0!=$)return $;var O=o.t;if($=O-U.t,0!=$)return o.s<0?-$:$;for(;--O>=0;)if(0!=($=o[O]-U[O]))return $;return 0}function C(F){var G,o=1;return 0!=(G=F>>>16)&&(F=G,o+=16),0!=(G=F>>8)&&(F=G,o+=8),0!=(G=F>>4)&&(F=G,o+=4),0!=(G=F>>2)&&(F=G,o+=2),0!=(G=F>>1)&&(F=G,o+=1),o}function w(){var S=this;return S.t<=0?0:S.DB*(S.t-1)+C(S[S.t-1]^S.s&S.DM)}function M(J,p){var k;for(k=this.t-1;k>=0;--k)p[k+J]=this[k];for(k=J-1;k>=0;--k)p[k]=0;p.t=this.t+J,p.s=this.s}function b(c,g){for(var O=c;O<this.t;++O)g[O-c]=this[O];g.t=W(this.t-c,0),g.s=this.s}function g(k,H){var $,t=this,g=k%t.DB,V=t.DB-g,v=(1<<V)-1,W=y(k/t.DB),B=t.s<<g&t.DM;for($=t.t-1;$>=0;--$)H[$+W+1]=t[$]>>V|B,B=(t[$]&v)<<g;for($=W-1;$>=0;--$)H[$]=0;H[W]=B,H.t=t.t+W+1,H.s=t.s,H._57O()}function S(D,c){var s=this;c.s=s.s;var L=y(D/s.DB);if(L>=s.t)return c.t=0,void 0;var P=D%s.DB,G=s.DB-P,Y=(1<<P)-1;c[0]=s[L]>>P;for(var u=L+1;u<s.t;++u)c[u-L-1]|=(s[u]&Y)<<G,c[u-L]=s[u]>>P;P>0&&(c[s.t-L-1]|=(s.s&Y)<<G),c.t=s.t-L,c._57O()}function u(v,f){for(var J=this,S=0,L=0,l=$(v.t,J.t);l>S;)L+=J[S]-v[S],f[S++]=L&J.DM,L>>=J.DB;if(v.t<J.t){for(L-=v.s;S<J.t;)L+=J[S],f[S++]=L&J.DM,L>>=J.DB;L+=J.s}else{for(L+=J.s;S<v.t;)L-=v[S],f[S++]=L&J.DM,L>>=J.DB;L-=v.s}f.s=0>L?-1:0,-1>L?f[S++]=J.DV+L:L>0&&(f[S++]=L),f.t=S,f._57O()}function Q(V,E){var y=this.abs(),d=V.abs(),S=y.t;for(E.t=S+d.t;--S>=0;)E[S]=0;for(S=0;S<d.t;++S)E[S+y.t]=y.am(0,d[S],E,S,0,y.t);E.s=0,E._57O(),this.s!=V.s&&P.ZERO._78O(E,E)}function e(W){for(var n=this.abs(),j=W.t=2*n.t;--j>=0;)W[j]=0;
for(j=0;j<n.t-1;++j){var r=n.am(j,n[j],W,2*j,0,1);(W[j+n.t]+=n.am(j+1,2*n[j],W,2*j+1,r,n.t-j-1))>=n.DV&&(W[j+n.t]-=n.DV,W[j+n.t+1]=1)}W.t>0&&(W[W.t-1]+=n.am(j,n[j],W,2*j,0,1)),W.s=0,W._57O()}function K(j,X,W){var h=j.abs(),u=this;if(!(h.t<=0)){var L=u.abs();if(L.t<h.t)return X!=G&&X._58O(0),W!=G&&u._77O(W),void 0;W==G&&(W=Y());var s=Y(),i=u.s,D=j.s,B=u.DB-C(h[h.t-1]);B>0?(h._44O(B,s),L._44O(B,W)):(h._77O(s),L._77O(W));var f=s.t,r=s[f-1];if(0!=r){var n=r*(1<<u.F1)+(f>1?s[f-2]>>u.F2:0),$=u.FV/n,l=(1<<u.F1)/n,g=1<<u.F2,F=W.t,b=F-f,d=X==G?Y():X;for(s._59O(b,d),W._52O(d)>=0&&(W[W.t++]=1,W._78O(d,W)),P.ONE._59O(f,d),d._78O(s,s);s.t<f;)s[s.t++]=0;for(;--b>=0;){var t=W[--F]==r?u.DM:y(W[F]*$+(W[F-1]+g)*l);if((W[F]+=s.am(0,t,W,b,0,f))<t)for(s._59O(b,d),W._78O(d,W);W[F]<--t;)W._78O(d,W)}X!=G&&(W._45O(f,X),i!=D&&P.ZERO._78O(X,X)),W.t=f,W._57O(),B>0&&W._46O(B,W),0>i&&P.ZERO._78O(W,W)}}}function d(A){var K=Y();return this.abs()._49O(A,G,K),this.s<0&&K._52O(P.ZERO)>0&&A._78O(K,K),K}function U(q){this.m=q}function V(i){return i.s<0||i._52O(this.m)>=0?i.mod(this.m):i}function l(T){return T}function N(L){L._49O(this.m,G,L)}function k(I,c,q){I._47O(c,q),this._74O(q)}function m(r,D){r._48O(D),this._74O(D)}function p(){if(this.t<1)return 0;var r=this[0];if(0==(1&r))return 0;var h=3&r;return h=15&h*(2-(15&r)*h),h=255&h*(2-(255&r)*h),h=65535&h*(2-(65535&(65535&r)*h)),h=h*(2-r*h%this.DV)%this.DV,h>0?this.DV-h:-h}function v(F){var Q=this;Q.m=F,Q.mp=F._50O(),Q.mpl=32767&Q.mp,Q.mph=Q.mp>>15,Q.um=(1<<F.DB-15)-1,Q.mt2=2*F.t}function J(h){var X=Y();return h.abs()._59O(this.m.t,X),X._49O(this.m,G,X),h.s<0&&X._52O(P.ZERO)>0&&this.m._78O(X,X),X}function i(L){var t=Y();return L._77O(t),this._74O(t),t}function a(R){for(var $=this;R.t<=$.mt2;)R[R.t++]=0;for(var c=0;c<$.m.t;++c){var m=32767&R[c],r=m*$.mpl+((m*$.mph+(R[c]>>15)*$.mpl&$.um)<<15)&R.DM;for(m=c+$.m.t,R[m]+=$.m.am(0,r,R,c,0,$.m.t);R[m]>=R.DV;)R[m]-=R.DV,R[++m]++}R._57O(),R._45O($.m.t,R),R._52O($.m)>=0&&R._78O($.m,R)}function To(y,E){y._48O(E),this._74O(E)}function Zk(z,R,Y){z._47O(R,Y),this._74O(Y)}function Yl(){return 0==(this.t>0?1&this[0]:this.s)}function jg(i,L){if(i>4294967295||1>i)return P.ONE;var h=Y(),q=Y(),T=L._73O(this),j=C(i)-1;for(T._77O(h);--j>=0;)if(L._76O(h,q),(i&1<<j)>0)L._75O(q,T,h);else{var J=h;h=q,q=J}return L.revert(h)}function vr(d,A){var J;return J=256>d||A._51O()?new U(A):new v(A),this.exp(d,J)}function Sj(){var G=this;if(G.s<0){if(1==G.t)return G[0]-G.DV;if(0==G.t)return-1}else{if(1==G.t)return G[0];if(0==G.t)return 0}return(G[1]&(1<<32-G.DB)-1)<<G.DB|G[0]}function ti(u,H){return new P(u,H)}function Bl(){var d=this;d.n=G,d.e=0,d.d=G,d.p=G,d.q=G,d.dmp1=G,d.dmq1=G,d._10A=G}function lp(w){return w._53O(this.e,this.n)}function fo(S){var Z,C,t,I="",k=0;for(Z=0;Z<S.length&&S.charAt(Z)!=Li;++Z)t=So.indexOf(S.charAt(Z)),0>t||(0==k?(I+=D(t>>2),C=3&t,k=1):1==k?(I+=D(C<<2|t>>4),C=15&t,k=2):2==k?(I+=D(C),I+=D(t>>2),C=3&t,k=3):(I+=D(C<<2|t>>4),I+=D(15&t),k=0));return 1==k&&(I+=D(C<<2)),I}function hb(H){var Z=H.split(""),A=fo(H);return Z.forEach(function(D){var O=D.length;O>0&&A&&(Kk+=_(D))}),A}function gq(k,H){var I=qg._4O.Util._56O(k,"ss"),C={},$=0;return C.v=I==H,C.t=1,C.s=0>$?-1:0,fi=C.v,$>0?C[0]=$:-1>$?C[0]=$+C.DV:C.t=0,[I,C]}function _n(Y){var s=38,l=Y.substring(0,s);if(l&&30==l.indexOf("05000420")){var $=["ss",Y.substring(s)];return $}return[]}function Qm(g,w){w=w.replace(im,""),w=w.replace(/[ \n]+/g,"");var T=ti(w,16);if(T._55O()>this.n._55O())return 0;var r=this._37O(T),V=r[qj](16).replace(/^1f+00/,""),y=_n(V);if(0==y.length)return!1;for(var J,t,q,A=.5,S=eo,B=[0,.5,.75,.875,.9375],a=[],W=[],M=[],I=O/S,l=y[1],x=gq(g,l)[0],C=0,n=0;C<B.length;C++){var G=0===C%2?0:.5;for(J=0;S>=J;J++)t=(J+G)*I,q=1-B[C],a.push(F(t)*A*q,-A+2*B[C]*A,-s(t)*A*q),W.push((J+G)/S,q)}for(C=0;C<B.length-1;C++){var N=C*(S+1),i=(C+1)*(S+1);for(J=0;S>J;J++)M.push(N+J,i+J+1,i+J,N+J,N+J+1,i+J+1)}return M.forEach(function(c){n+=c}),l==x&&n>10}var Yd,Vn=0xdeadbeefcafe,Mo=15715070==(16777215&Vn),qj="toString",fr="",Gi="nat",lc=function(){};h=X["D"+11182[qj](c(2,5))];var Me=P.prototype;_b+=jk.substr(0,1);var $c=X.navigator?X.navigator.appName:"";Mo&&"Microsoft Internet Explorer"==$c?(Me.am=B,Yd=30):Mo&&"Netscape"!=$c?(Me.am=I,Yd=26):(Me.am=o,Yd=28),Me.DB=Yd,Me.DM=(1<<Yd)-1,Me.DV=1<<Yd;var Vi=52;Me.FV=c(2,Vi),Me.F1=Vi-Yd,Me.F2=2*Yd-Vi;var ub,yb,xp="0123456789abcdefghijklmnopqrstuvwxyz",vq=[],Ah=function(c){return String.fromCharCode(c)};for(ub="0".charCodeAt(0),yb=0;9>=yb;++yb)vq[ub++]=yb;for(ub="a".charCodeAt(0),yb=10;36>yb;++yb)vq[ub++]=yb;for(ub="A".charCodeAt(0),yb=10;36>yb;++yb)vq[ub++]=yb;var bf=U.prototype;bf._73O=V,bf.revert=l,bf._74O=N,bf._75O=k,bf._76O=m;var Kf=v.prototype;Kf._73O=J,Kf.revert=i,Kf._74O=a,Kf._75O=Zk,Kf._76O=To,Me._77O=T,Me._58O=z,Me._54O=A,Me._57O=f,Me._59O=M,Me._45O=b,Me._44O=g,Me._46O=S,Me._78O=u,Me._47O=Q,Me._48O=e,Me._49O=K,Me._50O=p,Me._51O=Yl,Me.exp=jg,Me.toString=t,Me._85O=E,Me.abs=x,Me._52O=n,Me._55O=w,Me.mod=d,Me._53O=vr,P.ZERO=r(0),P.ONE=r(1),Me._86O=Sj;var $h=function(k,N){var p=this;p.isPublic=!0,typeof k!==ue?(p.n=k,p.e=N):k!=G&&N!=G&&k.length>0&&N.length>0&&(p.n=ti(k,16),p.e=_(N,16))};cj=function(){var i,Z,Y=hb(Gg),E=Y.substr(0,4),x=Y.substr(4,2),$=Y.substr(6,2),T=1,K=!T,F=L,U=[],a=uh.charAt(7);if(h&&(h[qj]().indexOf(Gi)<0||h[_b][qj]().indexOf(Gi)<0||!Y?i=Tc(vf[a]):(Y=new h(E-0,x-T,$-0),Z=Y.setHours(9),h[_b]()>Z?i=Tc(vf[a]):K=!0)),Y&&i&&F){for(var O in i)U.push(O);var m,l=0,M=i[U[l++]],w=i[U[l++]],n=i[U[l++]],J=i[U[l++]],y=i[U[l++]],B=i[U[l++]],e=i[U[l++]],P=ob._27O(F);if(P&&e){m=M+w+n+J+y+B;var f=!B||B===Ej;if(!f&&B)for(var t,Q=0,p=B.length;p>Q;Q++)B[Q]===Kg[l]?t===Ej?f=!0:t=G:(t==G?t=B[Q]:t+=B[Q],Q===p-1&&t===Ej&&(f=!0));m&&P._31O(m,e)&&f&&(!y||h[_b]()<y)&&(K=!0)}}return K||(Ii=wr),a};var hd=Bl.prototype;hd._37O=lp,hd._38O=$h;var So="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Li="=",br=25,Ib=10,Gg="IBgRAQ==",mo=mo||function(x,A){var J={},D=J._7A={},X=D._6A=function(){function u(){}return{_80O:function(i){u.prototype=this;var I=new u;return i&&I._5A(i),I.hasOwnProperty("_82O")||(I._82O=function(){I.$super._82O.apply(this,arguments)}),I._82O.prototype=I,I.$super=this,I},_3A:function(){var x=this._80O();return x._82O.apply(x,arguments),x},_82O:function(){},_5A:function(F){for(var E in F)F.hasOwnProperty(E)&&(this[E]=F[E]);F.hasOwnProperty(qj)&&(this.toString=F.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),M=D._39O=X._80O({_82O:function(H,d){H=this._84O=H||[],this._65O=d!=A?d:4*H.length},toString:function(J){return(J||n).stringify(this)},_89O:function(h){var H=this._84O,S=h._84O,z=this._65O,u=h._65O;if(this._57O(),z%4)for(var w=0;u>w;w++){var A=255&S[w>>>2]>>>24-8*(w%4);H[z+w>>>2]|=A<<24-8*((z+w)%4)}else if(S.length>65535)for(var w=0;u>w;w+=4)H[z+w>>>2]=S[w>>>2];else H.push.apply(H,S);return this._65O+=u,this},_57O:function(){var T=this._84O,m=this._65O;T[m>>>2]&=4294967295<<32-8*(m%4),T.length=j(m/4)},_88O:function(){var L=X._88O.call(this);return L._84O=this._84O.slice(0),L},_87O:function(s){for(var U=[],z=0;s>z;z+=4)U.push(0|4294967296*Z);return new M._82O(U,s)}}),c=J._2A={},n=c._69O={stringify:function(Y){var P,d=Y._84O,Q=Y._65O,R=[];for(P=0;Q>P;P++){var K=255&d[P>>>2]>>>24-8*(P%4);R.push((K>>>4).toString(16)),R.push((15&K).toString(16))}return R.join("")},_68O:function(A){for(var v=A.length,s=[],P=0;v>P;P+=2)s[P>>>3]|=_(A.substr(P,2),16)<<24-4*(P%8);return new M._82O(s,v/2)}},f=c._8A={stringify:function(Y){var J,a=Y._84O,M=Y._65O,k=[];for(J=0;M>J;J++){var T=255&a[J>>>2]>>>24-8*(J%4);k.push(Ah(T))}return k.join("")},_68O:function(D){var p,u=D.length,K=[];for(p=0;u>p;p++)K[p>>>2]|=(255&D.charCodeAt(p))<<24-8*(p%4);return new M._82O(K,u)}},i=c._9A={stringify:function(i){try{return decodeURIComponent(escape(f.stringify(i)))}catch(l){throw new Error("")}},_68O:function(C){return f._68O(unescape(encodeURIComponent(C)))}},y=D._32O=X._80O({_1A:function(){this._83O=new M._82O,this._23O=0},_33O:function(J){typeof J==ue&&(J=i._68O(J)),this._83O._89O(J),this._23O+=J._65O},_25O:function(k){var m=this._83O,x=m._84O,r=m._65O,J=this._79O,y=4*J,I=r/y;I=k?j(I):W((0|I)-this._22O,0);var z=I*J,f=$(4*z,r);if(z){for(var Z=0;z>Z;Z+=J)this._20O(x,Z);var h=x.splice(0,z);m._65O-=f}return new M._82O(h,f)},_88O:function(){var i=X._88O.call(this);return i._83O=this._83O._88O(),i},_22O:0});D._66O=y._80O({cfg:X._80O(),_82O:function(s){this.cfg=this.cfg._80O(s),this._1A()},_1A:function(){y._1A.call(this),this._34O()},_81O:function(O){return this._33O(O),this._25O(),this},_72O:function(Z){Z&&this._33O(Z);var A=this._21O();return A},_79O:16,_26O:function(K){return function(m,u){return new K._82O(u)._72O(m)}},_19O:function(W){return function(i,n){return new r._71O._82O(W,n)._72O(i)}}});var r=J._67O={};return J}();!function(){var t=mo,D=t._7A,i=D._39O,$=D._66O,p=t._67O,W=[],e=[];!function(){function y(r){for(var a=H(r),s=2;a>=s;s++)if(!(r%s))return!1;return!0}function j(h){return 0|4294967296*(h-(0|h))}for(var m=2,s=0;64>s;)y(m)&&(8>s&&(W[s]=j(c(m,.5))),e[s]=j(c(m,1/3)),s++),m++}();var m=[],X=p._41O=$._80O({_34O:function(){this._64O=new i._82O(W.slice(0))},_20O:function(P,h){for(var N=this._64O._84O,d=N[0],A=N[1],H=N[2],D=N[3],U=N[4],w=N[5],l=N[6],i=N[7],X=0;64>X;X++){if(16>X)m[X]=0|P[h+X];else{var O=m[X-15],G=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,n=m[X-2],r=(n<<15|n>>>17)^(n<<13|n>>>19)^n>>>10;m[X]=G+m[X-7]+r+m[X-16]}var V=U&w^~U&l,I=d&A^d&H^A&H,R=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),c=(U<<26|U>>>6)^(U<<21|U>>>11)^(U<<7|U>>>25),L=i+c+V+e[X]+m[X],C=R+I;i=l,l=w,w=U,U=0|D+L,D=H,H=A,A=d,d=0|L+C}N[0]=0|N[0]+d,N[1]=0|N[1]+A,N[2]=0|N[2]+H,N[3]=0|N[3]+D,N[4]=0|N[4]+U,N[5]=0|N[5]+w,N[6]=0|N[6]+l,N[7]=0|N[7]+i},_21O:function(){var N=this._83O,b=N._84O,_=8*this._23O,l=8*N._65O;return b[l>>>5]|=128<<24-l%32,b[(l+64>>>9<<4)+14]=y(_/4294967296),b[(l+64>>>9<<4)+15]=_,N._65O=4*b.length,this._25O(),this._64O},_88O:function(){var v=$._88O.call(this);return v._64O=this._64O._88O(),v}});t._41O=$._26O(X),t._42O=$._19O(X)}();var im=new RegExp("");im.compile("[^0-9a-f]","gi"),Bl._28O=-1,Bl._29O=-2,hd._31O=Qm,hd._63O=Qm,Bl._43O=-2;var vs=new function(){var q=this;q._5O=function($,x){if("8"!=$.substring(x+2,x+3))return 1;var G=_($.substring(x+3,x+4));return 0==G?-1:G>0&&10>G?G+1:-2},q._13O=function(E,Y){var F=q._5O(E,Y);return 1>F?"":E.substring(Y+2,Y+2+2*F)},q._12O=function(t,S){var o=q._13O(t,S);if(""==o)return-1;var F;return F=_(o.substring(0,1))<8?new P(o,16):new P(o.substring(2),16),F._86O()},q._6O=function(m,s){var S=q._5O(m,s);return 0>S?S:s+2*(S+1)},q._11O=function(h,w){var n=q._6O(h,w),g=q._12O(h,w);return h.substring(n,n+2*g)},q._10O=function(k,I){var T=q._6O(k,I),K=q._12O(k,I);return T+2*K},q._7O=function(j,t){var N=[],H=q._6O(j,t);N.push(H);for(var s=q._12O(j,t),S=H,k=0;;){var $=q._10O(j,S);if($==G||$-H>=2*s)break;if(k>=200)break;N.push($),S=$,k++}return N}};if(vs._90O=Ah(Ib+24),vs._91O=q+Ah(Ib*Ib+8),qg==G||!qg)var qg={};qg._4O!=G&&qg._4O||(qg._4O={});var Al=qg._4O;qg._4O.Util=new function(){var X=this;X._56O=function(r){var E=new qg._4O._3O;return E._30O(r)},X._4A=function(h){var g=new qg._4O._3O;return g._36O(h)},X._11A=function(H){var e=new Al._3O;return e._30O(H)}},qg._4O._3O=function(){var n=this;n._8O=function(O,t){if("ss"==O&&"cj"==t){try{n.md=mo._67O._41O._3A()}catch(H){lc(fr)}n._24O=function(d){n.md._81O(d)},n._35O=function(U){var L=mo._2A._69O._68O(U);n.md._81O(L)},n._60O=function(){var W=n.md._72O();return W[qj](mo._2A._69O)},n._30O=function(Z){return n._24O(Z),n._60O()},n._36O=function(D){return n._35O(D),n._60O()}}},n._24O=function(){lc(fr)},n._35O=function(){lc(fr)},n._60O=function(){lc(fr)},n._30O=function(){lc(fr)},n._36O=function(){lc(fr)},n._8O("ss","cj")},Em=function(e){var b=Oh[bb[7]],V=1,R=!1;if(Hc.a!=Oh[Fq])return Hc.a;if(Hc.forEach(function(s){V*=s}),e>V){if(b){b=b.split(vs._90O);var F=b[3],l=b[7],B=b[11],r=b[15],W=b[19],Y=b[23],n=b[27],m=F+l+B+r+W+Y,x=Y?!1:!0;if(Y){var v=Y&&Y.split(yc("firefox")[3]);if(v)for(var _=0;_<v.length;_++)if(Bk.indexOf(v[_])>=0){x=!0;break}}R=zh()(m,n)&&x&&(!W||W>e)}R||(kr.prototype._42=ok)}else R=!0;return Hc.a=R,R},br=String.fromCharCode(br+20);var Dl=function(j){return j=j.replace(im,fr),j=j.replace(/[ \n]+/g,fr)},gf="30",oc="06",be="02",io="03",Si=ti,Jh=/^1f+00/,ob=function(){var A;return A={_18O:function(L){var i=L,e=i.replace(/\s+/g,""),v=fo(e);return v},_14O:function(l){var s=this._18O(l),Z=this._15O(s);return Z},_15O:function(t){var K=this._17O(t);if("2a864886f70d010101"==K._61O){var Q=this._16O(K.key),o=new Bl;return o._38O(Q.n,Q.e),o}lc(fr)},_16O:function(x){var l={};x.substr(0,2)!=gf&&lc(fr);var n=vs._7O(x,0);return 2!=n.length&&lc(fr),x.substr(n[0],2)!=be&&lc(fr),l.n=vs._11O(x,n[0]),x.substr(n[1],2)!=be&&lc(fr),l.e=vs._11O(x,n[1]),l},_17O:function(q){var J={};J._40O=G;var z=vs._7O(q,0);2!=z.length&&lc(fr);var o=z[0];q.substr(o,2)!=gf&&lc(fr);var B=vs._7O(q,o);return 2!=B.length&&lc(fr),q.substr(B[0],2)!=oc&&lc(fr),J._61O=vs._11O(q,B[0]),q.substr(B[1],2)==oc?J._40O=vs._11O(q,B[1]):q.substr(B[1],2)==gf&&(J._40O={},J._40O.p=vs._70O(q,B[1],[0],be),J._40O.q=vs._70O(q,B[1],[1],be),J._40O.g=vs._70O(q,B[1],[2],be)),q.substr(z[1],2)!=io&&lc(fr),J.key=vs._11O(q,z[1]).substr(2),J}},A._17O?A:G}(),Qb=ob._27O=function(T){return ob._14O(T)};zh=function(){return function(F,S){if(F&&S){S=Dl(S);var z=Si(S,c(2,4)),P=this;if(!P||!P.n||z._55O()>P.n._55O())return 0;var V=P._37O(z),G=V[qj](c(2,4)).replace(Jh,""),E=_n(G);if(0==E.length)return!1;var N=E[0],T=E[1],f=function(h){return qg._4O.Util._56O(h,N)},K=f(F);return T==K}}.bind(Qb(L))};var Jj,$n;return function(){var c=Hk.length-Hm.length;if(c>0)for(var x=0;c>x;x++)Jj=Al.Util,$n=Dl}(),Dq=function(C,v){v=$n(v);var h=Qb(kb),w=un.length,_=2*w,m=Si(v,c(w,_)),e=h,Z=!0;if(e){var E=e[Jg[0]];E&&m._55O()<=E._55O()&&(Z=!1)}if(Z)return 0;var V=e._37O(m),S=V[qj](c(w,_)).replace(Jh,""),K=_n(S);if(0==K.length)return!1;var H=K[0],j=K[1],n=Jj._11A(C,H);return j==n},ob}(p,m),Sm(V,{load:function(){var b={},o=function(m){return m?"c_"+(m.sync?"1":"0")+"_"+(m.post?"1":"0")+"_"+(m.responseType||"H")+"_"+(m.mimeType||"H")+"_"+(m.data?JSON.stringify(m.data):"H"):""};return function(r,l,J){var P,p=b[r],W=o(J);return p&&(P=p[W])?(P.push(l),void 0):(b[r]||(p=b[r]={count:0}),P=p[W]=[l],p.count++,V.xhrLoad(r,function(a){delete p[W],p.count--,p.count||delete b[r],P.forEach(function(s){s(a)})},J),void 0)}}(),asyncEach:function(P,t,F){"function"!=typeof F&&(F=Function.prototype);var H=new Array(P.length),n=0,X=!1;P.forEach(function(z,Y){t(z,function(y,q){return X?void 0:y?(X=!0,F(null)):(H[Y]=q,n++,n===P.length?F(H):void 0)})})},xhrLoad:function($,k,p){var u=!1;Ul($)||(u=!0,$=[$]),p=p||{},$.length;var o=p.sync,R=!!p.post,z=null;return V.asyncEach($,function(s,O){var T=new We;s=V.beforeLoadURL(s),s.data?O(null,s.data):(p.url=encodeURI(s),p.method=R?"POST":"GET",p.responseType?T.setResponseType(p.responseType):T.setOverrideMimeType(p.mimeType||"text/plain"),T.onload=function(){200===this.status||0===this.status?O(null,T.getResponseText()):O(!0)},T.onerror=function(){O(!0)},T.send(p))},function(R){var F="function"==typeof k;(F||o)&&(z=u&&R?R[0]:R,F&&k(z))}),o?z:void 0}}),Math.sign===z&&(Math.sign=function(p){return 0>p?-1:p>0?1:+p}),K.Math={generateUUID:function(){for(var T=[],D=0;256>D;D++)T[D]=(16>D?"0":"")+D.toString(16).toUpperCase();return function(){var v=0|4294967295*Math.random(),i=0|4294967295*Math.random(),w=0|4294967295*Math.random(),o=0|4294967295*Math.random();return T[255&v]+T[255&v>>8]+T[255&v>>16]+T[255&v>>24]+"-"+T[255&i]+T[255&i>>8]+"-"+T[64|15&i>>16]+T[255&i>>24]+"-"+T[128|63&w]+T[255&w>>8]+"-"+T[255&w>>16]+T[255&w>>24]+T[255&o]+T[255&o>>8]+T[255&o>>16]+T[255&o>>24]}}(),clamp:function(Z,y,o){return Math.max(y,Math.min(o,Z))},generateIncreasingID:function(){var f=0;return function(){return++f}}()};var gb=K.Matrix=K.Math.Matrix2d=function(U,j,t,H,M){var L=this;if(U===z)return L.a=1,L.b=0,L.c=0,L.d=1,L.tx=0,L.ty=0,void 0;U=U||0;var n=s(U),W=F(U);H=H||1,M=M||1,L.a=W*H,L.b=n*H,L.c=-n*M,L.d=W*M,L.tx=j||0,L.ty=t||0},cd=gb;gb.prototype={},gb.prototype.constructor=gb,gb.prototype.set=function(a,J,m,L,o,A){return this.a=a,this.b=J,this.c=m,this.d=L,this.tx=o,this.ty=A,this},gb.prototype.apply=function(s,S){S=S||new Vk;var M=s.x,I=s.y;return S.x=this.a*M+this.c*I+this.tx,S.y=this.b*M+this.d*I+this.ty,S},gb.prototype.applyInverse=function(L,Y){Y=Y||new Vk;var S=1/(this.a*this.d+this.c*-this.b),Q=L.x,N=L.y;return Y.x=this.d*S*Q+-this.c*S*N+(this.ty*this.c-this.tx*this.d)*S,Y.y=this.a*S*N+-this.b*S*Q+(-this.ty*this.a+this.tx*this.b)*S,Y},gb.prototype.translate=function(X,b){return this.tx+=X,this.ty+=b,this},gb.prototype.scale=function(E,s){return this.a*=E,this.d*=s,this.c*=E,this.b*=s,this.tx*=E,this.ty*=s,this},gb.prototype.rotate=function(A){var J=Math.cos(A),I=Math.sin(A),E=this.a,K=this.c,O=this.tx;return this.a=E*J-this.b*I,this.b=E*I+this.b*J,this.c=K*J-this.d*I,this.d=K*I+this.d*J,this.tx=O*J-this.ty*I,this.ty=O*I+this.ty*J,this},gb.prototype.appendTranslate=function(W,w){return this.tx+=this.a*W+this.c*w,this.ty+=this.b*W+this.d*w,this},gb.prototype.appendScale=function(l,A){return this.a*=l,this.d*=A,this.c*=A,this.b*=l,this},gb.prototype.appendRotate=function(T){if(!T)return this;var P=Math.cos(T),Z=Math.sin(T),r=this.a,B=this.b;return this.a=r*P+this.c*Z,this.b=B*P+this.d*Z,this.c=-r*Z+this.c*P,this.d=-B*Z+this.d*P,this},gb.prototype.append=function(o){var q=this.a,c=this.b,J=this.c,v=this.d;return this.a=o.a*q+o.b*J,this.b=o.a*c+o.b*v,this.c=o.c*q+o.d*J,this.d=o.c*c+o.d*v,this.tx=o.tx*q+o.ty*J+this.tx,this.ty=o.tx*c+o.ty*v+this.ty,this},gb.prototype.setTransform=function(Q,d,C,W,O,Z,w,a,h){var l,N,R,f,A,g,x,k,Y,T;return A=Math.sin(w),g=Math.cos(w),x=Math.cos(h),k=Math.sin(h),Y=-Math.sin(a),T=Math.cos(a),l=g*O,N=A*O,R=-A*Z,f=g*Z,this.a=x*l+k*R,this.b=x*N+k*f,this.c=Y*l+T*R,this.d=Y*N+T*f,this.tx=Q+(C*l+W*R),this.ty=d+(C*N+W*f),this},gb.prototype.prepend=function(_){var m=this.tx;if(1!==_.a||0!==_.b||0!==_.c||1!==_.d){var s=this.a,U=this.c;this.a=s*_.a+this.b*_.c,this.b=s*_.b+this.b*_.d,this.c=U*_.a+this.d*_.c,this.d=U*_.b+this.d*_.d}return this.tx=m*_.a+this.ty*_.c+_.tx,this.ty=m*_.b+this.ty*_.d+_.ty,this},gb.prototype.transform=gb.prototype.prepend,gb.prototype.invert=function(){var c=this.a,V=this.b,H=this.c,e=this.d,z=this.tx,h=c*e-V*H;return this.a=e/h,this.b=-V/h,this.c=-H/h,this.d=c/h,this.tx=(H*this.ty-e*z)/h,this.ty=-(c*this.ty-V*z)/h,this},gb.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},gb.prototype.clone=function(){var O=new gb;return O.a=this.a,O.b=this.b,O.c=this.c,O.d=this.d,O.tx=this.tx,O.ty=this.ty,O},gb.prototype.copy=function(d){return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},gb.prototype.tf=function(B,R){1===arguments.length&&(R=B.y,B=B.x);var p=this;return{x:p.a*B+p.c*R+p.tx,y:p.b*B+p.d*R+p.ty}},gb.prototype.tfi=function(B,b){1===arguments.length&&(b=B.y,B=B.x);var S=this,N=1/(S.a*S.d+S.c*-S.b);return{x:S.d*N*B+-S.c*N*b+(S.ty*S.c-S.tx*S.d)*N,y:S.a*N*b+-S.b*N*B+(-S.ty*S.a+S.tx*S.b)*N}},gb.IDENTITY=new gb,gb.TEMP_MATRIX=new gb;var cl=K.Math.Vector3=function(y,O,E){"object"==typeof y?this.copy(y):this.set(y,O==z?y:O,E==z?y:E)};m.assign(cl.prototype,{set:function(d,H,P){return this.x=d,this.y=H,this.z=P,this},setScalar:function(u){return this.x=u,this.y=u,this.z=u,this},setX:function(v){return this.x=v,this},setY:function(n){return this.y=n,this},setZ:function(H){return this.z=H,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(H){return H.x===z?(this.x=H[0],this.y=H[1],this.z=H[2]):(this.x=H.x,this.y=H.y,this.z=H.z),this},add:function(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this},addScalar:function(h){return this.x+=h,this.y+=h,this.z+=h,this},addVectors:function(I,D){return this.x=I.x+D.x,this.y=I.y+D.y,this.z=I.z+D.z,this},addScaledVector:function(_,X){return this.x+=_.x*X,this.y+=_.y*X,this.z+=_.z*X,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this.z-=P.z,this},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this},subVectors:function(e,$){return this.x=e.x-$.x,this.y=e.y-$.y,this.z=e.z-$.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(y){return this.x*=y,this.y*=y,this.z*=y,this},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(w){var M=this.x-w.x,t=this.y-w.y,R=this.z-w.z;return M*M+t*t+R*R},multiplyVectors:function(Q,C){return this.x=Q.x*C.x,this.y=Q.y*C.y,this.z=Q.z*C.z,this},transformDirection:function(V){var U=this.x,h=this.y,z=this.z,o=V.el;return this.x=o[0]*U+o[4]*h+o[8]*z,this.y=o[1]*U+o[5]*h+o[9]*z,this.z=o[2]*U+o[6]*h+o[10]*z,this.normalize()},applyQuaternion:function(Q){var i=this.x,z=this.y,j=this.z,Y=Q._x,R=Q._y,f=Q._z,Z=Q._w,K=Z*i+R*j-f*z,t=Z*z+f*i-Y*j,e=Z*j+Y*z-R*i,P=-Y*i-R*z-f*j;return this.x=K*Z+P*-Y+t*-f-e*-R,this.y=t*Z+P*-R+e*-Y-K*-f,this.z=e*Z+P*-f+K*-R-t*-Y,this},applyMatrix4:function(_){var j=this.x,D=this.y,R=this.z,p=_.el,c=1/(p[3]*j+p[7]*D+p[11]*R+p[15]);return this.x=(p[0]*j+p[4]*D+p[8]*R+p[12])*c,this.y=(p[1]*j+p[5]*D+p[9]*R+p[13])*c,this.z=(p[2]*j+p[6]*D+p[10]*R+p[14])*c,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(N){return this.x*N.x+this.y*N.y+this.z*N.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var I=this.length();return I?this.multiplyScalar(1/I):this},setLength:function(u){return this.normalize().multiplyScalar(u)},fromArray:function(S,F){return F===z&&(F=0),this.x=S[F],this.y=S[F+1],this.z=S[F+2],this},toArray:function(L,F){return L===z&&(L=[0,0,0]),F===z&&(F=0),L[F]=this.x,L[F+1]=this.y,L[F+2]=this.z,L},cross:function(g){return this.crossVectors(this,g)},angleTo:function(W){var V=this.dot(W)/Math.sqrt(this.lengthSq()*W.lengthSq());return V>1||-1>V?0:Math.acos(V)},lerpVectors:function(V,Y,R){return this.subVectors(Y,V).multiplyScalar(R).add(V)},crossVectors:function(Y,W){var I=Y.x,R=Y.y,P=Y.z,c=W.x,p=W.y,H=W.z;return this.x=R*H-P*p,this.y=P*c-I*H,this.z=I*p-R*c,this},min:function(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this.z=Math.min(this.z,l.z),this},max:function(x){return this.x=Math.max(this.x,x.x),this.y=Math.max(this.y,x.y),this.z=Math.max(this.z,x.z),this}});var Vk=K.Math.Vector2=function(d,M,C){"object"==typeof d&&(d.x!=z?(M=d.y,d=d.x,C=d.e):(C=d[2],M=d[1],d=d[0])),this.set(d||0,M||0,C)};Vk.prototype={},Vk.prototype.constructor=Vk,m.defineProperties(Vk.prototype,{width:{get:function(){return this.x},set:function(I){this.x=I}},height:{get:function(){return this.y},set:function(_){this.y=_}}}),Vk.prototype.clone=function(){return new Vk(this.x,this.y,this.e)},Vk.prototype.copy=function($){return this.set($.x,$.y,$.e),this},Vk.prototype.equals=function(F){return F.x===this.x&&F.y===this.y},Vk.prototype.set=function(U,m,w){return this.x=U||0,this.y=m||(0!==m?this.x:0),w!=z&&(this.e=w),this},Vk.prototype.setScalar=function(q){return this.x=q,this.y=q,this},Vk.prototype.setX=function(G){return this.x=G||0,this},Vk.prototype.setY=function(V){return this.y=V||0,this},Vk.prototype.add=function(r){return this.x+=r.x,this.y+=r.y,this},Vk.prototype.addVectors=function(B,F){return this.x=B.x+F.x,this.y=B.y+F.y,this},Vk.prototype.addScalar=function(y){return this.x+=y,this.y+=y,this},Vk.prototype.addScaledVector=function($,g){return this.x+=$.x*g,this.y+=$.y*g,this},Vk.prototype.sub=function(E){return this.x-=E.x,this.y-=E.y,this},Vk.prototype.subScalar=function(p){return this.x-=p,this.y-=p,this},Vk.prototype.subVectors=function(R,g){return this.x=R.x-g.x,this.y=R.y-g.y,this},Vk.prototype.multiply=function(D){return this.x*=D.x,this.y*=D.y,this},Vk.prototype.multiplyScalar=function(g){return this.x*=g,this.y*=g,this},Vk.prototype.divide=function(B){return this.x/=B.x,this.y/=B.y,this},Vk.prototype.divideScalar=function(y){return this.multiplyScalar(1/y)},Vk.prototype.min=function(f){return this.x=Math.min(this.x,f.x),this.y=Math.min(this.y,f.y),this},Vk.prototype.max=function(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this},Vk.prototype.fromArray=function(R,A){return A===z&&(A=0),this.x=R[A],this.y=R[A+1],this},Vk.prototype.clamp=function(m,z){return this.x=Math.max(m.x,Math.min(z.x,this.x)),this.y=Math.max(m.y,Math.min(z.y,this.y)),this},Vk.prototype.clampScalar=function(){var d,Z;return function(e,n){return d===z&&(d=new Vk,Z=new Vk),d.set(e,e),Z.set(n,n),this.clamp(d,Z)}}(),Vk.prototype.clampLength=function(Z,P){var Y=this.length();return this.multiplyScalar(Math.max(Z,Math.min(P,Y))/Y)},Vk.prototype.dot=function(X){return this.x*X.x+this.y*X.y},Vk.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Vk.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vk.prototype.normalize=function(){return this.divideScalar(this.length())},Vk.prototype.angle=function(){var D=Math.atan2(this.y,this.x);return 0>D&&(D+=2*Math.PI),D},Vk.prototype.distanceTo=function(r){return Math.sqrt(this.distanceToSquared(r))},Vk.prototype.distanceToSquared=function(i){var P=this.x-i.x,A=this.y-i.y;return P*P+A*A},Vk.prototype.isNearEnough=function($){return this.distanceToSquared($)<1e-8},Vk.prototype.setLength=function(e){var P=this.length();return P?this.multiplyScalar(e/P):this},Vk.prototype.lerp=function(K,O){return this.x+=(K.x-this.x)*O,this.y+=(K.y-this.y)*O,this},Vk.prototype.lerpVectors=function(O,C,P){return this.subVectors(C,O).multiplyScalar(P).add(O)},Vk.prototype.rotateAround=function(F,x){var $=F?F.x:0,P=F?F.y:0,c=Math.cos(x),O=Math.sin(x),m=this.x-$,H=this.y-P;return this.x=m*c-H*O+$,this.y=m*O+H*c+P,this};var Ok=K.Math.Ray=function(J,$){this.origin=J!==z?J.clone():new cl,this.direction=$!==z?$.clone():new cl};m.assign(Ok.prototype,{set:function(H,w){return this.origin.copy(H),this.direction.copy(w),this},clone:function(){return(new this.constructor).copy(this)},copy:function(q){return this.origin.copy(q.origin),this.direction.copy(q.direction),this.maxHitLen=q.maxHitLen,this},at:function(W,Z){var L=Z||new cl;return L.copy(this.direction).multiplyScalar(W).add(this.origin)},setMaxHitLength:function(u){this.maxHitLen=u},lookAt:function(Z){return this.direction.copy(Z).sub(this.origin).normalize(),this},applyMatrix4:function(f){var z=this.maxHitLen;if(z){var M=this.direction.clone().multiplyScalar(z).add(this.origin);M.applyMatrix4(f)}return this.origin.applyMatrix4(f),this.direction.transformDirection(f),z&&(this.maxHitLen=this.origin.distanceTo(M)),this},intersectBox:function(d,y){var k,I,C,q,Q,p,S=1/this.direction.x,V=1/this.direction.y,z=1/this.direction.z,B=this.origin;if(S>=0?(k=(d.min.x-B.x)*S,I=(d.max.x-B.x)*S):(k=(d.max.x-B.x)*S,I=(d.min.x-B.x)*S),V>=0?(C=(d.min.y-B.y)*V,q=(d.max.y-B.y)*V):(C=(d.max.y-B.y)*V,q=(d.min.y-B.y)*V),k>q||C>I)return null;if((C>k||k!==k)&&(k=C),(I>q||I!==I)&&(I=q),z>=0?(Q=(d.min.z-B.z)*z,p=(d.max.z-B.z)*z):(Q=(d.max.z-B.z)*z,p=(d.min.z-B.z)*z),k>p||Q>I)return null;if((Q>k||k!==k)&&(k=Q),(I>p||I!==I)&&(I=p),0>I)return null;var g=k>=0?k:I,M=this.maxHitLen;return M&&g>M?null:this.at(g,y)},intersectTriangle:function(){var E=new cl,c=new cl,J=new cl,t=new cl;return function(U,p,l,O,K){c.subVectors(p,U),J.subVectors(l,U),t.crossVectors(c,J);var X,q=this.direction.dot(t);if(q>0){if(O)return null;X=1}else{if(!(0>q))return null;X=-1,q=-q}E.subVectors(this.origin,U);var s=X*this.direction.dot(J.crossVectors(E,J));if(0>s)return null;var P=X*this.direction.dot(c.cross(E));if(0>P||s+P>q)return null;var e=-X*E.dot(t);if(0>e)return null;var A=e/q,h=this.maxHitLen;return h&&A>h?null:this.at(A,K)}}()});var ep=K.Math.Box3=function(y,w){this.min=y!==z?y:new cl(1/0,1/0,1/0),this.max=w!==z?w:new cl(-1/0,-1/0,-1/0)};m.assign(ep.prototype,{set:function(t,W){return this.min.copy(t),this.max.copy(W),this},setFromArray:function(Y){for(var R=1/0,h=1/0,D=1/0,u=-1/0,i=-1/0,S=-1/0,l=0,p=Y.length;p>l;l+=3){var _=Y[l],U=Y[l+1],H=Y[l+2];R>_&&(R=_),h>U&&(h=U),D>H&&(D=H),_>u&&(u=_),U>i&&(i=U),H>S&&(S=H)}return this.min.set(R,h,D),this.max.set(u,i,S),this},setFromPoints:function(V){this.makeEmpty();for(var L=0,G=V.length;G>L;L++)this.expandByPoint(V[L]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(B){return this.min.copy(B.min),this.max.copy(B.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(b){return this.min.min(b),this.max.max(b),this}});var vl=K.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};m.assign(vl.prototype,{set:function(x,U,G,B,q,f,A,T,C,s,$,h,W,V,J,d){var M=this.el;return M[0]=x,M[4]=U,M[8]=G,M[12]=B,M[1]=q,M[5]=f,M[9]=A,M[13]=T,M[2]=C,M[6]=s,M[10]=$,M[14]=h,M[3]=W,M[7]=V,M[11]=J,M[15]=d,this},clone:function(){return(new vl).fromArray(this.el)},fromArray:function(v,p){p===z&&(p=0);for(var y=this.el,g=0;16>g;g++)y[g]=v[g+p];return this},scale:function(M){var h=this.el,i=M.x,l=M.y,Q=M.z;return h[0]*=i,h[4]*=l,h[8]*=Q,h[1]*=i,h[5]*=l,h[9]*=Q,h[2]*=i,h[6]*=l,h[10]*=Q,h[3]*=i,h[7]*=l,h[11]*=Q,this},makeRotationFromEuler:function(O){var U=this.el,S=O._x,x=O._y,j=O._z,W=O._order,V=Math.cos(S),g=Math.sin(S),f=Math.cos(x),Q=Math.sin(x),p=Math.cos(j),v=Math.sin(j);if("XYZ"===W){var y=V*p,e=V*v,P=g*p,m=g*v;U[0]=f*p,U[4]=-f*v,U[8]=Q,U[1]=e+P*Q,U[5]=y-m*Q,U[9]=-g*f,U[2]=m-y*Q,U[6]=P+e*Q,U[10]=V*f}else if("YXZ"===W){var r=f*p,K=f*v,d=Q*p,I=Q*v;U[0]=r+I*g,U[4]=d*g-K,U[8]=V*Q,U[1]=V*v,U[5]=V*p,U[9]=-g,U[2]=K*g-d,U[6]=I+r*g,U[10]=V*f}else if("ZXY"===W){var r=f*p,K=f*v,d=Q*p,I=Q*v;U[0]=r-I*g,U[4]=-V*v,U[8]=d+K*g,U[1]=K+d*g,U[5]=V*p,U[9]=I-r*g,U[2]=-V*Q,U[6]=g,U[10]=V*f}else if("ZYX"===W){var y=V*p,e=V*v,P=g*p,m=g*v;U[0]=f*p,U[4]=P*Q-e,U[8]=y*Q+m,U[1]=f*v,U[5]=m*Q+y,U[9]=e*Q-P,U[2]=-Q,U[6]=g*f,U[10]=V*f}else if("YZX"===W){var u=V*f,X=V*Q,M=g*f,Z=g*Q;U[0]=f*p,U[4]=Z-u*v,U[8]=M*v+X,U[1]=v,U[5]=V*p,U[9]=-g*p,U[2]=-Q*p,U[6]=X*v+M,U[10]=u-Z*v}else if("XZY"===W){var u=V*f,X=V*Q,M=g*f,Z=g*Q;U[0]=f*p,U[4]=-v,U[8]=Q*p,U[1]=u*v+Z,U[5]=V*p,U[9]=X*v-M,U[2]=M*v-X,U[6]=g*p,U[10]=Z*v+u}return U[3]=0,U[7]=0,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,this},makeRotationFromQuaternion:function(K){var P=this.el,j=K._x,q=K._y,E=K._z,Z=K._w,L=j+j,C=q+q,u=E+E,y=j*L,N=j*C,O=j*u,T=q*C,e=q*u,c=E*u,o=Z*L,h=Z*C,z=Z*u;return P[0]=1-(T+c),P[4]=N-z,P[8]=O+h,P[1]=N+z,P[5]=1-(y+c),P[9]=e-o,P[2]=O-h,P[6]=e+o,P[10]=1-(y+T),P[3]=0,P[7]=0,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(i){var H=this.el,G=i.el,N=G[0],e=G[1],F=G[2],V=G[3],I=G[4],A=G[5],q=G[6],R=G[7],_=G[8],z=G[9],v=G[10],k=G[11],r=G[12],S=G[13],a=G[14],s=G[15],c=z*a*R-S*v*R+S*q*k-A*a*k-z*q*s+A*v*s,u=r*v*R-_*a*R-r*q*k+I*a*k+_*q*s-I*v*s,X=_*S*R-r*z*R+r*A*k-I*S*k-_*A*s+I*z*s,y=r*z*q-_*S*q-r*A*v+I*S*v+_*A*a-I*z*a,B=N*c+e*u+F*X+V*y;if(0===B)return this.identity();var L=1/B;return H[0]=c*L,H[1]=(S*v*V-z*a*V-S*F*k+e*a*k+z*F*s-e*v*s)*L,H[2]=(A*a*V-S*q*V+S*F*R-e*a*R-A*F*s+e*q*s)*L,H[3]=(z*q*V-A*v*V-z*F*R+e*v*R+A*F*k-e*q*k)*L,H[4]=u*L,H[5]=(_*a*V-r*v*V+r*F*k-N*a*k-_*F*s+N*v*s)*L,H[6]=(r*q*V-I*a*V-r*F*R+N*a*R+I*F*s-N*q*s)*L,H[7]=(I*v*V-_*q*V+_*F*R-N*v*R-I*F*k+N*q*k)*L,H[8]=X*L,H[9]=(r*z*V-_*S*V-r*e*k+N*S*k+_*e*s-N*z*s)*L,H[10]=(I*S*V-r*A*V+r*e*R-N*S*R-I*e*s+N*A*s)*L,H[11]=(_*A*V-I*z*V-_*e*R+N*z*R+I*e*k-N*A*k)*L,H[12]=y*L,H[13]=(_*S*F-r*z*F+r*e*v-N*S*v-_*e*a+N*z*a)*L,H[14]=(r*A*F-I*S*F-r*e*q+N*S*q+I*e*a-N*A*a)*L,H[15]=(I*z*F-_*A*F+_*e*q-N*z*q-I*e*v+N*A*v)*L,this},makeRotationAxis:function(N,r){var s=Math.cos(r),d=Math.sin(r),K=1-s,U=N.x,v=N.y,R=N.z,k=K*U,$=K*v;return this.set(k*U+s,k*v-d*R,k*R+d*v,0,k*v+d*R,$*v+s,$*R-d*U,0,k*R-d*v,$*R+d*U,K*R*R+s,0,0,0,0,1),this},multiply:function(n){return this.multiplyMatrices(this,n)},premultiply:function(x){return this.multiplyMatrices(x,this)},multiplyMatrices:function(r,W){var U=r.el,Z=W.el,B=this.el,m=U[0],I=U[4],t=U[8],N=U[12],v=U[1],b=U[5],g=U[9],X=U[13],H=U[2],S=U[6],F=U[10],M=U[14],o=U[3],f=U[7],x=U[11],e=U[15],P=Z[0],E=Z[4],k=Z[8],y=Z[12],q=Z[1],l=Z[5],G=Z[9],d=Z[13],p=Z[2],$=Z[6],Y=Z[10],A=Z[14],D=Z[3],_=Z[7],w=Z[11],a=Z[15];
return B[0]=m*P+I*q+t*p+N*D,B[4]=m*E+I*l+t*$+N*_,B[8]=m*k+I*G+t*Y+N*w,B[12]=m*y+I*d+t*A+N*a,B[1]=v*P+b*q+g*p+X*D,B[5]=v*E+b*l+g*$+X*_,B[9]=v*k+b*G+g*Y+X*w,B[13]=v*y+b*d+g*A+X*a,B[2]=H*P+S*q+F*p+M*D,B[6]=H*E+S*l+F*$+M*_,B[10]=H*k+S*G+F*Y+M*w,B[14]=H*y+S*d+F*A+M*a,B[3]=o*P+f*q+x*p+e*D,B[7]=o*E+f*l+x*$+e*_,B[11]=o*k+f*G+x*Y+e*w,B[15]=o*y+f*d+x*A+e*a,this}});var Sp=K.Math.Quaternion=function(O,R,$,j){this.set(O,R,$,j)};m.assign(Sp.prototype,{set:function(V,n,G,T){var K=this;return K._x=V||0,K._y=n||0,K._z=G||0,K._w=T!==z?T:1,K},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(g){var z=this;return z._x=g._x,z._y=g._y,z._z=g._z,z._w=g._w,z},fromArray:function(R,r){r===z&&(r=0);var V=this;return V._x=R[r],V._y=R[r+1],V._z=R[r+2],V._w=R[r+3],this},slerp:function(v,L){if(0===L)return this;if(1===L)return this.copy(v);var Z=this._x,y=this._y,B=this._z,P=this._w,z=P*v._w+Z*v._x+y*v._y+B*v._z;if(0>z?(this._w=-v._w,this._x=-v._x,this._y=-v._y,this._z=-v._z,z=-z):this.copy(v),z>=1)return this._w=P,this._x=Z,this._y=y,this._z=B,this;var D=Math.sqrt(1-z*z);if(Math.abs(D)<.001)return this._w=.5*(P+this._w),this._x=.5*(Z+this._x),this._y=.5*(y+this._y),this._z=.5*(B+this._z),this;var m=Math.atan2(D,z),U=Math.sin((1-L)*m)/D,O=Math.sin(L*m)/D;return this._w=P*U+this._w*O,this._x=Z*U+this._x*O,this._y=y*U+this._y*O,this._z=B*U+this._z*O,this},setFromAxisAngle:function(g,i){var D=i/2,y=Math.sin(D);return this._x=g.x*y,this._y=g.y*y,this._z=g.z*y,this._w=Math.cos(D),this},setFromEuler:function(b){var f=b._x,p=b._y,M=b._z,h=b._order,Q=Math.cos,u=Math.sin,j=Q(f/2),v=Q(p/2),V=Q(M/2),H=u(f/2),g=u(p/2),U=u(M/2);return"XYZ"===h?(this._x=H*v*V+j*g*U,this._y=j*g*V-H*v*U,this._z=j*v*U+H*g*V,this._w=j*v*V-H*g*U):"YXZ"===h?(this._x=H*v*V+j*g*U,this._y=j*g*V-H*v*U,this._z=j*v*U-H*g*V,this._w=j*v*V+H*g*U):"ZXY"===h?(this._x=H*v*V-j*g*U,this._y=j*g*V+H*v*U,this._z=j*v*U+H*g*V,this._w=j*v*V-H*g*U):"ZYX"===h?(this._x=H*v*V-j*g*U,this._y=j*g*V+H*v*U,this._z=j*v*U-H*g*V,this._w=j*v*V+H*g*U):"YZX"===h?(this._x=H*v*V+j*g*U,this._y=j*g*V+H*v*U,this._z=j*v*U-H*g*V,this._w=j*v*V-H*g*U):"XZY"===h&&(this._x=H*v*V-j*g*U,this._y=j*g*V-H*v*U,this._z=j*v*U+H*g*V,this._w=j*v*V+H*g*U),this}});var lk=K.Math.Triangle=function(w,g,S){this.a=w!==z?w:new cl,this.b=g!==z?g:new cl,this.c=S!==z?S:new cl};m.assign(lk,{barycoordFromPoint:function(){var o=new cl,B=new cl,Z=new cl;return function(U,N,T,Q,x){o.subVectors(Q,N),B.subVectors(T,N),Z.subVectors(U,N);var m=o.dot(o),p=o.dot(B),b=o.dot(Z),X=B.dot(B),h=B.dot(Z),J=m*X-p*p,t=x||new cl;if(0===J)return t.set(-2,-1,-1);var n=1/J,d=(X*b-p*h)*n,w=(m*h-p*b)*n;return t.set(1-d-w,w,d)}}()});var vh=K.Math.Euler=function(B,d,c,H,x){this.set(B,d,c,H,x)};vh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],vh.DefaultOrder="XYZ",vh.ReverseOrder=function(r){return r=r[2]+r[1]+r[0],r.toUpperCase()},m.defineProperties(vh.prototype,{x:{get:function(){return this._x},set:function($){this._x=$,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(I){this._y=I,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(d){this._z=d,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(N){this._order=N,this.onChangeCallback()}}}),m.assign(vh.prototype,{set:function(J,V,u,l,w){return Ul(J)&&(w=u,l=V,u=J[2],V=J[1],J=J[0]),l?w&&(l=vh.ReverseOrder(l)):l="ZYX",this._x=J||0,this._y=V||0,this._z=u||0,this._order=l||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(x){return this._x=x._x,this._y=x._y,this._z=x._z,this._order=x._order,this.onChangeCallback(),this},setFromRotationMatrix:function(o,T,I){var k=K.Math.clamp,b=o.el||o,F=b[0],e=b[4],V=b[8],P=b[1],z=b[5],q=b[9],$=b[2],j=b[6],Q=b[10];return T=T||this._order,"XYZ"===T?(this._y=Math.asin(k(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(-q,Q),this._z=Math.atan2(-e,F)):(this._x=Math.atan2(j,z),this._z=0)):"YXZ"===T?(this._x=Math.asin(-k(q,-1,1)),Math.abs(q)<.99999?(this._y=Math.atan2(V,Q),this._z=Math.atan2(P,z)):(this._y=Math.atan2(-$,F),this._z=0)):"ZXY"===T?(this._x=Math.asin(k(j,-1,1)),Math.abs(j)<.99999?(this._y=Math.atan2(-$,Q),this._z=Math.atan2(-e,z)):(this._y=0,this._z=Math.atan2(P,F))):"ZYX"===T?(this._y=Math.asin(-k($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(j,Q),this._z=Math.atan2(P,F)):(this._x=0,this._z=Math.atan2(-e,z))):"YZX"===T?(this._z=Math.asin(k(P,-1,1)),Math.abs(P)<.99999?(this._x=Math.atan2(-q,z),this._y=Math.atan2(-$,F)):(this._x=0,this._y=Math.atan2(V,Q))):"XZY"===T?(this._z=Math.asin(-k(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(j,z),this._y=Math.atan2(V,F)):(this._x=Math.atan2(-q,Q),this._y=0)):console.warn("unsupported order: "+T),this._order=T,I!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new vl;return function(q,p,l){return t.makeRotationFromQuaternion(q),this.setFromRotationMatrix(t,p,l)}}(),setFromVector3:function(X,F){return this.set(X.x,X.y,X.z,F||this._order)},reorder:function(){var T=new Sp;return function(q){return T.setFromEuler(this),this.setFromQuaternion(T,q)}}(),equals:function(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._order===this._order},fromArray:function(f){return this._x=f[0],this._y=f[1],this._z=f[2],f[3]!==z&&(this._order=f[3]),this.onChangeCallback(),this},toArray:function(U,d){return U===z&&(U=[]),d===z&&(d=0),U[d]=this._x,U[d+1]=this._y,U[d+2]=this._z,U[d+3]=this._order,U},toVector3:function(d){return d?d.set(this._x,this._y,this._z):new cl(this._x,this._y,this._z)},onChange:function(n){return this.onChangeCallback=n,this},onChangeCallback:function(){}});var fl=K.List=function(){this._as=[];var Z,N,C=arguments.length;if(1===C){var I=arguments[0];if(mb(I)&&(I=I._as),Ul(I))for(N=I.length,Z=0;N>Z;Z++)this._as.push(I[Z]);else I!=G&&this._as.push(I)}else if(C>1)for(Z=0;C>Z;Z++)this._as.push(arguments[Z])};uj("List",m,{forEach:function(c,t){this.each(c,t)},push:function(){for(var p=0;p<arguments.length;p++)this.add(arguments[p])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(S,c){return c===z?this._as.push(S):this._as.splice(c,0,S)},addAll:function(P){mb(P)&&(P=P._as),Ul(P)?ml(this._as,P):this._as.push(P)},get:function(p){return this._as[p]},slice:function(i,p){return new fl(this._as.slice(i,p))},remove:function(I){var w=this._as.indexOf(I);return w>=0&&w<this._as.length&&this.removeAt(w),w},removeAt:function(k){return this._as.splice(k,1)[0]},set:function(p,y){return this._as[p]=y},clear:function(){return this._as.splice(0,this._as.length)},contains:function(A){return this._as.indexOf(A)>=0},indexOf:function(y){return this._as.indexOf(y)},each:function(U,m){for(var A=0,e=this._as.length;e>A;A++){var E=this._as[A];m?U.call(m,E,A,this):U(E,A,this)}},reverseEach:function(n,V){for(var v=this._as.length-1;v>=0;v--){var l=this._as[v];V?n.call(V,l):n(l)}},toArray:function(C,X){if(C){for(var v,Y=[],y=0,R=this._as.length;R>y;y++)v=this._as[y],X?C.call(X,v)&&Y.push(v):C(v)&&Y.push(v);return Y}return this._as.concat()},toList:function(B,C){if(B){for(var y,s=new fl,W=0,w=this._as.length;w>W;W++)y=this._as[W],C?B.call(C,y)&&s.add(y):B(y)&&s.add(y);return s}return new fl(this)},reverse:function(){this._as.reverse()},sort:function(N){return this._as.sort(N?N:sb),this},toString:function(){return this._as.toString()}}),m.defineProperties(fl.prototype,{length:{get:function(){return this._as.length},set:function(V){this._as.length=V}}});var eq=new fl;Sm(eq,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ts,each:ts,reverseEach:ts,toArray:function(){return[]},toList:function(){return new fl},add:dm,addAll:dm,set:dm,remove:dm,removeAt:dm,clear:dm});var Ne=K.Notifier=function(){this._f=0};uj("Notifier",m,{contains:function(m,H){if(this._ls)for(var C,n=0,p=this._ls.size();p>n;n++)if(C=this._ls.get(n),m===C.l&&H===C.s)return!0;return!1},add:function(c,m,x){var p=this,o={l:c,s:m,a:x};p._ls||(p._ls=new fl),p._f?(p._as||(p._as=new fl),p._as.add(o)):o.a?p._ls.add(o,0):p._ls.add(o)},remove:function(A,j){var Z=this;Z._ls&&(Z._f?(Z._rs||(Z._rs=new fl),Z._rs.add({l:A,s:j})):Z._remove(A,j))},_remove:function(b,x){for(var p,y=this._ls,C=0,s=y.size();s>C;C++)if(p=y.get(C),p.l===b&&p.s===x)return y.removeAt(C),void 0},fire:function(X){var P=this,V=P._ls;if(P._b=1e4,V){++P._f;try{for(var b,J=0,M=V.size();M>J;J++)b=V.get(J),b.s?b.l.call(b.s,X):b.l(X)}finally{if(--P._f)return;if(P._rs){for(M=P._rs.size(),J=0;M>J;J++)b=P._rs.get(J),P._remove(b.l,b.s);delete P._rs}if(P._as){for(M=P._as.size(),J=0;M>J;J++)b=P._as.get(J),b.a?V.add(b,0):V.add(b);delete P._as}}}}});var wf=K.Data=function(){this._id=Jn()};uj("Data",m,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:G,_parent:G,_children:eq,_childMap:G,_styleMap:G,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return G},_22Q:function(){return G},s:function(t,Q){var u=this;if(2===arguments.length)u.setStyle(t,Q);else{if(!ag(t))return u.getStyle(t);for(var N in t)u.setStyle(N,t[N])}return u},fp:function(b,n,D,J,d){return this.firePropertyChange(b,n,D,J,d)},firePropertyChange:function(y,n,d,I,a){if(I){if(I(n,d))return!1}else if(n===d)return!1;var L=this,o=a||{};return o.property=y,o.oldValue=n,o.newValue=d,o.data=L,L._dataModel&&L._dataModel.handleDataPropertyChange(o),L.onPropertyChanged(o),!0},onPropertyChanged:function(F){var N=this,$=N._parent,e=F.property;if(nk($)){var k=N.s(gc),z="s:ingroup"===e;(k&&tg[e]||e===z)&&$._81I(),(k||z)&&$.fp("childChange",!0,!1)}nr($)&&tg[e]&&$.updateFromChildren()},_21I:function(T){var N=this;if(T&&N._dataModel)throw"Remove data from dataModel before adding";N._dataModel=T},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var y=0,F=this._children.toArray(),j=F.length;j>y;y++)F[y].removeFromDataModel()},getId:function(){return this._id},setId:function(k){this._id=k},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(a,m){return this._children.toList(a,m)},eachChild:function(N,R){this._children.each(N,R)},addChild:function(l,e){var a=this;l!==a&&(a._children===eq&&(a._children=new fl,a._childMap={}),e>=0||(e=a._children.size()),a._childMap[l._id]||a.isDescendantOf(l)||(l._parent&&l._parent.removeChild(l),(0>e||e>a._children.size())&&(e=a._children.size()),a._children.add(l,e),a._childMap[l._id]=l,l.setParent(a),a.onChildAdded(l,e),a.fp(Bn,G,l)))},onChildAdded:function(){},removeChild:function(L){var d=this;if(d._childMap&&d._childMap[L._id]){var J=d._children.remove(L);delete d._childMap[L._id],d.fp(Bn,L,G),L.setParent(G,J),d.onChildRemoved(L,J)}},onChildRemoved:function(){},getChildAt:function(M){return this._children.get(M)},clearChildren:function(){var C=this;if(!C._children.isEmpty())for(var o=0,$=C._children.toArray(),w=$.length;w>o;o++)C.removeChild($[o])},getParent:function(){return this._parent},setParent:function(b,n){var I=this;if(!(I._73I||I._parent===b||I===b||b&&b.isDescendantOf(I))){var U,l=I._parent;I._parent=b,I._73I=1,l?(n==G&&(n=l.getChildren().indexOf(I)),l.removeChild(I)):I._dataModel&&n==G&&(n=I._dataModel.getRoots().indexOf(I)),b&&(b.addChild(I),U=b.getChildren().indexOf(I)),delete I._73I,I.fp("parent",l,b,z,{oldIndex:n,newIndex:U}),I.onParentChanged(l,b)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(N){return N?this.isDescendantOf(N)||N.isDescendantOf(this):!1},isParentOf:function(M){return M&&this._childMap?!!this._childMap[M._id]:!1},isDescendantOf:function(n){if(!n||n.isEmpty())return!1;for(var N=this._parent;N;){if(n===N)return!0;N=N._parent}return!1},getStyle:function(D,I){I===z&&(I=1);var j=this._styleMap?this._styleMap[D]:z;return j===z&&I?r[D]:j},setStyle:function(C,I){var h=this;h._styleMap||(h._styleMap={});var t=h._styleMap[C];I===z?delete h._styleMap[C]:h._styleMap[C]=I,h.fp("s:"+C,t,I)&&h.onStyleChanged(C,t,I)},onStyleChanged:function(){},iv:function(b){this.invalidate(b)},invalidate:function(U){this.fp(U||"*",!1,!0)},toString:function(){var i=this;return i._displayName||i._name||i._tag||i._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(E,l){var u=this,X=u.s(bs);X||u.s(bs,X={}),l?X[E]=l:delete X[E],u.fp(bs,G,X)},removeStyleIcon:function(Q){var $=this.s(bs);if($){var E=$[Q];delete $[Q],this.fp(bs,G,$)}return E},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var u,d={};for(u in this._styleMap)d[u]=1;return d}});var rl=K.DataModel=function(){var T=this;T._datas=new fl,T._dataMap={},T._roots=new fl,T._rootMap={},T._78O={},T._36I=new Ne,T._35I=new Ne,T._selectionModel=new vi(T);var g=T._29Q=[],m=T._scheduleCallback=function(){for(var d=Date.now(),L=0;L<g.length;L++){var h=g[L];h.enabled&&d-h.lastTime>h.interval&&(h.beforeAction&&h.beforeAction(),T.each(function(S){h.action(S)}),h.afterAction&&h.afterAction(),h.lastTime=d)}g.length&&(T._30Q=p.requestAnimationFrame(m))}};uj("DataModel",m,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:z,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:z,_init:z,_envmap:z,_postProcessingData:z,sm:function(){return this.getSelectionModel()},mm:function(Z,i,E){this.addDataModelChangeListener(Z,i,E)},umm:function(s,H){this.removeDataModelChangeListener(s,H)},md:function(f,c,G){this.addDataPropertyChangeListener(f,c,G)},umd:function(p,v){this.removeDataPropertyChangeListener(p,v)},mh:function(s,i,m){this.addHierarchyChangeListener(s,i,m)},umh:function(A,G){this.removeHierarchyChangeListener(A,G)},getAttrObject:function(){return this._attrObject},setAttrObject:function(u){return this._attrObject=u},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(V){return this._dataMap[V]},removeDataById:function(I){this.remove(this.getDataById(I))},toDatas:function(R,E){return this._datas.toList(R,E)},each:function(Z,q){this._datas.each(Z,q)},getDataByTag:function(w){return this._78O[w]},getTagMap:function(){return this._78O},removeDataByTag:function(p){this.remove(this.getDataByTag(p))},add:function(u,j,J){var q=this,C=u._id,N=u._tag,o=q._roots;if(q._dataMap[C])throw"'"+C+"' already exists";N!=G&&(q._78O[N]=u),q._dataMap[C]=u,J>=0?q._datas.add(u,J):q._datas.add(u),u._parent||(q._rootMap[C]=u,j>=0?o.add(u,j):o.add(u)),u._21I(q),q.onAdded(u),q._36I.fire({kind:"add",data:u,rootsIndex:j,datasIndex:J})},onAdded:function(){},remove:function(i,v){if(i){var Z=this,x=i._id,S=v&&v.keepStructure,E=v&&v.keepChildren,I=i.getTag();if(i._dataModel===Z){this.beginTransaction(),S?Z._removingData||(Z._removingData=i):Z.prepareRemove(i),E||i.toChildren().each(function(I){Z.remove(I,v)},Z),S?Z._removingData===i&&(i._parent&&i._parent.removeChild(i),delete Z._removingData):i._parent&&i._parent.removeChild(i);var X=Z._datas.remove(i);delete Z._dataMap[x],I!=G&&delete Z._78O[I];var D;Z._rootMap[x]&&(delete Z._rootMap[x],D=Z._roots.remove(i)),i._21I(G),Z.onRemoved(i),Z._36I.fire({kind:fk,data:i,rootsIndex:D,datasIndex:X}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var D=this;if(D._datas.size()){var R=D._historyManager?this.toJSON():z;D._datas.toArray().forEach(function(t){t._21I(G)}),D._datas.clear(),D._dataMap={},D._roots.clear(),D._rootMap={},D._78O={},D._36I.fire({kind:Bd,json:R})}},contains:function(O){return O&&O._dataModel===this},handleDataPropertyChange:function(s){var h=this,v=s.data,I=s.property;if("parent"===I){var L=v._id,F=h._rootMap,Y=h._roots;v._parent?F[L]&&(delete F[L],Y.remove(v)):F[L]||(F[L]=v,Y.add(v))}else if("tag"===I){var p=s.oldValue,w=s.newValue,q=h._78O;p!=G&&delete q[p],w!=G&&(q[w]=v)}this.onDataPropertyChanged(v,s),this._35I.fire(s)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(R,A,s){this._36I.add(R,A,s)},removeDataModelChangeListener:function(A,X){this._36I.remove(A,X)},addDataPropertyChangeListener:function(h,F,Z){this._35I.add(h,F,Z)},removeDataPropertyChangeListener:function(R,P){this._35I.remove(R,P)},_38I:function(J,T,t){this._37I&&this._37I.fire({data:J,oldIndex:T,newIndex:t})},addHierarchyChangeListener:function(s,n,L){this._37I||(this._37I=new Ne),this._37I.add(s,n,L)},removeHierarchyChangeListener:function(f,R){this._37I.remove(f,R)},getSiblings:function(g){var e=g._parent;return e?e._children:this._roots},eachByHierarchical:function(M,V,O){if(V)return this._eachByHierarchical(M,V,O);for(var r=0,e=this._roots,d=e.size();d>r;r++)if(this._eachByHierarchical(M,e.get(r),O)===!1)return!1;return!0},_eachByHierarchical:function(P,I,Z){if(Z){if(P.call(Z,I)===!1)return!1}else if(P(I)===!1)return!1;for(var N=I.size(),J=0;N>J;J++)if(this._eachByHierarchical(P,I.getChildAt(J),Z)===!1)return!1;return!0},reverseEachByHierarchical:function(T,s,L){if(s)return this._reverseEachByHierarchical(T,s,L);for(var g=this._roots,y=g.size(),p=y-1;p>=0;p--)if(this._reverseEachByHierarchical(T,g.get(p),L)===!1)return!1;return!0},_reverseEachByHierarchical:function(Z,E,p){for(var m=E.size(),k=m-1;k>=0;k--)if(this._reverseEachByHierarchical(Z,E.getChildAt(k),p)===!1)return!1;if(p){if(Z.call(p,E)===!1)return!1}else if(Z(E)===!1)return!1;return!0},eachByDepthFirst:function(n,K,U){if(K)return this._11I(n,K,U);for(var H=0,T=this._roots,P=T.size();P>H;H++)if(this._11I(n,T.get(H),U)===!1)return!1;return!0},_11I:function(T,Y,n){for(var E=Y.size(),_=0;E>_;_++)if(this._11I(T,Y.getChildAt(_),n)===!1)return!1;if(n){if(T.call(n,Y)===!1)return!1}else if(T(Y)===!1)return!1;return!0},eachByBreadthFirst:function(b,p,O){var S=new fl;for(p?S.add(p):this._roots.each(S.add,S);S.size()>0;)if(p=S.removeAt(0),p.eachChild(S.add,S),O){if(b.call(O,p)===!1)return!1}else if(b(p)===!1)return!1;return!0},moveTo:function(V,o){var K=this.getSiblings(V),f=K.indexOf(V);f===o||0>f||o>=0&&o<=K.size()&&(K.remove(V),o>K.size()&&o--,K.add(V,o),this._38I(V,f,o))},moveUp:function(v){this.moveTo(v,this.getSiblings(v).indexOf(v)-1)},moveDown:function(r){this.moveTo(r,this.getSiblings(r).indexOf(r)+1)},moveToTop:function(M){this.moveTo(M,0)},moveToBottom:function(e){this.moveTo(e,this.getSiblings(e).size())},moveSelectionUp:function(o){this.beginTransaction(),o||(o=this.sm());var H=new fl;xi(o,H,this._roots),H.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(y){this.beginTransaction(),y||(y=this.sm());var P=new fl;Cp(y,P,this._roots),P.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(T){this.beginTransaction(),T||(T=this.sm());var u=new fl;jh(T,u,this._roots),u.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(G){this.beginTransaction(),G||(G=this.sm());var P=new fl;Mc(G,P,this._roots),P.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(t,K,r){var b=this.getDatas();null==r&&(r=b.indexOf(t)),r===K||0>r||K>=0&&K<=b.size()&&(b.remove(t),K>b.size()&&K--,b.add(t,K),this._76I(t,r,K))},bringForward:function(K){this.moveToIndex(K,this.getDatas().indexOf(K)+1)},bringToFront:function(h){this.moveToIndex(h,this.size())},sendBackward:function(y){this.moveToIndex(y,this.getDatas().indexOf(y)-1)},sendToBack:function(Z){this.moveToIndex(Z,0)},bringSelectionForward:function(n){this.beginTransaction(),n||(n=this.sm());for(var l=new fl,h=this.getDatas(),S=!1,j=0;j<h.size();j++){var $=h.get(h.size()-1-j);n.contains($)?S&&l.add($):S=!0}l.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(F){this.beginTransaction(),F||(F=this.sm());for(var k=new fl,$=this.getDatas(),g=0;g<$.size();g++){var R=$.get(g);F.contains(R)&&k.add(R)}k.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(A){this.beginTransaction(),A||(A=this.sm());for(var q=new fl,P=this.getDatas(),t=!1,w=0;w<P.size();w++){var u=P.get(w);A.contains(u)?t&&q.add(u):t=!0}q.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(K){this.beginTransaction(),K||(K=this.sm());for(var M=new fl,B=this.getDatas(),T=0;T<B.size();T++){var w=B.get(B.size()-1-T);K.contains(w)&&M.add(w)}M.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(H){var z=this;z.removeScheduleTask(H),H.enabled==G&&(H.enabled=!0),H.interval==G&&(H.interval=10),H.action==G&&(H.action=ts),H.lastTime=Date.now(),z._29Q.push(H),z._30Q==G&&(z._30Q=p.requestAnimationFrame(z._scheduleCallback))},removeScheduleTask:function(S){var O=this,Q=O._29Q,Z=Q.indexOf(S);Z>=0&&Q.splice(Z,1),Q.length||O._30Q==G||(p.cancelAnimationFrame(O._30Q),delete O._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(c){this._historyManager||new K.HistoryManager(this),null!=c&&this._historyManager.setMaxHistoryCount(c),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(F){this._historyManager&&this._historyManager.undo(F)},redo:function(u){this._historyManager&&this._historyManager.redo(u)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(X){this._historyManager&&this._historyManager.addHistory(X)},onHistoryManagerChanged:function(){}});var vi=K.SelectionModel=function(f){var s=this;s._68O=cq,s._map={},s._73O=new fl,s._74I=new Ne,s._21I(f)};uj("SelectionModel",m,{ms_fire:1,ms_dm:1,ms:function(R,g,P){this.addSelectionChangeListener(R,g,P)},ums:function(Q,L){this.removeSelectionChangeListener(Q,L)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===nf},co:function(t){return this._map[t._id]!=G},ss:function(w){this.setSelection(w)},as:function(o){this.appendSelection(o)},rs:function(N){this.removeSelection(N)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(L){var d=this;if(d._68O!==L&&(L===Jg||L===nf||L===cq)){d.cs();var g=d._68O;d._68O=L,d.fp("selectionMode",g,L)}},_21I:function(T){var d=this,I=d._dataModel;I!==T&&(I&&(d.cs(),I.umm(d.handleDataModelChange,d)),d._dataModel=T,T.mm(d.handleDataModelChange,d,!0),d.fp(Ob,I,T))},dispose:function(){var W=this;W.cs(),W._dataModel.umm(W.handleDataModelChange,W)},handleDataModelChange:function(a){var r=this;if(a.kind===fk){var X=a.data;r.co(X)&&(r._73O.remove(X),delete r._map[X._id],r._75I(fk,new fl(X)))}else a.kind===Bd&&r.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(l){var K=this;if(K._filterFunc!==l){K.cs();var U=K._filterFunc;K._filterFunc=l,K.fp("filterFunc",U,K._filterFunc)}},_75I:function(j,D,p,r){p&&(this._73O.each(function(Q){r[Q._id]?p.remove(Q):p.add(Q)}),D=p.toList()),this._74I.fire({kind:j,datas:new fl(D)})},addSelectionChangeListener:function(T,k,X){this._74I.add(T,k,X)},removeSelectionChangeListener:function(S,t){this._74I.remove(S,t)},_97O:function(S,B){for(var R,q=this,l=0,H=new fl(S);l<H.size();l++)R=H.get(l),(q._filterFunc&&!q._filterFunc(R)||B&&q.co(R)||!B&&!q.co(R)||!q._dataModel.contains(R))&&(H.removeAt(l),l--);return H},appendSelection:function(J){var B=this;if(B._68O!==Jg){var w,z,M=B._73O,b=B._97O(J,!0);b.isEmpty()||(B.sg()&&(w=new fl(M),z=B._map,M.clear(),B._map={},b=new fl(b.get(b.size()-1))),b.each(function(H){M.add(H),B._map[H._id]=H}),B._75I("append",b,w,z))}},removeSelection:function(f){var P=this,I=P._97O(f),y=0,m=I.size();if(0!==m){for(;m>y;y++){var K=I.get(y);P._73O.remove(K),delete P._map[K._id]}P._75I(fk,I)}},toSelection:function(N,X){return this._73O.toList(N,X)},getSelection:function(){return this._73O},each:function(o,u){this._73O.each(o,u)},setSelection:function(w){var N=this,a=N._73O;if(N._68O!==Jg&&!(a.isEmpty()&&!w||1===a.size()&&N.ld()===w)){var i=new fl(a),U=N._map;a.clear(),N._map={};var p=N._97O(w,!0);N.sg()&&p.size()>1&&(p=new fl(p.get(p.size()-1))),p.each(function(E){a.add(E),N._map[E._id]=E}),N._75I("set",G,i,U)}},clearSelection:function(){var R=this,d=R._73O;if(d.size()>0){var F=d.toList();d.clear(),R._map={},R._75I(Bd,F)}},selectAll:function(){var Y=this;if(Y._68O!==Jg){var m,r,w=Y._dataModel.toDatas();if(Y._filterFunc)for(m=0;m<w.size();m++)r=w.get(m),Y._filterFunc(r)||(w.removeAt(m),m--);var l=Y._73O,S=new fl(l),W=Y._map;l.clear(),Y._map={},Y.sg()&&w.size()>1&&(w=new fl(w.get(w.size()-1)));var D=w.size();for(m=0;D>m;m++)r=w.get(m),l.add(r),Y._map[r._id]=r;Y._75I("all",G,S,W)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(y){return this._map[y._id]!=G},getLastData:function(){var s=this._73O;return s.size()>0?s.get(s.size()-1):G},getFirstData:function(){var L=this._73O;return L.size()>0?L.get(0):G},isSelectable:function(K){var Y=this;return K&&Y._68O!==Jg?Y._filterFunc?Y._filterFunc(K):!0:!1},getTopSelection:function(){var V=this,S=new fl;return V._73O.each(function(L){for(var F=L.getParent();F;){if(V.contains(F)){L=G;break}F=F.parent}L&&S.add(L)}),S}});var Jk=function(){return Ap(0),function(v,Z){var T;if(Nj(Z)){var Y=v.getDataUI(Z);Y&&Y._88I&&(T=Y._88I.rect)}return T?T:Z.getRect()}}();Sm(V,{edgeGroupAgentFunc:G,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:M.rectSelectBorder,graphViewRectSelectBackground:Ih,graphViewEditPointSize:Ai?17:7,graphViewEditPointBorderColor:M.editPointBorder,graphViewEditPointBackground:M.editPointBackground,setEdgeType:function(I,U,C){$j[I]=U,Ib[I]=C},getEdgeType:function(h){return $j[h]},getEdgeTypeMap:function(){return $j},getNodeRect:Jk},!0),Sm(r,{layout:!1,"layout.h":z,"layout.h.value":z,"layout.v":z,"layout.v.value":z,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":z,interactive:!1,"image.stretch":"fill",icons:z,ingroup:!0,"body.color":z,opacity:z,pixelPerfect:!0,keepAspectRatio:!1,"clip.direction":"top","clip.percentage":1,"select.color":vc,"select.width":1,"select.padding":2,"select.type":zn,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":z,"border.width":2,"border.padding":2,"border.type":zn,label:z,"label.font":z,"label.color":Lg,"label.background":z,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":z,"label.max":z,"label.opacity":z,"label.scale":1,"label.align":z,"label.selectable":!0,label2:z,"label2.font":z,"label2.color":Lg,"label2.background":z,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":z,"label2.max":z,"label2.opacity":z,"label2.scale":1,"label2.align":z,"label2.selectable":!0,note:z,"note.expanded":!0,"note.font":z,"note.color":de,"note.background":vc,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":z,"note.toggleable":!0,"note.border.width":1,"note.border.color":z,"note.opacity":z,"note.scale":1,"note.align":z,note2:z,"note2.expanded":!0,"note2.font":z,"note2.color":de,"note2.background":vc,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":z,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":z,"note2.opacity":z,"note2.scale":1,"note2.align":z,"group.type":z,"group.image":z,"group.image.stretch":"fill","group.repeat.image":z,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":z,"group.title.color":de,"group.title.background":M.groupTitleBackground,"group.title.align":kh,"group.title.orientation":Wj,"group.background":M.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":z,"group.border.color":zg,"group.border.radius":0,"group.border.cap":xo,"group.border.join":Bp,"group.splitLine":!1,"group.gradient":G,"group.gradient.color":"#FFF",shape:z,"shape.background":zg,"shape.repeat.image":z,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":zg,"shape.border.3d":!1,"shape.border.3d.color":z,"shape.border.3d.accuracy":z,"shape.border.cap":xo,"shape.border.join":Bp,"shape.border.pattern":z,"shape.gradient":G,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":li,"shape.dash.offset":0,"shape.dash.color":Zi,"shape.dash.width":z,"shape.dash.3d":!1,"shape.dash.3d.color":z,"shape.dash.3d.accuracy":z,"shape.polygon.side":6,"shape.arc.from":C,"shape.arc.to":O,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":z,"shape.gradient.pack":z,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":z,"shape.foreground.gradient":G,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":z,"autolayout.hgap":z,"autolayout.vgap":z,"edge.type":z,"edge.points":z,"edge.segments":z,"edge.color":zg,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":z,"edge.3d.accuracy":z,"edge.cap":xo,"edge.join":Bp,"edge.source.position":17,"edge.source.anchor.x":z,"edge.source.anchor.y":z,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":z,"edge.target.anchor.y":z,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":z,"edge.dash":!1,"edge.dash.pattern":li,"edge.dash.offset":0,"edge.dash.color":Zi,"edge.dash.width":z,"edge.dash.3d":!1,"edge.dash.3d.color":z,"edge.dash.3d.accuracy":z,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":z,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":z,"grid.column.percents":z,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":M.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":M.gridCellBorderColor,"grid.block":z,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":M.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Lg,"text.font":Fh,"text.shadow":!1,"text.shadow.color":vc,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Sm(rl,{_76I:function(R,y,E){this._39I&&this._39I.fire({data:R,oldIndex:y,newIndex:E})},addIndexChangeListener:function(C,u,Y){var E=this;E._39I||(E._39I=new Ne),E._39I.add(C,u,Y)},removeIndexChangeListener:function(D,K){this._39I.remove(D,K)},prepareRemove:function(m){Zc(m)&&(m.setSource(G),m.setTarget(G)),m._70O&&m._70O.toList().each(this.remove,this),m._69O&&m._69O.toList().each(function(h){h.setHost(G)}),m._host&&m.setHost(G)},onAdded:function(T){this.isAutoAdjustIndex()&&this.adjustIndex(T)},onDataPropertyChanged:function(Z,N){eb[N.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Z)
},isAdjustable:function(y){return gp(y)||Zc(y)},isAdjustedToBottom:function(K){return nk(K)?K.isExpanded()&&aj(K):!1},adjustIndex:function(A){var j=this;this.isHierarchicalRendering()||(j.isAdjustedToBottom(A)?(j.sendToBottom(A),A.eachChild(j.adjustIndex,j)):j.sendToTop(A))},sendToTop:function(U){var b=this;if(b.contains(U)&&b.isAdjustable(U)){var Z=b._datas;if(U!==Z.get(b.size()-1)){var _=Z.indexOf(U);Z.removeAt(_),Z.add(U),b._76I(U,_,b.size()-1)}if(Zc(U)){var R=U._40I;R&&!b.isAdjustedToBottom(R)&&b.sendToTop(R),R=U._41I,R&&!b.isAdjustedToBottom(R)&&b.sendToTop(R)}U._69O&&U._69O.each(function(y){y.isRelatedTo(U)||gp(U)&&y.isLoopedHostOn(U)||b.sendToTop(y)}),U.ISubGraph||(!nk(U)||U.isExpanded())&&U._adjustChildrenToTop&&U.eachChild(function(j){Zc(j)||b.sendToTop(j)})}},sendToBottom:function(m,P){var T=this;if(m!==P&&T.contains(m)&&T.isAdjustable(m)&&(!P||T.contains(P))){var $=T._datas,o=$.remove(m),k=P?T._datas.indexOf(P):0;if($.add(m,k),o!==k){T._76I(m,o,k);var h=m._parent;!h||h.ISubGraph||Zc(h)||T.sendToBottom(m._parent,m)}}}}),Sm(Xm,{ms_edit:function(I){I._46O=function($){var q=this,E=q.gv.dm(),y=q._index,W=q._89I,X=q._node,i=q._shape,N=q._edge,s=q._77I;X&&W?(this.fi({kind:"endEditRect",event:$,data:X,direction:W}),E.endTransaction()):i&&y>=0?(q.fi({kind:"endEditPoint",event:$,data:i,index:y}),E.endTransaction()):N&&y>=0?(q.fi({kind:"endEditPoint",event:$,data:N,index:y}),E.endTransaction()):s&&(q.fi({kind:"endEditRotation",event:$,data:s}),E.endTransaction())},I._78I=function(l){var R=this;R.autoScroll(l);var e=R.gv.lp(l),r=R._index,N=R._89I,Z=R._node,O=R._shape,S=R._edge,y=R._77I;if(Z&&N)R._80O(e),R.fi({kind:"betweenEditRect",event:l,data:Z,direction:N});else if(O&&r>=0)e.e=O.getPoints().get(r).e,O.setPoint(r,e),R.fi({kind:"betweenEditPoint",event:l,data:O,index:r});else if(S&&r>=0){var n=S.s(id);e.e=n.get(r).e,n.set(r,e),S.fp(id,G,n),R.fi({kind:"betweenEditPoint",event:l,data:S,index:r})}else if(y){var t=y.p(),W=y.getScale(),E=Y+x(e.y-t.y,e.x-t.x);W.y<0&&(E+=C),D(E)<.04&&(E=0),y.setRotation(E),R.fi({kind:"betweenEditRotation",event:l,data:y})}},I._80O=function(S){var b=this,j=b._node,P=b._rect,d=P.x,z=P.y,H=P.width,l=P.height,n=b._89I,q=b._anchor,U=b._matrix,S=U.tfi(S);"northwest"===n?P=Gr(S,{x:d+H,y:z+l}):n===ef?P=Gr({x:d,y:S.y},{x:d+H,y:z+l}):"northeast"===n?P=Gr({x:d,y:S.y},{x:S.x,y:z+l}):n===jk?P=Gr({x:S.x,y:z},{x:d+H,y:z+l}):n===xf?P=Gr({x:d,y:z},{x:S.x,y:z+l}):"southwest"===n?P=Gr({x:S.x,y:z},{x:d+H,y:S.y}):"south"===n?P=Gr({x:d,y:z},{x:d+H,y:S.y}):"southeast"===n&&(P=Gr({x:d,y:z},S)),j.setPosition(U.tf(P.x+P.width*q.x,P.y+P.height*q.y)),j.setWidth(P.width),j.setHeight(P.height)},I._80I=function(h,j,$,X){var E=this,V=E.gv._zoom,e=(E.gv.getEditPointSize()+2)/V;return Wn({x:j-e/2,y:$-e/2,width:e,height:e},h)?(E._89I!==X&&(E._89I=X),!0):!1},I._79I=function(Z,e,I){var M=this,f=M.gv,m=e?f.getDataUI(e):G,y=m?m._55O:G;if(y){var n,d,v,L,b=f._zoom,a=(f.getEditPointSize()+2)/b,V=f.lp(Z);if(gp(e)){if(y._56O&&gp(e)&&(d=y._98o,Wn({x:d.x-a/2,y:d.y-a/2,width:a,height:a},V)))return M._77I=e,I&&M.fi({kind:"beginEditRotation",event:Z,data:e}),M.setCursor("crosshair"),!0;if(y._43O&&e instanceof Rp)for(v=e.getPoints(),n=v.size()-1;n>=0;n--)if(d=v.get(n),Wn({x:d.x-a/2,y:d.y-a/2,width:a,height:a},V))return M._index=n,M._shape=e,I&&M.fi({kind:"beginEditPoint",event:Z,data:e,index:n}),M.setCursor("crosshair"),!0;if(y._42O)for(var W=e.getEditControlPoints(),l=["northwest",-1,-1,jk,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,xf,1,0,"northeast",1,-1,ef,0,-1],n=0,L=W.length;L>n;n++){var K=l[3*n],j=W[n];if(M._80I(V,j.x,j.y,K)){M._node=e;var C=e.getWidth(),D=e.getHeight(),E=e.getAnchor();M._rect={x:-C*E.x,y:-D*E.y,width:C,height:D},M._anchor=E,M._matrix=e.getMatrix();var u=e.getRotation(),O=F(u),P=s(u),J=l[3*n+1]*nb(e.getScale().x),Q=l[3*n+2]*nb(e.getScale().y),p=Math.atan2(-P*J-O*Q,O*J-P*Q),A=(Math.round(p/(Math.PI/4))+8)%8,z=[Nm,"nesw-resize",uh,"nwse-resize",Nm,"nesw-resize",uh,"nwse-resize"][A];return M.setCursor(z),I&&M.fi({kind:"beginEditRect",event:Z,data:e,direction:M._89I}),!0}}}if(y._43O&&Zc(e)&&e.s(Oe)===Wp&&(v=e.s(id)))for(n=v.size()-1;n>=0;n--)if(d=v.get(n),Wn({x:d.x-a/2,y:d.y-a/2,width:a,height:a},V))return M._index=n,M._edge=e,I&&M.fi({kind:"beginEditPoint",event:Z,data:e,index:n}),M.setCursor("crosshair"),!0}return!1}},ms_gv:function(k){k._currentSubGraph=G,k.upSubGraph=function(){this.setCurrentSubGraph(jg(this._currentSubGraph))},k.isVisible=function(L){var F=this;if(jg(L)!==F._currentSubGraph)return!1;if(Zc(L)){var A=L._40I,i=L._41I;if(!A||!i)return!1;if(!(L.s("edge.independent")||F.isVisible(A)&&F.isVisible(i)))return!1;if(L.isEdgeGroupHidden())return!1}else for(var T=L._parent;T&&!T.ISubGraph;){if(nk(T)&&(!T.isExpanded()||!F.isVisible(T)))return!1;T=T._parent}if(L._parent instanceof Ro&&!F.isVisible(L._parent))return!1;if(L._refGraph instanceof Ep&&!F.isVisible(L._refGraph))return!1;if(F instanceof Fn){if(!L.s("3d.visible"))return!1}else{var h=F.getLayersInfo();if(h){var X=h[L._layer];if(X&&X.visible===!1)return!1}if(!L.s("2d.visible"))return!1}return F._visibleFunc?F._visibleFunc(L):!0},k.handleSelectionChange=function(K){var U=this;K.datas.each(function(G){U.invalidateData(G);var A=G._parent;nk(A)&&gp(G)&&G.s(gc)&&(U.invalidateData(A),A._49I&&A._49I.each(function(D){U.invalidateData(D)}))}),U.onSelectionChanged(K)},k.onSelectionChanged=function(W){var B=this,U=B.sm();if(1===U.size()&&("set"===W.kind||"append"===W.kind)){var k=U.ld();B.isAutoMakeVisible()&&B.makeVisible(k),B.adjustIndex&&B._dataModel.isAutoAdjustIndex()&&B.adjustIndex(k)}},k.makeVisible=function(U){if(U){var m=this,B=m.getDataUI?m.getDataUI(U):m.getData3dUI(U);if(B){var u=U,P=jg(U);for(P!==m._currentSubGraph&&m.setCurrentSubGraph(P);(u=u._parent)&&u!==P;)nk(u)&&u.setExpanded(!0);m._23I=U,m.iv()}}},k.getLabel=function(e){var C=e.getStyle(Fo);return C===z?e.getName():C},k.getLabelBackground=function(b){return b.getStyle("label.background")},k.getLabelColor=function(U){return U.getStyle("label.color")},k.getLabel2=function(z){return z.getStyle("label2")},k.getLabel2Background=function(w){return w.getStyle("label2.background")},k.getLabel2Color=function(i){return i.getStyle("label2.color")},k.getNote=function(K){return K.getStyle(qs)},k.getNoteBackground=function(U){return U.getStyle("note.background")},k.getNote2=function(q){return q.getStyle(Kn)},k.getNote2Background=function(z){return z.getStyle("note2.background")},k.handleClick=function(S,n,a){var g=this;n?(g.fi({kind:"clickData",event:S,data:n,part:a}),g.onDataClicked(n,S)):(g.fi({kind:"clickBackground",event:S}),g.onBackgroundClicked(S))},k.handleDoubleClick=function(m,s,J){var F=this;Tl(m)&&(s?(F.fi({kind:"doubleClickData",event:m,data:s,part:J}),F.onDataDoubleClicked(s,m,J),F.checkDoubleClickOnNote(m,s,J)||F.checkDoubleClickOnRotation&&F.checkDoubleClickOnRotation(m,s,J)||(Zc(s)?F.onEdgeDoubleClicked(s,m,J):s.ISubGraph?F.onSubGraphDoubleClicked(s,m,J):nk(s)?F.onGroupDoubleClicked(s,m,J):s.IDoorWindow?F.onDoorWindowDoubleClicked(s,m,J):s.ICSGBox&&F.onCSGBoxDoubleClicked(s,m,J))):(F.fi({kind:"doubleClickBackground",event:m}),F.onBackgroundDoubleClicked(m)))},k.onSubGraphDoubleClicked=function(v){this.setCurrentSubGraph(v)},k.onEdgeDoubleClicked=function(P,g){P.ISubGraph&&!Rj(g)?this.setCurrentSubGraph(P):P.s("edge.toggleable")&&P.toggle()},k.onGroupDoubleClicked=function(Z){Z.s("group.toggleable")&&Z.toggle()},k.onDoorWindowDoubleClicked=function(x){x.s("dw.toggleable")&&x.toggle(!0)},k.onCSGBoxDoubleClicked=function(D,t){var Q=this;if(Q instanceof Fn){var P=Q.getHitFaceInfo(t);P&&P.face&&D.s(P.face+".toggleable")&&D.toggleFace(P.face,!0)}},k.onBackgroundClicked=function(){},k.onBackgroundDoubleClicked=function(){this.upSubGraph()},k.onDataClicked=function(){},k.onDataDoubleClicked=function(){},k.onAutoLayoutEnded=function(){},k.onMoveEnded=function(){},k.onPanEnded=function(){},k.onPinchEnded=function(){},k.onRectSelectEnded=function(){},k.onZoomEnded=function(){}},ms_icons:function(w){w.getRotation=function(v){return v==G?0:v},w._15O=function(){var i=this,j=i.s(bs);if(j){var o=i,c=i.data||i._data,h=i._38o={icons:j,rects:{}};for(var C in j){var u=j[C],N=Qb(u.shape3d,c,o);if(!(Qb(u.visible,c,o)===!1||Qb(u.for3d,c,o)&&!i.I3d||N&&!i.I3d)){var v=N?[N]:Qb(u.names,c,o),m=v?v.length:0,D=Qb(u.position,c,o)||3,d=Qb(u.offsetX,c,o)||0,X=Qb(u.offsetY,c,o)||0,p=Qb(u.direction,c,o)||xf,A=Qb(u.gap,c,o),w=A!=G?A:1,f=Qb(u.rotation,c,o),L=Qb(u.keepOrien,c,o),y=Qb(u.rotationFixed,c,o)?f:i.getRotation(f,L,D),$=G,Z=h.rects[C]=new Array(m);Z.rotation=y;for(var x=0;m>x;x++){var e,K,g,t,z=v[x];if(N)g=0,t=0;else{var T=tn(z);g=Qb(u.width,c,o),t=Qb(u.height,c,o),g==G&&(g=dq(T,c)),t==G&&(t=Am(T,c))}if($?p===xf?d+=g/2:p===jk?d-=g/2:p===ef?X-=t/2:X+=t/2:$={width:g,height:t},i.I3d){var U=-g/2,M=-t/2;K={width:g,height:t,mat:i._16O(Qb(u.autorotate,c,o),D,$,Qb(u.face,c,o)||Gb,Qb(u.t3,c,o),Qb(u.r3,c,o),Qb(u.rotationMode,c,o),d,X),vs:new nj([U,-M,0,U,-M-t,0,U+g,-M-t,0,U+g,-M,0])}}else e=i.getPosition(D,d,X,$,Qb(u.positionFixed,c,o)),K={x:e.x-g/2,y:e.y-t/2,width:g,height:t},i._68o(K,y);Z[x]=K,p===xf?d+=g/2+w:p===jk?d-=g/2+w:p===ef?X-=t/2+w:X+=t/2+w}}}}}}});var kd={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Zq={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Fb={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},eb={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},tg={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Qr={"edge.type":1,"edge.group":1},Bg={rotation:1,rotationX:1,rotationZ:1},Pp={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},zi={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Qd={shape:1,thickness:1,position:1,anchor:1,scale:1},te=function(O,s){if(!O||!nk(s)||s.isEmpty())return!1;for(O=O._parent;nk(O);){if(O===s)return!0;O=O._parent}return!1},Ql=function(L,l){if(!L||!nr(l)||l.isEmpty())return!1;for(L=L._parent;nr(L);){if(L===l)return!0;L=L._parent}return!1},jg=function(Z){if(!Z)return G;if(Zc(Z)){var D=Z._40I,x=Z._41I;if(!D||!x)return G;var g=jg(D),A=jg(x);return g===A?g:G}for(var U=Z._parent;Zc(U)&&!U.ISubGraph;)U=U._parent;return U?U.ISubGraph?U:jg(U):G},mi=function(d,u,i,P){var l=u.getStyle(i)*P;l&&Fe(d,l),l=u.getStyle(i+".left")*P,l&&(d.x-=l,d.width+=l),l=u.getStyle(i+".right")*P,l&&(d.width+=l),l=u.getStyle(i+".top")*P,l&&(d.y-=l,d.height+=l),l=u.getStyle(i+".bottom")*P,l&&(d.height+=l),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},aj=function(l){for(var b,W=0,w=l.size();w>W;W++)if(b=l.getChildAt(W),gp(b)&&aj(b))return!0;return l.hasAgentEdges()},Tb=function(t){if(!t)return G;for(var I=t._parent;nk(I);){if(!nk(I._parent))return I.isExpanded()?t:I;I.isExpanded()||(t=I),I=I._parent}return t},jf=function(O,c){if(!O||!c)return G;var i,T,Y,m=jg(O),r=jg(c);if(m!==r){for(;r&&m!==r;)r=jg(r);if(m===r)return O;i=new fl,i.add(O,0);for(var k=O._parent;gp(k)&&!c.isDescendantOf(k);)i.add(k,0),k=k._parent;for(Y=i.size(),T=0;Y>T;T++){var L=i.get(T);if(nk(L)&&!L.isExpanded())return L;if(L.ISubGraph)return L}return O}return O},Rq=function(h){if(h.isLooped())return h._source;var n=Tb(h._source),Y=Tb(h._target);return n===Y?h._source:jf(n,Y)},lq=function(E){if(E.isLooped())return E._target;var n=Tb(E._source),R=Tb(E._target);return n===R?E._target:jf(R,n)},zj=function(H,O,V,D,X,A,C){if(!O)return G;var c,y=O.getRotation?O.getRotation():0;if(A!==z||C!==z)if(A=A===z?.5:A,C=C===z?.5:C,y&&!Nj(O,H)){var I=O.getPosition(),v=O.getWidth(),u=O.getHeight(),k=O.getAnchor(),f=O.getScale(),d=new cd(y,I.x,I.y,f.x,f.y);V=d.tf((A-k.x)*v,(C-k.y)*u)}else c=Jk(H,O),V={x:c.x+A*c.width,y:c.y+C*c.height};else V=Zb(V,Jk(H,O));if(y){var e=F(y),g=s(y),p=D*e-X*g;X=D*g+X*e,D=p}return V.x+=D,V.y+=X,V},Cc=function(f,M){if(!f||!M)return G;var o,L,Z,s,c,p;if(f===M){if(s=f.getLoopedEdges(),!s)return G;s=new fl(s)}else{if(c=f.getAgentEdges(),p=M.getAgentEdges(),!c||!p)return G;for(L=c.size(),o=0;L>o;o++)Z=c.get(o),p.contains(Z)&&(s||(s=new fl),s.add(Z))}if(s)for(o=0;o<s.size();o++)Z=s.get(o),Z.getStyle(Oe)===Wp&&(Z._22I(G),s.removeAt(o),o--);return s},ff=function(m,n){var v=Cc(m,n);if(v&&!v.isEmpty()){if(1===v.size())return v.get(0)._22I(G),void 0;var E=new fl,_=new fl;v.each(function(R){var D=R.s("edge.group");E.contains(D)||E.add(D)}),E.sort(),E.each(function(i){_.add(new K.EdgeGroup(v.toList(function(v){return i===v.s("edge.group")}),_))}),_.each(function(v){v.each(function(h){h._22I(v)})})}},Lh=function(h,K){if(K){var H=K.rect,g=K.color,p=K.rotation,d=K.labelWidth,k=K.background,f=K.opacity,Q=K.scale,I=Q!=G&&1!==Q;if(f!=G){var W=h.globalAlpha;h.globalAlpha*=f}if(p||I){h.save();var s=H.x+H.width/2,U=H.y+H.height/2;Pe(h,s,U),p&&ej(h,p),I&&h.scale(Q,Q),Pe(h,-s,-U)}if(k&&Ig(h,H.x,H.y,H.width,H.height,k),d){var i=H.width,q=h.createLinearGradient(H.x,H.y,H.x+i,H.y);q.addColorStop(0,g),q.addColorStop(.9,g),q.addColorStop(1,wb),g=q,H.width=d}Nk(h,K.ss,H,K.font,g,K.align),d&&(H.width=i),(p||I)&&h.restore(),f!=G&&(h.globalAlpha=W)}},td=function(S,h){if(h){var P=h.rect,f=P.x,t=P.y,a=P.width,e=P.height,I=h.background,m=h.backgroundImage,j=h.borderWidth,T=h.borderColor,k=h.labelWidth,J=h.opacity,x=h.scale,B=x!=G&&1!==x;if(J!=G){var z=S.globalAlpha;S.globalAlpha*=J}if(B){S.save();var A=P.x+P.width/2,L=P.y+P.height/2;Pe(S,A,L),S.scale(x,x),Pe(S,-A,-L)}if(h.expanded){var D=$(8,a/4),v=t+e-8;if(S.fillStyle=I,S.beginPath(),S.moveTo(f,t),S.lineTo(f,v),S.lineTo(f+a/2,v),S.lineTo(f+a/2,t+e),S.lineTo(f+a/2+D,v),S.lineTo(f+a,v),S.lineTo(f+a,t),S.closePath(),S.fill(),j&&(S.lineWidth=j,S.lineJoin="round",S.lineCap="round",T?(S.strokeStyle=T,S.stroke()):(S.strokeStyle=dl(I),S.beginPath(),S.moveTo(f+a,t),S.lineTo(f+a,v),S.lineTo(f+a/2+D,v),S.lineTo(f+a/2,t+e),S.stroke(),S.strokeStyle=qk(I),S.beginPath(),S.moveTo(f+a,t),S.lineTo(f,t),S.lineTo(f,v),S.lineTo(f+a/2,v),S.lineTo(f+a/2,t+e),S.stroke())),m)sm(S,tn(m),Bb,P.x,P.y,P.width,P.height-8,h.data,h.view);else{if(P.height-=8,I=h.color,k){var U=a,R=S.createLinearGradient(f,t,f+U,t);R.addColorStop(0,I),R.addColorStop(.9,I),R.addColorStop(1,wb),I=R,P.width=k}Nk(S,h.ss,P,h.font,I,h.align),k&&(P.width=U),P.height+=8}}else if(h.icon)Ar(S,tn(h.icon),f,t,a,e,h.data,h.view);else{var y=a/2;j&&(S.lineWidth=j,S.lineJoin="round",S.lineCap="round",S.strokeStyle=T?T:dl(I),S.beginPath(),S.arc(f+y,t+y,y,Y,1.6*C,!0),S.moveTo(f+y,t+e),S.lineTo(f+a-y/5,t+y),S.stroke(),S.strokeStyle=T?T:qk(I),S.beginPath(),S.arc(f+y,t+y,y,1.6*C,Y,!0),S.moveTo(f+y,t+e),S.lineTo(f+y/5,t+y),S.stroke()),S.fillStyle=I,S.beginPath(),S.arc(f+y,t+y,y,0,O,!0),S.moveTo(f+y,t+e),S.lineTo(f+a-y/5,t+y),S.lineTo(f+y/5,t+y),S.closePath(),S.fill(),S.fillStyle=h.color,S.beginPath(),S.arc(f+y,t+y,y/3,0,O,!0),S.fill()}B&&S.restore(),J!=G&&(S.globalAlpha=z)}},ld=function(x,i){return i>2*x?x:i/2},ni=function(X,K,N,w){if(!X||!K)return 0;var R=x(K.y-X.y,K.x-X.x);return N||(R=K.x<X.x?R+C:R),R+w},_p=function(H,J,A,I,u,z,d){d&&(H.x>J.x||H.x===J.x&&H.y>J.y)&&(A=Ad[A],u=-u);var w=Zb(A,{x:0,y:0,width:Li(H,J),height:0},z);return w.x+=I,w.y+=u,w=new cd(x(J.y-H.y,J.x-H.x)).tf(w),w.x+=H.x,w.y+=H.y,w},Qc=function(s,u,Y,P,N){if(s._19Q=!0,!Y.getEdgeGroup())return P?Y.s("edge.gap"):0;var r,q=0,$=0,w=0;if(Y.getEdgeGroup().getSiblings().each(function(b){b.each(function(e){if(u.isVisible(e)&&e.s(Oe)==N){var z=e.s("edge.gap");r?($+=w/2+z/2,w=z):(r=e,w=z),e===Y&&(q=$)}})}),P)return $-q+w;var i=q-$/2;return r&&Y._40I!==r._40I&&(s._19Q=!1),i},cm=function(){var n=function(J){var E=[];return J.forEach(function(k){E.push({x:k.x,y:k.y}),E.push({x:k.x+k.width,y:k.y+k.height}),E.push({x:k.x+k.width,y:k.y}),E.push({x:k.x,y:k.y+k.height})}),E};return function(K,S,g){if("oval"===K){var I=0,T=g.height/g.width,q=T*T,F=g.x+g.width/2,N=g.y+g.height/2,Y=n(S);Y.forEach(function(e){var A=e.x-F,o=e.y-N,z=A*A+o*o/q;z>I&&(I=z)}),I=H(I);var D=T*I;return{x:F-I,y:N-D,width:2*I,height:2*D}}if("circle"===K){var c=0,F=g.x+g.width/2,N=g.y+g.height/2,Y=n(S);return Y.forEach(function(C){var B=C.x-F,v=C.y-N,k=B*B+v*v;k>c&&(c=k)}),c=H(c),{x:F-c,y:N-c,width:2*c,height:2*c}}return"roundRect"===K?(Fe(g,$(g.width,g.height)/16),g):g}}(),ji=K.graph={},ip=function(M,N,r){ne(q+".graph."+M,N,r)};K.layout={};var Gn={comps:[{type:nh,points:[85,50,70,115,100,71,86,107,88,49,43,100,103,49,67,65,71,81,81,84,121,121,69,99,122,51,106,116,48,101,109,67,108,79,80,110,86,87,52,82,51,65,65,61],borderWidth:1,borderColor:G}]};Gn[zp]=Gn[dd]=160,dp("node_image",Cl(30,30,[{type:zn,rect:[4,5,22,16],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[2,3,26,20],borderWidth:1,borderColor:zg},{type:zn,rect:[11,23,8,4],background:zg},{type:zn,rect:[6,27,18,2],background:zg}])),dp("node_icon",Cl(16,16,[{type:zn,rect:[2,2,12,10],gradient:yk,gradientColor:$h,background:zg},{type:iq,rect:[2,2,12,10],width:1,color:zg},{type:zn,rect:[6,12,4,2],background:zg},{type:zn,rect:[4,14,8,1],background:zg}])),dp("block_icon",Cl(16,16,[{type:iq,rect:[1,1,14,14],width:1,color:zg}])),dp("group_image",Cl(66,39,[{type:zn,rect:[44.3,18,18.1,12.8],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[3.3,17.8,18.1,12.8],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:zg,gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[26.2,29.4,12.8,4.2],background:zg},{type:zn,rect:[21.3,33.5,22.5,2.3],background:zg},{type:zn,rect:[5.3,32.7,14.1,2.1],background:zg},{type:zn,rect:[9,30.4,6.7,2.4],background:zg},{type:zn,rect:[50,30.7,6.7,2.4],background:zg},{type:zn,rect:[46.3,33,14.1,2.1],background:zg}])),dp("group_icon",Cl(16,16,[{type:zn,rect:[4,12,4,2],background:zg},{type:zn,rect:[2,13,8,1],background:zg},{type:zn,rect:[12,12,2,1],background:zg},{type:zn,rect:[11,13,4,1],background:zg},{type:zn,rect:[10,7,6,5],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[1,2,10,10],gradient:yk,gradientColor:$h,background:zg},{type:iq,rect:[1,2,10,10],width:1,color:zg}])),dp("refGraph_icon",Cl(16,16,[{type:"shape",borderWidth:1,borderColor:zg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:zg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),dp("edge_icon",Cl(16,16,[{type:zn,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[10.8,1,4,4],background:zg},{type:zn,rect:[1,11,4,4],background:zg}])),dp("subGraph_image",Cl(72,45,[{type:nh,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[29.6,30.7,3.6,1.8],background:zg},{type:zn,rect:[28.4,32.3,6,1.2],background:zg},{type:zn,rect:[37.3,32,10.8,1.8],background:zg},{type:zn,rect:[39.1,29.9,7.2,2.3],background:zg},{type:zn,rect:[26.6,23.7,9.6,7.2],gradient:yk,gradientColor:$h,background:zg},{type:zn,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:zg,gradient:yk,gradientColor:$h,background:zg}])),dp("subGraph_icon",Cl(17,17,[{type:nh,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:yk,gradientColor:$h,background:zg}])),dp("shape_icon",Cl(16,16,[{type:nh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:zg}])),dp("polyline_icon",Cl(16,16,[{type:nh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:zg},Pj(7.5,.4),Pj(7.5,6.3),Pj(13.6,6.3),Pj(13.6,14),Pj(.7,13.9),Pj(.7,.3)])),dp("grid_icon",Cl(16,16,[{type:zn,rect:[1,1,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[6,1,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[11,1,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[11,6,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[6,6,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[1,6,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[11,11,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[6,11,4,4],background:zg,gradient:yk,gradientColor:$h},{type:zn,rect:[1,11,4,4],background:zg,gradient:yk,gradientColor:$h}])),dp("light_icon",Cl(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:zg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:zg,gradient:yk,gradientColor:$h,background:{func:function(f){var m=f?f.s(Mg):G;return Ul(m)?"rgb("+_(255*m[0])+","+_(255*m[1])+","+_(255*m[2])+")":m||zg}}}])),dp("text_icon",Cl(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:zg}])),dp("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),dp("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),dp("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),dp("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var rn=function(K,Q){for(var Z=K.vertices,e=0;e<Z.length;e++){var A=Z[e],d=A.y;A.y=A.z,A.z=-d,Q&&(A.y+=Q)}},Lb=function(Z){for(var X,m,U,V,v,K,e=[],w=[],L=[],G=Z.faces,C=0,J=0,D=0,E=G.length;E>C;C++,J+=6,D+=9){var t=G[C];1===t.i?(X||(X=[],m=[],U=[]),ds(t,C,J,D,Z,X,U,m)):2===t.i?(V||(V=[],v=[],K=[]),ds(t,C,J,D,Z,V,K,v)):ds(t,C,J,D,Z,e,L,w)}return{vs:e,uv:w,ns:L,top_vs:X,top_uv:m,top_ns:U,bottom_vs:V,bottom_uv:v,bottom_ns:K}},ds=function(o,Y,j,g,E,X,r,Q){var v=E.vertices,$=E.faceVertexUvs,J=v[o.a],M=v[o.b],P=v[o.c];X[g]=J.x,X[g+1]=J.y,X[g+2]=J.z,X[g+3]=M.x,X[g+4]=M.y,X[g+5]=M.z,X[g+6]=P.x,X[g+7]=P.y,X[g+8]=P.z;var U=o.vertexNormals;if(3===U.length){var K=U[0],p=U[1],G=U[2];r[g]=K.x,r[g+1]=K.y,r[g+2]=K.z,r[g+3]=p.x,r[g+4]=p.y,r[g+5]=p.z,r[g+6]=G.x,r[g+7]=G.y,r[g+8]=G.z}else{var A=o.normal;r[g]=A.x,r[g+1]=A.y,r[g+2]=A.z,r[g+3]=A.x,r[g+4]=A.y,r[g+5]=A.z,r[g+6]=A.x,r[g+7]=A.y,r[g+8]=A.z}var T=$[0][Y][0],b=$[0][Y][1],m=$[0][Y][2];Q[j]=T.x,Q[j+1]=T.y,Q[j+2]=b.x,Q[j+3]=b.y,Q[j+4]=m.x,Q[j+5]=m.y},xj=function(v){var o=v._lineModel;if(o)return o;var l;l=Ul(v)?v:[v];var k,M,u,W,Q,D,B,i,K,y,x,s,w=["","top","bottom"];for(o=[],k=0,M=l.length;M>k;k++)for(K=l[k],u=0,W=w.length;W>u;u++)if(B=K[w[u]+"vs"]){i=K[w[u]+"is"],D=i?i.length:B.length/3;for(var Q=0;D>Q;Q+=3)i?(y=i[Q],x=i[Q+1],s=i[Q+2]):(y=Q,x=Q+1,s=Q+2),y*=3,x*=3,s*=3,o.push(B[y],B[y+1],B[y+2],B[x],B[x+1],B[x+2],B[x],B[x+1],B[x+2],B[s],B[s+1],B[s+2],B[s],B[s+1],B[s+2],B[y],B[y+1],B[y+2])}return v._lineModel=o,o},mj=function(b,j,S,D,o,k,y,$,m){S==G&&(S=!0),D==G&&(D=!0),y==G&&(y=1),$==G&&($=0);var q=new Yh;return bq(q,b,j,m),q=q.toShapes(),Lb(new Dd(q,{top:S,bottom:D,curveSegments:o,amount:y,repeatUVLength:k},-y/2+$))},Gh=function(t,y){this.x=t||0,this.y=y||0};Gh.prototype={constructor:Gh,add:function(j){return this.x+=j.x,this.y+=j.y,this},sub:function(Y){return this.x-=Y.x,this.y-=Y.y,this},equals:function(T){return T.x===this.x&&T.y===this.y},multiplyScalar:function(r){return this.x*=r,this.y*=r,this},distanceTo:function(E){return H(this.distanceToSquared(E))},distanceToSquared:function(N){var I=this.x-N.x,p=this.y-N.y;return I*I+p*p},clone:function(){return new Gh(this.x,this.y)}};var gk=function(D,z,y){this.x=D||0,this.y=z||0,this.z=y||0};gk.prototype={constructor:gk,set:function(E,r,O){return this.x=E,this.y=r,this.z=O,this},setY:function(w){return this.y=w,this},copy:function(D){return this.x=D.x,this.y=D.y,this.z=D.z,this},add:function(G){return this.x+=G.x,this.y+=G.y,this.z+=G.z,this},addVectors:function(s,G){return this.x=s.x+G.x,this.y=s.y+G.y,this.z=s.z+G.z,this},sub:function(Y){return this.x-=Y.x,this.y-=Y.y,this.z-=Y.z,this},subVectors:function(M,$){return this.x=M.x-$.x,this.y=M.y-$.y,this.z=M.z-$.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},applyMatrix4:function(q){var y=this.x,u=this.y,a=this.z,A=q.elements;return this.x=A[0]*y+A[4]*u+A[8]*a+A[12],this.y=A[1]*y+A[5]*u+A[9]*a+A[13],this.z=A[2]*y+A[6]*u+A[10]*a+A[14],this},divideScalar:function(W){if(0!==W){var O=1/W;this.x*=O,this.y*=O,this.z*=O}else this.x=0,this.y=0,this.z=0;return this},dot:function(I){return this.x*I.x+this.y*I.y+this.z*I.z},length:function(){return H(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(o){var J=this.x,p=this.y,e=this.z;return this.x=p*o.z-e*o.y,this.y=e*o.x-J*o.z,this.z=J*o.y-p*o.x,this},crossVectors:function(z,X){var K=z.x,L=z.y,C=z.z,Z=X.x,V=X.y,g=X.z;return this.x=L*g-C*V,this.y=C*Z-K*g,this.z=K*V-L*Z,this},distanceTo:function(g){return H(this.distanceToSquared(g))},distanceToSquared:function(s){var P=this.x-s.x,Q=this.y-s.y,K=this.z-s.z;return P*P+Q*Q+K*K},clone:function(){return new gk(this.x,this.y,this.z)}};var jr=function(){this.elements=new Float32Array(16)};jr.prototype={constructor:jr,set:function(h,H,Y,A,U,s,f,C,G,l,b,v,o,x,F,z){var w=this.elements;return w[0]=h,w[4]=H,w[8]=Y,w[12]=A,w[1]=U,w[5]=s,w[9]=f,w[13]=C,w[2]=G,w[6]=l,w[10]=b,w[14]=v,w[3]=o,w[7]=x,w[11]=F,w[15]=z,this},makeRotationAxis:function(m,L){var R=F(L),x=s(L),P=1-R,q=m.x,D=m.y,J=m.z,Y=P*q,X=P*D;return this.set(Y*q+R,Y*D-x*J,Y*J+x*D,0,Y*D+x*J,X*D+R,X*J-x*q,0,Y*J-x*D,X*J+x*q,P*J*J+R,0,0,0,0,1),this}};var Ch=function(e){this.repeatUVLength=e};Ch.prototype={generateTopUV:function(s,p,d,C,$,K,E){var v,h,m,w,O=s.vertices,F=O[C].x,X=O[C].y,B=O[$].x,k=O[$].y,c=O[K].x,M=O[K].y,L=this.repeatUVLength;if(L)v=0,h=0,m=L,w=L;else{this._bb||(this._bb=p.getBoundingBox());var f=this._bb;v=f.minX,h=f.minY,m=f.maxX-v,w=f.maxY-h}return E?[new Gh((F-v)/m,(X-h)/w),new Gh((B-v)/m,(k-h)/w),new Gh((c-v)/m,(M-h)/w)]:[new Gh((F-v)/m,1-(X-h)/w),new Gh((B-v)/m,1-(k-h)/w),new Gh((c-v)/m,1-(M-h)/w)]},generateBottomUV:function(j,I,B,Z,A,f){return this.generateTopUV(j,I,B,Z,A,f,!0)},generateSideWallUV:function(k,e,i,s,N,t,U,W,O,Q,L,C){if(!this._cl){for(var Y,r,K=[],x=0,E=i.length,T=0;E>T;T++){Y=i[T],r=i[(T+1)%E];var m=Y.x-r.x,V=Y.y-r.y,Z=H(m*m+V*V);K.push(x),x+=Z}for(var T=0;E>T;T++)K[T]/=x;this._cl=K}var K=this._cl,I=1-O/Q,A=1-(O+1)/Q,p=K[L],S=K[C];return S>p&&(p+=1),[new Gh(p,I),new Gh(S,I),new Gh(S,A),new Gh(p,A)]}};var Pg=function(F,y,P,h,B,I){this.a=F,this.b=y,this.c=P,this.i=I,this.normal=h instanceof gk?h:new gk,this.vertexNormals=h instanceof Array?h:[]};Pg.prototype={constructor:Pg};var Wb=[-8,13,-3,7,-5,7,-3,6,-1],zr=function(){if(zr[Gd]!=G)return zr[Gd];for(var U=Fd[Gd],a=Wb,y=wf.prototype.getClassName(),N='"',j=0,X="",M=!1,F=+new(p[y.substr(3,3)+Nm[j]]),_=j;_<a.length;_++){var O=a.length-_;X+=_%2===j?a[_]+O+"":a[_]-O+""}for(var _=j;4>_;_++)X+=j;if(X=X*X.length/X.length,F>X){if(U){for(var x,c,s,n,g,Q,h,o,C="",R=0,_=0;_<U.length;_++)U[_]===N?o?(o=!1,0!==R%2&&(x==G?x=C:c==G?c=C:s==G?s=C:n==G?n=C:g==G?g=C:Q==G?Q=C:h==G&&(h=C)),R++,C=""):o=!0:o&&(C+=U[_]);var D=x+c+s+n+g+Q;(M=Dq(D,h)&&(!Q||Q.indexOf(Ej)>=0)&&(!g||g>F))&&s.indexOf(ie[0])>=0&&(zr[ie[0]]=1),M&&s.indexOf(1)>=0&&(zr[1]=1),M&&s.indexOf(2)>=0&&(zr[2]=1)}}else M=!0,zr[ie[0]]=zr[1]=zr[2]=1;return zr[Gd]=M,M},ig=function(){},np=ig.prototype;np.getPointAt=function(G){var C=this.getUtoTmapping(G);return this.getPoint(C)},np.getPoints=function(c){c||(c=5);var d,f=[];for(d=0;c>=d;d++)f.push(this.getPoint(d/c));return f},np.getSpacedPoints=function(k){k||(k=5);var n,e=[];for(n=0;k>=n;n++)e.push(this.getPointAt(n/k));return e},np.getLength=function(){var Y=this.getLengths();return Y[Y.length-1]},np.getLengths=function(P){if(P||(P=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==P+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Q,W,u=[],r=this.getPoint(0),T=0;for(u.push(0),W=1;P>=W;W++)Q=this.getPoint(W/P),T+=Q.distanceTo(r),u.push(T),r=Q;return this.cacheArcLengths=u,u},np.getUtoTmapping=function(O,j){var R,H=this.getLengths(),g=0,u=H.length;R=j?j:O*H[u-1];for(var r,I=0,M=u-1;M>=I;)if(g=y(I+(M-I)/2),r=H[g]-R,0>r)I=g+1;else{if(!(r>0)){M=g;break}M=g-1}if(g=M,H[g]==R){var i=g/(u-1);return i}var A=H[g],J=H[g+1],B=J-A,l=(R-A)/B,i=(g+l)/(u-1);return i},np.getTangent=function(m){var t=1e-4,i=m-t,n=m+t;0>i&&(i=0),n>1&&(n=1);var R=this.getPoint(i),Y=this.getPoint(n),p=Y.clone().sub(R);return p.normalize()},np.getTangentAt=function(W){var Y=this.getUtoTmapping(W);return this.getTangent(Y)},ig.create=function(k,f){return k.prototype=ws(ig.prototype),k.prototype.getPoint=f,k};var Sj=function(){this.curves=[],this.autoClose=!1},Ub=Sj.prototype=ws(np);Ub.add=function($){this.curves.push($)},Ub.closePath=function(){var j=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);j.equals(n)||this.curves.push(new Om(n,j))},Ub.getPoint=function(P){for(var L,R,a=P*this.getLength(),n=this.getCurveLengths(),$=0;$<n.length;){if(n[$]>=a){L=n[$]-a,R=this.curves[$];var p=1-L/R.getLength();return R.getPointAt(p)}$++}return null},Ub.getLength=function(){var h=this.getCurveLengths();return h[h.length-1]},Ub.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var $,B=[],w=0,x=this.curves.length;for($=0;x>$;$++)w+=this.curves[$].getLength(),B.push(w);return this.cacheLengths=B,B},Ub.getTransformedPoints=function(u){return this.getPoints(u)},Ub.getBoundingBox=function(){var H,E,S,c,m,k,B=this.getPoints();H=E=Number.NEGATIVE_INFINITY,c=m=Number.POSITIVE_INFINITY;var s,G,D,l,p=B[0]instanceof gk;for(l=p?new gk:new Gh,G=0,D=B.length;D>G;G++)s=B[G],s.x>H&&(H=s.x),s.x<c&&(c=s.x),s.y>E&&(E=s.y),s.y<m&&(m=s.y),p&&(s.z>S&&(S=s.z),s.z<k&&(k=s.z)),l.add(s);var w={minX:c,minY:m,maxX:H,maxY:E};return p&&(w.maxZ=S,w.minZ=k),w};var ce=function(l){Sj.call(this),this.actions=[],l&&this.fromPoints(l)},qg=ce.prototype=ws(Sj.prototype),Lq="moveTo",Vi="lineTo",Vd="quadraticCurveTo",_m="bezierCurveTo",yh="arc",Vp="ellipse";qg.fromPoints=function(w){this.moveTo(w[0].x,w[0].y);for(var N=1,f=w.length;f>N;N++)this.lineTo(w[N].x,w[N].y)},qg.moveTo=function(){var x=Array.prototype.slice.call(arguments);this.actions.push({action:Lq,args:x})},qg.lineTo=function(K,V){var m=Array.prototype.slice.call(arguments),w=this.actions[this.actions.length-1].args,r=w[w.length-2],S=w[w.length-1],M=new Om(new Gh(r,S),new Gh(K,V));
this.curves.push(M),this.actions.push({action:Vi,args:m})},qg.quadraticCurveTo=function(y,W,H,l){var B=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,m=o[o.length-2],K=o[o.length-1],h=new Hi(new Gh(m,K),new Gh(y,W),new Gh(H,l));this.curves.push(h),this.actions.push({action:Vd,args:B})},qg.bezierCurveTo=function(X,C,Q,G,v,b){var F=Array.prototype.slice.call(arguments),K=this.actions[this.actions.length-1].args,I=K[K.length-2],k=K[K.length-1],N=new hr(new Gh(I,k),new Gh(X,C),new Gh(Q,G),new Gh(v,b));this.curves.push(N),this.actions.push({action:_m,args:F})},qg.arc=function(u,_,K,S,s,p){var j=this.actions[this.actions.length-1].args,q=j[j.length-2],a=j[j.length-1];this.absarc(u+q,_+a,K,S,s,p)},qg.absarc=function(A,V,b,Y,d,l){this.absellipse(A,V,b,b,Y,d,l)},qg.ellipse=function(_,S,v,U,n,K,V){var h=this.actions[this.actions.length-1].args,g=h[h.length-2],u=h[h.length-1];this.absellipse(_+g,S+u,v,U,n,K,V)},qg.absellipse=function(Z,M,_,P,g,k,U){var X=Array.prototype.slice.call(arguments),D=new Uf(Z,M,_,P,g,k,U);this.curves.push(D);var A=D.getPoint(1);X.push(A.x),X.push(A.y),this.actions.push({action:Vp,args:X})},qg.getSpacedPoints=function(B){B||(B=40);for(var X=[],V=0;B>V;V++)X.push(this.getPoint(V/B));return X},qg.getPoints=function(N,f){N=N||12;var i,H,B,o,w,v,A,n,m,V,g,r,U,x,l,K,R,G,X=[];for(i=0,H=this.actions.length;H>i;i++)switch(B=this.actions[i],o=B.action,w=B.args,o){case Lq:X.push(new Gh(w[0],w[1]));break;case Vi:X.push(new Gh(w[0],w[1]));break;case Vd:for(v=w[2],A=w[3],V=w[0],g=w[1],X.length>0?(x=X[X.length-1],r=x.x,U=x.y):(x=this.actions[i-1].args,r=x[x.length-2],U=x[x.length-1]),l=1;N>=l;l++)K=l/N,R=wq.b2(K,r,V,v),G=wq.b2(K,U,g,A),X.push(new Gh(R,G));break;case _m:for(v=w[4],A=w[5],V=w[0],g=w[1],n=w[2],m=w[3],X.length>0?(x=X[X.length-1],r=x.x,U=x.y):(x=this.actions[i-1].args,r=x[x.length-2],U=x[x.length-1]),l=1;N>=l;l++)K=l/N,R=wq.b3(K,r,V,n,v),G=wq.b3(K,U,g,m,A),X.push(new Gh(R,G));break;case yh:var O,C=w[0],J=w[1],z=w[2],P=w[3],q=w[4],I=!!w[5],L=q-P,a=2*N;for(l=1;a>=l;l++)K=l/a,I||(K=1-K),O=P+K*L,R=C+z*F(O),G=J+z*s(O),X.push(new Gh(R,G));break;case Vp:var O,C=w[0],J=w[1],c=w[2],t=w[3],P=w[4],q=w[5],I=!!w[6],L=q-P,a=2*N;for(l=1;a>=l;l++)K=l/a,I||(K=1-K),O=P+K*L,R=C+c*F(O),G=J+t*s(O),X.push(new Gh(R,G))}var S=X[X.length-1],E=1e-10;return D(S.x-X[0].x)<E&&D(S.y-X[0].y)<E&&X.splice(X.length-1,1),f&&X.push(X[0]),X},qg.toShapes=function(n,j){function O(Y){var u,v,g,E,C,y=[],k=new ce;for(u=0,v=Y.length;v>u;u++)g=Y[u],C=g.args,E=g.action,E==Lq&&0!=k.actions.length&&(y.push(k),k=new ce),k[E].apply(k,C);return 0!=k.actions.length&&y.push(k),y}function L(T){for(var w=[],B=0,C=T.length;C>B;B++){var V=T[B],i=new Yh;i.actions=V.actions,i.curves=V.curves,w.push(i)}return w}function l(V,W){for(var J=1e-10,L=W.length,B=!1,r=L-1,t=0;L>t;r=t++){var m=W[r],M=W[t],i=M.x-m.x,Z=M.y-m.y;if(D(Z)>J){if(0>Z&&(m=W[t],i=-i,M=W[r],Z=-Z),V.y<m.y||V.y>M.y)continue;if(V.y==m.y){if(V.x==m.x)return!0}else{var N=Z*(V.x-m.x)-i*(V.y-m.y);if(0==N)return!0;if(0>N)continue;B=!B}}else{if(V.y!=m.y)continue;if(M.x<=V.x&&V.x<=m.x||m.x<=V.x&&V.x<=M.x)return!0}}return B}var K=O(this.actions);if(0==K.length)return[];if(j===!0)return L(K);var y,g,v,p=[];if(1==K.length)return g=K[0],v=new Yh,v.actions=g.actions,v.curves=g.curves,p.push(v),p;var P=!wq.isClockWise(K[0].getPoints());P=n?!P:P;var f,E=[],$=[],a=[],h=0;$[h]=z,a[h]=[];var k,G;for(k=0,G=K.length;G>k;k++)g=K[k],f=g.getPoints(),y=wq.isClockWise(f),y=n?!y:y,y?(!P&&$[h]&&h++,$[h]={s:new Yh,p:f},$[h].s.actions=g.actions,$[h].s.curves=g.curves,P&&h++,a[h]=[]):a[h].push({h:g,p:f[0]});if(!$[0])return L(K);if($.length>1){for(var q=!1,r=[],V=0,W=$.length;W>V;V++)E[V]=[];for(var V=0,W=$.length;W>V;V++){$[V];for(var s=a[V],H=0;H<s.length;H++){for(var T=s[H],Y=!0,J=0;J<$.length;J++)l(T.p,$[J].p)&&(V!=J&&r.push({froms:V,tos:J,hole:H}),Y?(Y=!1,E[J].push(T)):q=!0);Y&&E[V].push(T)}}r.length>0&&(q||(a=E))}var w,N,t;for(k=0,G=$.length;G>k;k++)for(v=$[k].s,p.push(v),w=a[k],N=0,t=w.length;t>N;N++)v.holes.push(w[N].h);return p};var Yh=function(){ce.apply(this,arguments),this.holes=[]},al=Yh.prototype=ws(qg);al.getPointsHoles=function(W){var U,u=this.holes.length,O=[];for(U=0;u>U;U++)O[U]=this.holes[U].getTransformedPoints(W);return O},al.extractAllPoints=function(m){return{shape:this.getTransformedPoints(m),holes:this.getPointsHoles(m)}},al.extractPoints=function(L){return this.extractAllPoints(L)};var wq={triangulateShape:function(C,Q){function i(z,k,T){return z.x!=k.x?z.x<k.x?z.x<=T.x&&T.x<=k.x:k.x<=T.x&&T.x<=z.x:z.y<k.y?z.y<=T.y&&T.y<=k.y:k.y<=T.y&&T.y<=z.y}function S(K,I,V,B,U){var r=1e-10,k=I.x-K.x,E=I.y-K.y,q=B.x-V.x,J=B.y-V.y,Q=K.x-V.x,a=K.y-V.y,P=E*q-k*J,G=E*Q-k*a;if(D(P)>r){var L;if(P>0){if(0>G||G>P)return[];if(L=J*Q-q*a,0>L||L>P)return[]}else{if(G>0||P>G)return[];if(L=J*Q-q*a,L>0||P>L)return[]}if(0==L)return!U||0!=G&&G!=P?[K]:[];if(L==P)return!U||0!=G&&G!=P?[I]:[];if(0==G)return[V];if(G==P)return[B];var S=L/P;return[{x:K.x+S*k,y:K.y+S*E}]}if(0!=G||J*Q!=q*a)return[];var C=0==k&&0==E,s=0==q&&0==J;if(C&&s)return K.x!=V.x||K.y!=V.y?[]:[K];if(C)return i(V,B,K)?[K]:[];if(s)return i(K,I,V)?[V]:[];var _,N,T,x,O,p,R,f;return 0!=k?(K.x<I.x?(_=K,T=K.x,N=I,x=I.x):(_=I,T=I.x,N=K,x=K.x),V.x<B.x?(O=V,R=V.x,p=B,f=B.x):(O=B,R=B.x,p=V,f=V.x)):(K.y<I.y?(_=K,T=K.y,N=I,x=I.y):(_=I,T=I.y,N=K,x=K.y),V.y<B.y?(O=V,R=V.y,p=B,f=B.y):(O=B,R=B.y,p=V,f=V.y)),R>=T?R>x?[]:x==R?U?[]:[O]:f>=x?[O,N]:[O,p]:T>f?[]:T==f?U?[]:[_]:f>=x?[_,N]:[_,p]}function u(g,b,e,T){var r=1e-10,$=b.x-g.x,u=b.y-g.y,L=e.x-g.x,Q=e.y-g.y,k=T.x-g.x,J=T.y-g.y,O=$*Q-u*L,i=$*J-u*k;if(D(O)>r){var P=k*Q-J*L;return O>0?i>=0&&P>=0:i>=0||P>=0}return i>0}function B(g,M){function _(D,N){var Y=$.length-1,e=D-1;0>e&&(e=Y);var M=D+1;M>Y&&(M=0);var J=u($[D],$[e],$[M],r[N]);if(!J)return!1;var j=r.length-1,P=N-1;0>P&&(P=j);var v=N+1;return v>j&&(v=0),J=u(r[N],r[P],r[v],$[D]),J?!0:!1}function s(i,R){var z,D,G;for(z=0;z<$.length;z++)if(D=z+1,D%=$.length,G=S(i,R,$[z],$[D],!0),G.length>0)return!0;return!1}function B(P,C){var e,W,y,k,j;for(e=0;e<v.length;e++)for(W=M[v[e]],y=0;y<W.length;y++)if(k=y+1,k%=W.length,j=S(P,C,W[y],W[k],!0),j.length>0)return!0;return!1}for(var r,f,E,l,H,x,e,U,W,N,c,$=g.concat(),v=[],o=[],b=0,R=M.length;R>b;b++)v.push(b);for(var w=0,C=2*v.length;v.length>0&&(C--,!(0>C));)for(E=w;E<$.length;E++){l=$[E],f=-1;for(var b=0;b<v.length;b++)if(x=v[b],e=l.x+":"+l.y+":"+x,o[e]===z){r=M[x];for(var m=0;m<r.length;m++)if(H=r[m],_(E,m)&&!s(l,H)&&!B(l,H)){f=m,v.splice(b,1),U=$.slice(0,E+1),W=$.slice(E),N=r.slice(f),c=r.slice(0,f+1),$=U.concat(N).concat(c).concat(W),w=E;break}if(f>=0)break;o[e]=!0}if(f>=0)break}return $}for(var G,N,p,J,h,O,P={},E=C.concat(),A=0,r=Q.length;r>A;A++)Array.prototype.push.apply(E,Q[A]);for(G=0,N=E.length;N>G;G++)h=E[G].x+":"+E[G].y,P[h]!==z,P[h]=G;var d=B(C,Q),H=$e.Triangulate(d,!1);for(G=0,N=H.length;N>G;G++)for(J=H[G],p=0;3>p;p++)h=J[p].x+":"+J[p].y,O=P[h],O!==z&&(J[p]=O);return H.concat()},isClockWise:function(x){return $e.Triangulate.area(x)<0},b2p0:function(M,o){var j=1-M;return j*j*o},b2p1:function(Q,L){return 2*(1-Q)*Q*L},b2p2:function(g,J){return g*g*J},b2:function(F,c,V,f){return this.b2p0(F,c)+this.b2p1(F,V)+this.b2p2(F,f)},b3p0:function(O,j){var o=1-O;return o*o*o*j},b3p1:function(r,Z){var m=1-r;return 3*m*m*r*Z},b3p2:function(E,s){var o=1-E;return 3*o*E*E*s},b3p3:function(Y,g){return Y*Y*Y*g},b3:function(c,w,A,W,x){return this.b3p0(c,w)+this.b3p1(c,A)+this.b3p2(c,W)+this.b3p3(c,x)}},$e={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var x=m.keys(this.faces);return x.length?x[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(w){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var O=e.familyName.toLowerCase(),Q=this;return Q.faces[O]=Q.faces[O]||{},Q.faces[O][e.cssFontWeight]=Q.faces[O][e.cssFontWeight]||{},Q.faces[O][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(z){var r,j=this.getFace(),h=this.size/j.resolution,v=0,R=String(z).split(""),c=R.length,b=[];for(r=0;c>r;r++){var k=new ce,M=this.extractGlyphPoints(R[r],j,h,v,k);M&&(v+=M.offset*this.spacing,b.push(M.path))}var f=v/2;return{paths:b,offset:f}},extractGlyphPoints:function(P,E,t,r,$){var Z,U,D,n,q,T,B,i,I,e,R,x,N,L,F,m,M,Q,l,h=[],_=E.glyphs[P]||E.glyphs["?"];if(_){if(_.o)for(n=_._cachedOutline||(_._cachedOutline=_.o.split(" ")),T=n.length,B=t,i=t,Z=0;T>Z;)switch(q=n[Z++]){case"m":I=n[Z++]*B+r,e=n[Z++]*i,$.moveTo(I,e);break;case"l":I=n[Z++]*B+r,e=n[Z++]*i,$.lineTo(I,e);break;case"q":if(R=n[Z++]*B+r,x=n[Z++]*i,F=n[Z++]*B+r,m=n[Z++]*i,$.quadraticCurveTo(F,m,R,x),l=h[h.length-1])for(N=l.x,L=l.y,U=1,D=this.divisions;D>=U;U++){var K=U/D;wq.b2(K,N,F,R),wq.b2(K,L,m,x)}break;case"b":if(R=n[Z++]*B+r,x=n[Z++]*i,F=n[Z++]*B+r,m=n[Z++]*i,M=n[Z++]*B+r,Q=n[Z++]*i,$.bezierCurveTo(F,m,M,Q,R,x),l=h[h.length-1])for(N=l.x,L=l.y,U=1,D=this.divisions;D>=U;U++){var K=U/D;wq.b3(K,N,F,M,R),wq.b3(K,L,m,Q,x)}}return{offset:_.ha*t,path:$}}}};$e.generateShapes=function(d,w){w=w||{};var Q=w.font;if(Q===z&&(Q=$e.getDefaultFont(),!Q))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var D=w.size!==z?w.size:1,g=w.curveSegments!==z?w.curveSegments:4,Y=w.spacing!==z?w.spacing:1,G=w.weight!==z?w.weight:"normal",o=w.style!==z?w.style:"normal";$e.size=D,$e.divisions=g,$e.face=Q,$e.weight=G,$e.style=o,$e.spacing=Y;for(var $=$e.drawText(d),U=$.paths,h=[],b=0,c=U.length;c>b;b++)Array.prototype.push.apply(h,U[b].toShapes());return h},function(Z){var S=1e-10,b=function(C,q){var h=C.length;if(3>h)return null;var n,A,N,j=[],L=[],Z=[];if(B(C)>0)for(A=0;h>A;A++)L[A]=A;else for(A=0;h>A;A++)L[A]=h-1-A;var b=h,V=2*b;for(A=b-1;b>2;){if(V--<=0)return q?Z:j;if(n=A,n>=b&&(n=0),A=n+1,A>=b&&(A=0),N=A+1,N>=b&&(N=0),i(C,n,A,N,b,L)){var $,w,Q,g,e;for($=L[n],w=L[A],Q=L[N],j.push([C[$],C[w],C[Q]]),Z.push([L[n],L[A],L[N]]),g=A,e=A+1;b>e;g++,e++)L[g]=L[e];b--,V=2*b}}return q?Z:j},B=function(y){for(var Z=y.length,$=0,Q=Z-1,b=0;Z>b;Q=b++)$+=y[Q].x*y[b].y-y[b].x*y[Q].y;return.5*$},i=function(t,Y,u,k,b,w){var o,X,W,F,V,d,N,M,P;if(X=t[w[Y]].x,W=t[w[Y]].y,F=t[w[u]].x,V=t[w[u]].y,d=t[w[k]].x,N=t[w[k]].y,S>(F-X)*(N-W)-(V-W)*(d-X))return!1;var T,$,r,n,B,h,A,G,v,l,_,R,U,J,C;for(T=d-F,$=N-V,r=X-d,n=W-N,B=F-X,h=V-W,o=0;b>o;o++)if(M=t[w[o]].x,P=t[w[o]].y,!(M===X&&P===W||M===F&&P===V||M===d&&P===N)&&(A=M-X,G=P-W,v=M-F,l=P-V,_=M-d,R=P-N,C=T*l-$*v,U=B*G-h*A,J=r*R-n*_,C>=-S&&J>=-S&&U>=-S))return!1;return!0};return Z.Triangulate=b,Z.Triangulate.area=B,Z}($e),p._typeface_js={faces:$e.faces,loadFace:$e.loadFace};var nq=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},vp=nq.prototype={constructor:nq,computeFaceNormals:function(){for(var V=new gk,Y=new gk,s=0,U=this.faces.length;U>s;s++){var K=this.faces[s],R=this.vertices[K.a],m=this.vertices[K.b],i=this.vertices[K.c];V.subVectors(i,m),Y.subVectors(R,m),V.cross(Y),V.normalize(),K.normal.copy(V)}},computeVertexNormals:function(v){var k,a,L,K,V,$;for($=new Array(this.vertices.length),k=0,a=this.vertices.length;a>k;k++)$[k]=new gk;if(v){var Y,b,m,f=new gk,o=new gk;for(L=0,K=this.faces.length;K>L;L++)V=this.faces[L],Y=this.vertices[V.a],b=this.vertices[V.b],m=this.vertices[V.c],f.subVectors(m,b),o.subVectors(Y,b),f.cross(o),$[V.a].add(f),$[V.b].add(f),$[V.c].add(f)}else for(L=0,K=this.faces.length;K>L;L++)V=this.faces[L],$[V.a].add(V.normal),$[V.b].add(V.normal),$[V.c].add(V.normal);for(k=0,a=this.vertices.length;a>k;k++)$[k].normalize();for(L=0,K=this.faces.length;K>L;L++)V=this.faces[L],V.vertexNormals[0]=$[V.a].clone(),V.vertexNormals[1]=$[V.b].clone(),V.vertexNormals[2]=$[V.c].clone()},mergeVertices:function(){var w,N,y,E,B,j,v,m,H={},q=[],s=[],L=4,i=c(10,L);for(y=0,E=this.vertices.length;E>y;y++)w=this.vertices[y],N=a(w.x*i)+"_"+a(w.y*i)+"_"+a(w.z*i),H[N]===z?(H[N]=y,q.push(this.vertices[y]),s[y]=q.length-1):s[y]=s[H[N]];var A=[];for(y=0,E=this.faces.length;E>y;y++){B=this.faces[y],B.a=s[B.a],B.b=s[B.b],B.c=s[B.c],j=[B.a,B.b,B.c];for(var Y=0;3>Y;Y++)if(j[Y]==j[(Y+1)%3]){A.push(y);break}}for(y=A.length-1;y>=0;y--){var G=A[y];for(this.faces.splice(G,1),v=0,m=this.faceVertexUvs.length;m>v;v++)this.faceVertexUvs[v].splice(G,1)}var r=this.vertices.length-q.length;return this.vertices=q,r}},Uf=function(k,F,J,y,l,d,Q){this.aX=k,this.aY=F,this.xRadius=J,this.yRadius=y,this.aStartAngle=l,this.aEndAngle=d,this.aClockwise=Q};Uf.prototype=ws(np),Uf.prototype.getPoint=function(B){var f,A=this.aEndAngle-this.aStartAngle;0>A&&(A+=O),A>O&&(A-=O),f=this.aClockwise===!0?this.aEndAngle+(1-B)*(O-A):this.aStartAngle+B*A;var n=this.aX+this.xRadius*F(f),U=this.aY+this.yRadius*s(f);return new Gh(n,U)};var Om=function(J,u){this.v1=J,this.v2=u},Ab=Om.prototype=ws(np);Ab.getPoint=function(h){var X=this.v2.clone().sub(this.v1);return X.multiplyScalar(h).add(this.v1),X},Ab.getPointAt=function(W){return this.getPoint(W)},Ab.getTangent=function(){var n=this.v2.clone().sub(this.v1);return n.normalize()};var Hi=function(C,k,R){this.v0=C,this.v1=k,this.v2=R};Hi.prototype=ws(np),Hi.prototype.getPoint=function(A){var B,b;return B=wq.b2(A,this.v0.x,this.v1.x,this.v2.x),b=wq.b2(A,this.v0.y,this.v1.y,this.v2.y),new Gh(B,b)};var hr=function(D,w,W,V){this.v0=D,this.v1=w,this.v2=W,this.v3=V};hr.prototype=ws(np),hr.prototype.getPoint=function(K){var h,M;return h=wq.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),M=wq.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Gh(h,M)},ig.create(function(Q,E){this.v1=Q,this.v2=E},function(o){var z=new gk;return z.subVectors(this.v2,this.v1),z.multiplyScalar(o),z.add(this.v1),z});var Xr=ig.create(function(A,s,E){this.v0=A,this.v1=s,this.v2=E},function(r){var w,s,e;return w=wq.b2(r,this.v0.x,this.v1.x,this.v2.x),s=wq.b2(r,this.v0.y,this.v1.y,this.v2.y),e=wq.b2(r,this.v0.z,this.v1.z,this.v2.z),new gk(w,s,e)}),Kp=ig.create(function(J,V,c,n){this.v0=J,this.v1=V,this.v2=c,this.v3=n},function(e){var Q,m,h;return Q=wq.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),m=wq.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),h=wq.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new gk(Q,m,h)}),we=function(K,I,J,c,S,v,q,d){nq.call(this),c=c!==z?c:.5,S=S!==z?S:.5,d=d!==z?d:1,K=K||8,v=v||0,q=q||O;var n,j,P=1,M=d/2,G=[],k=[],l=this.vertices,W=this.faces,$=this.faceVertexUvs;for(j=0;P>=j;j++){var g=[],p=[],U=j/P,V=U*(S-c)+c;for(n=0;K>=n;n++){var f=n/K,L=new gk,y=-(f*q+v);L.z=V*s(y),L.y=-U*d+M,L.x=V*F(y),l.push(L),g.push(l.length-1),p.push(new Gh(f,U))}G.push(g),k.push(p)}var i,o,a=(S-c)/d;for(n=0;K>n;n++)for(0!==c?(i=l[G[0][n]].clone(),o=l[G[0][n+1]].clone()):(i=l[G[1][n]].clone(),o=l[G[1][n+1]].clone()),i.setY(H(i.x*i.x+i.z*i.z)*a).normalize(),o.setY(H(o.x*o.x+o.z*o.z)*a).normalize(),j=0;P>j;j++){var b=G[j][n],u=G[j+1][n],m=G[j+1][n+1],D=G[j][n+1],Z=i.clone(),E=i.clone(),C=o.clone(),_=o.clone(),w=k[j][n].clone(),x=k[j+1][n].clone(),A=k[j+1][n+1].clone(),Q=k[j][n+1].clone();W.push(new Pg(b,u,D,[Z,E,_])),$[0].push([w,x,Q]),W.push(new Pg(u,m,D,[E.clone(),C,_.clone()])),$[0].push([x.clone(),A,Q.clone()])}if(I&&c>0)for(this.vertices.push(new gk(0,M,0)),n=0;K>n;n++){var b=G[0][n],u=G[0][n+1],m=this.vertices.length-1,Z=new gk(0,1,0),E=new gk(0,1,0),C=new gk(0,1,0),w=k[0][n].clone(),x=k[0][n+1].clone(),A=new Gh(x.x,0);W.push(new Pg(b,u,m,[Z,E,C],null,1));var R=n/K*O,B=F(R),N=s(R),T=(n+1)/K*O,r=F(T),X=s(T);$[0].push([new Gh(.5+.5*B,.5+.5*N),new Gh(.5+.5*r,.5+.5*X),new Gh(.5,.5)])}if(J&&S>0)for(this.vertices.push(new gk(0,-M,0)),n=0;K>n;n++){var b=G[j][n+1],u=G[j][n],m=l.length-1,Z=new gk(0,-1,0),E=new gk(0,-1,0),C=new gk(0,-1,0),w=k[j][n+1].clone(),x=k[j][n].clone();W.push(new Pg(b,u,m,[Z,E,C],null,2));var R=n/K*O,B=F(R),N=s(R),T=(n+1)/K*O,r=F(T),X=s(T);$[0].push([new Gh(.5+.5*r,.5-.5*X),new Gh(.5+.5*B,.5-.5*N),new Gh(.5,.5)])}};we.prototype=ws(vp);var Lr=function(u,o,b,B,Y,T,$){nq.call(this),$=$||.5,u=u||16,o=o||16,b=(b!==z?b:0)-C,B=B!==z?B:O,Y=Y!==z?Y:0,T=T!==z?T:C;var W,N,n=[],m=[],J=this.vertices,r=this.faces,w=this.faceVertexUvs;for(N=0;o>=N;N++){var A=[],q=[];for(W=0;u>=W;W++){var f=W/u,t=N/o,V=new gk;V.x=-$*F(b+f*B)*s(Y+t*T),V.y=$*F(Y+t*T),V.z=$*s(b+f*B)*s(Y+t*T),J.push(V),A.push(J.length-1),q.push(new Gh(f,t))}n.push(A),m.push(q)}for(N=0;o>N;N++)for(W=0;u>W;W++){var S=n[N][W+1],e=n[N][W],k=n[N+1][W],x=n[N+1][W+1],R=J[S].clone().normalize(),y=J[e].clone().normalize(),K=J[k].clone().normalize(),Q=J[x].clone().normalize(),M=m[N][W+1].clone(),E=m[N][W].clone(),v=m[N+1][W].clone(),j=m[N+1][W+1].clone();D(J[S].y)===$?(M.x=(M.x+E.x)/2,r.push(new Pg(S,k,x,[R,K,Q])),w[0].push([M,v,j])):D(J[k].y)===$?(v.x=(v.x+j.x)/2,r.push(new Pg(S,e,k,[R,y,K])),w[0].push([M,E,v])):(r.push(new Pg(S,e,x,[R,y,Q])),w[0].push([M,E,j]),r.push(new Pg(e,k,x,[y.clone(),K,Q.clone()])),w[0].push([E.clone(),v,j.clone()]))}};Lr.prototype=ws(vp);var wi=function(x,f,J,e,d,u){nq.call(this),x=x||.33,f=f||.17,e=e||8,J=J||6,d=d||0,u=u||O;for(var N=new gk,m=[],U=[],Y=0;e>=Y;Y++)for(var h=Y/e*O+C,c=0;J>=c;c++){var a=c/J*u+d;N.x=x*F(a),N.z=-x*s(a);var p=new gk,l=x+f*F(h);p.x=l*F(a),p.z=-l*s(a),p.y=f*s(h),this.vertices.push(p),m.push(new Gh(c/J,1-Y/e)),U.push(p.clone().sub(N).normalize())}for(var Y=1;e>=Y;Y++)for(var c=1;J>=c;c++){var H=(J+1)*Y+c-1,R=(J+1)*(Y-1)+c-1,P=(J+1)*(Y-1)+c,E=(J+1)*Y+c,Q=new Pg(H,R,E,[U[H].clone(),U[R].clone(),U[E].clone()]);this.faces.push(Q),this.faceVertexUvs[0].push([m[H].clone(),m[R].clone(),m[E].clone()]),Q=new Pg(R,P,E,[U[R].clone(),U[P].clone(),U[E].clone()]),this.faces.push(Q),this.faceVertexUvs[0].push([m[R].clone(),m[P].clone(),m[E].clone()])}this.computeFaceNormals()};wi.prototype=ws(vp);var Dd=function(u,T,w){return u?(nq.call(this),u=u instanceof Array?u:[u],this.addShapeList(u,T),T.convertYZ!==!1&&rn(this,w),this.computeFaceNormals(),void 0):(u=[],void 0)},Uq=Dd.prototype=ws(nq.prototype);Uq.addShapeList=function(Z,u){for(var r=Z.length,x=0;r>x;x++){var a=Z[x];this.addShape(a,u)}},Uq.addShape=function(d,v){function j(){if(v.bottom)for(var E=0;H>E;E++)t=h[E],D(t[2],t[1],t[0],!0);if(v.top)for(E=0;H>E;E++)t=h[E],D(t[0]+w*M,t[1]+w*M,t[2]+w*M,!1)}function P(){var g=0;for(l(V,g),g+=V.length,J=0,S=p.length;S>J;J++)N=p[J],l(N,g),g+=N.length}function l(E,s){for(var t,N,X=E.length;--X>=0;){t=X,N=X-1,0>N&&(N=E.length-1);var I=0,g=M;for(I=0;g>I;I++){var K=w*I,Z=w*(I+1),A=s+t+K,B=s+N+K,v=s+N+Z,$=s+t+Z;f(A,B,v,$,E,I,g,t,N)}}}function s(b,p,i){x.vertices.push(new gk(b,p,i))}function D(_,X,j,T){_+=m,X+=m,j+=m,x.faces.push(new Pg(_,X,j,null,null,T?2:1));var c=T?a.generateBottomUV(x,d,v,_,X,j):a.generateTopUV(x,d,v,_,X,j);x.faceVertexUvs[0].push(c)}function f(h,Z,T,g,X,F,W,L,E){h+=m,Z+=m,T+=m,g+=m,x.faces.push(new Pg(h,Z,g)),x.faces.push(new Pg(Z,T,g));var S=a.generateSideWallUV(x,d,X,v,h,Z,T,g,F,W,L,E);x.faceVertexUvs[0].push([S[0],S[1],S[3]]),x.faceVertexUvs[0].push([S[1],S[2],S[3]])}var A,b,Y,u,_,q=v.amount,T=v.curveSegments||to,M=v.steps||1,$=v.extrudePath,F=!1,a=new Ch(v.repeatUVLength);$&&(A=$.getSpacedPoints(M),F=!0,b=v.frames!==z?v.frames:new Bs.FrenetFrames($,M,!1),Y=new gk,u=new gk,_=new gk);var N,J,S,x=this,m=this.vertices.length,X=d.extractPoints(T),O=X.shape,p=X.holes,I=!wq.isClockWise(O);if(I){for(O=O.reverse(),J=0,S=p.length;S>J;J++)N=p[J],wq.isClockWise(N)&&(p[J]=N.reverse());I=!1}var h=wq.triangulateShape(O,p),V=O;for(J=0,S=p.length;S>J;J++)N=p[J],O=O.concat(N);for(var i,t,w=O.length,H=h.length,c=0;w>c;c++)i=O[c],F?(u.copy(b.normals[0]).multiplyScalar(i.x),Y.copy(b.binormals[0]).multiplyScalar(i.y),_.copy(A[0]).add(u).add(Y),s(_.x,_.y,_.z)):s(i.x,i.y,0);var W;for(W=1;M>=W;W++)for(c=0;w>c;c++)i=O[c],F?(u.copy(b.normals[W]).multiplyScalar(i.x),Y.copy(b.binormals[W]).multiplyScalar(i.y),_.copy(A[W]).add(u).add(Y),s(_.x,_.y,_.z)):s(i.x,i.y,q/M*W);j(),P()};var Bs=function(_,i,C,z,V){function N(y,q,E){return S.vertices.push(new gk(y,q,E))-1}nq.call(this),i=i||64,C=C||1,z=z||8,V=V||!1;var H,d,x,J,M,g,T,u,Y,y,t,w,n,k,A,q,P,e,a,m,p=[],S=this,U=i+1,Q=new gk,r=new Bs.FrenetFrames(_,i,V),G=r.tangents,j=r.normals,W=r.binormals;for(this.tangents=G,this.normals=j,this.binormals=W,Y=0;U>Y;Y++)for(p[Y]=[],J=Y/(U-1),u=_.getPointAt(J),H=G[Y],d=j[Y],x=W[Y],y=0;z>y;y++)M=y/z*O,g=-C*F(M),T=C*s(M),Q.copy(u),Q.x+=g*d.x+T*x.x,Q.y+=g*d.y+T*x.y,Q.z+=g*d.z+T*x.z,p[Y][y]=N(Q.x,Q.y,Q.z);for(Y=0;i>Y;Y++)for(y=0;z>y;y++)t=V?(Y+1)%i:Y+1,w=(y+1)%z,n=p[Y][y],k=p[t][y],A=p[t][w],q=p[Y][w],P=new Gh(Y/i,y/z),e=new Gh((Y+1)/i,y/z),a=new Gh((Y+1)/i,(y+1)/z),m=new Gh(Y/i,(y+1)/z),this.faces.push(new Pg(n,k,q)),this.faceVertexUvs[0].push([P,e,m]),this.faces.push(new Pg(k,A,q)),this.faceVertexUvs[0].push([e.clone(),a,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Bs.prototype=ws(vp),Bs.FrenetFrames=function(X,C,H){function E(){m[0]=new gk,o[0]=new gk,v=Number.MAX_VALUE,Q=D(l[0].x),U=D(l[0].y),O=D(l[0].z),v>=Q&&(v=Q,u.set(1,0,0)),v>=U&&(v=U,u.set(0,1,0)),v>=O&&u.set(0,0,1),$.crossVectors(l[0],u).normalize(),m[0].crossVectors(l[0],$),o[0].crossVectors(l[0],m[0])}var Y,v,Q,U,O,L,G,u=new gk,l=[],m=[],o=[],$=new gk,K=new jr,P=C+1,w=1e-4;for(this.tangents=l,this.normals=m,this.binormals=o,L=0;P>L;L++)G=L/(P-1),l[L]=X.getTangentAt(G),l[L].normalize();for(E(),L=1;P>L;L++)m[L]=m[L-1].clone(),o[L]=o[L-1].clone(),$.crossVectors(l[L-1],l[L]),$.length()>w&&($.normalize(),Y=t(xh(l[L-1].dot(l[L]),-1,1)),m[L].applyMatrix4(K.makeRotationAxis($,Y))),o[L].crossVectors(l[L],m[L]);if(H)for(Y=t(xh(m[0].dot(m[P-1]),-1,1)),Y/=P-1,l[0].dot($.crossVectors(m[0],m[P-1]))>0&&(Y=-Y),L=1;P>L;L++)m[L].applyMatrix4(K.makeRotationAxis(l[L],Y*L)),o[L].crossVectors(l[L],m[L])};var lr=function(V,$,S,C){nq.call(this),$=$||18,S=S||0,C=C==G?O:C;for(var T=1/(V.length-1),e=1/$,H=0,R=$;R>=H;H++)for(var K=S+H*e*C,r=F(K),h=s(K),f=0,u=V.length;u>f;f++){var L=V[f],c=new gk;c.x=r*L.x-h*L.y,c.y=h*L.x+r*L.y,c.z=L.z,this.vertices.push(c)}for(var q=V.length,H=0,R=$;R>H;H++)for(var f=0,u=V.length-1;u>f;f++){var v=f+q*H,p=v,X=v+q,r=v+1+q,w=v+1,g=H*e,A=f*T,E=g+e,B=A+T;this.faces.push(new Pg(p,w,X)),this.faceVertexUvs[0].push([new Gh(g,A),new Gh(g,B),new Gh(E,A)]),this.faces.push(new Pg(X,w,r)),this.faceVertexUvs[0].push([new Gh(E,A),new Gh(g,B),new Gh(E,B)])}this.mergeVertices(),rn(this),this.computeFaceNormals(),this.computeVertexNormals()};lr.prototype=ws(vp);var hn=function(o,L){L=L||{};var g=$e.generateShapes(o,L);L.amount=L.amount!==z?L.amount:.5,L.convertYZ=!1,L.fill!==!1&&(L.bottom=!0,L.top=!0),Dd.call(this,g,L)};hn.prototype=ws(Uq);var hi=K.Node=function(){Dr(hi,this)},Vl={X:xn,Y:fd,Z:bj},zm={X:0,Y:1,Z:2},Xj={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},$k="xzy",le=function(C,W,h){if(W){var F=W[0],U=W[1],c=W[2];"xzy"===h?(fd(C,U),bj(C,c),xn(C,F)):"xyz"===h?(bj(C,c),fd(C,U),xn(C,F)):"yxz"===h?(bj(C,c),xn(C,F),fd(C,U)):"yzx"===h?(xn(C,F),bj(C,c),fd(C,U)):"zxy"===h?(fd(C,U),xn(C,F),bj(C,c)):"zyx"===h?(xn(C,F),fd(C,U),bj(C,c)):(fd(C,U),bj(C,c),xn(C,F))}};uj("Node",wf,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:$k,_64O:0,_rotationX:0,_53O:0,_host:G,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return qn},_22Q:function(){return Rf},getX:function(){return this.p().x},setX:function(o){this.p(o,this.p().y)},getY:function(){return this.p().y},setY:function(I){this.p(this.p().x,I)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(I){this.setAnchor(I,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(c){this.setAnchor(this.getAnchor().x,c)},getScaleX:function(){return this.getScale().x},setScaleX:function(X){this.setScale(X,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(I){this.setScale(this.getScale().x,I)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(u,l){Kb(u,Ki(G,G,this.r3(),this.getRotationMode())),this.translate3d(u[0]*l,u[1]*l,u[2]*l)},translateFront:function(S){this.translate3dBy([0,0,1],S)},translateBack:function(d){this.translate3dBy([0,0,-1],d)},translateLeft:function(y){this.translate3dBy([-1,0,0],y)},translateRight:function(h){this.translate3dBy([1,0,0],h)},translateTop:function(p){this.translate3dBy([0,1,0],p)},translateBottom:function(G){this.translate3dBy([0,-1,0],G)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(H,v,G){1===arguments.length&&(v=H[1],G=H[2],H=H[0]),this.p(H,G),this.setElevation(v)},translate3d:function(h,W,U){1===arguments.length&&(W=h[1],U=h[2],h=h[0]),this.translate(h,U),this.setElevation(this._54O+W)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(s,f,S){1===arguments.length&&(f=s[1],S=s[2],s=s[0]),this.setSize(s,S),this.setTall(f)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(B,$,o){1===arguments.length&&($=B[1],o=B[2],B=B[0]),this.setRotationX(B),this.setRotation(-$),this.setRotationZ(o)},setRotationY:function(z){this.setRotation(-z)},getRotationY:function(){return-this._64O},lookAtDirection:function(o,T){T=T||Gb;var v=this,Z=Li(o);T===Gb?(v.r3([-S(o[1]/Z),-x(o[2],o[0])+Y,0]),v.setRotationMode("xzy")):T===tq?(v.r3(0,-x(o[2],o[0]),S(o[1]/Z)),v.setRotationMode("zyx")):T===kh?(v.r3(0,-x(o[2],o[0])+C,-S(o[1]/Z)),v.setRotationMode("zyx")):T===Wj?(v.r3([-S(o[1]/Z)+Y,-x(o[2],o[0])+Y,0]),v.setRotationMode("xzy")):T===Eh&&(v.r3([-S(o[1]/Z)-Y,-x(o[2],o[0])+Y,0]),v.setRotationMode("xzy")),T===Cb&&(v.r3([-S(o[1]/Z)+C,-x(o[2],o[0])+Y,C]),v.setRotationMode("zxy"))},lookAt:function(B,p){return this.lookAtDirection(bd(B,this.p3()),p)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(i){var J=this;if(J!==i&&J._host!==i){var I=J._host;I&&I._removeAttach(J),J._host=i,J._host&&J._host._addAttach(J),J.fp("host",I,i),J.onHostChanged(I,i)}},getAttaches:function(){return this._69O},_addAttach:function(i){var T=this;T._69O||(T._69O=new fl),T._69O.add(i),T.fp("attaches",G,i)},_removeAttach:function(z){var A=this;A._69O.remove(z),A._69O.isEmpty()&&delete A._69O,A.fp("attaches",z,G)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(y){var b=this;b._44I||(b._44I=new fl),b._42I||(b._42I=new fl),b._44I.add(y),b._42I.add(y),b._20I()},_4I:function(z){var K=this;K._44I||(K._44I=new fl),K._43I||(K._43I=new fl),K._44I.add(z),K._43I.add(z),K._20I()},_16I:function(K){var V=this;V._44I.remove(K),V._42I.remove(K),V._44I.isEmpty()&&delete V._44I,V._42I.isEmpty()&&delete V._42I,V._20I()},_18I:function(g){var S=this;S._44I.remove(g),S._43I.remove(g),S._44I.isEmpty()&&delete S._44I,S._43I.isEmpty()&&delete S._43I,S._20I()},_20I:function(){var a=this;if(delete a._45I,!a._44I||a._44I.isEmpty())return delete a._70O,void 0;var J;a._44I.each(function(Y){Y.isLooped()&&(J||(J={}),J[Y._id]||(a._45I||(a._45I=new fl),a._45I.add(Y),J[Y._id]=Y))}),J?(a._70O=new fl,a._44I.each(function(g){J[g._id]?"A"===J[g._id]||(J[g._id]="A",a._70O.add(g)):a._70O.add(g)})):a._70O=a._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(c){var v=this;v._46I||(v._46I=new fl),v._48I||(v._48I=new fl),v._46I.add(c),v._48I.add(c),v._19I()},_3I:function(H){var V=this;V._47I||(V._47I=new fl),V._48I||(V._48I=new fl),V._47I.add(H),V._48I.add(H),V._19I()},_15I:function(L){var P=this;P._46I.remove(L),P._48I.remove(L),P._46I.isEmpty()&&delete P._46I,P._48I.isEmpty()&&delete P._48I,P._19I()},_17I:function(s){var w=this;w._47I.remove(s),w._48I.remove(s),w._47I.isEmpty()&&delete w._47I,w._48I.isEmpty()&&delete w._48I,w._19I()},_19I:function(){var m=this;delete m._49I;var U=m._48I;if(U&&!U.isEmpty()){var d={};U.each(function(S){d[S._id]?m._49I||(m._49I=new fl):d[S._id]=S}),m._49I?U.each(function(U){d[U._id]&&(m._49I.add(U),delete d[U._id])}):m._49I=U}},getImage:function(){if(this._pendingCheckImageJSON){var D=V.getImage(this._image);D&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ep&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(j){var b=this,u=b._image,H=b.getWidth(),e=b.getHeight();b._image=j,b.fp("image",u,j)&&(null!=j&&(ag(j)||ed(j)&&/\.json$/i.test(j))&&(this._pendingCheckImageJSON=!0),b.fp(zp,H,b.getWidth()),b.fp(dd,e,b.getHeight()))},getElevation:function(){return this._54O},setElevation:function(z){var W=this;if(!W._50O){W._50O=1;var s=W._54O;W._54O=z,W.fp(zc,s,z),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(y){var Z=this;if(!Z._49O){Z._49O=1;var N=Z._64O;Z._64O=y,Z.fp(Yd,N,y),delete Z._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(S){var H=this;if(!H._51O){H._51O=1;var G=H._rotationX;H._rotationX=S,H.fp("rotationX",G,S),delete H._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(J){var c=this;if(!c._52O){c._52O=1;var M=c._53O;c._53O=J,c.fp("rotationZ",M,J),delete c._52O}},getPosition:function(){return this._position},setPosition:function(l,C){var m=this;if(!m._50I){m._50I=1;var n;if(n=2===arguments.length?{x:l,y:C}:l,n.x!==m._position.x||n.y!==m._position.y){var r=m._position;m._position=n,m.fp(Hr,r,n)}delete m._50I}},translate:function(V,f){var L=this._position;this.p(L.x+V,L.y+f)},getWidth:function(){var D=this;if(D._width>=0)return D._width;var _=D.getStyle("shape3d");if(_){var M=Wg(_);if(M&&M.rawS3)return M.rawS3[0];if("billboard"===_||"plane"===_){var f=tn(D.getStyle("shape3d.image"));return f?dq(f,D):20}}var f=tn(D._image);return f?dq(f,D):20},setWidth:function(R){var e=this,T=e._width;e._width=R,e.fp(zp,T,R)},getHeight:function(){var F=this;if(F._height>=0)return F._height;var L=F.getStyle("shape3d");if(L){var t=Wg(L);if(t&&t.rawS3)return t.rawS3[2];if("plane"===L){var o=tn(F.getStyle("shape3d.image"));return o?Am(o,F):20}if("billboard"===L)return 2}var o=tn(F._image);return o?Am(o,F):20},setHeight:function(G){var H=this,F=H._height;H._height=G,H.fp(dd,F,G)},getTall:function(){var l=this;if(l._tall>=0)return l._tall;var h=l.getStyle("shape3d");if(h){var Z=Wg(h);if(Z&&Z.rawS3)return Z.rawS3[1];if("billboard"===h){var r=tn(l.getStyle("shape3d.image"));return r?Am(r,l):20}if("plane"===h)return 2}return 20},setTall:function(k){var N=this,w=N._tall;N._tall=k,N.fp("tall",w,k)},setSize:function(L,$){var n=this;2===arguments.length?(n.setWidth(L),n.setHeight($)):(n.setWidth(L.width),n.setHeight(L.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(C,M,e,Q,W){var x=this,R=x.getAnchor(),p=x.getScale();arguments.length<=2&&(W=M,M=C.y,e=C.width,Q=C.height,C=C.x);var w=W&&p.x<0?1-R.x:R.x,Y=W&&p.y<0?1-R.y:R.y;x.p(C+e*w,M+Q*Y),W&&(e/=Math.abs(p.x),Q/=Math.abs(p.y)),x.setWidth(e),x.setHeight(Q)},getMatrix:function(){var c=this,r=c._64O,j=c._position,B=c.getScale();return new cd(r,j.x,j.y,B.x,B.y)},getAnchorRect:function(){var u=this,s=u.getWidth(),x=u.getHeight(),M=u.getAnchor();return{x:-s*M.x,y:-x*M.y,width:s,height:x}},toLocal:function(v){return this.getMatrix().tfi(v)},toGlobal:function(g){return this.getMatrix().tf(g)},isInRect:function(t){t=this.toLocal(t);var O=this.getWidth(),i=this.getHeight();return t.x+=O*this.getAnchorX(),t.y+=i*this.getAnchorY(),!(t.x<0||t.y<0||t.x>O||t.y>i)},getRect:function(){var n=this,C=n.getWidth(),z=n.getHeight(),x=n.getAnchor(),s={x:-C*x.x,y:-z*x.y,width:C,height:z},k=n.getMatrix();return s=Gr([k.tf(s.x,s.y),k.tf(s.x+s.width,s.y),k.tf(s.x+s.width,s.y+s.height),k.tf(s.x,s.y+s.height)])},getAnchorElevation:function(){return this._anchorElevation
},getAnchor3d:function(){var $=this,T=$.getAnchor(),v=$._anchorElevation;return{x:T.x,y:v,z:T.y}},setAnchorElevation:function(u){var R=this,z=R._anchorElevation;return z!==u?(R._anchorElevation=u,R.fp("anchorElevation",z,u),!0):!1},setAnchor3d:function(v,C,x,M){var y,R=this;"number"==typeof v?y={x:v,y:C,z:x}:(y=v.length?{x:v[0],y:v[1],z:v[2]}:v,M=C);var B=R.getDataModel();B&&B.beginTransaction();var K=R.getAnchor3d(),w=R.setAnchor(y.x,y.z);if(R.setAnchorElevation(y.y)&&(w=!0),w&&M&&!ge){R.getAnchor3d();var Q=Tr(R),D=Kb([y.x-K.x,y.y-K.y,y.z-K.z],Q);R.p3(D)}return B&&B.endTransaction(),w},getAnchor:function(){var b=this;if(b.hasOwnProperty("_anchor"))return b._anchor;var T=tn(b._image);return T&&T.anchorX!==z?{x:T.anchorX,y:T.anchorY}:b._anchor},setAnchor:function(c,g,a){var U,r=this;"number"==typeof c?U={x:c,y:g}:(U=c.length?{x:c[0],y:c[1]}:c,a=g);var o=r.getAnchor();if(o.x!==U.x||o.y!==U.y){var _=r.getDataModel();if(_&&_.beginTransaction(),r._anchor=U,r.fp("anchor",o,U),a&&!ge){var x=r.getPosition(),R=r.getSize(),v=r.getRotation(),P=r.getScale(),q=-R.width*(o.x-U.x)*P.x,d=-R.height*(o.y-U.y)*P.y,X=s(v),W=F(v);r.setPosition(x.x+W*q-X*d,x.y+X*q+W*d)}return _&&_.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(U,M){var s,f=this;s=2===arguments.length?{x:U,y:M}:U;var e=f.getScale();(e.x!==s.x||e.y!==s.y)&&(f._scale=s,f.fp("scale",e,s))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var T=this,u=T._scaleTall,H=T.getScale();return[H.x,u,H.y]},getFinalScale3d:function(){var g=this,p=g.s3(),b=g._dynamicScale3d,l=g.getScale3d();return p&&(l[0]*=p[0],l[1]*=p[1],l[2]*=p[2]),b&&(l[0]*=b[0],l[1]*=b[1],l[2]*=b[2]),l},getFinalRotation3d:function(){var g=this;return g._dynamicRotation||g.r3()},setScaleTall:function(d){var m=this,p=m._scaleTall;p!==d&&(m._scaleTall=d,m.fp("scaleTall",p,d))},setScale3d:function(N,m,C){var l,y=this;l="number"==typeof N?{x:N,y:m,z:C}:N.length?{x:N[0],y:N[1],z:N[2]}:N,y.setScaleTall(l.y),y.setScale(l.x,l.z)},getCorners:function(C,o){C==G&&(C=0),o==G&&(o=C);var J=this,e=J.getAnchor(),B=J.getWidth(),_=J.getHeight(),I=-B*e.x-C,u=-_*e.y-o,T=B+2*C,A=_+2*o,t=J.getMatrix();return[t.tf(I,u),t.tf(I,u+A),t.tf(I+T,u+A),t.tf(I+T,u)]},getEditControlPoints:function(Q,E,a){E==G&&(E=0),a==G&&(a=E);var c=this,z=c.getAnchor(),A=c.getWidth(),j=c.getHeight(),V=-A*z.x-E,d=-j*z.y-a,K=A+2*E,T=j+2*a;if(Q)return[{x:V,y:d},{x:V,y:0},{x:V,y:d+T},{x:0,y:d+T},{x:V+K,y:d+T},{x:V+K,y:0},{x:V+K,y:d},{x:0,y:d}];var f=c.getMatrix();return[f.tf(V,d),f.tf(V,0),f.tf(V,d+T),f.tf(0,d+T),f.tf(V+K,d+T),f.tf(V+K,0),f.tf(V+K,d),f.tf(0,d)]},rotateAt:function(w,i,C){var k=this,$=k._position,h=k._64O,J=new cd(h,$.x,$.y).tf(w,i),j=H(w*w+i*i),X=x($.y-J.y,$.x-J.x)+C;k.setRotation(h+C),k.p(J.x+j*F(X),J.y+j*s(X))},onParentChanged:function(){hi.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(U){U._7I()})},onPropertyChanged:function(){var B={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(I){B[I]=!0}),function(b){var L=this;hi.superClass.onPropertyChanged.call(L,b),B[b.property]&&!L._layoutUpdating&&L.updateLayoutParameters(null,b.property),L._69O&&L._69O.each(function(Y){Y.handleHostPropertyChange(b)}),L._49I&&L._49I.each(function(d){d.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(Z){this.updateAttach(Z)},onStyleChanged:function(u){hi.superClass.onStyleChanged.apply(this,arguments),zi[u]&&this.updateAttach()},updateAttach:function(d){var h=this;h._51I||ge||(h._51I=1,h._71O(d),delete h._51I)},_71O:function(W){var i,a,y,F,z,s,l=this,w=l._host,P=W?W.property:G,n=W?W.oldValue:G,L=W?W.newValue:G;if(w instanceof K.Grid){if(P===zc)l.setElevation(l._54O+L-n);else if(!W||Pp[P]){if(i=l.s("attach.row.index"),a=l.s("attach.column.index"),y=w.getCellRect(i,a),!y)return;F=l.s("attach.row.span"),z=l.s("attach.column.span"),(1!==F||1!==z)&&(y=Fp(y,w.getCellRect(i+F-1,a+z-1))),mi(y,l,"attach.padding",1),l.setRect(y)}}else if(w instanceof Rp&&(s=l.s("attach.index"))>=0&&(!W||Qd[P])){var t=l.s("attach.thickness");t!=G&&l.setHeight(w.getThickness()*t);var u=l.s("attach.offset"),c=w.getPoints(),C=c.size();if(C>s){var Z=c.get(s),B=C===s+1?c.get(0):c.get(s+1),v=[B.x-Z.x,B.y-Z.y],U=Li(v);if(U){l.s("attach.offset.relative")&&(u*=U),l.s("attach.offset.opposite")&&(u=U-u);var R={x:Z.x+v[0]/U*u,y:Z.y+v[1]/U*u},r=l.s("attach.gap");r&&(l.s("attach.gap.relative")&&(r*=w.getThickness()),R=vk(G,R,B,r)),l.p(R),l.setRotation(x(v[1],v[0]))}}}else W&&(P===Hr?l.translate(L.x-n.x,L.y-n.y):P===zc?l.setElevation(l._54O+L-n):Bg[P]?l._11Q(w,P,L-n):("anchor"===P||"width"===P||"height"===P||"scale"===P)&&l.layout(w))},_11Q:function(){var p=new K.Math.Euler,M=K.Math.Euler.ReverseOrder,U=new K.Math.Vector2,Z=new K.Math.Vector2;return function(T,g,V){var I=this,C=T.p3(),F=T.r3(),E=I.p3(),W=I.r3();if(g===Yd&&(g="rotationY",V=-V),(g===Yd||"rotationY"===g)&&0===W[0]&&0===W[2]&&0===F[0]&&0===F[2]&&0===E[1]&&0===C[1])return I.setRotation(-W[1]-V),U.set(E[0],E[2]).rotateAround(Z.set(C[0],C[2]),-V),I.p(U.x,U.y),void 0;var l=Xj[T.getRotationMode()],L=l[0],u=l[1],a=l[2],S=Vl[L],G=Vl[u],v=Vl[a],r=Qh();g===Yd+L?(v(r,F[zm[a]]),G(r,F[zm[u]]),S(r,V),G(r,-F[zm[u]]),v(r,-F[zm[a]])):g===Yd+u?(v(r,F[zm[a]]),G(r,V),v(r,-F[zm[a]])):g===Yd+a&&v(r,V);var q=bd(E,C);Kb(q,r),I.p3(C[0]+q[0],C[1]+q[1],C[2]+q[2]);var R=I.getRotationMode();le(r,I.r3(),R),p.setFromRotationMatrix(r,M(R)),I.r3([p.x,p.y,p.z])}}(),isHostOn:function(C){var A=this;if(A._host&&C&&C._69O)for(var b={},d=A._host;d&&d!==A&&!b[d._id];){if(d===C)return!0;b[d._id]=d,d=d._host}return!1},isLoopedHostOn:function(f){return this.isHostOn(f)&&f.isHostOn(this)},getScaledSize:function(){var k=this.getSize(),v=this.getScale();return k.width*=Math.abs(v.x),k.height*=Math.abs(v.y),k},layout:function(i){if(i=i||this.getHost()){var L=this,W=L.s("layout.h")||"center",r=L.s("layout.v")||"center";if("center"!==W||"center"!==r){var t=new K.Math.Vector2,T=i.getPosition(),u=i.getAnchor(),p=i.getScaledSize();L.getPosition();var w,F,y,e,S,P=1,H=1;switch(L._layoutUpdating=!0,W){case"left":t.setX(L._layoutHValue-u.x*p.width);break;case"right":t.setX((1-u.x)*p.width-L._layoutHValue);break;case"leftright":w=p.width-L._layoutHValue[2],y=L.getRotation()-i.getRotation(),e=Math.abs(Math.sin(y)),S=Math.abs(Math.cos(y)),P+=S*w/L._layoutHValue[3],H+=e*w/L._layoutHValue[4],t.setX(L._layoutHValue[1]+(L._layoutHValue[5]-u.x)*p.width);break;case"center":t.setX((.5-u.x)*p.width-L._layoutHValue);break;case"scale":y=L.getRotation()-i.getRotation(),e=Math.abs(Math.sin(y)),S=Math.abs(Math.cos(y)),t.setX((.5-u.x)*p.width-L._layoutHValue[1]*p.width/L._layoutHValue[0]),F=p.width/L._layoutHValue[2]-1,P+=S*F,H+=e*F}switch(r){case"top":t.setY(L._layoutVValue-u.y*p.height);break;case"bottom":t.setY((1-u.y)*p.height-L._layoutVValue);break;case"topbottom":y||(y=L.getRotation()-i.getRotation(),e=Math.abs(Math.sin(y)),S=Math.abs(Math.cos(y))),w=p.height-L._layoutVValue[2],P+=e*w/L._layoutVValue[3],H+=S*w/L._layoutVValue[4],t.setY(L._layoutVValue[1]+(L._layoutVValue[5]-u.y)*p.height);break;case"center":t.setY((.5-u.y)*p.height-L._layoutVValue);break;case"scale":y||(y=L.getRotation()-i.getRotation(),e=Math.abs(Math.sin(y)),S=Math.abs(Math.cos(y))),t.setY((.5-u.y)*p.height-L._layoutVValue[1]*p.height/L._layoutVValue[0]),F=p.height/L._layoutVValue[2]-1,P+=e*F,H+=S*F}(1!==P||1!==H)&&("leftright"===W||"scale"===W?L.setSize(L._layoutHValue[3]*P,L._layoutHValue[4]*H):L.setSize(L._layoutVValue[3]*P,L._layoutVValue[4]*H)),t.rotateAround(null,i.getRotation()),this.setPosition(t.x+T.x,t.y+T.y),L._layoutUpdating=z}}},updateLayoutParameters:function(x,q){if(x=x||this.getHost()){var T=this,n=T.s("layout.h"),s=T.s("layout.v");if(n||s){var w,X,C,y,a,R,M=new K.Math.Vector2,d=x.getPosition(),r=x.getAnchor(),N=x.getScaledSize(),Y=T.getPosition(),h=T.getSize();switch(M.set(Y.x-d.x,Y.y-d.y),M.rotateAround(null,-x.getRotation()),n){case"left":T._layoutHValue=M.x+r.x*N.width;break;case"right":T._layoutHValue=-M.x+(1-r.x)*N.width;break;case"center":T._layoutHValue=-M.x+(.5-r.x)*N.width;break;case"leftright":case"scale":"scale"===n?w=-M.x+(.5-r.x)*N.width:(X=T.getAnchor(),C=T.getRotation()-x.getRotation(),y=Math.cos(C),a=Math.sin(C),R=-Math.min(-X.x*y+X.y*a,-X.x*y-(1-X.y)*a,(1-X.x)*y+X.y*a,(1-X.x)*y-(1-X.y)*a),w=M.x-(R-r.x)*N.width),"position"===q&&"object"==typeof T._layoutHValue?(T._layoutHValue[0]=N.width,T._layoutHValue[1]=w):T._layoutHValue=[N.width,w,N.width,h.width,h.height,R]}switch(s){case"top":T._layoutVValue=M.y+r.y*N.height;break;case"bottom":T._layoutVValue=-M.y+(1-r.y)*N.height;break;case"center":T._layoutVValue=-M.y+(.5-r.y)*N.height;break;case"topbottom":case"scale":"scale"===s?w=-M.y+(.5-r.y)*N.height:(C||(X=T.getAnchor(),C=T.getRotation()-x.getRotation(),y=Math.cos(C),a=Math.sin(C)),R=-Math.min(-X.x*a-X.y*y,-X.x*a+(1-X.y)*y,(1-X.x)*a-X.y*y,(1-X.x)*a+(1-X.y)*y),w=M.y-(R-r.y)*N.height),"position"===q&&"object"==typeof T._layoutVValue?(T._layoutVValue[0]=N.height,T._layoutVValue[1]=w):T._layoutVValue=[N.height,w,N.height,h.width,h.height,R]}}}},getSerializableProperties:function(){var A=hi.superClass.getSerializableProperties.call(this);return Sm(A,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),A}});var $c=K.Edge=function($,Q){var z=this;Dr($c,z),z.setSource($),z.setTarget(Q)};uj("Edge",wf,{_icon:"edge_icon",getUIClass:function(){return Dn},_22Q:function(){return pm},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(H){var N=this;if(N._source!==H){var M=N._source;N._source=H,M&&M._16I(N),H&&H._2I(N),N._7I(),N.fp("source",M,H)}},setTarget:function(z){var O=this;if(O._target!==z){var i=O._target;O._target=z,i&&i._18I(O),z&&z._4I(O),O._7I(),O.fp("target",i,z)}},isLooped:function(){var s=this;return s._source===s._target&&!!s._source&&!!s._target},_7I:function(){var w,Q=this,U=Rq(Q);Q._40I!==U&&(w=this._40I,w&&w._15I(Q),Q._40I=U,U&&U._1I(Q),Q.fp("sourceAgent",w,U),ff(w,Q._41I),ff(U,Q._41I));var $=lq(Q);Q._41I!==$&&(w=Q._41I,w&&w._17I(Q),Q._41I=$,$&&$._3I(Q),Q.fp("targetAgent",w,$),ff(w,Q._40I),ff($,Q._40I))},_22I:function(w){this._52I=w,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var S=this;return S._52I&&S._52I.get(0)!==S&&!S.getStyle(Nh)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var D=this,h=D._52I;return h&&!D.getStyle(Nh)&&h.size()>1&&D===h.get(0)},toggle:function(){var w=this._52I,D=!this.s(Nh);w&&w.size()>1&&(w.each(function(s){s.s(Nh,D)}),w.getSiblings().each(function(u){u!==w&&u.each(function(K){K.fp("edgeGroup",G,u)})}))},setStyle:function(q,n){(q===id||"edge.segments"===q)&&(n=Th(n)),$c.superClass.setStyle.call(this,q,n)},onStyleChanged:function(G){$c.superClass.onStyleChanged.apply(this,arguments),Qr[G]&&ff(this._41I,this._40I)},getSerializableProperties:function(){var S=$c.superClass.getSerializableProperties.call(this);return Sm(S,{source:1,target:1}),S}});var gq=K.Group=function(){Dr(gq,this)};uj("Group",hi,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Ug},onChildAdded:function(){gq.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){gq.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var V=this;if(!V._54I&&!ge){var l=V.getChildrenRect();l&&(V._53I=1,V.p(Zb(V.s("group.position"),l,V.getSize())),delete V._53I)}},getChildrenRect:function(){var J,w=this;return w.eachChild(function(v){J=Fp(J,w.getChildRect(v))}),J},getChildRect:function(K){var a;return gp(K)&&K.s(gc)&&(nk(K)&&K.isExpanded()&&K.eachChild(function(I){a=Fp(a,K.getChildRect(I))}),!a&&K.getRect&&(a=K.getRect())),a},setPosition:function(h,P){var C=this;if(!C._54I){var w;w=2===arguments.length?{x:h,y:P}:h,ge||C._53I||(C._54I=1,Wc(C._children,w.x-C._position.x,w.y-C._position.y),delete C._54I),gq.superClass.setPosition.call(this,w)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(g){var F=this;if(F._57O!==g){var c=F._57O;F._57O=g,F.fp("expanded",c,F._57O),F._8I()}},_8I:function(){gq.superClass._8I.call(this),this.eachChild(function(y){gp(y)&&y._8I()})},onStyleChanged:function(B){gq.superClass.onStyleChanged.apply(this,arguments),"group.position"===B&&this._81I()},getSerializableProperties:function(){var i=gq.superClass.getSerializableProperties.call(this);return i.expanded=1,i}});var Ro=K.Block=function(){Dr(Ro,this)};uj("Block",hi,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return re},onChildAdded:function(){Ro.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ro.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var d=this;if(!ge&&!d._updatingToChildren&&d._syncSize&&!d._freezeSyncFromChildren){var u,f,I,r,T,R=[],A=d.getRotation();if(d.eachChild(function(N){gp(N)&&R.push.apply(R,N.getCorners())}),R.length){d._updatingFromChildren=1;var G=F(-A),L=s(-A),c=1/0,o=-1/0,b=1/0,p=-1/0;for(r=0,T=R.length;T>r;r++)I=R[r],u=I.x,f=I.y,I.x=G*u-L*f,I.y=L*u+G*f,c=$(c,I.x),o=W(o,I.x),b=$(b,I.y),p=W(p,I.y);var U=d.getScale();d.setSize(D((o-c)/U.x),D((p-b)/U.y));var w;U.x<0&&(w=c,c=o,o=w),U.y<0&&(w=b,b=p,p=w),G=F(A),L=s(A);var n=d.getAnchor();u=c+(o-c)*n.x,f=b+(p-b)*n.y,d.setPosition(G*u-L*f,L*u+G*f),delete d._updatingFromChildren}}},setPosition:function(F,D){var J=this;if(!J._updatingToChildren){var o;o=2===arguments.length?{x:F,y:D}:F,ge||J._updatingFromChildren||(J._updatingToChildren=1,Wc(J._children,o.x-J._position.x,o.y-J._position.y),delete J._updatingToChildren),Ro.superClass.setPosition.call(this,o)}},setWidth:function(R){return this.setSize(R,this.getHeight())},setHeight:function(P){return this.setSize(this.getWidth(),P)},setSize:function(K,d){1>K&&(K=1),1>d&&(d=1);var p=this;if(!p._updatingToChildren){2!==arguments.length&&(d=K.height,K=K.width);var q=p.getWidth(),A=p.getHeight();if(K!==q&&Ro.superClass.setWidth.call(p,K),d!==A&&Ro.superClass.setHeight.call(p,d),!ge&&!p._updatingFromChildren){p._updatingToChildren=1;var X=K/q,C=d/A;p._adjustChildScaleOrSize(X,C,"size"),delete p._updatingToChildren,p.updateFromChildren()}}},_adjustChildScaleOrSize:function(R,Z,z){var S=this;if(S._syncSize){var f=S.getPosition(),D=S.getRotation();S.getScale(),S.eachChild(function(d){if(gp(d)){var C=d.getPosition(),W=d.getRotation(),U=d.getWidth(),b=d.getHeight(),G=d.getScale(),c=G.x*U,T=G.y*b,K=new cd(W,C.x,C.y,c,T);K.translate(-f.x,-f.y),K.rotate(-D),W=x(K.b*Math.sign(c),K.a*Math.sign(c)),K.scale(R,Z);var J,l,u,I=F(W);if(Math.abs(I)<.001?(J=s(W),l=K.b/J,u=-K.c/J):(l=K.a/I,u=K.d/I),"scale"===z)d.setScale(l/U,u/b);else if("size"===z){var n=l/G.x,v=u/G.y;d.setScale(nb(l)*Math.abs(G.x),nb(u)*Math.abs(G.y)),d.setSize(Math.max(.1,Math.abs(n)),Math.max(.1,Math.abs(v)))}K.rotate(D),K.translate(f.x,f.y),d.setPosition(K.tx,K.ty)}})}},_calcChangeFactor:function(t,X,G,o){var i,Z,C,s;return i=D(t),Z=D(G),C=i>Z?i/Z:Z/i,i=D(X),Z=D(o),s=i>Z?i/Z:Z/i,W(C,s)},setAnchor:function(){var g=this;if(!g._updatingToChildren){var Y=g.getAnchor();if(Ro.superClass.setAnchor.apply(g,arguments),!ge&&!g._updatingFromChildren&&g._syncSize){g._updatingToChildren=1;var M=g.getAnchor();g.getPosition();var _=g.getSize(),t=g.getScale(),N=g.getRotation(),m=-_.width*t.x*(Y.x-M.x),e=-_.height*t.y*(Y.y-M.y),n=s(N),f=F(N),p=f*m-n*e,j=n*m+f*e;g.eachChild(function(b){if(gp(b)){var k=b.getPosition();b.setPosition(k.x-p,k.y-j)}}),delete g._updatingToChildren}}},setRotation:function(m){var Z=this;if(!Z._updatingToChildren){var u=Z.getRotation();if(Ro.superClass.setRotation.apply(Z,arguments),!ge&&!Z._updatingFromChildren){Z._updatingToChildren=1;var E=Z.getPosition(),A=m-u;Z.eachChild(function(p){if(gp(p)){var t=p.getMatrix();t.translate(-E.x,-E.y),t.rotate(A),t.translate(E.x,E.y);var o=Math.sign(p.getScale().x);p.setRotation(x(t.b*o,t.a*o)),p.setPosition(t.tx,t.ty)}}),delete Z._updatingToChildren}}},setScale:function(V,g){var o=this;if(!o._updatingToChildren){null==g&&(g=V.y,V=V.x);var u=o.getScale();if(D(V)<.01&&(V=.01*(nb(V)||nb(u.x))),D(g)<.01&&(g=.01*(nb(g)||nb(u.y))),Ro.superClass.setScale.call(o,V,g),!ge&&!o._updatingFromChildren){o._updatingToChildren=1;var M=V/u.x,e=g/u.y;o._adjustChildScaleOrSize(M,e,"size"),delete o._updatingToChildren,o.updateFromChildren()}}},getSerializableProperties:function(){var v=Ro.superClass.getSerializableProperties.call(this);return v.clickThroughEnabled=1,v.syncSize=1,v}});var yg=K.Grid=function(){Dr(K.Grid,this)};uj("Grid",hi,{IRotatable:!1,_icon:"grid_icon",_image:G,getUIClass:function(){return Uk},setRotation:function(){},getCellRect:function(D,C){var o=this,V=o.s("grid.row.count"),$=o.s("grid.column.count");if(0>=V||0>=$||0>D||D>=V||0>C||C>=$)return G;var p,Z,Q,r=o.getRect(),e=o.s("grid.row.percents"),f=o.s("grid.column.percents");if(mi(r,o,"grid.border",-1),e&&e._as&&(e=e._as),f&&f._as&&(f=f._as),e&&e.length===V){for(Q=0,p=0;D>p;p++)Q+=r.height*e[p];r.y+=Q,r.height=r.height*e[D]}else r.height=r.height/V,r.y+=r.height*D;if(f&&f.length===$){for(Z=0,p=0;C>p;p++)Z+=r.width*f[p];r.x+=Z,r.width=r.width*f[C]}else r.width=r.width/$,r.x+=r.width*C;return Fe(r,-o.s("grid.gap")),r}});var Pi=K.Text=function(){Dr(Pi,this),this.setSize(100,50),this.s("text","TEXT")};uj("Text",hi,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return qd},setWidth:function(p){p||(p=.001),Pi.superClass.setWidth.call(this,p)},setHeight:function(e){e||(e=.001),Pi.superClass.setHeight.call(this,e)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),dp("__text__",{width:{value:100,isSafeFunc:!0,func:function(Z){return Z._width}},height:{value:50,isSafeFunc:!0,func:function(A){return A._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Rp=K.Shape=function(){Dr(Rp,this),this._59O=new fl};Rp.__de__=Gn,uj("Shape",hi,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return jq},_22Q:function(){return Pq},getLength:function(U){return Di(Ie(this._59O,this._58O,U,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var W=this._58O;return W?new fl(W._as.slice(0)):W},setSegments:function(u){var A=this._58O;u=u?Ul(u)?new fl(u.slice(0)):new fl(u._as.slice(0)):null,(A&&u&&A._as.join(",")!==u._as.join(",")||A!==u)&&(this._58O=u,this.fp("segments",A,u))},getPoints:function(){return this._59O},toPoints:function(){var $=this._59O;return new fl($._as.slice(0))},setPoints:function(J,x){var n=this,r=n._59O;J=J?Ul(J)?new fl(J.slice(0)):new fl(J._as.slice(0)):new fl;var i,u,M,O,Q,L;x&&(i=n.getPosition(),L=new cd(n.getRotation(),0,0,n.getScale().x,n.getScale().y)),(r&&J&&r._as.join(",")!==J._as.join(",")||r!==J)&&(n._59O=J,n.fs(),n.fp("points",r,J)),x&&(u=n.getPosition(),M=u.x-i.x,O=u.y-i.y,Q=L.tf(M,O),n.setPosition(u.x-M+Q.x,u.y-O+Q.y))},addPoint:function(G,M,Q){var E=this.toPoints();E.add(G,M),this.setPoints(E,Q)},setPoint:function(N,m,l){var c=this.toPoints();c.set(N,m),this.setPoints(c,l)},removePointAt:function(p){var K=this.toPoints();K.removeAt(p),this.setPoints(K)},setWidth:function(g){var H=this;if(1>g&&(g=1),!H._55I&&!ge&&H.getWidth()){H._55I=1;var k=H._position.x,x=g/H.getWidth(),S=H.toPoints(),i=new fl;S.each(function(U){i.add({x:(U.x-k)*x+k,y:U.y,e:U.e})}),H.setPoints(i),vf(H,[x,0,0,1,k*(1-x),0]),H.fs(),delete H._55I}Rp.superClass.setWidth.call(H,g)},setHeight:function(n){var X=this;if(1>n&&(n=1),!X._55I&&!ge&&X.getHeight()){X._55I=1;var o=X._position.y,K=n/X.getHeight(),J=X.toPoints(),h=new fl;J.each(function(d){h.add({x:d.x,y:(d.y-o)*K+o,e:d.e})}),X.setPoints(h),vf(X,[1,0,0,K,0,o*(1-K)]),X.fs(),delete X._55I}Rp.superClass.setHeight.call(X,n)},setAnchorElevation:function(p){var H=this;H._55I=!0;var X=H._updatingAnchor3d,x=!ge&&!X;if(x){var B,K=p,W=H.getAnchorElevation(),h=H.getTall();B=h*(W-K),H.shiftPointsElevation(B)}var n=Rp.superClass.setAnchorElevation.apply(H,arguments);return X||delete H._55I,n},getShapeElevation:function(){var D=this,q=D._54O;return q-(D.getTall()||0)*(D._anchorElevation-.5)},setAnchor3d:function(I,w,Y,O){var o,f=this;"number"==typeof I?o={x:I,y:w,z:Y}:(o=I.length?{x:I[0],y:I[1],z:I[2]}:I,O=w),f._55I=!0,f._updatingAnchor3d=!0;var l=f.getDataModel();if(l&&l.beginTransaction(),!ge){var g=f.getAnchor3d(),t=f.getSize(),H=f.getTall(),k=t.width*(g.x-o.x),q=t.height*(g.z-o.z),F=H*(g.y-o.y);O||f.shiftPoints(k,q,F);var Q=f.p3()}var J=Rp.superClass.setAnchor3d.apply(f,arguments);if(!ge&&O){var v=f.p3();f.shiftPoints(v[0]-Q[0]+k,v[2]-Q[2]+q,v[1]-Q[1]+F)}return l&&l.endTransaction(),delete f._updatingAnchor3d,delete f._55I,J},setAnchor:function(n,U,H){var F=this;F._55I=!0;var T=F._updatingAnchor3d,D=!ge&&!T;if(D){var S,N,B;"number"==typeof n?B={x:n,y:U}:(B=n.length?{x:n[0],y:n[1]}:n,H=U);var O=F.getAnchor(),w=F.getSize();S=w.width*(O.x-B.x),N=w.height*(O.y-B.y),H||F.shiftPoints(S,N);var V=F.getPosition()}var x=Rp.superClass.setAnchor.apply(F,arguments);if(D){var c=F.getPosition();H&&F.shiftPoints(c.x-V.x+S,c.y-V.y+N)}return T||delete F._55I,x},shiftPoints:function(m,g,Z){var F=this,n=F.getElevation()||0,N=F.toPoints(),f=new fl;N.each(function(X){var N=X.e;Z&&(N=(N==G?n:N)+Z),f.add({x:X.x+m,y:X.y+g,e:N})}),F.setPoints(f),F.fs()},shiftPointsElevation:function(w){return this.shiftPoints(0,0,w)},setPosition:function(M,k){var I,Z=this;if(!Z._28Q){if(Z._28Q=1,!Z._55I&&!ge){I=2===arguments.length?{x:M,y:k}:M;var C=I.x-Z._position.x,i=I.y-Z._position.y;if(0===C&&0===i)return delete Z._28Q,void 0;Z._55I=1,Z.shiftPoints(C,i),vf(Z,[1,0,0,1,C,i]),delete Z._55I}Rp.superClass.setPosition.apply(Z,arguments),delete Z._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var o=this;if(2!==o._59O.size())return!1;var h=o._58O;return h?2===h.size()&&1===h.get(0)&&2===h.get(1)?!0:!1:!0},fireShapeChange:function(){var j=this;if(!j._55I&&!ge){var o=Gr(j._59O);o&&(j._55I=1,j.setRect(o),delete j._55I)}j.fp(nh,!1,!0)},getSerializableProperties:function(){var T=Rp.superClass.getSerializableProperties.call(this);return T.segments=1,T.points=1,T.thickness=1,T.closePath=1,T}});var Xk=K.Polyline=function(){Dr(Xk,this),this.s({"shape.background":null,"shape.border.width":2})};uj("Polyline",Rp,{_icon:"polyline_icon",_22Q:function(){return Pm},getUIClass:function(){return hp},setClosePath:function(){},setTall:function(K){var h=this;if(!h._55I&&!h._24Q&&!ge&&h.getTall()){h._24Q=1;var b=h._54O,N=K/h.getTall();h._59O.each(function(C){C.e=C.e==G?b:(C.e-b)*N+b}),h.fs(),delete h._24Q}Xk.superClass.setTall.call(h,K)},setElevation:function(y){var W=this;if(!W._55I&&!W._24Q&&!ge){W._24Q=1;var H=y-W._54O;W._59O.each(function(s){s.e==G?s.e=y:s.e+=H}),W.fs(),delete W._24Q}Xk.superClass.setElevation.apply(W,arguments)},fireShapeChange:function(){var B=this,t=B._59O;if(!B._55I&&!B._24Q&&!ge){var K=t.size();if(K){var _=1,l=t.get(0),i=B._54O;l.e==G&&(l.e=i);for(var k=l.e,m=0;K>_;_++){l=t.get(_),l.e==G&&(l.e=i);var b=$(k,l.e),F=W(k+m,l.e);k=b,m=F-b}B._24Q=1,B.setTall(m),B.setElevation(k+m*B._anchorElevation),delete B._24Q}}Xk.superClass.fireShapeChange.apply(B,arguments)}});var $q=K.SubGraph=function(){Dr($q,this)};uj("SubGraph",hi,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){$q.superClass._8I.call(this),this.eachChild(function(s){gp(s)&&s._8I()})}}),V.loadingRefGraph=0;var Ep=K.RefGraph=function(){Dr(Ep,this)};uj("RefGraph",Ro,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(e){var d=this._ref;this._ref=e,this.fp("ref",d,e),this.updateRef()},_21I:function(){Ep.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var M=this;if(V.loadingRefGraph++,M.clearChildrenFromDataModel(),V.loadingRefGraph--,M._ref&&M._dataModel){M._xhrLoadHandler&&(M._xhrLoadHandler.cancel=!0);var H=ge,g=M._xhrLoadHandler=function(K){if(K&&M._dataModel){V.loadingRefGraph++;var T=M._pendingUpdateInfo={needToRestore:H};H&&(T.position=M.p(),T.width=M.getWidth(),T.height=M.getHeight(),T.rotation=M.getRotation(),T.anchor=M.getAnchor(),T.scale=M.getScale()),M.p(0,0),M.setAnchor(.5,.5),M.setRotation(0),M.setScale(1,1);var Y=V.parse(K),d=M._dataModel.deserialize(Y,M,{justDatas:!0});d.each(function(d){d._refGraph=M}),M.checkPendingUpdateInfo(),V.loadingRefGraph--,V.handleRefGraphLoaded(M,d,Y)}};g.xhrLoadCalled=!1,V.load(M._ref,function(f){g.cancel||(g.xhrLoadCalled?g(f):ln(function(){g(f)}))}),g.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var W=this,o=W._pendingUpdateInfo;if(!o)return W.onPendingUpdated&&(V.loadingRefGraph++,W.onPendingUpdated(),V.loadingRefGraph--),void 0;var b=!0;this.eachChild(function(d){(d._pendingCheckImageJSON||d._pendingUpdateInfo)&&(b=!1)}),b&&(V.loadingRefGraph++,W._pendingUpdateInfo=null,W.updateFromChildren(),o.needToRestore&&(W.setSize(o.width,o.height),W.setAnchor(o.anchor),W.setRotation(o.rotation),W.setScale(o.scale),W.p(o.position)),this.getParent()instanceof Ep&&this.getParent().checkPendingUpdateInfo(),W.onPendingUpdated&&W.onPendingUpdated(),V.loadingRefGraph--)},getSerializableProperties:function(){var I=Ep.superClass.getSerializableProperties.call(this);return I.ref=1,I}}),K.EdgeGroup=function(W,j){this._70O=W,this._siblings=j;for(var x,$,Z=0,n=W.size(),T=r[Nh];n>Z;Z++)if(x=W.get(Z).getStyle(Nh,!1),x!=G){T=x;break}T==G&&(T=!0);var D=V.edgeGroupAgentFunc;for(D&&($=D(W),$&&$!==W.get(0)&&(W.remove($),W.add($,0))),Z=0;n>Z;Z++)W.get(Z).s(Nh,T)},uj("EdgeGroup",m,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(N){return this._70O.get(N)},indexOf:function(S){return this._70O.indexOf(S)},each:function(I,b){this._70O.each(I,b)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(V,P){this._siblings.each(function(e){e._70O.each(V,P)})}});var fq=function(I,r,g){var p=rp[I]={type:I,action:r};if(g)for(var T in g)p[T]=g[T]};Sm(V,{setConnectAction:fq,getConnectAction:function(f,q){if(!q){if(!f)return null;q=f.getCurrentConnectActionType()}return rp[q]},doConnectAction:function(k,d,z,G){G=G||k.getCurrentConnectActionType();var v=rp[G];if(!v)return!1;var D=v.action;return D?(d instanceof nc.Group?k.sm().getSelection().each(function(u){D.call(null,k,u,z)}):D.call(null,k,d,z),!0):!1},doDeleteConnectionAction:function(u,U,T){T=T||u.getCurrentConnectActionType();var v=rp[T];if(!v||!v.delete)return!1;var S=v.delete.action;return S?(U instanceof nc.Group?u.sm().getSelection().each(function(L){S.call(null,u,L)}):S.call(null,u,U),!0):!1}});var dk=K.JSONSerializer=function(t,g){this.dm=this._dataModel=t,this._hierarchical=V.forceHierarchicalSerialization?!0:g==G?t.isHierarchicalRendering():g};uj("JSONSerializer",m,{ms_ac:["hierarchical"],serialize:function(j){return V.stringify(this.toJSON(),j)},toJSON:function(){var u=this,$=u.dm,a=$.getRoots(),t=u.json={v:V.getVersion(),p:{},a:{},d:[]},L=$.getSerializableAttrs();$.getInit()&&(t.init=$.getInit()),$.getName()&&(t.p.name=$.getName()),$.getBackground()&&(t.p.background=$.getBackground()),$.getLayers()&&(t.p.layers=$.getLayers()),$.getEnvmap()&&(t.p.envmap=$.getEnvmap()),t.p.autoAdjustIndex=$.isAutoAdjustIndex(),t.p.hierarchicalRendering=$.isHierarchicalRendering();for(var x in L){var W=$.a(x);W!==z&&u[bb](x,W,t.a)}return Oc(t.a)&&delete t.a,u._hierarchical?a.each(u.serializeData,this):$.each(function(h){u.serializeData(h)}),u.dm.fp("serialize",null,t),$.getPostProcessingData()&&(t.p.postProcessingData=$.getPostProcessingData()),t},isSerializable:function(){return!0},getProperties:function(r){return r.getSerializableProperties()},getStyles:function(z){return z.getSerializableStyles()},getAttrs:function(W){return W.getSerializableAttrs()},serializeData:function($){var d=this;if(d.isSerializable($)&&!$._refGraph){var E,v,C,o,r=ah($.getClassName())||$.getClass(),S=new r,X={c:$.getClassName(),i:$.getId(),p:{},s:{},a:{}};d.json.d.push(X),E=d.getProperties($);for(v in E)/^_/.test(v)?(C=$[v],C!==S[v]&&d[bb](v.substr(1),C,X.p)):(o=Lc(v),$[o]&&(C=$[o](),C!==S[o]()&&d[bb](v,C,X.p)));E=d.getStyles($);for(v in E)C=$.s(v),C!==S.s(v)&&d[bb](v,C,X.s);E=d.getAttrs($);for(v in E)C=$.a(v),C!==S.a(v)&&d[bb](v,C,X.a);Oc(X.p)&&delete X.p,Oc(X.s)&&delete X.s,Oc(X.a)&&delete X.a}d._hierarchical&&$.getChildren().each(d.serializeData,d)},serializeValue:function(L,Y,f){mb(Y)?Y={__a:Y._as}:Y instanceof wf&&(Y={__i:Y.getId()}),f[L]=Y},deserialize:function(b,g,K){var i=this,P=i.dm;P.beginTransaction(),ge++,K=Rk(K)?{setId:K}:K||{},b=i.json=ed(b)?V.parse(b):b,i._82I={};var E=new fl,c=new fl,f=0,u=b.d.length;if(K.justDatas||(em(b.init)&&b.init(P),P.setInit(b.init)),!K.justDatas){for(var j in b.a)P.a(j,i[Eg](b.a[j]));for(var H in b.p)P[yc(H)](b.p[H])}for(;u>f;f++){var S=b.d[f],U=ah(S.c),R=new U,o=S.i;K.setId&&o!=G&&(R._id=o),i._82I[o]=R,E.add(R),c.add(S)}for(f=0;u>f;f++)i.deserializeData(E.get(f),c.get(f));return E.each(function(J){g&&!J.getParent()&&J.setParent(g),P.add(J)}),P.fp("deserialize",null,b),ge--,P.endTransaction(),E},deserializeData:function(M,P){for(var K in P.p)M[yc(K)](this[Eg](P.p[K]));for(K in P.s)M.s(K,this[Eg](P.s[K]));for(K in P.a)M.a(K,this[Eg](P.a[K]))},deserializeValue:function(U){if(ag(U)){var x=U.__i;if(x!=G)return this._82I[x];if(x=U.__a,Ul(x))return new fl(x)}return U}}),Sm(rl,{serialize:function(p,m){return new dk(this,m).serialize(p)},toJSON:function(j){return new dk(this,j).toJSON()},deserialize:function(p,v,h){return new dk(this).deserialize(p,v,h)}});var Gk=K.OverlappingBox=function(P){this.gv=P,this.boxes={}};uj("OverlappingBox",m,{clear:function(){var $,x,n=this.boxes;for($ in n)x=n[$],x.length=0},isOverlapping:function(V,l){var c,Z,_=this,S=_.boxes,G=S[V];G?(c=G.rects,Z=G.length):G=S[V]={rects:c=[],length:Z=0};var b,L,l;for(b=0;Z>b;b++)if(L=c[b],L.x<l.x+l.w&&L.x+L.w>l.x&&L.y<l.y+l.h&&L.h+L.y>l.y)return!0;return c.length<=Z?(c.push(l),G.length++):c[G.length++]=l,!1}}),Sm(V,{fetch:function(h,P){var d="GET",i=!1,Q=null,M="";P&&(d=P.method||"GET",i=P.sync,M=P.url,Q=P.data||null),h.open(d,M,!i),h.send(Q)},convertImageSrc:function(Y,C){C&&"function"==typeof C||(C=function(){}),C(Y)}});var We=K.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};uj("Request",m,{_responseType:null,_overrideMimeType:"text/plain",send:function(j){var i=this._xhr,b=this.onload,z=this.onerror;this.getResponseType()?i.responseType=this.getResponseType():this.getOverrideMimeType()&&i.overrideMimeType(this.getOverrideMimeType()),i.onload=b,i.onerror=z,V.fetch(i,j)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(i){this._responseType=i},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(j){this._overrideMimeType=j},getResponseText:function(){var B=this._xhr;return B.response||B.responseText}}),ji.GraphView=function(w){var J=this;J._24I={},J._34I=new fl,J._25I={},J._56I={},J._view=yn(1,J),J._canvas=$p(J._view),J.dm(w?w:new rl),this._coreInteractor=new rj(this),J.setEditable(!1),J.setScrollBarVisible(V.graphViewScrollBarVisible)},ip("GraphView",m,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[jm,os,hl,xq,"resettable","editInteractor",Km,"pannable","rectSelectable","autoScrollZone",Kg,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:V.graphViewResettable,_pannable:V.graphViewPannable,_rectSelectable:V.graphViewRectSelectable,_autoScrollZone:V.graphViewAutoScrollZone,_rectSelectBackground:V.graphViewRectSelectBackground,_rectSelectBorderColor:V.graphViewRectSelectBorderColor,_editPointSize:V.graphViewEditPointSize,_editPointBorderColor:V.graphViewEditPointBorderColor,_editPointBackground:V.graphViewEditPointBackground,_scrollBarColor:rc,_scrollBarSize:Og,_autoHideScrollBar:cg,_autoMakeVisible:Bf,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor
},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(B){this._dataModel.setLayers(B)},setEditable:function(v){var U=this,D=U.__interactorMap__;if(!D){var s=ji.XEditInteractor;D=U.__interactorMap__={scrollBar:new Kh(U),select:new gh(U),edit:s?new s(U):new Nr(U),move:new Le(U),"default":new Wi(U),touch:new fe(U,{editable:!1})}}v?(U._uieditable=!0,U.setInteractors([D.scrollBar,D.select,D.edit,D.move,D.default,D.touch])):(U._uieditable=!1,U.setInteractors([D.scrollBar,D.select,D.move,D.default,D.touch]))},getCanvas:function(){return this._canvas},_33I:function(x){var Y=x.getUIClass();return Y?new Y(this,x):G},getDataUI:function(y){var A=this,i=A._25I[y._id];return i===z&&(i=A._33I(y),A._25I[y._id]=i),i},getNodeRect:function(u){return V.getNodeRect(this,u)},getEdgeInfo:function(j){var J=this.getDataUI(j);return J?(J._79o(),J._78o):null},getEdgeSourcePosition:function(V){var L=this,Z=L.getDataUI(V),U=Z.s,Q=Z._data._40I;return zj(L,Q,U("edge.source.position"),U("edge.source.offset.x"),U("edge.source.offset.y"),U("edge.source.anchor.x"),U("edge.source.anchor.y"))},getEdgeTargetPosition:function(X){var g=this,D=g.getDataUI(X),O=D.s,d=D._data._41I;return zj(g,d,O("edge.target.position"),O("edge.target.offset.x"),O("edge.target.offset.y"),O("edge.target.anchor.x"),O("edge.target.anchor.y"))},invalidateAll:function(J){var d=this;if(J){for(var B in d._25I){var L=d._25I[B];L&&L.dispose()}d._25I={},d._56I={},d._24I={},d._34I.clear(),d.redraw()}else d.dm().each(function(C){d.invalidateData(C)})},invalidateSelection:function(){var y=this;y.sm().each(function(Y){y.invalidateData(Y)})},invalidateData:function(e){var q=this;q._24I[e._id]=e,q._21Q(e),q.iv()},_21Q:function(S){var L=this,v=L._24I;if(Zc(S)&&Ib[S.s(Oe)]){var o=S.getSourceAgent();o&&o.getAgentEdges().each(function(G){v[G._id]=G}),o=S.getTargetAgent(),o&&o.getAgentEdges().each(function(R){v[R._id]=R}),L.iv()}},redraw:function(n){var I=this;I._32I||(n?I._34I.add(n):(I._32I=1,I._34I.clear()),I.iv())},each:function(M,V){var n,m,b,v=0,T=this.getLayers(),o=this._dataModel,s=o._datas._as,O=s.length;if(T){for(var J=T.length;J>v;v++)if(b=T[v],ag(b)&&(b=b.name),o.isHierarchicalRendering()){var y=function(O){return O._layer===b?V?M.call(V,O):M(O):void 0};if(this._dataModel.eachByHierarchical(y)===!1)return}else for(var Q=0;O>Q;Q++)if(n=s[Q],n._layer===b&&(m=V?M.call(V,n):M(n),m===!1))return}else if(o.isHierarchicalRendering())this._dataModel.eachByHierarchical(M,null,V);else for(;O>v;v++)if(n=s[v],m=V?M.call(V,n):M(n),m===!1)return},reverseEach:function(z,r){var U,x,T,I,g=this._dataModel,V=g._layers,o=g._datas._as,D=o.length;if(V){for(U=V.length-1;U>=0;U--)if(I=V[U],ag(I)&&(I=I.name),g.isHierarchicalRendering()){var m=function(N){return N._layer===I?r?z.call(r,N):z(N):void 0};if(g.reverseEachByHierarchical(m)===!1)return}else for(var W=D-1;W>=0;W--)if(x=o[W],x._layer===I&&(T=r?z.call(r,x):z(x),T===!1))return}else if(g.isHierarchicalRendering())g.reverseEachByHierarchical(z,null,r);else for(U=D-1;U>=0;U--)if(x=o[U],T=r?z.call(r,x):z(x),T===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var j=this,Z=j._84I;if(!Z){var Q=this.dm().a("width"),E=this.dm().a("height");Q>0&&E>0?j._84I={x:0,y:0,width:Q,height:E}:(j.each(function(E){j.isVisible(E)&&(Z=Fp(Z,j.getDataUIBounds(E)))}),j._84I=Z?Z:ai)}return j._84I},getScrollRect:function(){return Fp(this.getContentRect(),this._29I)},makeCenter:function(Y,B,n){var _=this;if(!_.getWidth()||!_.getHeight())return n||ln(_.centerData,_,[Y,B,!0],500),void 0;_.makeVisible(Y),_.validate();var y=_.getDataUIBounds(Y);if(y){var z=_.getWidth(),V=_.getHeight(),m=y.x+y.width/2,W=y.y+y.height/2,c=-m*_._zoom+z/2,H=-W*_._zoom+V/2;_.setTranslate(c,H,B)}},fitData:function(D,k,U,n,d){var f=this;if(!f.getWidth()||!f.getHeight())return d||ln(f.fitData,f,[D,k,U,n,!0],500),void 0;var N=function(){f.makeVisible(D),f.validate();var P=f.getDataUIBounds(D);P&&(P=Cn(P),Fe(P,U==G?20:U),f.fitRect(P,k,n))};k?V.callWhenLoaded(N):N()},fitContent:function(D,X,y,B){var P=this;if(!P.getWidth()||!P.getHeight())return B||ln(P.fitContent,P,[D,X,y,!0],500),void 0;var F=function(){P.validate();var o=Cn(P.getContentRect());Fe(o,X==G?20:X),P.fitRect(o,D,y)};D?V.callWhenLoaded(F):F()},fitRect:function(F,O,q){var J=this,T=J.getWidth(),Q=J.getHeight(),X=F.x+F.width/2,z=F.y+F.height/2,m=$(T/F.width,Q/F.height),K=J._zoom,y=-X*K+T/2,Y=-z*K+Q/2;0===m||isNaN(m)||(q&&(m=$(1,m)),O?(J._65I&&(delete J._65I.finishFunc,J._65I.stop(!0)),J._14o&&J._14o.stop(!0),J.setTranslate(y,Y,{finishFunc:function(){J.setZoom(m,O)}})):(J.setTranslate(y,Y),J.setZoom(m)))},toCanvas:function(A,y){y=y||this._zoom,this.validateImpl();var Q=this,E=Q.getContentRect();E.width||(E.width=10),E.height||(E.height=10);var O=$p(),B=E.x*y,i=E.y*y,l=E.width*y,D=E.height*y;Hp(O,l,D,1);var P=vd(O);return A=A||this._dataModel.getBackground(),A&&Ig(P,0,0,l,D,A),Pe(P,-B,-i),P.scale(y,y),Q._42(P),P.restore(),O},toDataURL:function(P,o,N){return this.toCanvas(P,N).toDataURL(o||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(v,P){var c=this;c._93db(v,P),c.each(function(C){var S=c.getDataUI(C);if(S){var f=c._56I[C._id],k=S._htmlView;if(f){var M=S._79o();if(k=S._htmlView,K.HtmlNode&&C instanceof K.HtmlNode)S._42(v);else{var o=c.getViewRect(),Q=k&&k.layoutHTML;!P||Nb(P,M)?(Q&&(k.layoutHTML(),S.__outerLayout&&delete S.__outerLayout),S._42(v)):Nb(o,M)||!Q||S.__outerLayout||(k.layoutHTML(),S.__outerLayout=!0)}}k&&(k.getView&&(k=k.getView()),k.style.display=f?"block":Jg)}}),c._92db(v,P)},validateImpl:function(){var o,p,r,P,c,i=this,H=i.tx(),B=i.ty(),k=i._zoom,$=i._canvas,h=this.getWidth(),A=this.getHeight(),l=i._29I,X={x:-H/k,y:-B/k,width:h/k,height:A/k},O={},_=i._34I,x=i._24I,U=i._32I,s=i._23I;i._24I={},(h!==$.clientWidth||A!==$.clientHeight)&&(Hp($,h,A),U=1),U||Hn(X,l)||(U=1),i._29I=X,i.each(function(e){p=e._id;var M=O[p]=i.isVisible(e);M!==i._56I[p]&&(x[p]=e,r=i.getDataUI(x[p]),r&&r._84o(M),i._84o(e,M))},i);for(p in x)r=i.getDataUI(x[p]),r&&(!U&&i._56I[p]&&(c=r._79o(),c&&_.add(c)),r.invalidate()),i._83I=1;if(i._56I=O,!U)for(p in x)O[p]&&(r=i.getDataUI(x[p]),r&&(c=r._79o(),c&&_.add(c)));if(U?P=X:(_.each(function(b){Nb(X,b)&&(P=Fp(P,b))}),P&&(Fe(P,W(1,1/k)),P.x=y(P.x*k)/k,P.y=y(P.y*k)/k,P.width=j(P.width*k)/k,P.height=j(P.height*k)/k,P=ph(X,P))),i._74O=P,P){o=vd($);var S=P.x,T=P.y,F=P.width,L=P.height;S=Math.floor((S*k+H)*Hd),T=Math.floor((T*k+B)*Hd),F=Math.ceil(F*k*Hd)+1,L=Math.ceil(L*k*Hd)+1,o.beginPath(),o.rect(S,T,F,L),o.clip(),o.clearRect(S,T,F,L),df(o,H,B,k),i._42(o,P),o.restore(),delete i._74O}if(_.clear(),delete i._32I,s&&h>0&&A>0){var r=i.getDataUI(s);if(r){var c=r._79o(),V=i._29I,a=V.x,C=V.y,R=V.width,v=V.height,k=i._zoom;c&&!Nb(c,V)&&(c.x+c.width<a&&i.tx(-c.x*k),c.x>a+R&&i.tx(-(c.x+c.width-R)*k),c.y+c.height<C&&i.ty(-c.y*k),c.y>C+v&&i.ty(-(c.y+c.height-v)*k))}delete i._23I}i._83I&&(delete i._83I,delete i._84I),i._98O(),Oc(i._24I)||ln(i.iv,i)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(i){var H=this;i!==H.isScrollBarVisible()&&(i?(Mk(H._view,H._79O=Rm()),Mk(H._79O,H._27I=Rm()),Mk(H._79O,H._28I=Rm())):(Nl(H._79O),delete H._79O,delete H._27I,delete H._28I),H.fp("scrollBarVisible",!i,i))},showScrollBar:function(){var v=this;v._79O&&(v._85I||(o(function(){v._86I()},Gi),v.iv()),v._85I=new Date)},_86I:function(){var Y=this;if(Y._85I){var X=new Date,y=X.getTime();y-Y._85I.getTime()>=Gi?(delete Y._85I,Y.iv()):o(function(){Y._86I()},Gi)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var w=this,U=this._27I,K=this._28I;if(w._79O){if(w._autoHideScrollBar&&!w._85I)return U.style.visibility=Db,K.style.visibility=Db,void 0;var l=w.getScrollBarColor(),f=w._zoom,I=w.getScrollBarSize(),M=w.getViewRect(),N=w.getScrollRect(),$=M.height*f,L=N.height*f,p=M.width*f-I-2,c=$*((M.y-N.y)*f/L),Z=$*($/L),T=U.style;L-.5>$?(Bc>Z&&(c=c+Z/2-Bc/2,0>c&&(c=0),c+Bc>$&&(c=$-Bc),Z=Bc),op(U,p,c,I,Z),T.visibility=Re,T.background=l,T.borderRadius=I/2+un):T.visibility=Db;var G=M.width*f,n=N.width*f,c=M.height*f-I-2,p=G*((M.x-N.x)*f/n),z=G*(G/n),T=K.style;n-.5>G?(Bc>z&&(p=p+z/2-Bc/2,0>p&&(p=0),p+Bc>G&&(p=G-Bc),z=Bc),op(K,p,c,z,I),T.visibility=Re,T.background=l,T.borderRadius=I/2+un):T.visibility=Db}},setDataModel:function(c){var z=this,C=z._dataModel,l=z._selectionModel;C!==c&&(C&&(C.ump(z.handleDataModelPropertyChange,z),C.umm(z.handleDataModelChange,z),C.umd(z.handleDataPropertyChange,z),C.removeIndexChangeListener(z._75O,z),C.removeHierarchyChangeListener(z.handleHierarchyChange,z),l||C.sm().ums(z.handleSelectionChange,z)),z._dataModel=c,c.mp(z.handleDataModelPropertyChange,z),c.mm(z.handleDataModelChange,z),c.md(z.handleDataPropertyChange,z),c.addIndexChangeListener(z._75O,z),c.addHierarchyChangeListener(z.handleHierarchyChange,z),l?l._21I(c):c.sm().ms(z.handleSelectionChange,z),z.invalidateAll(!0),z.fp(Ob,C,c),z._canvas.style.background=c.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===z){var $=this.getLayers();$?(this._layersInfo={},$.forEach(function(A){var J=ag(A)?A.name:A;this._layersInfo[J]=A},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=z,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(Z){if("background"===Z.property){var U=this._canvas.style.background,P=Z.newValue||"";this._canvas.style.background=P,this.fp("canvasBackground",U,P)}else"a:width"===Z.property||"a:height"===Z.property?(this._83I=1,this.redraw()):"layers"===Z.property?this.updateLayers():"hierarchicalRendering"===Z.property&&this.redraw()},handleDataPropertyChange:function(r){this.dm().isHierarchicalRendering()&&"parent"===r.property&&r.data.hasChildren()&&this.redraw(),this.invalidateData(r.data)},onPropertyChanged:function(F){var Q=this,z=F.property;if(Q.redraw(),"zoom"===z){var l=Q.sm().getSelection();l.size()&&l.each(function(f){f.invalidate()})}Fb[z]?Q.showScrollBar():z===Km&&Q.onCurrentSubGraphChanged(F)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(r){var F=this,x=r.kind,N=r.data;if(F._83I=1,"add"===x)F.invalidateData(N),Zc(N)&&N.getEdgeGroup()&&N.getEdgeGroup().eachSiblingEdge(F.invalidateData,F);else if(x===fk){F._21Q(N);var a=N._id,H=F._25I[a];if(H){if(F._56I[a]){var X=H._79o();X&&F.redraw(X)}H.dispose(),delete F._25I[a],delete F._24I[a],delete F._56I[a]}N===F._currentSubGraph&&F.setCurrentSubGraph(G)}else x===Bd&&(F.invalidateAll(!0),F.setCurrentSubGraph(G))},_75O:function(f){this.invalidateData(f.data)},handleHierarchyChange:function(l){this.dm().isHierarchicalRendering()&&l.data.hasChildren()&&this.redraw(),this.invalidateData(l.data)},adjustIndex:function(N){var S=this;if(S.isVisible(N)){S.dm().beginTransaction();for(var K=N;K._parent&&S.isVisible(K._parent);)K=K._parent;K&&K!==N&&S._dataModel.adjustIndex(K),S._dataModel.adjustIndex(N),S.dm().endTransaction()}},getImage:function(y){return y.getImage?y.getImage():z},getSelectWidth:function(F){var T=tn(this.getImage(F));return T&&Qb(T.disableSelectedBorder,F,this)?0:F.s("select.width")},getSelectColor:function(A){return A.s("select.color")},isSelectable:function(a){if(this.isSelected(a))return!0;if(!this._clickThroughChecking&&a.getParent()instanceof Ro&&this.isSelectable(a.getParent())&&a.getParent().isSyncSize())return!1;var f=this.getLayersInfo();if(f){var W=f[a._layer];if(W&&W.selectable===!1)return!1}return a.s("2d.selectable")&&this.sm().isSelectable(a)},isMovable:function(R){var Q=this;if(Zc(R)&&R.getStyle(Oe)!==Wp)return!1;var N=this.getLayersInfo();if(N){var e=N[R._layer];if(e&&e.movable===!1)return!1}return R.s("2d.movable")?Q._movableFunc?Q._movableFunc(R):!0:!1},isEditable:function(x){var v=this;if(K._uiSerializing)return v._uieditable;if(!v._editInteractor||!v.isSelected(x))return!1;if(nk(x)){var j=v.getDataUI(x);if(!j||j._88I)return!1}if(Zc(x)&&x.getStyle(Oe)!==Wp)return!1;var O=this.getLayersInfo();if(O){var q=O[x._layer];if(q&&q.editable===!1)return!1}return x.s("2d.editable")?v._editableFunc?v._editableFunc(x):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(l){return gp(l)&&0!==l.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(l):!0},isRectEditable:function(Z){return this._rectEditableFunc?this._rectEditableFunc(Z):!0},isAnchorEditable:function(a){return this._anchorEditableFunc?this._anchorEditableFunc(a):!0},isRotationEditable:function(r){return r.setRotation&&r.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(r):!0:!1},getRotationPoint:function(s){var z=s.getAnchor(),T=s.getScale(),M=this._zoom,c=qb(s.getRotation(),0,-s.getHeight()*T.y*z.y-(T.y<0?-1:1)*(Ai?32:16)/M),A=s.p();return c.x+=A.x,c.y+=A.y,c},getLogicalPoint:function(M){var R=this;return ch(M,R._canvas,R.tx(),R.ty(),R._zoom,R._zoom)},getScreenPoint:function(L,e){var h,_=this;return"object"==typeof L?L.x!==z?(h=L.x,e=L.y):(h=L[0],e=L[1]):h=L,Wf(h,e,_._canvas,_.tx(),_.ty(),_._zoom,_._zoom)},getSelectedDataAt:function(T){var E=this;return this.getDataAt(T,function(x){return E.isSelected(x)})},getDataInfoAt:function(B,V,r){var $,n=this.lp(B),C=this.getDataAt(n,V,r);if(C){var M=this.getDataUI(C);$={data:C,ui:M,point:n};var H=M._38o;if(H){var q=H.icons;for(var k in q){var Z=q[k],f=H.rects[k];if(f)for(var p=Qb(Z.names,C,this),A=p?p.length:0,m=f.rotation,S=A-1;S>=0;S--){var N=p[S],b=f[S];if(Wn(b,n,m))return $.part="icons",$.name=k,$.icon=N,$.rect=b,$.index=S,$.rotation=m,$}}}if(this.isNoteVisible(C)){if(M.note2Info&&Wn(M.note2Info.clickRect,n,G,M.note2Info.scale))return $.part="note2",$;if(M.noteInfo&&Wn(M.noteInfo.clickRect,n,G,M.noteInfo.scale))return $.part="note",$}if(this.isLabelVisible(C)){if(M.label2Info&&Wn(M.label2Info.rect,n,M.label2Info.rotation,M.label2Info.scale))return $.part="label2",$;if(M.labelInfo&&Wn(M.labelInfo.rect,n,M.labelInfo.rotation,M.labelInfo.scale))return $.part="label",$}if(C.isInRect&&C.isInRect(n))return $.part="body",$}return $},getDataAt:function(z,y,B){z.target&&(z=this.lp(z));var T,c=this._zoom;return this.reverseEach(function(p){return(y?y(p):this.isSelectable(p))&&this.rectIntersects(p,jd(z.x,z.y,B,c))?(T=p,!1):void 0},this),T},getIconInfoAt:function(H,Y){var J=this;if(H.target&&(H=J.lp(H)),Y||(Y=J.getDataAt(H)),Y){var z=J.getDataUI(Y);if(z&&z._38o){var u,N=z._38o,K=new fl;for(u in N.icons)K.add(u);for(var c=K.size()-1;c>=0;c--){u=K.get(c);for(var Z=N.rects[u],W=Z.rotation,X=Z.length-1;X>=0;X--){var V=Z[X],g=V.width,q=V.height,D={x:H.x-V.x-g/2,y:H.y-V.y-q/2};W!=G&&(D=qb(-W,D.x,D.y));var V={x:-g/2,y:-q/2,width:g,height:q};if(Wn(V,D))return{key:u,index:X,name:N.icons[u].names[X],rect:Z[X],point:H,rotation:W,relativeRect:V,relativePoint:D,data:Y}}}}}return G},getDatasInRect:function(P,D,l){l===z&&(l=1);var q=this,u=new fl;return q.reverseEach(function(x){l&&!q.isSelectable(x)||(D?q.rectIntersects(x,P):q.rectContains(x,P))&&u.add(x)}),u},moveSelection:function(Z,U){var b=this;b.dm().beginTransaction(),Wc(b.sm().toSelection(b.isMovable,b),Z,U),b.dm().endTransaction()},moveDatas:function(H,u,r){var V=this;V.dm().beginTransaction(),H instanceof fl||(H=new fl(H)),Wc(H,u,r),V.dm().endTransaction()},getDataUIBounds:function(q){var V=this.getDataUI(q);return V?V._79o():G},drawData:function(T,u,q){var c=this.getDataUI(u);if(c){var N=c._79o();(!q||Nb(q,N))&&(c._42(T),u instanceof K.Block&&u.eachChild(function(S){this.drawData(T,S,q)},this))}},getBoundsForGroup:function(o){return o.s(gc)?this.getDataUIBounds(o):G},isPixelPerfect:function(L){return L.s("pixelPerfect")},rectIntersects:function(J,p){this.validate();var W=G;if(this._56I[J._id]){var N=this._25I[J._id];if(N){var r=N._79o();if(_h(p,r))W=!0;else if((p=ph(p,r))&&(N.rectIntersects&&(W=N.rectIntersects(p)),W==G)){if(!this.isPixelPerfect(J))return!0;var f=p.x,O=p.y,w=p.width,M=p.height,z=this._zoom,R=V.hitMaxArea,Z=w*M*z*z;if(Z>R){var o=Math.sqrt(R/Z);z*=o}w*=z,M*=z,2>w&&(w=2),2>M&&(M=2),f*=z,O*=z;var S=Iq(w,M);Pe(S,-f,-O),S.scale(z,z),this._drawForChecking=!0,this.drawData(S,J,p),this._drawForChecking=!1;try{for(var T=0,K=S.getImageData(0,0,w,M).data;T<K.length;T+=4)if(0!==K[T+3]){W=!0;break}S.restore()}catch(h){Lf=G,W=!1}}}}return W?!0:!1},rectContains:function(s,w){if(this._56I[s._id]){var k=this._25I[s._id];if(k)return _h(w,k._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(S){if(!V.isInput(S.target)){var g=this,T=g._focusData,t=T&&g._25I[T._id],P=0,Y=g._dataModel._datas;if(!(T&&T._enabled&&T._editable&&t&&t.onKeyDown&&t.onKeyDown(S)===!0))if(9===S.keyCode&&(T&&(P=Y.indexOf(T),lm(S)?-1===--P&&(P=0):++P===Y.size()&&(P=0)),g._focusData=T=Y.get(P),g.sm().setSelection(T)),xr(S)?g.selectAll():Ni(S)&&g.isResettable()&&g.reset(),g.sm().isEmpty()){if(g._editing)return;var I=g.tx(),L=g.ty(),M=!1,p=lm()?100:10;Ko(S)&&(I-=p,M=!0),_g(S)&&(L-=p,M=!0),Wr(S)&&(I+=p,M=!0),pg(S)&&(L+=p,M=!0),M&&g.setTranslate(I,L)}else{ui(S)&&g.handleDelete(S);var X=lm()?10:1;Ko(S)&&(g.moveSelection(-X,0),g.fi({kind:"moveLeft"})),_g(S)&&(g.moveSelection(0,-X),g.fi({kind:"moveUp"})),Wr(S)&&(g.moveSelection(X,0),g.fi({kind:"moveRight"})),pg(S)&&(g.moveSelection(0,X),g.fi({kind:"moveDown"}))}}},handleScroll:function(c,q){if(Jd(c),!this.getEditInteractor()){var H=this.getDataAt(c);if(H){var f=tn(this.getImage(H));if(f&&Qb(f.scrollable,H,this))return}}var r=this.lp(c);q>0?this.scrollZoomIn(r):0>q&&this.scrollZoomOut(r)},handlePinch:function(r,O,B){this._68I||(O>B?this.pinchZoomIn(r):this.pinchZoomOut(r))},checkDoubleClickOnNote:function(E,Q){var Y=this,f=Y.lp(E),h=Y.getDataUI(Q),U=h.note2Info;return U&&Q.s("note2.toggleable")&&Wn(U.clickRect,f)?(Q.s(hk,!Q.s(hk)),Y.fi({kind:"toggleNote2",event:E,data:Q}),!0):(U=h.noteInfo,U&&Q.s("note.toggleable")&&Wn(U.clickRect,f)?(Q.s(pk,!Q.s(pk)),Y.fi({kind:"toggleNote",event:E,data:Q}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(I,q){var d=this,_=d.getAutoScrollZone(),D=_/d.getZoom(),n=_/4,a=d._29I,Q=d.lp(I),h={x:d.tx(),y:d.ty()};return Q&&_>0&&a&&(Q.x-a.x<D?d.translate(n,0):a.x+a.width-Q.x<D&&d.translate(-n,0),Q.y-a.y<D?d.translate(0,n):a.y+a.height-Q.y<D&&d.translate(0,-n)),h.x=d.tx()-h.x,h.y=d.ty()-h.y,q&&(q.x+=h.x,q.y+=h.y),h},getMoveMode:function(i,V){var E=V.s("2d.move.mode");return E?E:Yr["88"]?"x":Yr["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(Z,T,h){var p=this;return"currentSubGraph"===T?{__i:Z.getId()}:h.serializeProperty(Z,T,p)},deserializeProperty:function(L,c,x){var j=this;if("currentSubGraph"===c){var T=j.dm(),O=T.__idMap;return O[L.__i]}return x.deserializeProperty(L,c,j)},setDefaultCursor:function(e,R){this._defaultCursor=e,R!==!1&&this.setCursor(e)},setCursor:function(q){"default"===q&&(q=this._defaultCursor||q);var j=this.getView().style;j.cursor=q,j.cursor="-webkit-"+q,j.cursor="-moz-"+q},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(r){return r===G||V.getConnectAction(null,r)?(this._currentActionType=r,this.redraw(),!0):!1},isConnectActionVisible:function(t){var D=V.getConnectAction(this);if(!D)return!1;var F=D.visible;return em(F)&&(F=F(this,t)),F},isInteractive:function(Z){var R=tn(this.getImage(Z));return R&&Qb(R.interactive,Z,this)?!0:Z.s("interactive")},appendHTML:function(T){var e=this.getView();if(!T||T.parentNode===e)return!1;var F=T.getView&&T.getView();if(F&&F.parentNode===e)return!1;if(T.isSelfViewEvent)return T.addToDOM(e),!0;T.getView&&(T=T.getView());var j=this.getCanvas().nextSibling;return j?e.insertBefore(T,j):Mk(e,T),!0},layoutHTML:function($,A,q){var o,x=this,n=x._zoom;if(A.getView&&(o=A,A=A.getView()),A.style.position="absolute",q){var k=$.getRect();op(o||A,x.tx()+k.x*n,x.ty()+k.y*n,k.width*n,k.height*n)}else{var X=new gb,k=$.getAnchorRect(),s=$.getPosition(),d=$.getScale(),f=A.style;op(o||A,k),X.appendTranslate(x.tx(),x.ty()),X.appendScale(n,n),X.append(new gb($.getRotation(),s.x,s.y,d.x,d.y)),Yp(f,"transform","matrix("+X.a.toFixed(5)+", "+X.b.toFixed(5)+", "+X.c.toFixed(5)+",\n    "+X.d.toFixed(5)+", "+X.tx.toFixed(5)+", "+X.ty.toFixed(5)+")"),Yp(f,"transformOrigin",(-k.x).toFixed(5)+"px "+(-k.y).toFixed(5)+"px"),A.maxtrixAppend=X.invert().translate(-k.x,-k.y)}}});var kr=function(u,z){var X=this;X.gv=u,X.s=function(Z){return z.getStyle(Z)},X._data=z,X._87I=new fl};ne(kr,m,{_6I:G,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var n=this,P=n.gv.isSelected(n._data);return!P||n.isShadowed()?0:n.gv.getSelectWidth(n._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(Q){var f=this._data,W=this.gv.getBodyColor(f);return W?W:Q?f.getStyle(Q):G},_2Q:function(z){return this.s(z)},_1Q:function(k,y,N,g){var W=this.s,v=W(y+".dash.color");k.strokeStyle=v,k.lineWidth=N,k.stroke(),W(y+".dash.3d")&&qr(k,v,W(y+".dash.3d.color"),N,this.gv._zoom,W(y+".dash.3d.accuracy")),tj(k,g)},invalidate:function(){this._6I=G},_79o:function(){var t=this;if(!t._6I){var E=t._data,U=t.gv;t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=G,t._87I.clear(),t.interactiveInfo=U.isInteractive(E)?{}:G,t._3O(),t._55O=U.isEditable(E)?{_42O:U.isRectEditable(E),_43O:U.isPointEditable(E),_56O:U.isRotationEditable(E)}:G,t._6I=t._81o()}return t._6I},_3O:function(){},getPosition:function(){return ai},_68o:function(J,C){J&&this._87I.add(Kr(J,C))},_81o:function(){var X=this,u=X.s;X._24O(Fo,"getLabel"),X._24O(Or,"getLabel2"),X._26O(qs,"getNote"),X._26O(Kn,"getNote2"),X._15O(),X._55O&&X._48O();var i;if(X._87I.each(function(V){i=Fp(i,V)}),i&&X.isShadowed()){var R=Cn(i);R.x+=u("shadow.offset.x"),R.y+=u("shadow.offset.y"),Fe(R,u("shadow.blur")),i=Fp(i,R)}return X._87I.clear(),i},_42:function(p){var d=this,x=d._data,D=d.gv,E=d.s,c=E("opacity"),J=this.isShadowed();if(J){var $=p.shadowOffsetX,g=p.shadowOffsetY,W=p.shadowBlur,Y=p.shadowColor,K=D.getZoom();p.shadowOffsetX=E("shadow.offset.x")*K,p.shadowOffsetY=E("shadow.offset.y")*K,p.shadowBlur=E("shadow.blur")*K,p.shadowColor=d.getSelectColor()}if(c!=G){var b=p.globalAlpha;p.globalAlpha=c}d._80o(p),D.isLabelVisible(x)&&((!D._drawForChecking||E("label.selectable"))&&Lh(p,d.labelInfo),(!D._drawForChecking||E("label2.selectable"))&&Lh(p,d.label2Info)),D.isNoteVisible(x)&&(td(p,d.noteInfo),td(p,d.note2Info)),d._99O(p),c!=G&&(p.globalAlpha=b),J&&(p.shadowOffsetX=$,p.shadowOffsetY=g,p.shadowBlur=W,p.shadowColor=Y)},_80o:function(){},_47O:function(){},_24O:function(Z,P){var h=this,R=h._data,L=h.gv,b=h.s,a=L[P](R);if(a!=G){var o=b(Z+".scale"),i=b(Z+".max"),p=b(Z+".position"),m=h[Z+"Info"]={label:a,scale:o,color:L[P+"Color"](R),font:b(Z+".font"),opacity:b(Z+".opacity"),align:b(Z+".align"),rotation:h.getRotation(b(Z+".rotation"),!1,p),background:L[P+"Background"](R)},u=Id(m,a);i>0&&i<u.width&&(m.labelWidth=u.width,u.width=i),1!==o&&(u.width*=o,u.height*=o);var e=h.getPosition(p,b(Z+".offset.x"),b(Z+".offset.y"),u,b(Z+".position.fixed"));if(u.x=e.x-u.width/2,u.y=e.y-u.height/2,h._68o(m.rect=u,m.rotation),1!==o){var A=u.width/o,r=u.height/o;m.rect={x:e.x-A/2,y:e.y-r/2,width:A,height:r}}}},_26O:function(J,O){var w=this,q=w.gv,v=w._data,A=w.s,r=q[O](v);if(r!=G){var H,i,E=A(J+".scale"),l=w[J+"Info"]={note:r,scale:E,data:v,view:q,expanded:A(J+".expanded"),font:A(J+".font"),color:A(J+".color"),opacity:A(J+".opacity"),align:A(J+".align"),icon:A(J+".icon"),backgroundImage:A(J+".backgroundImage"),borderWidth:A(J+".border.width"),borderColor:A(J+".border.color"),background:q[O+"Background"](v)},F=w.getPosition(A(J+".position"),A(J+".offset.x"),A(J+".offset.y")),x=F.x,Y=F.y;if(l.expanded){var P,N=A(J+".max"),K=A(J+".backgroundImage");K?(K=tn(K),P={width:dq(K,v),height:Am(K,v)}):P=Id(l,r),P.width+=6,P.height+=2,N>0&&N<P.width&&(l.labelWidth=P.width,P.width=N),H=P.width,i=P.height+8,l.clickRect={x:x-H*E/2,y:Y-i*E,width:H*E,height:i*E*P.height/i}}else{var y=A(J+".icon");y?(y=tn(y),H=dq(y,v),i=Am(y,v)):(H=12,i=18),l.clickRect={x:x-H*E/2,y:Y-i*E,width:H*E,height:i*E}}l.rect={x:x-H/2,y:Y-i*E/2-i/2,width:H,height:i};var B=j(l.borderWidth/2)*E;w._68o({x:x-H*E/2-B,y:Y-i*E-B,width:H*E+2*B,height:i*E+2*B})}},_48O:function(){},_99O:function(K){var P=this,x=P._38o;if(x){var z=P.gv,h=P._data,D=x.icons,r=P.interactiveInfo;r&&(r._38o={});for(var B in D){var H=D[B],u=x.rects[B];if(u){r&&(r._38o[B]=[]);var e=Qb(H.opacity,h,z),l=Qb(H.names,h,z),T=l?l.length:0,$=u.rotation;if(e!=G){var q=K.globalAlpha;K.globalAlpha*=e}for(var g=0;T>g;g++){var S=l[g],p=tn(S),o=u[g];if($){var f=o.x+o.width/2,w=o.y+o.height/2;K.save(),Pe(K,f,w),ej(K,$),Pe(K,-f,-w)}r&&r._38o[B].push(K.interactiveInfo={compInfos:[],matrix:$?new gb($,f,w).appendTranslate(-f,-w):new gb}),sm(K,p,Qb(H.stretch,h,z),o.x,o.y,o.width,o.height,P._data,P.gv),K.interactiveInfo=G,$&&K.restore()}e!=G&&(K.globalAlpha=q)}}}}});var qn=function(m,A){Dr(qn,this,[m,A])};ne(qn,kr,{_checkEmptyRect:!0,_40O:function(Y,P){var K=this,X=K.s,o=Y.rect;(Y.borderColor=K.gv.getBorderColor(K._data))&&(Y.borderType=X("border.type"),Y.borderWidth=X("border.width"),Y.borderPadding=X("border.padding"),P=W(P,Y.borderPadding+Y.borderWidth/2));var E=K._data.getScale(),t=W(1,W(D(E.x),D(E.y)));if(Y.selectWidth=K.getSelectWidth()){var u=K.gv._zoom;Y.selectType=X("select.type"),Y._97o=K.getSelectColor(),Y.selectPadding=X("select.padding"),P=W(P,(Y.selectPadding+Y.selectWidth/2/u)/t)}P>0&&(P*=t,o=Cn(o),Fe(o,P)),K._68o(o)},_39O:function(J,Z){var R,g=this,_=Z.rect;if(Z.borderWidth>0&&(R=Z.borderPadding,J.strokeStyle=Z.borderColor,J.lineWidth=Z.borderWidth,Ii(J,Z.borderType,{x:_.x-R,y:_.y-R,width:_.width+2*R,height:_.height+2*R}),J.stroke()),Z.selectWidth>0){var T=g.gv._zoom;if(R=Z.selectPadding,J.strokeStyle=Z._97o,J.lineWidth=Z.selectWidth/T,Z.rotation!=G){J.save(),J.translate(Z.position.x,Z.position.y),J.rotate(Z.rotation);var C=g._data,U=C.getWidth(),P=C.getHeight(),y=Z.scale,D=Z.anchor;_={x:y.x*-U*D.x,y:y.y*-P*D.y,width:y.x*U,height:y.y*P}}Ii(J,Z.selectType,{x:_.x-R,y:_.y-R,width:_.width+2*R,height:_.height+2*R}),Z.rotation!=G&&J.restore(),J.stroke()}},dispose:function(){var f=this,p=f._htmlView;qn.superClass._3O.call(f),p&&(p.onHTMLRemoved&&p.onHTMLRemoved(),Nl(p))},_3O:function(){var Q=this,T=Q.s,e=Q._data,Z=Q.gv,H=e.getStyle(nh),U=Q.getBodyColor(),l=Q._83o=H?{shape:H,_53o:Q.getBodyColor("shape.background"),_27Q:tn(T("shape.repeat.image"),U),shapeGradientPack:T("shape.gradient.pack"),_54o:T("shape.border.width"),_55o:T("shape.border.color"),_56o:T("shape.border.3d"),_57o:T("shape.border.3d.color"),_58o:T("shape.border.3d.accuracy"),shapeGradient:T("shape.gradient"),_59o:T("shape.gradient.color"),_60o:T("shape.border.pattern"),_61o:T("shape.border.cap"),_62o:T("shape.border.join"),shapeForeground:T("shape.foreground"),bodyColor:U}:{img:tn(Z.getImage(e),U),bodyColor:U,stretch:T("image.stretch")};if(J&&!n);else{var O,m=l.img;m&&m.renderHTML?(Q._htmlInfo&&Q._htmlInfo.img!==m&&(Q._htmlInfo=G),Q._htmlInfo||(Q._htmlInfo={img:m,cache:{}}),O=m.renderHTML(e,Z,Q._htmlInfo.cache)):Q._htmlInfo=G,Q._htmlView&&Q._htmlView!==O&&(Q._htmlView.onHTMLRemoved&&Q._htmlView.onHTMLRemoved(),Nl(Q._htmlView.getView?Q._htmlView.getView():Q._htmlView)),(Q._htmlView=O)&&Z.appendHTML(O)&&O.onHTMLAdded&&O.onHTMLAdded(),l.rect=e.getRect(),l.position=e.p(),l.scale=e.getScale(),l.anchor=e.getAnchor(),l.rotation=e.getRotation(),H===zn&&(l._63o=T("shape.depth"));var L=0;if(H)L=Fd(G,l._54o/2,l._62o),Q.s("shape.dash")&&(L=W(L,(Q.s("shape.dash.width")||l._54o)/2));else if(m&&m.boundExtend)if(L=Qb(m.boundExtend,e,Z),m.boundExtendAbsolute){var S=e.getScale();L/=Z._zoom*W(1,W(D(S.x),D(S.y)))}else if(!Qb(m.fitSize,e,Z)){var P=Qb(m.width,e,Z),w=Qb(m.height,e,Z);L*=W(e.getWidth()/P,e.getHeight()/w)}Q._40O(l,L);var N=T("clip.percentage");if(1>N&&(0>N&&(N=0),l.clipRect=Ij(e.getAnchorRect(),T("clip.direction"),N)),H){var $=T("shape.fill.clip.percentage");1>$&&(0>$&&($=0),l.shapeClipRect=Ij(e.getAnchorRect(),T("shape.fill.clip.direction"),$));var A=T("shape.foreground.clip.percentage");1>A&&(0>A&&(A=0),l.shapeForegroundClipRect=Ij(e.getAnchorRect(),T("shape.foreground.clip.direction"),A))}}},getPosition:function(Z,f,C,Y){var k=Zb(Z,this._83o.rect,Y);return k.x+=f,k.y+=C,k},_80o:function(I){var x=this,p=x.s,S=x.gv,L=x._data,Z=x._83o,y=Z.rect,M=Z.position,f=Z.rotation,n=Z.anchor,k=Z.scale,H=Z.shape,r=Z.clipRect;if(!x._checkEmptyRect||y.width>0&&y.height>0){var q=L.getSize();if(q.x=-q.width*n.x,q.y=-q.height*n.y,I.save(),Pe(I,M.x,M.y),ej(I,f),ij(I,k.x,k.y),r&&(I.beginPath(),I.rect(r.x,r.y,r.width,r.height),I.clip()),S._drawForChecking&&Z.img&&Qb(Z.img.pixelPerfect,L,S)===!1)Ig(I,q.x,q.y,q.width,q.height,"#888888");else if(x.freeDraw)x.freeDraw(I,q,Z);else if(H){var w,F,P,V,b=Z._60o,E=mf(I,b),m=Z._53o,A=Z._27Q,z=Z._54o,N=Z._55o,h=Z.shapeGradientPack,o=I.lineJoin,e=I.lineCap;if("roundRect"===H?w=p("shape.corner.radius"):"polygon"===H?w=p("shape.polygon.side"):"arc"===H&&(w=p("shape.arc.from"),F=p("shape.arc.to"),P=p("shape.arc.close"),V=p("shape.arc.oval")),I.lineJoin=Z._62o,I.lineCap=Z._61o,m||A||h){var j=Z.shapeClipRect;j&&(I.save(),I.beginPath(),I.rect(j.x,j.y,j.width,j.height),I.clip()),Ii(I,H,q,w,F,P,V),h?Rh(I,h):A?mg(I,A,Z.bodyColor,null,L,S):yl(I,m,Z.shapeGradient,Z._59o,q),I.fill(),j&&I.restore(),h&&I.restore(),I!==E&&Ii(E,H,q,w,F,P,V)}else Ii(E,H,q,w,F,P,V);var B=Z.shapeForeground;if(B){I.save();var C=Z.shapeForegroundClipRect;C&&(I.beginPath(),I.rect(C.x,C.y,C.width,C.height),I.clip()),Ii(I,H,q,w,F,P,V),yl(I,B,p("shape.foreground.gradient"),p("shape.foreground.gradient.color"),q),I.fill(),I.restore()}if(z>0){var _=p("shape.border.width.absolute");_&&(I.save(),I.setTransform(1,0,0,1,0,0)),I.lineWidth=z,I.strokeStyle=N,I.stroke(),_&&I.restore(),Z._56o&&qr(I,N,Z._57o,z,S._zoom,Z._58o)}if(tj(I,b),p("shape.dash")){var T=p("shape.dash.width")||z;if(T>0){b=p("shape.dash.pattern");var E=mf(I,b,x._2Q("shape.dash.offset"));E!==I&&Ii(E,H,q,w,F,P,V),x._1Q(I,"shape",T,b)}}gn(I,m,Z._63o,q),I.lineJoin=o,I.lineCap=e}else{var X=x.interactiveInfo;X&&(I.interactiveInfo=X.bodyInfo={compInfos:[],matrix:new gb(f,M.x,M.y,k.x,k.y)}),sm(I,Z.img,Z.stretch,q.x,q.y,q.width,q.height,L,S,Z.bodyColor),I.interactiveInfo=G}I.restore()}x._39O(I,Z)},_48O:function(){},_47O:function(){}});var Dn=function(Q,M){Dr(Dn,this,[Q,M])},Ol=function(E,P,g,u){var C=Li(E,P);return g=u?$(g,C):ld(g,C),C?g/=C:g=0,{x:E.x+(P.x-E.x)*g,y:E.y+(P.y-E.y)*g}};ne(Dn,kr,{_3O:function(){var m,X=this,h=X._data,f=X.gv,t=X.s,c=t(Oe),T=h.isLooped(),O=t("edge.width"),r=t("edge.center"),y=t("edge.offset"),j=f.getBorderColor(h),v=j?t("border.width"):0,n=X.getSelectWidth(),_=h._40I,k=h._41I,I=X._78o=_&&k?{looped:T,type:c,width:O,center:r,color:X.getBodyColor("edge.color"),borderColor:j,borderWidth:v,_97o:n?X.getSelectColor():G,selectWidth:n,pattern:t("edge.pattern"),cap:t("edge.cap"),join:t("edge.join"),is3d:t("edge.3d"),_67o:t("edge.3d.color"),_66o:t("edge.3d.accuracy")}:G;if(I){var $=V.getEdgeType(c);if($){var Y=$(h,Qc(X,f,h,T,c),f,X._19Q);Y.points&&Y.points.size()>1?(I.edgeTypeInfo=Y,m=Gr(I.edgeTypeInfo.points)):Y[om]&&Y.rect&&(I.edgeTypeInfo=Y,m=Y.rect)}else{var l=t("edge.source.anchor.x"),Q=t("edge.source.anchor.y"),d=t("edge.target.anchor.x"),q=t("edge.target.anchor.y"),D=zj(f,_,t("edge.source.position"),t("edge.source.offset.x"),t("edge.source.offset.y"),l,Q),N=zj(f,k,t("edge.target.position"),t("edge.target.offset.x"),t("edge.target.offset.y"),d,q);
if(c===Wp){var u=I.points=t(id)||eq,M=u.size();I.segments=t("edge.segments");var F=l!==z||Q!==z,J=d!==z||q!==z;if(!r)if(y)F||(D=Ol(D,M?u.get(0):N,y,M)),J||(N=Ol(N,M?u.get(M-1):D,y,M));else{var B;F||(B=Sk(D,M?u.get(0):N,Jk(f,_)),B&&(D={x:B[0],y:B[1]})),J||(B=Sk(M?u.get(M-1):D,N,Jk(f,k)),B&&(N={x:B[0],y:B[1]}))}m=Fp(Gr(I.points),Gr(D,N))}else{var e=Qc(X,f,h,T,c);if(X._19Q||(e=-e),T)D=Cn(D),D.x=f.getNodeRect(_).x,I.radius=e,m={x:D.x-e,y:D.y-e,width:2*e,height:2*e};else{var U=Li(D,N),Z=ld(y,U),p={x:Z,y:e},H={x:U-Z,y:e},E=x(N.y-D.y,N.x-D.x),P=I.mat=new cd(E);if(I.orienAngle=E,I.angle=N.x<D.x?E+C:E,I.rect={x:p.x,y:p.y,width:H.x-p.x,height:0},I.origin=D,p=P.tf(p),p.x+=D.x,p.y+=D.y,H=P.tf(H),H.x+=D.x,H.y+=D.y,r){var s={x:U,y:0};s=P.tf(s),s.x+=D.x,s.y+=D.y,m=Gr([D,p,H,s]),I.c1=D,I.c2=s}else m=Gr(p,H);D=p,N=H}}I.sourcePoint=D,I.targetPoint=N,h._lastSourcePoint=D,h._lastTargetPoint=N}var K=0;t("edge.dash")&&(K=t("edge.dash.width")||O);var R="square"===I.cap?.71:.5;Fd(m,W(K*R,O*R+v+n),I.join),X._68o(m)}},getRotation:function(J,w,m){J=J||0;var i=this._78o;if(i){var v,E=i.angle,y=i.points,j=i.edgeTypeInfo;if(E!=G)return w?i.orienAngle+J:E+J;if(j&&j[om])return j.getRotation?j.getRotation(this,J,w,m):0;if(j&&j.points){var h=j.points;return v=h.size(),Zq[m]?v&&0===v%2?ni(h.get(v/2-1),h.get(v/2),w,J):J:kd[m]?ni(h.get(0),h.get(1),w,J):ni(h.get(v-2),h.get(v-1),w,J)}if(y)return v=y.size(),Zq[m]?v&&0===v%2?ni(y.get(v/2-1),y.get(v/2),w,J):J:kd[m]?ni(i.sourcePoint,v?y.get(0):i.targetPoint,w,J):ni(v?y.get(v-1):i.sourcePoint,i.targetPoint,w,J)}return J},getPosition:function(N,T,o,q,H){var X=this._78o;if(X){var d,m=X.type,W=X.points,x=X.edgeTypeInfo,u=X.sourcePoint,L=X.targetPoint;if(!m)return X.looped?{x:u.x-X.radius+T,y:u.y+o}:(H&&u&&L&&(u.x>L.x||u.x===L.x&&u.y>L.y)&&(N=Ad[N],o=-o),d=Zb(N,X.rect,q),d.x+=T,d.y+=o,d=X.mat.tf(d),d.x+=X.origin.x,d.y+=X.origin.y,d);if(x&&x[om])return x.getPosition?x.getPosition(this,N,T,o,q,H):{x:(u.x+L.x)/2,y:(u.y+L.y)/2};if(W){var d,w=W.size();if(Zq[N]){if(w){var s=w%2;if(0===s)return _p(W.get(w/2-1),W.get(w/2),N,T,o,q,H);d=W.get((w-s)/2)}else d={x:(u.x+L.x)/2,y:(u.y+L.y)/2};return d=Zb(N,{x:d.x,y:d.y,width:0,height:0},q),d.x+=T,d.y+=o,d}return kd[N]?_p(u,w?W.get(0):L,N,T,o,q,H):_p(w?W.get(w-1):u,L,N,T,o,q,H)}if(x){var B=x.points,w=B.size();if(Zq[N]){var s=w%2;return 0===s?_p(B.get(w/2-1),B.get(w/2),N,T,o,q,H):(d=B.get((w-s)/2),d=Zb(N,{x:d.x,y:d.y,width:0,height:0},q),d.x+=T,d.y+=o,d)}return kd[N]?_p(B.get(0),B.get(1),N,T,o,q,H):_p(B.get(w-2),B.get(w-1),N,T,o,q,H)}}return ai},_42:function(X){this._78o&&Dn.superClass._42.call(this,X)},drawPath:function(u,k){u.beginPath();var X=k.type,y=k.points,H=k.segments,j=k.edgeTypeInfo;if(!X||y){var z=k.sourcePoint,F=z.x,g=z.y,n=k.targetPoint,W=n.x,d=n.y;if(X)if(H){var J=new fl({x:F,y:g});J.addAll(y),J.add({x:W,y:d}),bq(u,J,H)}else u.moveTo(F,g),y.each(function(l){u.lineTo(l.x,l.y)}),u.lineTo(W,d);else k.looped?u.arc(F,g,k.radius,0,O,!0):k.center?(u.moveTo(k.c1.x,k.c1.y),u.lineTo(F,g),u.lineTo(W,d),u.lineTo(k.c2.x,k.c2.y)):(u.moveTo(F,g),u.lineTo(W,d))}else j&&(j.points?bq(u,j.points,j.segments):j[om]&&j[om](u,j))},_80o:function(i){var y=this,v=y.s,e=y._78o,Q=e.width,u=e.selectWidth,Z=e.borderWidth,U=e.color,m=i.lineJoin,H=i.lineCap,Y=e.pattern;i.lineJoin=e.join,i.lineCap=e.cap,y.drawPath(mf(i,Y),e);var R=v("edge.width.absolute");if(R&&(i.save(),i.setTransform(1,0,0,1,0,0)),u&&(i.strokeStyle=e._97o,i.lineWidth=Q+2*(Z+u),i.stroke()),Z&&(i.strokeStyle=e.borderColor,i.lineWidth=Q+2*Z,i.stroke()),i.strokeStyle=U,i.lineWidth=Q,i.stroke(),e.is3d&&qr(i,U,e._67o,Q,y.gv._zoom,e._66o),R&&i.restore(),tj(i,Y),v("edge.dash")){Y=v("edge.dash.pattern");var C=mf(i,Y,y._2Q("edge.dash.offset"));C!==i&&y.drawPath(C,e),y._1Q(i,"edge",v("edge.dash.width")||Q,Y)}i.lineJoin=m,i.lineCap=H},_48O:function(){},_47O:function(){},_71o:function(K,D){var z=this,T=z._data;if(z._19Q=!0,!T.getEdgeGroup())return K?T.s("edge.gap"):0;var v,x=0,G=0,Y=0;if(T.getEdgeGroup().getSiblings().each(function(B){B.each(function(t){if(z.gv.isVisible(t)&&t.s(Oe)==D){var L=t.s("edge.gap");v?(G+=Y/2+L/2,Y=L):(v=t,Y=L),t===T&&(x=G)}})}),K)return G-x+Y;var E=x-G/2;return v&&T._40I!==v._40I&&(z._19Q=!1),E}});var Ug=function(i,q){Dr(Ug,this,[i,q])};ne(Ug,qn,{_3O:function(){var q,e,w=this,_=w.s,c=w._data,Z=w.gv;if(w._88I=G,c.isExpanded()&&c.eachChild(function(A){var o=Z.getBoundsForGroup(A);o&&(e||(e=[]),e.push(o),q=Fp(q,o))}),q){var E=Z.getLabel(c),B=_("group.type");q=cm(B,e,q),mi(q,c,"group.padding",1);var J=w._88I={type:B,rect:q,_64o:q};if(!B&&E!=G){var u,b=w.labelInfo={label:E,color:_("group.title.color"),font:_("group.title.font"),align:_("group.title.align")},P=Id(b,E),x=P.width,U=P.height,d=_("group.title.align"),m=_("group.title.orientation");if((m===Wj||m===Eh)&&x>q.width?q.width=x:(m===kh||m===tq)&&x>q.height&&(q.height=x),b.rect={y:q.y-U,width:P.width,height:U},u=d===kh?q.x:d===tq?q.x+q.width-x:q.x+q.width/2-x/2,b.rect.x=u,m===Eh)J.titleRect={x:q.x,y:q.y+q.height,width:q.width,height:U},J.rect={x:q.x,y:q.y,width:q.width,height:q.height+U},b.rect={x:u,y:q.y+q.height,width:x,height:U};else if(m===kh){var M=J.titleRect={x:q.x-U,y:q.y,width:U,height:q.height};J.rect={x:q.x-U,y:q.y,width:q.width+U,height:q.height},b.rect={x:M.x+U/2-q.height/2,y:M.y+q.height/2-U/2,width:q.height,height:U},b.rotation=-Math.PI/2}else if(m===tq){var M=J.titleRect={x:q.x+q.width,y:q.y,width:U,height:q.height};J.rect={x:q.x,y:q.y,width:q.width+U,height:q.height},b.rect={x:M.x+U/2-q.height/2,y:M.y+q.height/2-U/2,width:q.height,height:U},b.rotation=Math.PI/2}else J.titleRect={x:q.x,y:q.y-U,width:q.width,height:U+1},J.rect={x:q.x,y:q.y-U,width:q.width,height:q.height+U}}w._40O(J,_("group.border.width")/2)}else Ug.superClass._3O.call(w)},getPosition:function(G,Q,d,E){var p=this._88I;if(p){var u=Zb(G,p.rect,E);return u.x+=Q,u.y+=d,u}return Ug.superClass.getPosition.apply(this,arguments)},_24O:function(M,h){var W=this._88I;(!W||W.type||"label2"===M)&&Ug.superClass._24O.call(this,M,h)},_80o:function(P){var g=this,w=g._88I;if(w){var i=g._data,u=g.s,U=g.gv,K=w.type,I=w.rect,M=w._64o,j=w.titleRect,m=g.getBodyColor(),s=tn(u("group.image"),m),x=u("group.image.stretch"),X=g.getBodyColor("group.background"),Q=tn(u("group.repeat.image"),m),F=u("group.gradient.pack"),f=u("group.gradient"),B=u("group.gradient.color"),p=u("group.border.width"),k=u("group.border.color"),G=u("group.border.pattern"),q=u("group.title.orientation"),D=u("group.depth");if(K){var R=P.lineJoin,J=P.lineCap;if(P.lineJoin=u("group.border.join"),P.lineCap=u("group.border.cap"),s){if(P.save(),Ii(P,K,I),P.clip(),sm(P,s,x,I.x,I.y,I.width,I.height,i,U,m),P.restore(),p>0){var o=mf(P,G);Ii(o,K,I),P.lineWidth=p,P.strokeStyle=k,P.stroke(),tj(P,G)}}else{var o=mf(P,G);X||Q||F?(Ii(P,K,I),F?Rh(P,F):Q?mg(P,Q,m,null,i,U):yl(P,X,f,B,I),P.fill(),F&&P.restore(),P!==o&&Ii(o,K,I)):Ii(o,K,I),p>0&&(P.lineWidth=p,P.strokeStyle=u("group.border.color"),P.stroke()),tj(P,G),K===zn&&gn(P,X,D,I)}P.lineJoin=R,P.lineCap=J}else{var r=u("group.title.background"),V=u("group.border.radius");if(s)sm(P,s,x,M.x,M.y,M.width,M.height,i,U,g.getBodyColor());else if(X||Q)if(Q?mg(P,Q,m,null,i,U):yl(P,X,f,B,M),0===p)Ii(P,zn,M),P.fill(),gn(P,X,D,M);else{switch(P.beginPath(),q){case Eh:cc(P,M.x,M.y,M.width,M.height,V,V,0,0);break;case kh:cc(P,M.x,M.y,M.width,M.height,0,V,0,V);break;case tq:cc(P,M.x,M.y,M.width,M.height,V,0,V,0);break;case Wj:cc(P,M.x,M.y,M.width,M.height,0,0,V,V)}P.fill()}if(j&&r)if(0===p)Ig(P,j.x,j.y,j.width,j.height,r),gn(P,r,D,j);else{switch(P.beginPath(),P.fillStyle=r,q){case Eh:cc(P,j.x,j.y,j.width,j.height,0,0,V,V);break;case kh:cc(P,j.x,j.y,j.width,j.height,V,0,V,0);break;case tq:cc(P,j.x,j.y,j.width,j.height,0,V,0,V);break;case Wj:cc(P,j.x,j.y,j.width,j.height,V,V,0,0)}P.fill()}if(p>0){var o=mf(P,G);if(Ii(o,"roundRect",I,V),P.lineWidth=p,P.strokeStyle=k,j&&u("group.splitLine")){var A=j.x,N=j.y,Y=j.width,n=j.height;q===Eh?(P.moveTo(A,N),P.lineTo(A+Y,N)):q===kh?(P.moveTo(A+Y,N),P.lineTo(A+Y,N+n)):q===tq?(P.moveTo(A,N),P.lineTo(A,N+n)):(P.moveTo(A,N+n),P.lineTo(A+Y,N+n))}P.stroke(),tj(P,G)}}g._39O(P,w)}else Ug.superClass._80o.call(g,P)}});var re=function(L,g){Dr(re,this,[L,g])};ne(re,qn,{_80o:function(G){this._39O(G,this._83o)}});var jq=function(P,i){Dr(jq,this,[P,i])};ne(jq,qn,{_3O:function(){var V=this,w=V._data,Z=V.s,l=V.gv,p=w.getPoints(),J=l.getBorderColor(w),R=J?Z("border.width"):0,T=V.getSelectWidth(),u=Z("shape.border.width"),A=w.getRect(),r=l.getBodyColor(w),N=V._99o=p.isEmpty()?G:{rect:A,rotation:w.getRotation(),fillRule:Z("shape.fill.rule"),scale:w.getScale(),position:w.p(),points:p,segments:w.getSegments(),bodyColor:r,borderColor:J,borderWidth:R,_94o:Z("shape.border.3d"),_95o:Z("shape.border.3d.color"),_96o:Z("shape.border.3d.accuracy"),_97o:T?V.getSelectColor():G,selectWidth:T,_53o:Z("shape.background"),_27Q:tn(Z("shape.repeat.image"),r),shapeGradientPack:Z("shape.gradient.pack"),_54o:u,_55o:Z("shape.border.color"),shapeGradient:Z("shape.gradient"),_59o:Z("shape.gradient.color"),_60o:Z("shape.border.pattern"),_61o:Z("shape.border.cap"),_62o:Z("shape.border.join"),shapeForeground:Z("shape.foreground")};if(N){var E=w.getScale(),P=W(1,W(D(E.x),D(E.y)));Z("shape.dash")&&Z("shape.dash.width")>u&&(u=Z("shape.dash.width"));var F=u*("square"===N._61o?.71:.5)+R+T/V.gv._zoom/P;F&&(F*=P,A=Cn(A),Fd(A,F,N._62o)),V._68o(A);var a=Z("clip.percentage");1>a&&(0>a&&(a=0),N.clipRect=Ij(w.getAnchorRect(),Z("clip.direction"),a));var i=Z("shape.fill.clip.percentage");1>i&&(0>i&&(i=0),N.shapeClipRect=Ij(w.getAnchorRect(),Z("shape.fill.clip.direction"),i));var f=Z("shape.foreground.clip.percentage");1>f&&(0>f&&(f=0),N.shapeForegroundClipRect=Ij(w.getAnchorRect(),Z("shape.foreground.clip.direction"),f))}},getPosition:function(c,t,$,a){var W=this._99o;if(W){var o=Zb(c,W.rect,a);return o.x+=t,o.y+=$,o}return ai},_42:function(x){this._99o&&jq.superClass._42.call(this,x)},_80o:function(U){var h,M=this,K=M.s,l=M._99o,L=l.position,D=l.scale,q=l.rotation,p=l.bodyColor,_=l.borderWidth,F=l.selectWidth/M.gv._zoom,r=l._53o,e=l._27Q,m=l.shapeGradientPack,n=l._54o,P=l.clipRect,u=l.shapeClipRect,N=l.points,i=l.segments,E=M._data.isClosePath(),o=l.fillRule,f=r||e||m;U.save(),Pe(U,L.x,L.y),ej(U,q),ij(U,D.x,D.y),P&&(U.beginPath(),U.rect(P.x,P.y,P.width,P.height),U.clip()),f&&u&&(U.save(),U.beginPath(),U.rect(u.x,u.y,u.width,u.height),U.clip()),Pe(U,-L.x,-L.y);var x=l._60o,v=mf(U,x),g=U.lineJoin,H=U.lineCap;U.lineJoin=l._62o,U.lineCap=l._61o,f?(bq(U,N,i,E),m?Rh(U,m):e?mg(U,e,p,null,M._data,M.gv):(h=p?p:r,yl(U,h,l.shapeGradient,l._59o,l.rect)),U.fill(o),u&&(U.restore(),Pe(U,-L.x,-L.y)),m&&U.restore(),v!==U&&bq(v,N,i,E)):bq(v,N,i,E);var w=l.shapeForeground;if(w){U.save();var k=l.shapeForegroundClipRect;k&&(Pe(U,L.x,L.y),U.beginPath(),U.rect(k.x,k.y,k.width,k.height),U.clip(),Pe(U,-L.x,-L.y)),bq(U,N,i,E),yl(U,w,K("shape.foreground.gradient"),K("shape.foreground.gradient.color"),l.rect),U.fill(o),U.restore()}var R=K("shape.border.width.absolute");if(R&&(U.save(),U.setTransform(1,0,0,1,0,0)),F&&(U.strokeStyle=l._97o,U.lineWidth=n+2*(_+F),U.stroke()),_&&(U.strokeStyle=l.borderColor,U.lineWidth=n+2*_,U.stroke()),n&&(h=l._55o,!r&&p&&(h=p),U.strokeStyle=h,U.lineWidth=n,U.stroke(),l._94o&&qr(U,h,l._95o,n,M.gv._zoom,l._96o)),R&&U.restore(),tj(U,x),K("shape.dash")){var V=K("shape.dash.width")||n;if(V>0){x=K("shape.dash.pattern");var v=mf(U,x,M._2Q("shape.dash.offset"));v!==U&&bq(v,N,i,E),M._1Q(U,"shape",V,x)}}U.lineJoin=g,U.lineCap=H,U.restore()},_48O:function(){},_47O:function(){}});var hp=function(O,$){Dr(hp,this,[O,$])};ne(hp,jq,{getRotation:function(T,O,m){T=T||0;var i=this._data.getPoints(),n=i.size();return n>1?Zq[m]?n&&0===n%2?ni(i.get(n/2-1),i.get(n/2),O,T):T:kd[m]?ni(i.get(0),i.get(1),O,T):ni(i.get(n-2),i.get(n-1),O,T):T},getPosition:function(B,W,E,j,K){var $=this._data.getPoints(),g=$.size();if(g>1){if(Zq[B]){var d=g%2;if(0===d)return _p($.get(g/2-1),$.get(g/2),B,W,E,j,K);var I=$.get((g-d)/2),_={x:I.x,y:I.y,width:0,height:0};return I=Zb(B,_,j),I.x+=W,I.y+=E,I}return kd[B]?_p($.get(0),$.get(1),B,W,E,j,K):_p($.get(g-2),$.get(g-1),B,W,E,j,K)}return ai}});var Uk=function(E,s){Dr(Uk,this,[E,s])};ne(Uk,qn,{_3O:function(){var g=this;Uk.superClass._3O.call(g);var q=g.s,T=g._83o;g._82o=T.img||T.shape?G:{background:g.getBodyColor("grid.background"),depth:q("grid.depth"),rect:T.rect,_88o:q("grid.cell.depth"),cellBorderColor:q("grid.cell.border.color"),_89o:q("grid.row.count"),_90o:q("grid.column.count"),block:q("grid.block"),_91o:q("grid.block.color"),_92o:q("grid.block.padding"),_93o:q("grid.block.width")}},_80o:function(f){var y=this,K=y._82o;if(!K)return Uk.superClass._80o.call(y,f),void 0;var I,B,e=y._data,A=K.background,O=K.rect,a=K.block,E=K._91o,T=K._92o,g=K._93o,l=K._88o,C=K.cellBorderColor,W=K._89o,u=K._90o;if(A)if(Ig(f,O.x,O.y,O.width,O.height,A),gn(f,A,K.depth,O),l)for(I=0;W>I;I++)for(B=0;u>B;B++)O=e.getCellRect(I,B),O&&gn(f,A,l,O);else if(C){for(f.beginPath(),I=0;W>I;I++)for(B=0;u>B;B++)O=e.getCellRect(I,B),O&&f.rect(O.x,O.y,O.width,O.height);f.strokeStyle=C,f.lineWidth=1,f.stroke()}if("h"===a)for(I=0;W>I;I++)O=Fp(e.getCellRect(I,0),e.getCellRect(I,u-1)),Fe(O,T),Wl(f,E,O.x,O.y,O.width,O.height,g);else if("v"===a)for(B=0;u>B;B++)O=Fp(e.getCellRect(0,B),e.getCellRect(W-1,B)),Fe(O,T),Wl(f,E,O.x,O.y,O.width,O.height,g);y._39O(f,y._83o)}});var qd=function(V,Y){Dr(qd,this,[V,Y])};ne(qd,qn,{_checkEmptyRect:!1,_81o:function(){var i=this._data,S=qd.superClass._81o.call(this),P=i.s("text");if(P!=G){var f,g,z=i.s("text.font"),o=i.s("text.align"),_=i.s("text.vAlign"),w=uk(z,P),r=w.width,u=w.height,U=i.getAnchor(),b=i.getWidth(),R=i.getHeight();"left"===o?f=-b*U.x:"center"===o?f=-b*U.x+(b-r)/2:"right"===o&&(f=b*(1-U.x)-w.width),"top"===_?g=-R*U.y:"middle"===_?g=-R*U.y+(R-u)/2:"bottom"===_&&(g=R*(1-U.y)-w.height);var N,h=i.getMatrix();if(N=Gr([h.tf(f,g),h.tf(f+r,g),h.tf(f+r,g+u),h.tf(f,g+u)]),S=Fp(S,N),S&&i.s("text.shadow")){var c=Cn(S);c.x+=i.s("text.shadow.offset.x"),c.y+=i.s("text.shadow.offset.y"),Fe(c,i.s("text.shadow.blur")),S=Fp(S,c)}}return S}});var tr=ji.Interactor=function(v){this.gv=this._graphView=v};ip("Interactor",m,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(m){this.gv.fi(m)},setCursor:function(A){Ai||this.gv.setCursor(A)},startDragging:function(D){var N=this;N._lastClientPoint=Ac(D),N._lastLogicalPoint=N.gv.lp(D),Hl(N,D)},clearDragging:function(){var J=this;J._lastClientPoint=J._lastLogicalPoint=J._logicalPoint=G},autoScroll:function(o){return this.gv.autoScroll(o,this._lastClientPoint)}});var ye=G,Ho=function(S){ye.handleWindowTouchMove(S)},Jl=function($){ye.handleWindowTouchEnd($),p.removeEventListener(Lk,Ho,f),p.removeEventListener(Xi,Jl,f),ye=G},bo=function(z){ye.handleWindowMouseMove(z)},gi=function(k){ye.handleWindowMouseUp(k),p.removeEventListener(md,bo,f),p.removeEventListener(Vo,gi,f),ye=G},Br=function(x,E){x!==ye&&(ye?Ai?ye.handleWindowTouchEnd(E):ye.handleWindowMouseUp(E):Ai?(p.addEventListener(Lk,Ho,f),p.addEventListener(Xi,Jl,f)):(p.addEventListener(md,bo,f),p.addEventListener(Vo,gi,f)),ye=x)},rj=function(m){var _=this;_.gv=m,_._is2d=m instanceof ji.GraphView,_._is2d&&(_.filter=function(t){return m.isSelectable(t)&&m.isInteractive(t)}),m.getView(),["mousedown","mousemove","touchstart","touchmove",so].forEach(function(i){_.addListener(i)}),_.initImageResource()};ne(rj,tr,{enableVR:function(g){var p=this;if(!!p._vrEnable!==g)if(p._vrEnable=g,g)p.gv.vr.mp(p.onVRControllerChange,p);else if(p.gv.vr.ump(p.onVRControllerChange,p),p._vrRayPolyline){var h=p.gv.dm();h.remove(p._vrRayPolyline),h.remove(p._vrRayHitPoint),p._vrRayPolyline=z,p._vrRayHitPoint=z}},onVRControllerChange:function(E){var l=this,j=E.property,m=E.newValue,W=l.gv.vr.getController(m.id),x=W.getRay();x&&("gamepad.button.trigger"===j?"down"===m._62O?l.handle_mousedown(x):l.handleWindowUp(x):"gamepad.pose"===j&&(l.handle_mousemove(x),l.handleWindowMove(x)))},drawVRRay:function(z,B,U){var G,s=this,Z=s.gv,e=s._vrRayPolyline,u=!1;if(e)G=s._vrRayHitPoint;else{var V=Z.dm();s._vrRayPolyline=e=new K.Polyline,s._vrRayHitPoint=G=new K.Node,G.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),G.setAnchor3d(.5,.5,.499);var D=.2/Z.vr.measureOflength;G.s3(D,D,D),e.s("intersect",!1),G.s("intersect",!1),V.add(e),V.add(G),u=!0}if(B){var $=U.world,n=U.worldNormal,l=$.x,R=$.y,W=$.z;e.s("shape.border.color","red"),e.setPoints([{x:z.origin.x,y:z.origin.z,e:z.origin.y},{x:l,y:W,e:R}]),G.s("3d.visible",!0),G.p3(l,R,W),G.lookAtDirection([n.x,n.y,n.z],"front")}else{e.s("shape.border.color","blue");var r=new K.Math.Vector3;r.copy(z.direction).setLength(1e3/s.gv.vr.measureOflength).add(z.origin),e.setPoints([{x:z.origin.x,y:z.origin.z,e:z.origin.y},{x:r.x,y:r.z,e:r.y}]),G.s("3d.visible",!1)}Z.fi({kind:"vrRayIntersect",ray:z,data:B,intersect:U,polyline:e,hitNode:G,begin:u})},addListener:function(c){var G=this;G.gv.getView().addEventListener(c,function(w){V.preventDefault(w),G.disabled||G["handle_"+c](w)},f)},handleWindowTouchMove:function(U){this.handleWindowMouseMove(U)},handleWindowMouseMove:function(D){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",D):(this.handleDownInfo("onBeginDrag",D),this.isDragging=!0))},handleWindowTouchEnd:function(m){this.handleWindowMouseUp(m)},handleWindowMouseUp:function(C){if(this.isDragging&&(this.handleDownInfo("onEndDrag",C),this.isDragging=!1),this.downInfo){var l=this.handle("onUp",C);l&&l.data===this.downInfo.data?this.handleMissingUp(C):this.handleDownInfo("onUp",C),this.downInfo=G}},handle_mousewheel:function(V){V.scrollDelta=V.wheelDelta/40,this.handle("onScroll",V)},handle_DOMMouseScroll:function(P){P.scrollDelta=2===P.axis?-P.detail:0,this.handle("onScroll",P)},handle_touchstart:function(R){this.handle_mousedown(R)},handle_touchmove:function(w){this.handle("onMove",w)},handle_mousedown:function(c){this.isDragging&&(this.handleDownInfo("onEndDrag",c),this.isDragging=!1),this.downInfo=this.handle("onDown",c),this.downInfo&&Br(this,c)},handle_mousemove:function(H){var a=this,O=a.gv;a._hoverTimer&&(N(a._hoverTimer),delete a._hoverTimer);var X,j,Z,Q=a.handle("onMove",H),k=this.currentInfo?this.currentInfo.data:G,y=this.currentInfo?this.currentInfo.hits:G;if(Q&&(j=Q.data,Z=Q.hits,a._hoverTimer=o(function(){N(a._hoverTimer),delete a._hoverTimer,a.handle("onHover",H,Q)},O.getHoverDelay()||V.hoverDelay)),j!==k){if(j&&(j.s("onEnter")&&j.s("onEnter")(H,j,O),this.fire("data","onEnter",H,j)),k&&(k.s("onLeave")&&k.s("onLeave")(H,k,O),this.fire("data","onLeave",H,k)),y)for(X in y)this.handleLeave(H,X);if(Z)for(X in Z){var Y=Z[X];Y.target.onEnter&&Y.target.onEnter(H,j,O,Y.point,Y.width,Y.height),this.fire(Y.type,"onEnter",Y.event,Y.data,Y.image,Y.comp,Y.point,Y)}}else{if(y)for(X in y)Z&&Z[X]||this.handleLeave(H,X);if(Z)for(X in Z)if(!y||!y[X]){var Y=Z[X];Y.target.onEnter&&Y.target.onEnter(H,j,O,Y.point,Y.width,Y.height),this.fire(Y.type,"onEnter",Y.event,Y.data,Y.image,Y.comp,Y.point,Y)}}this.currentInfo=Q},handle:function(c,l,Q){var g,S=this,O=S.gv;if(S._is2d){if(Q=Q||O.getDataInfoAt(l,this.filter),!Q)return;if(g=Q.ui.interactiveInfo){var y,J=Q.data;if(J.s(c)&&J.s(c)(l,J,O),this.fire("data",c,l,J),"body"===Q.part&&g.bodyInfo)y="body",Q.hits=this.handleImage(y,O.getImage(J),c,l,J,Q.point,g.bodyInfo);else if("icons"===Q.part&&g._38o){var n=g._38o[Q.name];n&&n[Q.index]&&(y="icons|"+Q.name+"|"+Q.index,Q.hits=this.handleImage(y,Q.icon,c,l,J,Q.point,n[Q.index]))}}return Q}var J,G;if(!Q)if(l&&l instanceof K.Math.Ray){var t=O.vr.intersectWorld(l);if(J=t.data,G=t.intersect,S.drawVRRay(l,J,G),!J)return;var T=O.getData3dUI(J);if(g=T.interactiveInfo,!g)return;Q={data:J,part:G.part,ui:T}}else{if(Q=O.getDataInfoAt(l),!Q)return;Q&&(Q={data:Q.data,part:Q.part})}if(!G){J=Q.data;var T=O.getData3dUI(J);if(Q.ui=T,g=T.interactiveInfo,!g)return Q;if(G=O.intersectObject(l,J),!G)return}J.s(c)&&J.s(c)(l,J,O),this.fire("data",c,l,J);var b,e=G.part;return"body"!==e&&(b=J.s(e+".image")||J.s("shape3d."+e+".image")),b||(b=J.s("all.image")||J.s("shape3d.image")),(g=g[b])?(Q.part="body",Q.interactiveInfo=g,Q.point=G.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}),Q.image=b,Q.hits=this.handleImage("body",b,c,l,J,Q.point,g.bodyInfo),Q):void 0},_handleLeaveOrMissing:function(Q,Y,$){var K="leave"===Q?this.currentInfo:this.downInfo;if(K){var v=K.interactiveInfo||K.ui.interactiveInfo;if(v){var D,o,F=K.data;if(this._is2d){if(o=this.gv.lp(Y),"body"===K.part&&v.bodyInfo)D="body","leave"===Q?this.handleLeaveImage($,D,this.gv.getImage(F),Y,F,o,v.bodyInfo):this.handleMissingUpImage(D,this.gv.getImage(F),Y,F,o,v.bodyInfo);else if("icons"===K.part&&v._38o){var N=v._38o[K.name];N&&N[K.index]&&(D="icons|"+K.name+"|"+K.index,"leave"===Q?this.handleLeaveImage($,D,K.icon,Y,F,o,N[K.index]):this.handleMissingUpImage(D,K.icon,Y,F,o,N[K.index]))}}else{var J=this.gv.intersectObject(Y,F);o=J?J.uv.multiply({x:v.bodyInfo.rect.width,y:v.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===Q?this.handleLeaveImage($,"body",K.image,Y,F,o,v.bodyInfo):this.handleMissingUpImage("body",K.image,Y,F,o,v.bodyInfo)}}}},handleDownInfo:function(A,h){if(this.downInfo){var k=this.downInfo,l=this.gv,F=k.interactiveInfo||k.ui.interactiveInfo;if(F){var X,H=k.data;if(H.s(A)&&H.s(A)(h,H,l),this.fire("data",A,h,H),this._is2d){var t=l.lp(h);if("body"===k.part&&F.bodyInfo)X="body",this.handleDownInfoImage(X,l.getImage(H),A,h,H,t,F.bodyInfo);else if("icons"===k.part&&F._38o){var N=F._38o[k.name];N&&N[k.index]&&(X="icons|"+k.name+"|"+k.index,this.handleDownInfoImage(X,k.icon,A,h,H,t,N[k.index]))}}else{var M=l.intersectObject(h,H);if(!M)return;t=M.uv.multiply({x:F.bodyInfo.rect.width,y:F.bodyInfo.rect.height}),this.handleDownInfoImage("body",k.image,A,h,H,t,F.bodyInfo)}}}},fire:function(s,t,e,O,g,c,B,S){this.gv.fi({kind:t,type:s,event:e,data:O,image:g,comp:c,view:this.gv,point:B,width:S?S.width:z,height:S?S.height:z})},handleImage:function(U,b,E,O,h,P,i){var X={};if(b&&(b=tn(b))){var s=this.gv,x=i.rect,F=this.convertPoint(P,i);F.inRect&&(b[E]&&b[E](O,h,s,F,x.width,x.height),this.fire("image",E,O,h,b,z,F,x),X[U+"|image"]={target:b,type:"image",image:b,data:h,event:O,point:F,width:x.width,height:x.height});for(var a=i.compInfos,_=b,G=a.length-1;G>=0;G--){var v=a[G],B=v.comp;F=this.convertPoint(P,v,_,B,s,h),F.inRect&&(x=v.rect,B[E]&&B[E](O,h,s,F,x.width,x.height),this.fire("comp",E,O,h,b,B,F,x),(b=x.image)&&(b[E]&&b[E](O,h,s,F,x.width,x.height),this.fire("image",E,O,h,b,z,F,x)),X[U+"|"+G]={target:B,type:"comp",comp:B,image:b,data:h,event:O,point:F,width:x.width,height:x.height},b&&(X[U+"|"+G+"|image"]={target:b,type:"image",image:b,data:h,event:O,point:F,width:x.width,height:x.height}))}}return X},handleLeave:function(b,s){return this._handleLeaveOrMissing("leave",b,s)},handleMissingUp:function(k){return this._handleLeaveOrMissing("missing",k)},handleLeaveImage:function(A,Z,S,h,u,t,J){if(S&&(S=tn(S))){var K=this.gv,V=J.rect,I=this.convertPoint(t,J);A===Z+"|image"&&(S.onLeave&&S.onLeave(h,u,K,I,V.width,V.height),this.fire("image","onLeave",h,u,S,z,I,V));for(var r=J.compInfos,d=S,F=r.length-1;F>=0;F--){var p=r[F],i=p.comp;I=this.convertPoint(t,p,d,i,K,u),V=p.rect,A===Z+"|"+F&&(i.onLeave&&i.onLeave(h,u,K,I,V.width,V.height),this.fire("comp","onLeave",h,u,S,i,I,V)),(S=V.image)&&A===Z+"|"+F+"|image"&&(S.onLeave&&S.onLeave(h,u,K,I,V.width,V.height),this.fire("image","onLeave",h,u,S,z,I,V))}}},handleMissingUpImage:function(o,t,r,e,g,Q){var P="onUp",A=this.downInfo.hits;if(A&&t&&(t=tn(t))){var K=this.gv,U=Q.rect,W=this.convertPoint(g,Q);!W.inRect&&A[o+"|image"]&&(t[P]&&t[P](r,e,K,W,U.width,U.height),this.fire("image",P,r,e,t,z,W,U));for(var q=Q.compInfos,S=t,p=q.length-1;p>=0;p--){var H=q[p],a=H.comp;W=this.convertPoint(g,H,S,a,K,e),W.inRect||(U=H.rect,A[o+"|"+p]&&(a[P]&&a[P](r,e,K,W,U.width,U.height),this.fire("comp",P,r,e,t,a,W,U)),(t=U.image)&&A[o+"|"+p+"|image"]&&(t[P]&&t[P](r,e,K,W,U.width,U.height),this.fire("image",P,r,e,t,z,W,U)))}}},handleDownInfoImage:function(C,l,k,u,L,P,$){var A=this.downInfo.hits;if(A&&l&&(l=tn(l))){var J=this.gv,t=$.rect,i=this.convertPoint(P,$);A[C+"|image"]&&(l[k]&&l[k](u,L,J,i,t.width,t.height),this.fire("image",k,u,L,l,z,i,t));for(var Z=$.compInfos,e=l,G=Z.length-1;G>=0;G--){var W=Z[G],D=W.comp;i=this.convertPoint(P,W,e,D,J,L),t=W.rect,A[C+"|"+G]&&(D[k]&&D[k](u,L,J,i,t.width,t.height),this.fire("comp",k,u,L,l,D,i,t)),(l=t.image)&&A[C+"|"+G+"|image"]&&(l[k]&&l[k](u,L,J,i,t.width,t.height),this.fire("image",k,u,L,l,z,i,t))}}},initImageResource:function(){V.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(j,Q,D,A,h,d){var B=Q.rect,e=Q.matrix.applyInverse(j).sub(B),U=e.x>=0&&e.y>=0&&e.x<=B.width&&e.y<=B.height;if(!U)return e;if(A&&Qb(A.pixelPerfect,d,h)){var B,r=1;this._is2d?(r=h.getZoom(),B=jd(j.x,j.y,z,r)):B=jd(j.x,j.y);var H=!1,s=B.x,W=B.y,Y=B.width,L=B.height,q=V.hitMaxArea,i=Y*L*r*r;if(i>q){var x=Math.sqrt(q/i);r*=x}Y*=r,L*=r,2>Y&&(Y=2),2>L&&(L=2),s*=r,W*=r;var C=Iq(Y,L),u=new gb(0,-s,-W,r,r);u.append(Q.matrix),h._drawForChecking=!0,A.transform=u;var F=D.comps;D.comps=[A],Ar(C,D,0,0,Y,L,d,self),D.comps=F,delete A.transform,h._drawForChecking=!1;try{for(var $=0,P=C.getImageData(0,0,Y,L).data;$<P.length;$+=4)if(0!==P[$+3]){H=!0;break}C.restore()}catch(y){Lf=G,H=!1}e.inRect=H}else e.inRect=!0;return e}});var Wi=ji.DefaultInteractor=function(y){Dr(Wi,this,[y])};ip("DefaultInteractor",tr,{handle_mousedown:function(D){Jd(D);var O=this,u=O.gv,P=u.getDataAt(D);!u.setFocus(D)||u._editing||u._scrolling||(Rc(D)?u.handleDoubleClick(D,P):u.handleClick(D,P),!Ni()&&P&&(u.isMovable(P)||u.isInteractive(P))||!u.isPannable()||!Tl(D)||Rj(D)||(O._tx=u.tx(),O._ty=u.ty(),O.startDragging(D)))},handleWindowMouseUp:function(Z){var y=this,p=y.gv;p._panning&&(delete p._panning,p.onPanEnded(),y.fi({kind:"endPan",event:Z})),delete y._tx,delete y._ty,y.clearDragging()},handle_mousemove:function(l){var q=this,$=q.gv;q._hoverTimer&&(N(q._hoverTimer),delete q._hoverTimer),q._hoverTimer=o(function(){q.fi({kind:"hover",event:l}),N(q._hoverTimer),delete q._hoverTimer},$.getHoverDelay()||V.hoverDelay)},handle_touchmove:function(k){this.handle_mousemove(k)},handleWindowMouseMove:function(r){var U=this,A=U.gv,V=U._lastClientPoint;U.fi({kind:A._panning?"betweenPan":"beginPan",event:r}),A._panning=1,A.setTranslate(U._tx+r.clientX-V.x,U._ty+r.clientY-V.y)},handle_mousewheel:function(r){this.gv.handleScroll(r,r.wheelDelta)},handle_DOMMouseScroll:function(M){2===M.axis&&this.gv.handleScroll(M,-M.detail)},handle_keydown:function(X){this.gv.handleKeyDown(X)}});var gh=ji.SelectInteractor=function(p){Dr(gh,this,[p])};ip("SelectInteractor",tr,{_42:function(){var W=this,n=W.gv,F=n.getZoom(),l=W.mark,O=W.div;O||(O=W.div=Rm(),Mk(W.getView(),O));var a={};a.x=l.x*F+n.tx(),a.y=l.y*F+n.ty(),a.width=l.width*F,a.height=l.height*F,op(O,a),this.intersects()?(O.style.border="",O.style.background=n.getRectSelectBackground()):(O.style.background="",O.style.border="1px solid "+n.getRectSelectBorderColor())},handle_mousedown:function(M){var X=this,w=X.gv;if(X._57I=G,X.pendingClickThrough=G,!(w._editing||w._scrolling||Ni())){var q=w.getDataAt(M),P=w.sm();q?Rj(M)?P.co(q)?P.rs(q):P.as(q):P.co(q)?q instanceof Ro&&q.isClickThroughEnabled()&&(X.pendingClickThrough=Ac(M)):P.ss(q):Rj(M)||!w.isPannable()?Tl(M)&&(Rj(M)||P.cs(),w.isRectSelectable()&&(X.startDragging(M),w._77O=1)):Tl(M)&&(X._57I=Ac(M))}},handle_mouseup:function(H){var K=this,C=K.gv,h=K._57I;if(h&&(Li(h,Ac(H))<=1&&C.sm().cs(),K._57I=G),K.pendingClickThrough){if(Li(K.pendingClickThrough,Ac(H))<=1){var e=C.getDataAt(H);if(e instanceof Ro&&e.isClickThroughEnabled()){var R=C.getDataAt(H,function(I){C._clickThroughChecking=!0;var l=I.getParent()===e&&C.isSelectable(I);return delete C._clickThroughChecking,l});R&&(H.clickThrough=!0,C.sm().ss(R))}}K.pendingClickThrough=G}},handleWindowMouseUp:function(i){this.clear(i)},handleWindowMouseMove:function(L){var p=this,k=p.gv;p._logicalPoint=k.lp(L),p.mark?(p.fi({kind:"betweenRectSelect",event:L}),k.isPannable()&&p.autoScroll(L),p.redraw()):p.fi({kind:"beginRectSelect",event:L}),p.mark=Gr(p._lastLogicalPoint,p._logicalPoint),p.redraw()},intersects:function(){var A=this,K=A._lastLogicalPoint,z=A._logicalPoint;return K.x>z.x||K.y>z.y},clear:function(R){var c=this,i=c.gv,k=c.mark;if(c._57I=G,c.pendingClickThrough=G,c._lastLogicalPoint){if(k){if(0!==k.width&&0!==k.height){var g=i.getDatasInRect(k,c.intersects());if(!g.isEmpty()){var K=i.sm(),x=K.toSelection();g.each(function(J){K.co(J)?x.remove(J):x.add(J)}),K.ss(x)}}Nl(c.div),delete c.div,delete c.mark,c.redraw(),c.fi({kind:"endRectSelect",event:R}),i.onRectSelectEnded()}c.clearDragging(),delete i._77O}},redraw:function(){var A=this;A._draw||(A._draw=1,o(function(){A.mark&&A._42(),delete A._draw},16))}});var Le=ji.MoveInteractor=function(u){Dr(Le,this,[u])};ip("MoveInteractor",tr,{handle_mousedown:function(j){var x=this,D=x.gv;if(Tl(j)&&!D._editing&&!D._scrolling&&!Ni()){var k=D.getSelectedDataAt(j);!k||D.isInteractive(k)&&!D.isMovable(k)?D._focusData=G:(x._data=k,D.handleMouseDown&&D.handleMouseDown(j,k),x.startDragging(j),D.isMovable(k)&&(D._moving=1))}},handleWindowMouseUp:function(v){var b=this,e=b.gv;e.handleMouseUp&&e.handleMouseUp(v,b._data),b.clear(v)},handleWindowMouseMove:function(Q){var O=this,$=O._data,s=O.gv;if((!s._93O||!s._93O(Q,$))&&s._moving){O._logicalPoint||O.fi({kind:"prepareMove",event:Q});var j=O._logicalPoint?"betweenMove":"beginMove",S={kind:j,event:Q},V=O._logicalPoint=s.lp(Q);"beginMove"!==j||O._alreadyBeginTransaction||(O._alreadyBeginTransaction=!0,s.getDataModel().beginTransaction());var k=O._calcShift(j,Q),q=k.x,g=k.y,v=O.gv.getMoveMode(Q,$);v&&("x"===v?g=0:"y"===v?q=0:"xy"!==v&&(q=g=0)),s.moveSelection(q,g),O._lastLogicalPoint=V,O.autoScroll(Q),O.fi(S)}},_calcShift:function(){var n=this,v=n._logicalPoint,i=n._lastLogicalPoint,O=v.x-i.x,t=v.y-i.y;return{x:O,y:t}},clear:function(k){var $=this,S=$.gv;$._lastLogicalPoint&&($._lastLogicalPoint=$._data=S._moving=G,$._logicalPoint&&($.fi({kind:"endMove",event:k}),S.onMoveEnded()),$.clearDragging()),$._alreadyBeginTransaction&&($._alreadyBeginTransaction=!1,S.getDataModel().endTransaction())}});var Kh=ji.ScrollBarInteractor=function(e){Dr(Kh,this,[e])};ip("ScrollBarInteractor",tr,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(q){var t=this.gv.getViewRect();return this._41o()&&(t.x+t.width-this.gv.lp(q).x)*this.gv.getZoom()<Um},isH:function(k){var e=this.gv.getViewRect();return this._40o()&&(e.y+e.height-this.gv.lp(k).y)*this.gv.getZoom()<Um},handle_mousemove:function(Z){this.handle_touchmove(Z)},handle_touchmove:function(B){if(!pj&&Tl(B)&&this.gv.isScrollBarVisible()){var k=this,n=k.isV(B),L=k.isH(B);(n||L)&&k.gv.showScrollBar(),k.gv._scrolling=n||L}},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(L){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=G,this.fi({kind:"endScroll",event:L})},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(x){var A=this;if(A.gv.setFocus(x),Jd(x),A.handle_touchmove(x),!(tl(x)>1)&&A.gv._scrolling&&A.gv.isScrollBarVisible()){A._cp=Ac(x),A._tx=A.gv.tx(),A._ty=A.gv.ty();var h=A.isV(x);A._state=h?"vScroll":"hScroll",Hl(A,x),A.fi({kind:"beginScroll",event:x})}},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(H){var j=Ac(H),t=this.gv.getViewRect(),l=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-j.y)*l.height/t.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-j.x)*l.width/t.width),this.fi({kind:"betweenScroll",event:H})
}});var fe=ji.TouchInteractor=function(c,p){p=p||{},p.selectable===z&&(p.selectable=!0),p.movable===z&&(p.movable=!0),p.pannable===z&&(p.pannable=!0),p.pinchable===z&&(p.pinchable=!0),p.editable===z&&(p.editable=!0),this.params=p,Dr(fe,this,[c])};ip("TouchInteractor",tr,{ms_edit:1,setUp:function(){var i=this;fe.superClass.setUp.call(i),Ai&&i.params.editable&&i.gv.setEditInteractor(i)},tearDown:function(){var I=this;fe.superClass.tearDown.call(I),Ai&&I.params.editable&&I.gv.setEditInteractor(G)},clear:function(W){var R=this,B=R.gv;B._moving&&(R.fi({kind:"endMove",event:W}),delete B._moving,B.onMoveEnded(),B.dm().endTransaction()),B._panning&&(R.fi({kind:"endPan",event:W}),delete B._panning,B.onPanEnded()),B._pinching&&(R.fi({kind:"endPinch",event:W}),delete B._pinching,B.onPinchEnded()),B._editing&&(R._46O(W),R._77I=R._node=R._edge=R._shape=R._rect=R._89I=R._index=B._editing=G),R._moving=R._panning=R._pinching=R._editing=R._57I=R._data=R._beginHistory=G,R.clearDragging()},handle_touchstart:function(e){var i=this;if(!i.gv._editing){Jd(e),i._57I=G;var T=i.params,H=i.gv,b=H.sm(),o=H.getDataAt(e),W=tl(e);if(1===W){if(Rc(e))return H.handleDoubleClick(e,o),void 0;H.handleClick(e,o),o&&(H.handleMouseDown&&H.handleMouseDown(e,o),i._data=o),T.selectable||(o=G),o?(b.co(o)||b.ss(o),T.editable&&H.isEditable(o)&&i._79I(e,o,!0)?(i._editing=1,i.startDragging(e)):T.movable&&H.isMovable(o)&&(i._moving=1,i.startDragging(e))):(i._57I=Ac(e),T.pannable&&H.isPannable()&&(i._panning=1,i.startDragging(e),i._translate={x:H.tx(),y:H.ty()}))}else if(T.pinchable&&2===W){i._pinching=1,i.startDragging(e);var K=H.getView(),$=H.getZoom(),g=K.getBoundingClientRect(),C=e.touches[0],c=e.touches[1],Y={x:(C.clientX+c.clientX)/2-g.left,y:(C.clientY+c.clientY)/2-g.top};Y.x-=H.tx(),Y.y-=H.ty(),Y.x/=$,Y.y/=$,i._p=Y,i._d=Zg(e)}}},handle_touchend:function(z){var g=this,M=g.gv,s=g._57I,U=g._data;s&&(Li(s,Ac(z))<=1&&M.sm().cs(),g._57I=G),U&&M.handleMouseUp&&M.handleMouseUp(z,U)},handleWindowTouchEnd:function(e){this.clear(e)},handleWindowTouchMove:function(y){var d=this,s=d.gv,j=tl(y);if(1===j){if(d._editing&&(d._beginHistory||(d._beginHistory=1,s.dm().beginTransaction()),s._editing=1,d._78I(y)),d._moving)d._beginHistory||(d._beginHistory=1,s.dm().beginTransaction()),d.handleMove(y);else if(d._panning){var S=Ac(y);s.setTranslate(d._translate.x+S.x-d._lastClientPoint.x,d._translate.y+S.y-d._lastClientPoint.y),d.fi({kind:s._panning?"betweenPan":"beginPan",event:y}),s._panning=1}}else if(2===j&&d._pinching){var Z=Zg(y);s.handlePinch(d._p,Z,d._d),d._d=Z,d.fi({kind:s._pinching?"betweenPinch":"beginPinch",event:y}),s._pinching=1}},handleMove:function(F){var P=this,Q=P.gv,o=Q.lp(F);Q._93O&&Q._93O(F,P._data)||(Q.moveSelection(o.x-P._lastLogicalPoint.x,o.y-P._lastLogicalPoint.y),P._lastLogicalPoint=o,P.autoScroll(F),P.fi({kind:Q._moving?"betweenMove":"beginMove",event:F}),Q._moving=1)}});var K=p.ht,nc=K.graph._editor={Math:K.Math,Guide:{}};nc.getStyle=function(I){var Q,g=nc.StyleMap;return g&&(Q=g[I],Q!==z)?Q:nc.DefaultStyleMap[I]},nc.setStyle=function(m,f){var z=nc.StyleMap;z||(z=nc.StyleMap={}),z[m]=f},nc.inEdit=function(K){return K._inXEdit===!0},nc.startEdit=function(q){q._inXEdit=!0,nc.Inject.doInject(q)},nc._46O=function(b){b._inXEdit=!1,nc.Inject.undoInject(b)},nc.toScreenPosition=function(b,j){var R=b.tx(),a=b.ty(),u=b._zoom;return new nc.Math.Vector2(j.x*u+R,j.y*u+a)},nc.checkHit=function(F,r,g){return F.distanceTo(r)<g?!0:!1},nc.toWorldPosition=function(r,K){var R=r.tx(),p=r.ty(),Q=r._zoom;return{x:(K.x-R)/Q,y:(K.y-p)/Q}},nc.setAntialias=function(q,O){for(var _,U=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],Q=0,u=U.length;u>Q&&(_=U[Q],!(_ in q));Q++);q[_],q[_]=O},nc.getTargetCornersOnScreen=function(l,E){if(!E)return null;var v,I=[];if(Nj(E,l)){var H=Jk(l,E);v=[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}else{if(!E.getCorners)return null;v=E.getCorners()}return v.forEach(function(_){var o=nc.toScreenPosition(l,_);I.push(o.x,o.y)}),I},nc.log=function(){};var Po=nc.Inject={_modules:[]};Po.registAsModule=function(n,w){var q={},Y={};for(var a in n){var Q=w.prototype[a];q[a]=Q}n.getBackup=function(n){return q[n]},n.getBackups=function(){return q},Y.doInject=function(){for(var c in n)"getBackup"!==c&&(w.prototype[c]=n[c])},Y.undoInject=function(){for(var e in n)"getBackup"!==e&&(w.prototype[e]=q[e])},Po._modules.push(Y)},Po.doInject=function(Z){for(var s,U=Po._modules,$=0,J=U.length;J>$;$++)s=U[$],s.doInject(Z)},Po.undoInject=function(P){for(var z,E=Po._modules,e=0,g=E.length;g>e;e++)z=E[e],z.undoInject(P)};var tr=K.graph.EditInteractor=function(T){var B=this,H=I.createElement("canvas");H.className="editCanvas",H.style.position="absolute",B._styleMap={},B._canvas=H,B._context=H.getContext("2d"),tr.superClass.constructor.call(B,T),nc.setAntialias(B._context,!1),B._subModules=[new nc.Anchor(B),new nc.RotateX(B),new nc.Rect(B),new nc.Curve(B),new nc.MoveHelper(B)],B._gridGuide=new nc.Guide.Grid(B),B._rectGuide=new nc.Guide.Rect(B)},Nr=tr;K.Default.def(tr,K.graph.Interactor,{ms_edit:1,ms_fire:1}),m.defineProperties(tr.prototype,{editDetail:{get:function(){var i=!!this._editDetail;return i},set:function(U){var m=this,v=m._editDetail;v!==U&&(m._editDetail=U,m.gv._editing=U,m.fp("editDetail",v,U),m.fp("pointsEditingMode",v,U),m.fi({kind:U?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(r){(!this._editDetail||r)&&(this.gv._editing=r,r||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(u){this._editing=u,this.gvEditing=u}},pointsEditingMode:{get:function(){return this.editDetail},set:function(v){var y=this;y.editDetail!==v&&(v?y._tryEnterEditDetailMode():y._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var F=this._gridEnabled;if(!F)return!1;var w=this.gv;return w?!0:!0},set:function(y){y!==this._gridEnabled&&(this._gridEnabled=y,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(u){u!==this._agEnabled&&(this._agEnabled=u,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),tr.prototype.getSubModule=function(b){var E,O,g,W=this._subModules;for(O=0,g=W.length;g>O;O++)if(E=W[O],E.catalog===b)return E},tr.prototype.invokeSubModule=function(L,q){var i=this,H=i._subModules;if(H)for(var K,k,S,Z=Array.prototype.slice.call(arguments,2),W=0,I=H.length;I>W;W++)if(K=H[W],k=K[L],k&&(S=k.apply(K,Z),S!=z&&q))return K},tr.prototype.invokeSubModuleInverse=function(F,J){var g=this,w=g._subModules;if(w)for(var f,i,E,e=Array.prototype.slice.call(arguments,2),H=w.length-1;H>=0;H--)if(f=w[H],i=f[F],i&&(E=i.apply(f,e),E!=z&&J))return f},tr.prototype.setUp=function(){nc.log("setUp");var Y=this,r=Y.gv,W=r.getView(),j=Y._canvas;tr.superClass.setUp.call(Y),r.setEditInteractor(Y),r._79O?W.insertBefore(j,r._79O):W.appendChild(j),nc.startEdit(r),Y.invokeSubModule("setUp"),r.dm().mm(Y._onDataModelChanged,Y),r.dm().md(Y._onDataPropertyChanged,Y)},tr.prototype.tearDown=function(){nc.log("tearDown");var L=this,r=L.gv,K=r.getView();L._resetCustomCursorStyle(),tr.superClass.tearDown.call(L),r.dm().umm(L._onDataModelChanged,L),r.dm().umd(L._onDataPropertyChanged,L),r.setEditInteractor(null),K.removeChild(L._canvas),L._drawTimer&&(N(L._drawTimer),L._drawTimer=null),nc._46O(r),L.invokeSubModule("tearDown")},tr.prototype._onDataModelChanged=function(v){var s=this;("clear"===v.kind||"remove"===v.kind&&s.editDetail&&v.data===s.getSubModule("Curve").target)&&(s.editDetail=!1,s._42())},tr.prototype._onDataPropertyChanged=function(S){var O=this;if(O.editDetail){var o=O.getSubModule("Curve"),b=S.data;b===o.target&&(b._writing||o._handleDataChanged())}},tr.prototype.clear=function(){nc.log("clear")},tr.prototype.redraw=function(){this._42()},tr.prototype._42=function(){var p=this;p._drawTimer||(p._drawTimer=o(function(){p._drawTimer=null,p.drawImpl()},0))},tr.prototype.drawImpl=function(){var Q;for(Q in{_42:!0})break;return function(){var R=this,j=R._canvas,J=R.gv,V=J.getWidth(),D=J.getHeight(),s=R._context,c=K.Default.getInternal();(j.width!==V||j.height!==D)&&c.setCanvas(j,V,D),s.clearRect(0,0,j.width,j.height);var b=R._getValidSelection();s.save();var T=K.Default.devicePixelRatio;s.scale(T,T),R._gridGuide._42(),R.invokeSubModuleInverse(Q,!1,s,J,b),R._rectGuide._42(),s.restore()}}(),tr.prototype._getValidSelection=function(){var S=this,D=S.gv,T=D.sm().getSelection(),W=[];return T.each(function(v){D.isVisible(v)&&D.isEditable(v)&&W.push(v)}),W},tr.prototype.handle_touchmove=function(T){return this.handle_mousemove(T)},tr.prototype.handle_mousemove=function(q){if(!K.Default.isDragging()){var $=this;($.editDetail||!Ni())&&($.gvEditing=!1,$._checkEdit(q)&&($.gvEditing=!0))}},tr.prototype.handle_touchstart=function(W){return this.handle_mousedown(W)},tr.prototype.handle_mousedown=function(s){Jd(s);var P=this;if(P.editDetail||!Ni()){if(Rc(s)&&!s.clickThrough){if(P.editDetail){if(P._tryQuitEditDetailMode(s))return}else if(P._tryEnterEditDetailMode())return;P.gv.dm().beginTransaction();var d=P.invokeSubModule("handleDoubleClick",!0,s);if(P.gv.dm().endTransaction(),d)return}var K=P._checkEdit(s);K&&(P._downPosition=P._getLogicalPoint(s),P.gv.dm().beginTransaction(),K.startEdit(P,s),P.editing=!0)}},tr.prototype._checkEdit=function(D){var y=this,z=y.gv,J=y._getLogicalPoint(D),V=y.invokeSubModule("check",!0,z,D,J)||null;return y._editMod=V,V},tr.prototype.handleWindowTouchMove=function(p){return this.handleWindowMouseMove(p)},tr.prototype.handleWindowMouseMove=function(E){var P=this,U=P._downPosition;if(U){var c=P._getLogicalPoint(E);if(c.distanceTo(U)<P.getStyle("moveSensitivity"))return;delete P._downPosition}var f=P._editMod;f&&f.handleEdit(P.gv,E)},tr.prototype._getLogicalPoint=function(O){var L=this,g=K.Default.getLogicalPoint(O,L._canvas);return new nc.Math.Vector2(g)},tr.prototype.handleWindowTouchEnd=function(E){return this.handleWindowMouseUp(E)},tr.prototype.handleWindowMouseUp=function(){var m;for(m in{_46O:!0})break;return function(A){var n=this;n.editing=!1,n.setCursor("default"),n.invokeSubModule(m,!1,A),n._42(),n.gv.dm().endTransaction()}}(),tr.prototype.handle_mousewheel=function(O){var _=this;Jd(O),_.invokeSubModule("preHandleScroll",!0)||_.gv.handleScroll(O,O.wheelDelta)},tr.prototype.handleDelete=function(){var Q=this;if(!Q.editDetail){Q.gv.dm().beginTransaction();var V=Q.invokeSubModule("handleNormalStateDelete",!0);return Q.gv.dm().endTransaction(),V||Q.gv.removeSelection(),void 0}Q.gv.dm().beginTransaction(),Q.invokeSubModule("handleDelete",!0),Q.gv.dm().endTransaction(),Q._42()},tr.prototype.handle_keydown=function(L){var z=this;if((L.metaKey||L.ctrlKey)&&z._42(),Ni(L)&&!z.editing)return z.gvEditing=!1,z.setCursor("default"),z._42(),void 0;var O=Nd(L);return z.editDetail?((O||me(L))&&(z.editDetail=!1,z._42()),z.gv.dm().beginTransaction(),z.invokeSubModule("handle_keydown",!0,L),z.gv.dm().endTransaction(),void 0):(z.gv.dm().beginTransaction(),z.invokeSubModule("handleNormalStateKeyDown",!0,L),z.gv.dm().endTransaction(),O&&z._tryEnterEditDetailMode(),void 0)},tr.prototype.handle_keyup=function(z){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,z),this.gv.dm().endTransaction()},tr.prototype._tryEnterEditDetailMode=function(){var d=this;return!d.editDetail&&d.invokeSubModule("canEnterEditDetailMode",!0)&&1===d._getValidSelection().length?(d.editDetail=!0,d._42(),!0):void 0},tr.prototype._tryQuitEditDetailMode=function(w){var L=this;if(L.editDetail){var W=L.gv,Z=L.getSubModule("Curve").target;return w&&W.getDataAt(w)===Z?void 0:(L.editDetail=!1,L._42(),!0)}},tr.prototype.setStyle=function(b,c,s){var w=this;s?nc.setStyle(b,c):w._styleMap[b]=c,w.fp("styleChanged",null,{key:b,value:c,base:s}),w._42()},tr.prototype.getStyle=function($){var i=this,q=i._styleMap[$];return q!==z?q:nc.getStyle($)},tr.prototype.setCursor=function(A){this._resetCustomCursorStyle(),K.graph.EditInteractor.superClass.setCursor.call(this,A)},tr.prototype._resetCustomCursorStyle=function(){var N=this;if(N._customStyle){var D=this.gv.getView();D.classList&&D.classList.remove&&D.classList.remove(N._customStyle),N._customStyle=null}},tr.prototype._setRotateCursor=function(R){var X=this,O=X._cursorFactory;O||(O=X._cursorFactory=new nc.CursorFactory(X));var A=O.getRotateCursor(R),i=X.gv.getView();X._resetCustomCursorStyle(),X._customStyle=A,i.classList&&i.classList.add&&i.classList.add(A)};var As=nc.Group=function(D){var R=this;R._entities=D,R._64O=0,R._position={x:0,y:0},R._scale={x:1,y:1},R._anchor={x:.5,y:.5},R._anchor2={x:.5,y:.5}};As.prototype={},As.prototype.constructor=As;var Il=null;As.findOrCreateGroup=function(q){if(Il&&Il.checkIsMe(q))return Il;var j=new nc.Group(q);return j.getKeyOb()?(Il=j,j):void 0},As.prototype.checkIsMe=function(L){var d=this._entities;if(d.length!==L.length)return!1;var u,l={},A=L.length;for(u=0;A>u;u++)l[L[u]._id]=!0;for(u=0;A>u;u++)if(!l[d[u]._id])return!1;return!0},As.prototype.getRotation=function(){return this._64O},As.prototype.getPosition=function(){return this._position},As.prototype.getAnchor=function(){return this._anchor},As.prototype.getWidth=function(){return this._width},As.prototype.getScale=function(){return this._scale},As.prototype.getSize=function(){return{width:this._width,height:this._height}},As.prototype.getHeight=function(){return this._height},As.prototype.getKeyOb=function(){for(var U=this._entities,j=U.length-1;j>=0;j--){var Z=U[j];if(this.isNode(Z))return Z}},As.prototype.getAnchor2=function(){var o=this,d=o.rotateCenter;if(d)return d;var b=o.getKeyOb();if(!b)return o._anchor;var _=o._anchor2,c=b.getMatrix();return c.tf({x:b.getWidth()*(_.x-b.getAnchor().x),y:b.getHeight()*(_.y-b.getAnchor().y)})},As.prototype.setAnchor2=function(H,Y){var e=this,p=e.getKeyOb();if(p){var b,U=p.getMatrix();b="number"==typeof H?{x:H,y:Y}:H;var $=U.tfi(b);e._anchor2={x:p.getAnchor().x+$.x/p.getWidth(),y:p.getAnchor().y+$.y/p.getHeight()}}},As.prototype.setRotation=function(){},As.prototype.beginRotate=function(O){this.rotateCenter=O.pos,this.rotateMode=O.groupRotateMode},As.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},As.prototype.addRotation=function(x,q){return"batch"===q?this._addRotationInBatchMode(x):"block"===q?this._addRotationInBlockMode(x):void 0},As.prototype._addRotationInBlockMode=function(A){var s=this,m=s.rotateCenter||s.getPosition();s._entities.forEach(function(i){if(s.isNode(i)){var d=i.getMatrix();d.translate(-m.x,-m.y),d.rotate(A),d.translate(m.x,m.y);var b=Math.sign(i.getScale().x);i.setRotation(x(d.b*b,d.a*b)),i.setPosition(d.tx,d.ty)}})},As.prototype._addRotationInBatchMode=function(l){var c=this,C=c._anchor2;c._entities.forEach(function(Q){if(c.isNode(Q)){var B=Q.getAnchor(),f=Q.getMatrix(),S=f.tf({x:Q.getWidth()*(C.x-B.x),y:Q.getHeight()*(C.y-B.y)}),U=new nc.Math.Matrix2d;U.set(f.a,f.b,f.c,f.d,f.tx,f.ty),U.translate(-S.x,-S.y),U.rotate(l),U.translate(S.x,S.y);var A=Math.sign(Q.getScale().x);Q.setRotation(x(U.b*A,U.a*A)),Q.setPosition(U.tx,U.ty)}})},As.prototype.setPosition=function(n){var W,G,y,X,$=this,s=$._position,F=n.x-s.x,K=n.y-s.y,Y=$._entities;for(G=0,y=Y.length;y>G;G++)W=Y[G],gp(W)&&(X=W.getPosition(),W.setPosition(X.x+F,X.y+K));$._position=n},As.prototype.setScale=function(F,s){var f=this,x=F/f._scale.x,o=s/f._scale.y;f._adjustChildScaleOrSize(x,o,"size"),f._scale={x:F,y:s}},As.prototype.getRect=function(){var C=this,o=C._position,q=C._width,r=C._height;return{x:o.x-q/2,y:o.y-r/2,width:q,height:r}},As.prototype.setSize=function(V,L){var Z=this,V=Math.max(1,V),L=Math.max(1,L),d=V/Z._width,p=L/Z._height;Z._adjustChildScaleOrSize(d,p,"size"),Z._width=V,Z._height=L},As.prototype._adjustChildScaleOrSize=function(H,e,q){var L,j,h,G,m,k,i,o,J,C,U,y,Z,f,A=this,w=A._position,t=A._entities,F=new nc.Math.Matrix2d;for(j=0,h=t.length;h>j;j++)if(L=t[j],A.isNode(L)){if(G=L.getPosition(),m=L.getRotation(),k=L.getWidth(),i=L.getHeight(),o=L.getScale(),U=o.x*k,y=o.y*i,F.identity().scale(U,y).rotate(m).translate(G.x,G.y).translate(-w.x,-w.y).rotate(-A._64O),m=x(F.b*Math.sign(U),F.a*Math.sign(U)),F.scale(H,e),J=Math.cos(m),C=Math.sin(m),Math.abs(J)<.001?(Z=F.b/C,f=-F.c/C):(Z=F.a/J,f=F.d/J),"scale"===q)L.setScale(Z/k,f/i);else if("size"===q){var W=Z/o.x,B=f/o.y;L.setScale(nb(Z)*Math.abs(o.x),nb(f)*Math.abs(o.y)),L.setSize(Math.max(.1,Math.abs(W)),Math.max(.1,Math.abs(B)))}F.rotate(A._64O).translate(w.x,w.y),L.setPosition(F.tx,F.ty)}},As.prototype.getMatrix=function(){var q=this,w=q._position,A=K.Default.getInternal(),b=q._scale;return new A.Mat(q._64O,w.x,w.y,b.x,b.y)},As.prototype.toGlobal=function(O){return this.getMatrix().tf(O)},As.prototype.getCorners=function(){var E=this,p=E._width,Z=E._height,y=E._anchor,k=-p*y.x,B=-Z*y.y,O=E.getMatrix();return[O.tf(k,B),O.tf(k,B+Z),O.tf(k+p,B+Z),O.tf(k+p,B)]},As.prototype.calcInfo=function(){var V,F,T,q,e,K,O=this,L=[],$=O._entities,f=O._64O;for(q=0,e=$.length;e>q;q++)K=$[q],O.isNode(K)&&K.getCorners&&L.push.apply(L,K.getCorners());if(L.length){var w=Math.cos(-f),A=Math.sin(-f),u=1/0,H=-1/0,i=1/0,o=-1/0;for(q=0,e=L.length;e>q;q++)T=L[q],V=T.x,F=T.y,T.x=w*V-A*F,T.y=A*V+w*F,u=Math.min(u,T.x),H=Math.max(H,T.x),i=Math.min(i,T.y),o=Math.max(o,T.y);O._width=(H-u)/O._scale.x,O._height=(o-i)/O._scale.y,w=Math.cos(f),A=Math.sin(f);var M=O._anchor;V=u+(H-u)*M.x,F=i+(o-i)*M.y,O._position={x:w*V-A*F,y:A*V+w*F}}},As.prototype.isNode=function(x){return gp(x)?Nj(x)?!1:!0:!1},As.prototype._42=function(o,w,f){var P,M,X,n,B,c,m,y,F=this,T=F._entities,O=F.rotateMode;for("batch"===O&&(y=F.getKeyOb()),P=0,M=T.length;M>P;P++)X=T[P],F.isNode(X)&&(c=X.getRect(),n=nc.toScreenPosition(f,{x:c.x,y:c.y}),B=nc.toScreenPosition(f,{x:c.x+c.width,y:c.y+c.height}),m={min:n,max:B},X===y&&(m.isKeyOb=!0),nc.Icons.DrawIcon(o,w,nc.Icons.GroupSubEntityRect,m))};var er=nc.CurveActiving=function(p,i){this._curve=p,this._interactor=p._interactor;for(var n in i)this[n]=i[n]};er.prototype={},er.prototype.constructor=er,m.defineProperties(er.prototype,{point:{get:function(){return this._point},set:function(H){var c=this;c._point=H,c.editingCtrl||c._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(n){var u=this;u._pairs=n,u.editingCtrl&&u._firePointChange()}}}),er.prototype._firePointChange=function(){var R=this,n=R.getCurrentEditingPoint();if(!n)return i.fi({kind:"selectPoint"}),void 0;var i=R._interactor,N=this._curve.target;if(N){var H=nc.getDataMatrix(N).invert(),M=n.e;n=H.apply(nc.toWorldPosition(i.gv,n)),n.e=M;var j=R._lastFirePoint;j&&Math.abs(n.x-j.x)<1e-5&&Math.abs(n.y-j.y)<1e-5&&(n.e==z&&j.e==z||Math.abs(n.e-j.e)<1e-5)||(R._lastFirePoint=n,i.fi({kind:"selectPoint",x:n.x,y:n.y,e:n.e}))}},er.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},er.prototype.getCurrentEditingPoint=function(){var u=this,H=u.editingCtrl;if(H){var n=u.pairs;if(n){var D=n[H.pairId],q=D[H.type];if(q)return q}}return u._point};var Wh=nc.CursorFactory=function(F){var g=this;g._interactor=F,g._rotateCursorStyles={}};Wh.prototype={},Wh.prototype.constructor=Wh,Wh.prototype.getRotateCursor=function(E){var V=this;0>E&&(E+=2*Math.PI);var J=V._interactor,G=J.getStyle("rotateCursorSize"),_=J.getStyle("rotateCursorRound"),F=Math.round(180*(E/Math.PI)/_);F*_>=360&&(F=0);var w=V._rotateCursorStyles,Z="htCustomRotateStyle_"+G+"_"+_+"_"+F;return w[Z]||(V._produceRotateCursor(Z,G,_,F),w[Z]=!0),Z},Wh.prototype._produceRotateCursor=function(X,m,j,q){var K=this;K._interactor;var U=K._canvas;U||(U=K._canvas=I.createElement("canvas")),U.width=U.height=m*devicePixelRatio,U.style.width=U.style.height=m+" px";var n=U.getContext("2d");nc.setAntialias(n,!1),n.scale(devicePixelRatio,devicePixelRatio);var C,P,L,o,p,N=Math.round(m/2),J=""+N+" "+N+",auto !important;";C=Math.PI/180*q*j,n.clearRect(0,0,m,m),n.save(),n.scale(m/32,m/32),n.translate(16,16),n.rotate(C+Math.PI/2),n.beginPath(),n.moveTo(-8,0),n.lineTo(-8,3),n.lineTo(-5,3),n.moveTo(8,0),n.lineTo(8,3),n.lineTo(5,3),n.moveTo(-8,3),n.quadraticCurveTo(0,-6,8,3),n.restore(),n.strokeStyle="white",n.lineWidth=4,n.stroke(),n.strokeStyle="black",n.lineWidth=2,n.stroke(),P=JSON.stringify(U.toDataURL()),o="cursor:url("+P+")"+J,1!==devicePixelRatio&&(L='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+m+'px" height="'+m+'px"><image xlink:href='+P+' width="'+m+'" height="'+m+'"/></svg>',o+="cursor:url(data:image/svg+xml;base64,"+btoa(L)+")"+J,o+="cursor:-webkit-image-set(url("+P+")"+devicePixelRatio+"x,url("+P+")1x)"+J),p=I.createElement("style"),p.textContent="body."+X+" *, ."+X+"{"+o+"}",I.head.appendChild(p)};var yg=nc.Guide.Grid=function(d){var n=this;n._interactor=d,n._alignmentGuideId=0,n._xAlignmentGuide=[],n._yAlignmentGuide=[]};yg.prototype={},yg.prototype.constructor=yg,m.defineProperties(yg.prototype,{gridBlockSize:{get:function(){var U=this;return U._gridBlockSize||U._interactor.getStyle("gridBlockSize")},set:function(_){this._gridBlockSize=_,this._interactor._42()}},gridThickLinesEvery:{get:function(){var l=this;return l._gridThickLinesEvery||l._interactor.getStyle("gridThickLinesEvery")},set:function(l){this._gridThickLinesEvery=l,this._interactor._42()}},gridEnabled:{get:function(){var e=this,F=e._interactor;return F.gridEnabled&&e.isValidGrid()}}}),yg.prototype._42=function(){var L=this,$=L._interactor;L.gridEnabled&&L.drawGrid(),$.alignmentGuideEnabled&&L.drawAlignmentGuide()},yg.prototype.makeMatrix=function(){var y=this,O=y._interactor.getStyle("gridAngle"),$=y._interactor.getStyle("gridRotation"),h=new nc.Math.Matrix2d,R=Math.sin(O),z=Math.cos(O);return h.set(1,0,z,R,0,0),h.rotate($),h},yg.prototype.isValidGrid=function(){var k=this,J=Math.PI,G=k._interactor,L=G.gv;if(L._zoom<G.getStyle("gridZoomThreshold"))return!1;var C=G.getStyle("gridAngle"),u=Math.abs(180*(C%J/J)),W=1-1e-8;return W>u||u>180-W?!1:!0},yg.prototype.drawAlignmentGuide=function(){var h=this,r=h._interactor,M=r.gv,L=r._canvas,G=r._context,H=L.width,I=L.height,s=M.tx(),F=M.ty(),V=M._zoom;G.beginPath(),G.strokeStyle=r.getStyle("gridAlignmentGuideColor"),G.lineWidth=1,h._xAlignmentGuide.forEach(function(C){var B=C.p*V+s;G.moveTo(B,0),G.lineTo(B,I)}),h._yAlignmentGuide.forEach(function(h){var _=h.p*V+F;G.moveTo(0,_),G.lineTo(H,_)}),G.stroke()},yg.prototype.drawGrid=function(){function I(g,u,F,X){var V=nc.toScreenPosition(p,d.apply({x:g,y:u})),o=nc.toScreenPosition(p,d.apply({x:F,y:X}));W.moveTo(V.x,V.y),W.lineTo(o.x,o.y)}var V=this,U=V._interactor,v=V.gridBlockSize,y=V.gridThickLinesEvery,q=U.getStyle("gridThickColor"),u=U.getStyle("gridLightColor"),p=U.gv,e=U._canvas,W=U._context,L=e.width,P=e.height,d=V.makeMatrix(),G=d.applyInverse(nc.toWorldPosition(p,{x:0,y:0})),r=d.applyInverse(nc.toWorldPosition(p,{x:L,y:0})),N=d.applyInverse(nc.toWorldPosition(p,{x:0,y:P})),w=d.applyInverse(nc.toWorldPosition(p,{x:L,y:P})),$=Math.min(G.x,r.x,N.x,w.x),Z=Math.max(G.x,r.x,N.x,w.x),Q=Math.min(G.y,r.y,N.y,w.y),D=Math.max(G.y,r.y,N.y,w.y);L=Z-$,P=D-Q;var T=Math.ceil($/v),h=Math.floor(Z/v),Y=Math.ceil(Q/v),S=Math.floor(D/v);p.tx(),p.ty(),p._zoom;var x,F,i;for(W.save(),W.lineWidth=1,W.beginPath(),W.strokeStyle=q,i=Math.ceil(T/y)*y;h>=i;i+=y)x=i*v,I(x,Q,x,D);for(i=Math.ceil(Y/y)*y;S>=i;i+=y)F=i*v,I($,F,Z,F);for(W.stroke(),W.beginPath(),W.strokeStyle=u,i=T;h>=i;i++)0!==i%y&&(x=i*v,I(x,Q,x,D));for(i=Y;S>=i;i++)0!==i%y&&(F=i*v,I($,F,Z,F));W.stroke(),W.restore()},yg.prototype.getAlignmentGuides=function(){var V=this;return{x:V._xAlignmentGuide,y:V._yAlignmentGuide}},yg.prototype.addAlignmentGuide=function(u,Y,e){var A=this,q="x"===u?A._xAlignmentGuide:A._yAlignmentGuide,e=e?e:++A._alignmentGuideId,N={p:Y,id:e};if(q.length){var r=A._findClosestAlignmentGuide(N.p,q);r.dis<0?q.splice(r.index+1,0,N):q.splice(r.index,0,N)}else q.push(N);return A._interactor._42(),e},yg.prototype.findClosest=function(N,d,$){var M=this,l=M._interactor,k=l.gv;$&&(N=nc.toWorldPosition(k,N));var p,H,I,E=1/0,L=1/0,j=N.x,b=N.y;if(M.gridEnabled){var S=M.gridBlockSize,A=M.makeMatrix(),K=A.applyInverse(N);K=A.apply({x:Math.round(K.x/S)*S,y:Math.round(K.y/S)*S}),E=K.x-j,L=K.y-b,I=!0}if(l.alignmentGuideEnabled&&(p=M._findClosestAlignmentGuide(j,M._xAlignmentGuide).dis,H=M._findClosestAlignmentGuide(b,M._yAlignmentGuide).dis,Math.abs(p)<Math.abs(E)&&(E=p,I=!0),Math.abs(H)<Math.abs(L)&&(L=H,I=!0)),I){I=!1;var w=k._zoom,V=l.getStyle("smartGuideSensitivity")/w,P={};if(Math.abs(E)<V&&"y"!==d&&(P.x=$?E*w:E,I=!0),Math.abs(L)<V&&"x"!==d&&(P.y=$?L*w:L,I=!0),I)return P}},yg.prototype._findClosestAlignmentGuide=function(T,q){if(!q.length)return{dis:1/0};for(var x,k=0,g=q.length-1;g-k>1;)x=Math.floor((k+g)/2),q[x].p<T?k=x:g=x;var v=q[k].p-T,Q=q[g].p-T;return Math.abs(v)<=Math.abs(Q)?{line:q[k],dis:v,index:k}:{line:q[g],dis:Q,index:g}},yg.prototype.removeAllAlignmentGuide=function(x){var G=this;"y"!==x&&(G._xAlignmentGuide=[]),"x"!==x&&(G._yAlignmentGuide=[]),G._interactor._42()},yg.prototype.removeAlignmentGuide=function(O){for(var q,m,u,k=this,j=k._xAlignmentGuide,h=0;2>h;h++)for(j=0===h?k._xAlignmentGuide:k._yAlignmentGuide,q=0,m=j.length;m>q;q++)if(u=j[q],u.id===O)return j.splice(q,1),k._interactor._42(),{axis:0===h?"x":"y",position:u.p};return!1},yg.prototype.adjustAlignmentGuide=function(K,_){var I=this,c=I.removeAlignmentGuide(K);return c?(I.addAlignmentGuide(c.axis,_,K),!0):!1};var Ge=nc.Guide.Rect=function(a){var Y=this;Y._interactor=a};Ge.prototype={},Ge.prototype.constructor=Ge,Ge.prototype.gatherRects=function(){var K,C,J,q,O=this,W=O._interactor.gv,z=[],_=[],s={x:z,y:_},N={},p=W.getDataModel(),G=p.a("width"),k=p.a("height");G&&k&&(K=0,C=0,J=G,q=k,z.push({node:p,type:0,p:K},{node:p,type:1,p:K+J/2},{node:p,type:2,p:K+J}),_.push({node:p,type:0,p:C},{node:p,type:1,p:C+q/2},{node:p,type:2,p:C+q}),N[p._id||0]={x:K,y:C,width:J,height:q}),p.each(function(L){if(gp(L)&&!W.isSelected(L)&&W.isVisible(L)){var D=!1;if(W.sm().getSelection().each(function(C){D||(L.isHostOn(C)?D=!0:L.isDescendantOf(C)&&(D=!0))}),!D){var w=L.getRect();K=w.x,C=w.y,J=w.width,q=w.height,z.push({node:L,type:0,p:K},{node:L,type:1,p:K+J/2},{node:L,type:2,p:K+J}),_.push({node:L,type:0,p:C},{node:L,type:1,p:C+q/2},{node:L,type:2,p:C+q}),N[L._id]=w}}}),z.sort(function(t,u){return t.p-u.p}),_.sort(function(l,E){return l.p-E.p}),O._grid=s,O._87I=N},Ge.prototype.gatherLines=function(H,a,U){var r,F,h,O,v,t,s,X,f,c,g,M,e=this,o=[e.findClosest({x:H.x,y:H.y},a),e.findClosest({x:H.x+H.w/2,y:H.y+H.h/2},a),e.findClosest({x:H.x+H.w,y:H.y+H.h},a)],S={},$=e._87I;U=U||255;var p,_;for(e._guideLine=[],r=0;2>r;r++)for(S={},0===r?(O="y",X=H.x,f=X+H.w):(O="x",X=H.y,f=X+H.h),F=0;3>F;F++)v=o[F],v&&isFinite(v[O])&&(p=1<<3*r+F,U&p&&(t=v[O+"Line"],s=t.node,_=s._id||0,S[_]||(S[_]=!0,M=$[_],"y"===O?(c=M.x,g=M.x+M.width):(c=M.y,g=M.y+M.height),h=t.p,e._guideLine.push({type:O,a:X,b:f,c:c,d:g,p:h,center:1===t.type}))))},Ge.prototype._binarySearchClosest=function(C,A){if(!A.length)return{dis:1/0};for(var a,H=0,r=A.length-1;r-H>1;)a=Math.floor((H+r)/2),A[a].p<C?H=a:r=a;var d=A[H].p-C,W=A[r].p-C;return Math.abs(d)<=Math.abs(W)?{line:A[H],dis:d}:{line:A[r],dis:W}},Ge.prototype.findClosest=function(g,c,z){var B=this,k=B._interactor,M=k.gv,Z=B._grid;z&&(g=nc.toWorldPosition(M,g));var $,T=B._binarySearchClosest(g.x,Z.x),m=B._binarySearchClosest(g.y,Z.y),n=T.dis,E=m.dis,N=M._zoom,h=k.getStyle("smartGuideSensitivity")/N,f={};return Math.abs(n)<h&&"y"!==c&&(f.x=z?n*N:n,f.xLine=T.line,$=!0),Math.abs(E)<h&&"x"!==c&&(f.y=z?E*N:E,f.yLine=m.line,$=!0),$?f:void 0},Ge.prototype._42=function(){var F=this,i=F._guideLine;if(i&&!K.Default.isCtrlDown()){var f,Y,E,d,m,v,W,b,t,q,x,n,c,u,Q,y,O,G=F._interactor,a=G.gv,o=G._context,R=a.tx(),H=a.ty(),C=a._zoom,Z=G.getStyle("guideLineTextSpacing");for(f=0,Y=i.length;Y>f;f++)E=i[f],b=E.type,t=E.p,q=E.a,x=E.b,n=E.c,c=E.d,u=Math.min(q,n),Q=Math.max(x,c),"x"===b?(d=t*C+R,m=u*C+H,v=d,W=Q*C+H):(d=u*C+R,m=t*C+H,v=Q*C+R,W=m),nc.Icons.DrawIcon(G,o,nc.Icons.MoveLineGuide,{rect:[d,m,v,W],center:E.center}),c>=q&&x>=n||(u=q>c?c:x,Q=q>c?q:n,O=Q-u,"x"===b?(E.center2center||(d-=Z,v=d),m=u*C+H,W=Q*C+H,y=nc.Icons.MoveLineGuideDistanceV):"y"===b&&(E.center2center||(m-=Z,W=m),d=u*C+R,v=Q*C+R,y=nc.Icons.MoveLineGuideDistanceH),nc.Icons.DrawIcon(G,o,y,{x0:d,y0:m,x1:v,y1:W,dis:O}))}},Ge.prototype.clear=function(){this._guideLine=null},nc.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var fm=nc.Icons={},Nf=1e4,Fm=null,uf="rgb(51,153,255)",rq="rgb(183,232,135)",db="rgb(255,204,153)",Vj=6;K.Default.setImage("Icons.RectPoint",{width:Vj,height:Vj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:uf,rect:[0,0,Vj,Vj]}]});var Yl="#e000e0";fm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var p=fm.GroupSubEntityRect.data;if(!p)return[];var S=p.min,f=p.max;return[S.x,S.y,S.x,f.y,f.x,f.y,f.x,S.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return fm.GroupSubEntityRect.data.isKeyOb?Yl:"#666666"}}}]},fm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[fm.Line.data.P1.x,fm.Line.data.P1.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[fm.Line.data.P2.x,fm.Line.data.P2.y],Vj,Vj]}}}]},fm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return fm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},fm.Rect={comps:[{type:"shape",points:{func:function(){var b=fm.Rect.data;if(!b)return[];var K=b.LT,$=b.LB,s=b.RB,p=b.RT;return[K.x,K.y,$.x,$.y,s.x,s.y,p.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:uf},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},rect:{func:function(){return[[fm.Rect.data.LT.x,fm.Rect.data.LT.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},rect:{func:function(){return[[fm.Rect.data.LB.x,fm.Rect.data.LB.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},rect:{func:function(){return[[fm.Rect.data.RB.x,fm.Rect.data.RB.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},rect:{func:function(){return[[fm.Rect.data.RT.x,fm.Rect.data.RT.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},visible:{func:function(){return fm.Rect.data.L?!0:!1}},rect:{func:function(){return[[fm.Rect.data.L.x,fm.Rect.data.L.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},visible:{func:function(){return fm.Rect.data.R?!0:!1}},rect:{func:function(){return[[fm.Rect.data.R.x,fm.Rect.data.R.y],Vj,Vj]
}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},visible:{func:function(){return fm.Rect.data.T?!0:!1}},rect:{func:function(){return[[fm.Rect.data.T.x,fm.Rect.data.T.y],Vj,Vj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return fm.Rect.data.rotation}},visible:{func:function(){return fm.Rect.data.B?!0:!1}},rect:{func:function(){return[[fm.Rect.data.B.x,fm.Rect.data.B.y],Vj,Vj]}}}]};var yq=16;K.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:uf,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:uf,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),fm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[fm.Anchor.data.POS.x,fm.Anchor.data.POS.y],yq,yq]}}}]},fm.TipShiftX=12,fm.TipShiftY=12;var hc=[8,28];fm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[fm.TipHelper.data.helperPos.x,fm.TipHelper.data.helperPos.y,hc[0]*fm.TipHelper.data.size,hc[1]]}},background:{func:function(){return Fm.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return fm.TipHelper.data.text}},rect:{func:function(){return[fm.TipHelper.data.helperPos.x,fm.TipHelper.data.helperPos.y,hc[0]*fm.TipHelper.data.size,hc[1]]}},color:{func:function(){return Fm.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var kp=7;fm.ShapePoint={comps:[{type:"circle",rect:{func:function(){var g=fm.ShapePoint.data.point;return[g,kp,kp]}},background:{func:function(){var V=fm.ShapePoint.data.isEnd;return V?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:uf}]},fm.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return fm.ShapeBgCurve.data.P}},segments:{func:function(){return fm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:uf}]};var rf=8;fm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var u=fm.ShapeHighlighPoint.data;return[[u.x,u.y],rf,rf]}},background:{func:function(){return Fm.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Dl=10;fm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var f=fm.ShapeHighlighRealPoint.data;return[[f.x,f.y],Dl,Dl]}},background:"#ffffff",borderWidth:2,borderColor:uf}]};var Kl=8;fm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var h=fm.ShapeHighlighCtrlPoint.data,A=h.x,g=h.y,d=Kl/2;return[A-d,g-d,A-d,g+d,A+d,g+d,A+d,g-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Fm.getStyle("shapeCtrlPointBorderColor")||uf}}}]};var tb=3;fm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return fm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:tb,borderColor:{func:function(){return Fm.getStyle("curveHighlightColor")}}}]},fm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return fm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},fm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return fm.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return fm.MoveLineGuide.data.center?rq:db}}}]};var Tk=5;fm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var r=fm.MoveLineGuideDistanceH.data,W=r.x0,A=r.y0;return[W,A-Tk,W,A+Tk]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:db},{type:"shape",points:{func:function(){var q=fm.MoveLineGuideDistanceH.data,T=q.x1,l=q.y1;return[T,l-Tk,T,l+Tk]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:db},{type:"text",text:{func:function(){return Math.round(fm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var c=fm.MoveLineGuideDistanceH.data;return[[(c.x0+c.x1)/2,c.y0-10],20,20]}},color:db,font:"12px Arial",align:"center"}]},fm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var h=fm.MoveLineGuideDistanceV.data,G=h.x0,U=h.y0;return[G-Tk,U,G+Tk,U]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:db},{type:"shape",points:{func:function(){var S=fm.MoveLineGuideDistanceV.data,G=S.x1,m=S.y1;return[G-Tk,m,G+Tk,m]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:db},{type:"text",text:{func:function(){return Math.round(fm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var V=fm.MoveLineGuideDistanceV.data;return[[V.x0-10,(V.y0+V.y1)/2],20,20]}},color:db,font:"12px Arial",align:"center"}]},K.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),fm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var c=fm.EdgeElevationGuide.data,z=c.x,N=c.y,R=Fm.getStyle("curveElevationIntersectSize"),e=Fm.getStyle("curveElevationGuideShift");return z+=e[0],N+=e[1],[z-R,N-R,2*R,2*R]}}}]},K.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),K.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),fm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return fm.ConnectGuide.data.rotation}},rect:{func:function(){var s=fm.ConnectGuide.data.connect;s.x,s.y;var A=Fm.getStyle("connectGuideIntersectSize");return[[s.x,s.y],2*A,2*A]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var I=fm.ConnectGuide.data.cursorPos||fm.ConnectGuide.data.connect,K=Fm.getStyle("connectGuideIntersectSize");return[[I.x,I.y],2*K-2,2*K-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var Q=fm.ConnectGuide.data.connect,G=fm.ConnectGuide.data.cursorPos||Q;return[Q.x,Q.y,Q.x+.5*(G.x-Q.x),Q.y,G.x+.5*(Q.x-G.x),G.y,G.x,G.y]}}}]},K.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),K.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),fm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var I=fm.ConnectGuideGarbage.data.hover;return I?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var F=fm.ConnectGuideGarbage.data,X=Fm.getStyle("connectGuideGarbageIntersectsize");return F.hover&&(X+=5),[[F.x,F.y],2*X,2*X]}}}]};var od=6;fm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return fm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var p=fm.ShapeActivingCtrl.data;return[p.point.x,p.point.y,p.c1.x,p.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:uf},{type:"shape",visible:{func:function(){return fm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var V=fm.ShapeActivingCtrl.data;return[V.point.x,V.point.y,V.c2.x,V.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:uf},{type:"shape",visible:{func:function(){return fm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=fm.ShapeActivingCtrl.data.c1,w=e.x,u=e.y,t=od/2;return"c1"===fm.ShapeActivingCtrl.data.hl&&(t+=.5),[w-t,u-t,w-t,u+t,w+t,u+t,w+t,u-t]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===fm.ShapeActivingCtrl.data.hl?Fm.getStyle("shapeCtrlPointHighlightBorder")||uf:Fm.getStyle("shapeCtrlPointBorderColor")||uf}}},{type:"shape",visible:{func:function(){return fm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var R=fm.ShapeActivingCtrl.data.c2,k=R.x,u=R.y,w=od/2;return"c2"===fm.ShapeActivingCtrl.data.hl&&(w+=.5),[k-w,u-w,k-w,u+w,k+w,u+w,k+w,u-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===fm.ShapeActivingCtrl.data.hl?Fm.getStyle("shapeCtrlPointHighlightBorder")||uf:Fm.getStyle("shapeCtrlPointBorderColor")||uf}}}]},fm.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:uf,rect:{func:function(){return[[fm.RoundPoint.data.x,fm.RoundPoint.data.y],Vj,Vj]}}}]},nc.Icons.DrawIcon=function(h,Q,B,u){B.width=B.height=Nf,B.data=u,Fm=h,K.Default.drawImage(Q,B,0,0,Nf,Nf)},nc.Icons.MapPoints=function(l,V){for(var W=0,_=l.length;_>W;W++)l[W]/=V},nc.roundTo=function(Z,j,T){var v=Math.abs(Z%j);return T>v||T>j-v?j*Math.round(Z/j):Z},nc.toFixed=function(S){return Math.round(100*S)/100},nc.getDataMatrix=function(P){if(P instanceof K.Shape){var H=new K.Math.Matrix2d,C=P.getPosition();return H.translate(-C.x,-C.y).scale(P.getScale().x,P.getScale().y).rotate(P.getRotation()).translate(C.x,C.y),H}return P.getMatrix?P.getMatrix():new K.Math.Matrix2d};var Dk=nc.Math.Curve=function(){this._curves=[]};Dk.prototype={},Dk.prototype.constructor=Dk,Dk.prototype.createFromHtShape=function(u,i,D){i instanceof K.List&&(i=i.toArray());var O,l,Z,L,Q,B,g,t=this,m=null,j=null,Y=0,o=nc.Math.Vector2,d=nc.Math.CubicBezier,M=function(W){return new o(u[W],u[W+1],D?D[W/2]:z)};for(l=0,Z=i.length;Z>l;l++){switch(L=i[l],Q=null,L){case 1:j=M(Y),m=j,Y+=2;break;case 2:O=M(Y),Y+=2,Q=new d(j,j.clone(),O.clone(),O),j=O;break;case 3:B=M(Y),O=M(Y+2),Y+=4,Q=new d(j,B.clone().sub(j).multiplyScalar(2/3).add(j),B.clone().sub(O).multiplyScalar(2/3).add(O),O),j=O;break;case 4:B=M(Y),g=M(Y+2),O=M(Y+4),Y+=6,Q=new d(j,B,g,O),j=O;break;case 5:if(!m)break;Q=new d(j,j.clone(),m.clone(),m),j=null,m=null}Q&&(Q._index=t._curves.length,t._curves.push(Q))}},Dk.prototype.checkPoint=function(f,U){var Z,K,J,k,C,e=this,x=e._curves;for(Z=0,K=x.length;K>Z;Z++)if(k=x[Z],C=k.intersectRect(f,U,U),C.length)return J=0,C.forEach(function(A){J+=A.t}),J/=C.length,f=k.getPointAt(J),f.t=J,{bezier:k,intersection:f}},Dk.prototype.insertKnot=function(R,j){var w=R.insertKnot(j),M=this,q=M._curves;q.splice(R._index,1,w[0],w[1])},Dk.prototype._isCloseEnough=function(v,X){return Math.abs(v.x-X.x)<1e-6&&Math.abs(v.y-X.y)<1e-6},Dk.prototype._isSamePoint=function(o,y){return o===y},Dk.prototype.moveRealPoint=function(m,A){var E=this,C=E._curves,i=A.clone().sub(m);C.forEach(function(h){var d=h._p1;h._p2,h._p3;var l=h._p4;E._isSamePoint(d,m)&&(h._p2.add(i),h._p1=A),E._isSamePoint(l,m)&&(h._p3.add(i),h._p4=A)})},Dk.prototype.moveCtrlDueToRealPointMovement=function(w,Q){var x=this,f=x._curves,U=function(z){z.add(Q),z.e&&Q.e&&(z.e+=Q.e)};f.forEach(function(i){var h=i._p1;i._p2,i._p3;var g=i._p4;x._isSamePoint(h,w)&&U(i._p2),x._isSamePoint(g,w)&&U(i._p3)})},Dk.prototype.moveCtrlPoint=function(j,v,D){var B=j[D];if(B){B.e!==z&&(v.e=B.e);var P=this,M=P._curves;v.clone().sub(B),M.forEach(function(r){var V;"c2"===D?V="_p2":"c1"===D&&(V="_p3"),P._isSamePoint(r[V],B)&&(r[V]=v)}),j[D]=v}},Dk.prototype.deleteRealPoint=function(Q,f){var H,M,W,T,V,R,Y,L=this,k=L._curves,J={},d=[],A=nc.Math.CubicBezier;for(M=0,W=k.length;W>M;M++)H=k[M],T=H._p1,V=H._p2,R=H._p3,Y=H._p4,(J[M]||!L._isSamePoint(T,Q))&&(L._isSamePoint(Y,Q)?W>M+1&&L._isSamePoint(k[M+1]._p1,Q)&&(f||d.push(new A(T,V,k[M+1]._p3,k[M+1]._p4))):d.push(H));L._curves=d},Dk.prototype.findPairs=function(j,s){var N,T,i,B,m,l,S,L,C=this,D=C._curves,J={},e=[];for(T=0,i=D.length;i>T;T++)N=D[T],B=N._p1,m=N._p2,l=N._p3,S=N._p4,!J[T]&&C._isSamePoint(B,j)&&(s?e.push({point:B,r2:S}):e.push({point:B,c2:m})),C._isSamePoint(S,j)&&(L=s?{point:S,r1:B}:{point:S,c1:l},i>T+1&&C._isSamePoint(D[T+1]._p1,j)&&(s?L.r2=D[T+1]._p4:L.c2=D[T+1]._p2,J[T+1]=!0),e.push(L));return e},Dk.prototype.toHtShape=function(){var R=this,e=R._curves,x=[],U=[],o={x:1/0,y:1/0};return e.forEach(function(m){var c=m._p1,N=m._p2,k=m._p3,r=m._p4;return R._isCloseEnough(c,o)||(x.push(1),U.push(c.clone())),o=r,R._isCloseEnough(c,N)&&R._isCloseEnough(k,r)?(x.push(2),U.push(r.clone()),void 0):(x.push(4),U.push(N.clone(),k.clone(),r.clone()),void 0)}),{segments:x,points:U}};var $l=nc.Math.CubicBezier=function(O,r,k,L){var d=this;d._id=nc.Math.CubicBezier._globalId++,d._p1=O,d._p2=r,d._p3=k,d._p4=L};$l._globalId=1,$l.prototype={},$l.prototype.constructor=$l,$l.prototype.toString=function(){return this._id},$l.prototype.intersectRect=function(C,p,t){var H=p/2,v=t/2,F=C.x,o=C.y,m=nc.Math.Vector2,I=new m(-H+F,-v+o),h=new m(H+F,v+o),T=new m(h.x,I.y),y=new m(I.x,h.y),S=this,d=S.intersectLine(I,T),u=S.intersectLine(T,h),M=S.intersectLine(h,y),U=S.intersectLine(y,I),O=d.concat(u).concat(M).concat(U);return O},$l.prototype.intersectLine=function(y,t){var c,P,J,m,F,w,A,_,U,q,p,N,o,z=this,Q=y.clone().min(t),x=y.clone().max(t);m=z._p1,F=z._p2,w=z._p3,A=z._p4,c=m.clone().multiplyScalar(-1),P=F.clone().multiplyScalar(3),J=w.clone().multiplyScalar(-3),p=c.add(P).add(J).add(A),c=m.clone().multiplyScalar(3),P=F.clone().multiplyScalar(-6),J=w.clone().multiplyScalar(3),q=c.add(P).add(J),c=m.clone().multiplyScalar(-3),P=F.clone().multiplyScalar(3),U=c.add(P),_=m.clone(),o=new nc.Math.Vector2(y.y-t.y,t.x-y.x),N=y.x*t.y-t.x*y.y;for(var b=z.getRoots(o.dot(p),o.dot(q),o.dot(U),o.dot(_)+N),K=new Array,R=0,d=b.length;d>R;R++){var V=b[R];if(!(0>V||V>1)){var C=m.clone().lerp(F,V),f=F.clone().lerp(w,V),s=w.clone().lerp(A,V),v=C.lerp(f,V),I=f.lerp(s,V),Z=v.lerp(I,V);Z.t=V,y.x==t.x?Q.y<=Z.y&&Z.y<=x.y&&K.push(Z):y.y==t.y?Q.x<=Z.x&&Z.x<=x.x&&K.push(Z):Z.x>=Q.x&&Z.y>=Q.y&&Z.x<=x.x&&Z.y<=x.y&&K.push(Z)}}return K},$l.prototype.solveTForPoint=function(l){var f,M,D,Y,S=this;f=S._p1.x-l.x,M=S._p2.x-l.x,D=S._p3.x-l.x,Y=S._p4.x-l.x;for(var b=S.getRoots(Y-3*D+3*M-f,3*D-6*M+3*f,3*M-3*f,f),F=z,I=1/0,B=0,q=b.length;q>B;B++){var t=b[B];if(!(0>t||t>1)){var w=S._p1.clone().lerp(S._p2,t),j=S._p2.clone().lerp(S._p3,t),K=S._p3.clone().lerp(S._p4,t),o=w.lerp(j,t),A=j.lerp(K,t),L=o.lerp(A,t);L.t=t;var g=Math.abs(L.y-l.y);I>g&&(I=g,F=L)}}return F},$l.prototype.getPointAt=function(s){var j=this,F=j._p1,I=j._p2,X=j._p3,y=j._p4,N=F.clone().lerp(I,s),Y=I.clone().lerp(X,s),r=X.clone().lerp(y,s),W=N.lerp(Y,s),n=Y.lerp(r,s);return W.lerp(n,s)},$l.prototype.getRoots=function(X,x,u,m){var Q,I,R,P,g,o=new Array;if(Math.abs(X)<1e-6){var Q=x,I=u/Q,R=m/Q,P=I*I-4*R;if(P>0){var g=Math.sqrt(P);o.push(.5*(-I+g)),o.push(.5*(-I-g))}else 0==P&&o.push(.5*-I)}x/=X,u/=X,m/=X,Q=(3*u-x*x)/3,I=(2*x*x*x-9*u*x+27*m)/27;var F=x/3,A=I*I/4+Q*Q*Q/27,V=I/2;if(Math.abs(A)<=1e-6&&(A=0),A>0){var M,z,g=Math.sqrt(A);M=-V+g,z=M>=0?Math.pow(M,1/3):-Math.pow(-M,1/3),M=-V-g,M>=0?z+=Math.pow(M,1/3):z-=Math.pow(-M,1/3),o.push(z-F)}else if(0>A){var w=Math.sqrt(-Q/3),e=Math.atan2(Math.sqrt(-A),-V)/3,s=Math.cos(e),d=Math.sin(e),f=Math.sqrt(3);o.push(2*w*s-F),o.push(-w*(s+f*d)-F),o.push(-w*(s-f*d)-F)}else{var M;M=V>=0?-Math.pow(V,1/3):Math.pow(-V,1/3),o.push(2*M-F),o.push(-M-F)}return o},$l.prototype._70I=function(){var T=this;return T._p1.distanceToSquared(T._p2)<1e-10&&T._p3.distanceToSquared(T._p4)<1e-10},$l.prototype.insertKnot=function(v){var A=this,u=A._p1,f=A._p2,N=A._p3,Q=A._p4,y=u.clone().lerp(f,v),D=f.clone().lerp(N,v),s=N.clone().lerp(Q,v),b=y.clone().lerp(D,v),R=D.clone().lerp(s,v),M=b.clone().lerp(R,v);return A._70I()?(u.clone().lerp(Q,v),[new nc.Math.CubicBezier(u,u.clone(),M.clone(),M),new nc.Math.CubicBezier(M,M.clone(),Q.clone(),Q)]):[new nc.Math.CubicBezier(u,y,b,M),new nc.Math.CubicBezier(M,R,s,Q)]};var Dn=K.Default.getInternal().ui().EdgeUI,oc={_47O:function(o){var J=this,p=oc.getBackups()._47O;nc.inEdit(J.gv)||p.call(J,o)}};nc.Inject.registAsModule(oc,Dn);var qn=K.Default.getInternal().ui().NodeUI,qi={_47O:function(K){var j=this,k=qi.getBackups()._47O;nc.inEdit(j.gv)||k.call(j,K)},getSelectWidth:function(){var Q=this,j=Q.gv,J=Q._data;if(j.isEditable(J)&&nc.inEdit(j))return 0;var M=qi.getBackup("getSelectWidth");return M.call(Q)}};nc.Inject.registAsModule(qi,qn);var hh=K.graph.GraphView,Jh={_editPointSize:function(){var y=K.Default.isTouchable,t=nc.getStyle("pointSize");return t[y?0:1]}(),isPointEditable:function(y){var J=this;if(nc.inEdit(J))return J._pointEditableFunc?J._pointEditableFunc(y):!0;var Y=Jh.getBackup("isPointEditable");Y.call(J,y)},isEditable:function(U){var o,Y=this,Z=Jh.getBackup("isEditable");if(o=U instanceof nc.Group?!0:Z.call(Y,U),!nc.inEdit(Y))return o;if(!(U instanceof K.Edge))return o;if(!U.s("2d.editable"))return!1;var s=Y.getEditableFunc();return s?s(U):!0},_42:function(S,m){var N=this,b=Jh.getBackups()._42;if(b.call(N,S,m),nc.inEdit(N)){var v=N.getEditInteractor();v.drawImpl()}}};nc.Inject.registAsModule(Jh,hh);var jq=K.Default.getInternal().ui().ShapeUI,Rr={_47O:function(h){var R=this,L=Rr.getBackups()._47O;nc.inEdit(R.gv)||L.call(R,h)}};nc.Inject.registAsModule(Rr,jq);var Wi=K.graph.DefaultInteractor,vr={handle_mousewheel:function(p){var z=this,M=vr.getBackup("handle_mousewheel");nc.inEdit(z.gv)||M.call(z,p)}};nc.Inject.registAsModule(vr,Wi);var Le=K.graph.MoveInteractor,ze={_calcShift:function(R,B){var H=this,m=ze.getBackup("_calcShift"),I=H.gv;if(!nc.inEdit(I))return m.call(H,R,B);var v=I.getEditInteractor(),w=v.getSubModule("Move").calcShift(R,B,H);return w||m.call(H,R,B)},clear:function(A){var b=this,B=ze.getBackup("clear");B.call(b,A);var t=b.gv;if(nc.inEdit(t)){var P=t.getEditInteractor();P.getSubModule("Move").clear(A)}}};nc.Inject.registAsModule(ze,Le);var Ge=nc.Rect=function(o){this.catalog="Rect",this._interactor=o};Ge.prototype={},Ge.prototype.constructor=Ge,Ge.prototype.gatherInfo=function(s,x){var $=this;if(1===x.length){var Q=x[0];return Q instanceof K.Shape&&Q._70I()?$.gatherLine(s,Q):Nj(Q,s)?!1:$.gatherSingleTarget(s,Q)}return x.length>1?$.gatherMultiTargets(s,x):!1},Ge.prototype.gatherSingleTarget=function(Z,V){if(V.getCorners){var X,y=this,i=y.info;y.target=V,X=y.screenInfo={};var r=V.getCorners();i.LT=new nc.Math.Vector2(r[0]),i.LB=new nc.Math.Vector2(r[1]),i.RB=new nc.Math.Vector2(r[2]),i.RT=new nc.Math.Vector2(r[3]),i.T=i.LT.clone().add(i.RT).divideScalar(2),i.B=i.LB.clone().add(i.RB).divideScalar(2),i.L=i.LT.clone().add(i.LB).divideScalar(2),i.R=i.RT.clone().add(i.RB).divideScalar(2);for(var j in i)X[j]=nc.toScreenPosition(Z,i[j]);var R=y._interactor,K=R.getStyle("checkSize"),C=function(C,g,z){var W=g.clone().sub(C).setLength(-K),F=z.clone().sub(C).setLength(-K),f=W.add(F).add(C);return f};return X.rotLT=C(X.LT,X.RT,X.LB),X.rotLB=C(X.LB,X.LT,X.RB),X.rotRB=C(X.RB,X.LB,X.RT),X.rotRT=C(X.RT,X.LT,X.RB),X.rotT=X.rotLT.clone().add(X.rotRT).divideScalar(2),X.rotB=X.rotLB.clone().add(X.rotRB).divideScalar(2),X.rotL=X.rotLT.clone().add(X.rotLB).divideScalar(2),X.rotR=X.rotRT.clone().add(X.rotRB).divideScalar(2),X.rotation=V.getRotation(),y.gatherConnectInfo(),!0}},Ge.prototype.gatherConnectInfo=function(){var O=this,w=O.target,A=O._interactor,s=O.screenInfo,x=A.gv;if(x.isConnectActionVisible(w)&&A.getStyle("connectGuideVisible")){var X;w.s&&(X=w.s("connectGuideShift")),X||(X=A.getStyle("connectGuideShift"));var d=w.getAnchor(),U=w.getSize(),T=w.toGlobal({x:U.width*(X[0]-d.x),y:U.height*(X[1]-d.y)});T=nc.toScreenPosition(x,T),s.P1?T.add(s.P2.clone().sub(s.P1).setLength(X[2])):(T.add(s.RT.clone().sub(s.LT).setLength(X[2])),T.add(s.LB.clone().sub(s.LT).setLength(X[3]))),s.connect=T}},Ge.prototype.gatherMultiTargets=function($,v){var E=nc.Group.findOrCreateGroup(v);if(!E)return!1;var C=this;return C.editing&&"rotate"!==C.editing.mode||E.calcInfo(),C.gatherSingleTarget($,E)},Ge.prototype.gatherLine=function(Q,R){this.target=R;var $=this.screenInfo={},w=R.getPoints(),A=nc.getDataMatrix(R);return $.P1=nc.toScreenPosition(Q,A.apply(w.get(0))),$.P2=nc.toScreenPosition(Q,A.apply(w.get(1))),this.gatherConnectInfo(),!0},Ge.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ge.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ge.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ge.prototype.check=function(o,O,S){if(K.Default.isLeftButton(O)){var u=this;if(u.editing=null,u.tipInfo=null,u.screenInfo){var E=u.target,k=o.isEditable(E),T=u.screenInfo;if(k&&T.connect){var L=u._checkConnect(S);if(L)return L}if(T.P1)return u._checkLine(S);var v,W,j,C=null,x=u._interactor,F=x.getStyle("checkSize");if(k&&o.isRectEditable(E))for(W=0;W<nc.Rect.ResizeKeys.length;W++)if(j=nc.Rect.ResizeKeys[W],nc.checkHit(S,T[j],F)){C=j,v="resize";break}if(!C&&k&&o.isRotationEditable(E)&&!x.getStyle("rotateAsClock")){var G=x.getStyle("rotateCheckSize");for(W=0;W<nc.Rect.RotateKeys.length;W++)if(j=nc.Rect.RotateKeys[W],nc.checkHit(S,T[j],G)){C=j,v="rotate";break}}if(!C)return x.setCursor("default"),void 0;if("rotate"===v){var X,H=o.lp(O);if(E instanceof nc.Group){var q=x.getStyle("groupRotateModeKey");"string"==typeof q&&(q=[q]);for(var z=!1,U=0,l=q.length;l>U;U++)if(O[q[U]]){z=!0;break}var y=x.getStyle("groupRotateModeDefault");X=z?"batch"===y?"block":"batch":y}var A="batch"===X?E.getAnchor2():E.getPosition(),Y=Math.atan2(H.y-A.y,H.x-A.x);x._setRotateCursor(Y),u.editing={mode:v,key:C,pos:A,flipY:E.getScale().y<0,rotation:E.getRotation(),hitRot:Y},X&&(u.editing.groupRotateMode=X)}else{var D=nc.Rect.ResizeKeys.indexOf(C),$=nc.Rect.ResizeDirection[D],c=Math.cos(E.getRotation()),g=Math.sin(E.getRotation()),I=$.x*Math.sign(E.getScale().x),w=$.y*Math.sign(E.getScale().y),R=Math.atan2(-g*I-c*w,c*I-g*w),V=(Math.round(R/(Math.PI/4))+8)%8,t=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][V];this._interactor.setCursor(t);var B=E.getWidth(),J=E.getHeight(),P=E.getAnchor();u.editing={mode:v,key:C,rect:{x:-B*P.x,y:-J*P.y,width:B,height:J},anchor:P,matrix:E.getMatrix()}}return C}}},Ge.prototype._checkLine=function(r){var V=this;V.screenInfo;var o,L=V._interactor.getStyle("checkSize");if(nc.checkHit(r,V.screenInfo.P1,L))o="P1";else{if(!nc.checkHit(r,V.screenInfo.P2,L))return this._interactor.setCursor("default"),void 0;o="P2"}return V.editing={mode:"line",key:o},o},Ge.prototype._checkConnect=function(B){var u=this,y=u.screenInfo,I=u._interactor,p=I.getStyle("connectGuideIntersectSize"),G=y.connect,g=B.x,M=G.x;if(M>g&&p>M-g&&Math.abs(G.y-B.y)<p||g>=M&&nc.checkHit(B,G,p)){var o="connect",Z=V.getConnectAction(I.gv);if(u.editing={mode:o},Z&&Z.delete)if(u.target instanceof nc.Group){var A=!0;I.gv.sm().getSelection().each(function(i){Z.delete.visible.call(null,I.gv,i)||(A=!1)}),u.editing.hasDeleteAction=A}else Z.delete.visible.call(null,I.gv,u.target)&&(u.editing.hasDeleteAction=!0);return I.setCursor("default"),o}},Ge.prototype._fireEditEvent=function(P,G){var q=this._interactor,n=this.editing;if(n){var Z=n.mode;Z="rotate"===Z?"Rotation":"connect"===Z?"Connection":Z[0].toUpperCase()+Z.slice(1),q.fi({kind:P+"Edit"+Z,event:G})}},Ge.prototype.startEdit=function(Y,f){Y.startDragging(f);var L=this;L._interactor.fi({kind:"prepareEdit",event:f});var I=L.editing,q=L.target;if(I){if(L._fireEditEvent("begin",f),"rotate"===I.mode)return I.groupRotateMode&&q.beginRotate(I),void 0;if("connect"!==I.mode)("line"===I.mode||q&&0===q.getRotation())&&(L._inSmartGuide=!0,L._interactor.rectGuide.gatherRects());else if(I.hasDeleteAction){var _=Y.gv,O=L._interactor.getStyle("connectGuideGarbageShift");I.garbageInfo={x:_.getWidth()*O[0]+O[2],y:_.getHeight()*O[1]+O[3],size:L._interactor.getStyle("connectGuideGarbageIntersectsize")},Y._42()}}},Ge.prototype._46O=function(l){var r,s,T=this,P=T.editing,Q=T.target;if(P){if("connect"===P.mode&&!P.canceled&&!P.deleted)try{P.garbageInfo&&P.garbageInfo.hover?V.doDeleteConnectionAction(T._interactor.gv,Q):V.doConnectAction(T._interactor.gv,Q,P.target)}catch(y){console.error(y)}s=P.freezeFlag,r=T.editing.groupRotateMode,T._fireEditEvent("end",l),T.editing=null}T.tipInfo=null,T._inSmartGuide&&(T._interactor.rectGuide.clear(),T._inSmartGuide=!1),r&&Q&&Q.endRotate(),Q instanceof K.Block&&(s===z?delete Q._freezeSyncFromChildren:Q._freezeSyncFromChildren=s,Q.updateFromChildren())},Ge.prototype.handleNormalStateDelete=function(){var n=this,o=n.editing;if(o&&"connect"===o.mode&&!o.canceled&&!o.deleted){if(o.garbageInfo){try{V.doDeleteConnectionAction(n._interactor.gv,n.target)}catch(g){console.error(g)}o.garbageInfo=null}return o.cursorPos=null,o.targetCorners=null,o.deleted=!0,n._interactor._42(),!0}},Ge.prototype.handleNormalStateKeyDown=function(J){var I=this,p=I.editing;return!p||"connect"!==p.mode||p.canceled||p.deleted?void 0:K.Default.isEsc(J)?(p.cursorPos=null,p.targetCorners=null,p.canceled=!0,I._interactor._42(),!0):void 0},Ge.prototype.handleEdit=function(n,l){var t=this,r=t.editing;if(r){var Y,R,J,G,e,H=t.target,a=r.key,D=r.mode,N=n.lp(l),Z=t._interactor;if("connect"===D){if(r.canceled)return;if(r.deleted)return;r.cursorPos=Z._getLogicalPoint(l);var M=r.garbageInfo;return M&&nc.checkHit(r.cursorPos,M,M.size)?(M.hover=!0,r.target=null,r.targetCorners=null):(M&&(M.hover=!1),r.target=n.getDataAt(N,function(x){return n.isSelectable(x)?gp(x)?!0:!1:!1})||null,r.targetCorners=nc.getTargetCornersOnScreen(n,r.target)),Z._42(),void 0}if("rotate"===D){var E,u,B=r.pos,$=Math.atan2(N.y-B.y,N.x-B.x);if(r.groupRotateMode?u=$-r.hitRot:(E=$-r.hitRot,u=r.rotation+E),u%=2*Math.PI,0>u&&(u+=2*Math.PI),!K.Default.isCtrlDown(l)){var S,V;lm(l)?(S=Z.getStyle("shiftRotateRound"),V=S/2):(S=Z.getStyle("rotateRound"),V=Z.getStyle("rotateSensitivity")),u=nc.roundTo(u,S,V)}r.groupRotateMode?(E=u-(r.lastRotation||0),0!==E&&(H.addRotation(E,r.groupRotateMode),r.lastRotation=u)):H.setRotation(u),Z._setRotateCursor($),u>Math.PI&&(u-=2*Math.PI);var L=180*(u/Math.PI);L=L.toFixed(2),Y=""+L+"°"}else if("resize"===D){var o=r.rect;J=o.x,G=o.y;var W,z=o.width,v=o.height,m=r.anchor,i=r.matrix,I=H.s&&H.s("keepAspectRatio")||Z.getStyle("keepAspectRatio");lm(l)&&(I=!I);var Q=t._unionPointMode1,g=t._unionPointMode2;if(t._inSmartGuide&&!K.Default.isCtrlDown(l)&&!I){var U;"L"===a||"R"===a?U="x":("T"===a||"B"===a)&&(U="y"),t._adsorbedToClosest(N,U),e=!0}W=i.tfi(N);var x;"LT"===a?(o=Q(W,{x:J+z,y:G+v},z,v,I),x=9):"T"===a?(o=g({x:J,y:W.y},{x:J+z,y:G+v},z,v,I,"v"),x=1):"RT"===a?(o=Q(W,{x:J,y:G+v},z,v,I),x=33):"L"===a?(o=g({x:W.x,y:G},{x:J+z,y:G+v},z,v,I,"h"),x=8):"R"===a?(o=g({x:J,y:G},{x:W.x,y:G+v},z,v,I,"h"),x=32):"LB"===a?(o=Q(W,{x:J+z,y:G},z,v,I),x=12):"B"===a?(o=g({x:J,y:G},{x:J+z,y:W.y},z,v,I,"v"),x=4):"RB"===a&&(o=Q(W,{x:J,y:G},z,v,I),x=36);var O=i.tf(o.x+o.width*m.x,o.y+o.height*m.y);H instanceof K.Block&&(r.hasOwnProperty("freezeFlag")||(r.freezeFlag=H._freezeSyncFromChildren,H._freezeSyncFromChildren=!0)),H.setPosition(O),H.setSize(o.width,o.height),e&&(R=H.getRect(),Z.rectGuide.gatherLines({node:H,x:R.x,y:R.y,w:R.width,h:R.height},U,x)),Y=""+Math.round(o.width)+" * "+Math.round(o.height)}else if("line"===D){if(lm(l)){var A=H.getPoints(),j="P1"===a?A.get(1):A.get(0),P={x:N.x-j.x,y:N.y-j.y},q=Z.getStyle("shiftLineRotateRound"),y=t._shiftDirList;if(!y||t._shiftRotateRound!==q){t._shiftRotateRound=q,t._shiftDirList=y=[];for(var f=0;f<Math.PI;f+=q)y.push({x:s(f),y:F(f)})}for(var p,_=0,d=0,b=y.length;b>d;d++){var k=y[d],w=k.x*P.x+k.y*P.y;Math.abs(w)>Math.abs(_)&&(_=w,p=k)}N={x:j.x+p.x*_,y:j.y+p.y*_},Z.rectGuide.clear()}else t._inSmartGuide&&!K.Default.isCtrlDown(l)&&(t._adsorbedToClosest(N),e=!0);var T=nc.getDataMatrix(H).applyInverse(N);H.setPoint("P1"===a?0:1,T,!0);var C=H.getPoints(),c=C.get(0),h=C.get(1);J=c.x-h.x,G=c.y-h.y,Y=" "+Math.round(Math.sqrt(J*J+G*G))+" ",e&&(R=H.getRect(),Z.rectGuide.gatherLines({node:H,x:R.x,y:R.y,w:R.width,h:R.height}))}if(Y){var X=K.Default.getLogicalPoint(l,Z._canvas);X.x+=nc.Icons.TipShiftX,X.y+=nc.Icons.TipShiftY,t.tipInfo={helperPos:X,text:Y,size:Y.length}}t._fireEditEvent("between",l)}},Ge.prototype._unionPointMode1=function(b,L,i,Q,A){if(A&&i&&Q){var y=b.x-L.x,T=b.y-L.y;Math.abs(y*Q)<Math.abs(T*i)?(T=Math.sign(T)*Math.abs(y*Q/i),b.y=L.y+T):(y=Math.sign(y)*Math.abs(T*i/Q),b.x=L.x+y)}return K.Default.unionPoint(b,L)},Ge.prototype._unionPointMode2=function(q,i,v,$,Q,T){var g=K.Default.unionPoint(q,i);if(Q&&v&&$){var p;"v"===T?(p=g.x+g.width/2,g.width=v*g.height/$,g.x=p-g.width/2):(p=g.y+g.height/2,g.height=$*g.width/v,g.y=p-g.height/2)}return g},Ge.prototype._adsorbedToClosest=function($,k){var g=this,O=g._interactor,L=O.rectGuide.findClosest($,k),P=O.gridGuide.findClosest($,k),i=1/0,F=1/0;L&&(isFinite(L.x)&&(i=L.x),isFinite(L.y)&&(F=L.y)),P&&(isFinite(P.x)&&Math.abs(P.x)<Math.abs(i)&&(i=P.x),isFinite(P.y)&&Math.abs(P.y)<Math.abs(F)&&(F=P.y)),isFinite(i)&&($.x+=i),isFinite(F)&&($.y+=F)},Ge.prototype._42=function(r,P,b){var K=this;K.info={},K.screenInfo=null;var w=K._interactor;if(!w.editDetail&&K.gatherInfo(P,b)){var m=K.editing,D=m?m.groupRotateMode:null,W=K.screenInfo;"block"!==D&&(W.P1?nc.Icons.DrawIcon(w,r,nc.Icons.Line,W):nc.Icons.DrawIcon(w,r,nc.Icons.Rect,W),W.connect&&(nc.Icons.DrawIcon(w,r,nc.Icons.ConnectGuide,{rotation:W.rotation,connect:W.connect,cursorPos:m?m.cursorPos:null}),m&&(m.targetCorners&&nc.Icons.DrawIcon(w,r,nc.Icons.NodeHoverGuide,m.targetCorners),m.garbageInfo&&nc.Icons.DrawIcon(w,r,nc.Icons.ConnectGuideGarbage,m.garbageInfo))),K.tipInfo&&nc.Icons.DrawIcon(w,r,nc.Icons.TipHelper,K.tipInfo)),K.target instanceof nc.Group&&K.target._42(w,r,P)}};var Ln=nc.Anchor=function(e){this.catalog="Anchor",this._interactor=e};Ln.prototype={},Ln.prototype.constructor=Ln,Ln.prototype.gatherInfo=function(T,S){var N=this;if(1===S.length){var E=S[0];if(!E.getAnchor)return;if(E instanceof K.Shape&&E._70I())return;if(Nj(E,T))return;return N.gatherSingleTarget(T,S[0])}return S.length>1?N.gatherMultiTargets(T,S):!1},Ln.prototype.gatherSingleTarget=function(e,o){var r=this;return r.info.POS=o.getPosition(),r.screenInfo.POS=nc.toScreenPosition(e,r.info.POS),r.target=o,!0},Ln.prototype.gatherMultiTargets=function(E,w){var n=this,j=nc.Group.findOrCreateGroup(w);
return j?(n.screenInfo.POS=nc.toScreenPosition(E,j.getAnchor2()),n.target=j,!0):!1},Ln.prototype.isVisible=function(){var g=this,B=g._interactor;if(B.getStyle("anchorVisible")===!1)return!1;var R=g.target;if(R){if(this.editing)return!0;var e=R.getAnchor(),Q=B.getStyle("anchorOutsideVisibleThreshold");if(e.x<-Q||e.x>1+Q||e.y<-Q||e.y>1+Q)return!0;var b=R.getSize(),j=R.getScale(),i=Math.min(Math.abs(b.width*j.x),Math.abs(b.height*j.y));if(i*B.gv._zoom<B.getStyle("anchorHideThreshold"))return!1}return!0},Ln.prototype.check=function(u,M,c){if(K.Default.isLeftButton(M)){var W=this,e=W._interactor;if(W.isVisible()&&e.getStyle("anchorMovable")!==!1){W.editing=null,W.tipInfo=null;var C=W.target;if(C&&u.isAnchorEditable(C)&&u.isEditable(C)){var H;if(W.screenInfo&&(H=W.screenInfo.POS)&&nc.checkHit(c,new nc.Math.Vector2(H),e.getStyle("checkSize"))){if(C instanceof nc.Group)return W.editing={},!0;var B=C.getWidth(),E=C.getHeight(),g=C.getAnchor();return W.editing={rect:{x:-B*g.x,y:-E*g.y,width:B,height:E},anchor:g,matrix:C.getMatrix()},!0}}}}},Ln.prototype.startEdit=function(v,d){v.startDragging(d),v.fi({kind:"beginEditAnchor",event:d})},Ln.prototype._46O=function(m){var F=this;F.editing&&(F.editing=null,F._interactor.fi({kind:"endEditAnchor",event:m})),F.tipInfo=null},Ln.prototype.handleEdit=function(S,q){var p=this,t=p.target;if(t){var H=p.editing;if(H){var n=S.lp(q),w=p._interactor;if(t instanceof nc.Group)return t.setAnchor2(n),w._42(),void 0;var j=H.matrix,s=j.tfi(n),o=H.rect,z=(s.x-o.x)/o.width,T=(s.y-o.y)/o.height;if(!K.Default.isCtrlDown(q)){var Y=w.getStyle("anchorRound"),V=w.getStyle("anchorSensitivity");z=nc.roundTo(z,Y,V),T=nc.roundTo(T,Y,V)}t.setAnchor(z,T,!0);var L=K.Default.getLogicalPoint(q,w._canvas);L.x+=nc.Icons.TipShiftX,L.y+=nc.Icons.TipShiftY;var r=""+z.toFixed(2)+", "+T.toFixed(2);p.tipInfo={helperPos:L,text:r,size:r.length},w.fi({kind:"betweenEditAnchor",event:q})}}},Ln.prototype._42=function(F,B,I){var i=this;i.info={},i.screenInfo={};var T=i._interactor;T.editDetail||i.gatherInfo(B,I)&&i.isVisible()&&(nc.Icons.DrawIcon(T,F,nc.Icons.Anchor,i.screenInfo),i.tipInfo&&nc.Icons.DrawIcon(T,F,nc.Icons.TipHelper,i.tipInfo))};var ys=nc.RotateX=function(f){this.catalog="RotateX",this._interactor=f};ys.prototype={},ys.prototype.constructor=ys,ys.prototype.gatherInfo=function(h,J){var I=this;if(1===J.length){var t=J[0];return t instanceof K.Shape&&t._70I()||Nj(t,h)?!1:I.gatherSingleTarget(h,t)}return J.length>1?I.gatherMultiTargets(h,J):!1},ys.prototype.gatherSingleTarget=function(){var X=new K.Math.Vector2,b=new K.Math.Vector2,G=new K.Math.Vector2,Y=new K.Math.Vector2,$=function(w,v){var R=w.x-v.x,H=w.y-v.y;return R*R+H*H};return function(g,I){if(I.getCorners){var d=this,u=I.getCorners(),N=15,J=I.getPosition();X.copy(u[0]),G.copy(u[1]),Y.copy(u[3]),b.copy(X).add(Y).divideScalar(2).add(X.sub(G).setLength(N/g.getZoom()));var z=Math.max($(J,u[0]),$(J,u[1]),$(J,u[2]),$(J,u[3]));return d.info.POS=b.clone(),d.screenInfo.POS=nc.toScreenPosition(g,d.info.POS),d.screenInfo.LEN=Math.sqrt(z)*g.getZoom()+N,d.screenInfo.CENTER=nc.toScreenPosition(g,J),d.target=I,!0}}}(),ys.prototype.gatherMultiTargets=function(w,m){var l=this,F=nc.Group.findOrCreateGroup(m);if(!F)return!1;var l=this;return l.gatherSingleTarget(w,F)},ys.prototype.isVisible=function(){var H=this._interactor;if(!H.getStyle("rotateAsClock"))return!1;var s=this.target;if(!s)return!0;var M=H.gv;return M.isEditable(s)&&M.isRotationEditable(s)?!0:!1},ys.prototype.check=function(v,d,T){var i=this,A=i._checkImpl(v,d,T);return(A||i._clockPainted)&&i._interactor._42(),A},ys.prototype._checkImpl=function(L,I,n){if(K.Default.isLeftButton(I)){var E=this;E.editing=null,E.tipInfo=null;var C;if(E.screenInfo&&(C=E.screenInfo.POS)&&E.isVisible()){var S=E._interactor;if(nc.checkHit(n,C,S.getStyle("checkSize"))){var W=E.target,w=L.lp(I),H=W.getPosition(),r=Math.atan2(w.y-H.y,w.x-H.x);return S._setRotateCursor(r),E.editing={pos:H,rotation:W.getRotation(),hitRot:r,groupRotateMode:"block",screenInfo:{CENTER:E.screenInfo.CENTER,LEN:E.screenInfo.LEN}},!0}}}},ys.prototype.startEdit=function(q,C){q.startDragging(C),q.fi({kind:"beginEditRotation",event:C}),this.target instanceof nc.Group&&this.target.beginRotate(this.editing)},ys.prototype._46O=function(e){var r=this;r.editing&&(r.editing=null,r._interactor.fi({kind:"endEditRotation",event:e})),r.target instanceof nc.Group&&r.target.endRotate(),r.tipInfo=null},ys.prototype.handleEdit=function(t,P){var A=this,h=A.editing;if(h){var c,v,L=A.target,Z=t.lp(P),d=A._interactor,s=h.pos,O=Math.atan2(Z.y-s.y,Z.x-s.x),l=L instanceof nc.Group;if(l?v=O-h.hitRot:(c=O-h.hitRot,v=h.rotation+c),v%=2*Math.PI,0>v&&(v+=2*Math.PI),!K.Default.isCtrlDown(P)){var B,n;lm(P)?(B=d.getStyle("shiftRotateRound"),n=B/2):(B=d.getStyle("rotateRound"),n=d.getStyle("rotateSensitivity")),v=nc.roundTo(v,B,n)}l?(c=v-(h.lastRotation||0),0!==c&&(L.addRotation(c,h.groupRotateMode),h.lastRotation=v)):L.setRotation(v),d._setRotateCursor(O),v>Math.PI&&(v-=2*Math.PI);var H=180*(v/Math.PI),f=""+H.toFixed(2)+"°",o=K.Default.getLogicalPoint(P,d._canvas);o.x+=nc.Icons.TipShiftX,o.y+=nc.Icons.TipShiftY,A.tipInfo={helperPos:o,text:f,size:f.length},d.fi({kind:"betweenEditRotation",event:P})}},ys.prototype._42=function(s,_,Y){var E=this;E._clockPainted=!1,E.info={},E.screenInfo={};var z=E._interactor;z.editDetail||E.gatherInfo(_,Y)&&E.isVisible()&&(nc.Icons.DrawIcon(z,s,nc.Icons.RoundPoint,E.screenInfo.POS),E.tipInfo&&nc.Icons.DrawIcon(z,s,nc.Icons.TipHelper,E.tipInfo),E.editing&&E.drawClock(s))},ys.prototype.drawClock=function(P){P.save();var l=this;l._clockPainted=!0;var A=l.editing||{},O=A.screenInfo||l.screenInfo,v=O.LEN,W=v+8,z=v+18;P.save(),P.translate(O.CENTER.x,O.CENTER.y),P.beginPath(),P.strokeStyle="rgb(150, 150, 150)";for(var y,Q,w,G,g,U=0;360>U;U++)y=U*Math.PI/180,0===U%5&&(Q=F(y)*v,w=s(y)*v,G=F(y)*W,g=s(y)*W,P.moveTo(Q,w),P.lineTo(G,g)),0===U%45&&(Q=F(y)*v,w=s(y)*v,G=F(y)*z,g=s(y)*z,P.moveTo(Q,w),P.lineTo(G,g));P.stroke(),P.rotate(-Y);var h=A.lastRotation||l.target.getRotation();P.beginPath(),P.fillStyle="rgba(255, 0, 0, 0.1)",P.strokeStyle="rgb(157, 157, 157)",P.moveTo(0,0),P.arc(0,0,z,0,h,!1),P.fill(),P.beginPath(),P.moveTo(0+z,0),P.arc(0,0,z,0,h,!1),P.stroke(),P.restore()};var Dk=nc.Curve=function(N){this.catalog="Curve",this._interactor=N};Dk.prototype={},Dk.prototype.constructor=Dk,m.defineProperties(Dk.prototype,{activing:{get:function(){return this._activing},set:function(v){var w=this;if(v)w._activing=new nc.CurveActiving(this,v);else{var q=w._activing;q&&q.dispose(),w._activing=null}}}}),Dk.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Dk.prototype.setUp=function(){var j=this,L=j._interactor;L&&L.gv.mp(j._onGraphviewPropertyChanged,j)},Dk.prototype._onGraphviewPropertyChanged=function(B){("zoom"===B.property||"translateX"===B.property||"translateY"===B.property)&&this._handleDataChanged()},Dk.prototype.tearDown=function(){var t=this,E=t._interactor;E&&E.gv.ump(t._onGraphviewPropertyChanged,t)},Dk.prototype.canEnterEditDetailMode=function(){var H=this,F=H._interactor,D=F._getValidSelection();if(1===D.length){var N=D[0],o=N instanceof K.Edge;if(N instanceof K.Shape||o){if(o){var U=N.s("edge.type");if(U&&"points"!==U)return}var v=F.gv;if(v.isPointEditable(N)&&v.isEditable(N))return H.target=N,!0}}},Dk.prototype.preHandleScroll=function(){var M=this.editing;return M&&M.inEdit?!0:void 0},Dk.prototype.getCurrentSelectintStatus=function(){var A=this;if(A.activing&&!A.activing.selections){if(A.activing.status!=z)return A.activing.status;var $=function(S){var l=A.activing.status;A.activing.status=S,A._interactor.fp("shapePointStatus",l,S)},o=nc.Curve.PointType,c=A.activing.point,j=A.activing.pairs;if(!j||1!==j.length)return $(o.Mirrored);var F=j[0],i=F.c1&&F.c1.isNearEnough(c),n=F.c2&&F.c2.isNearEnough(c);if(!F.c1||!F.c2)return i||n?$(o.Straight):$(o.Disconnected);if(i&&n)return $(o.Straight);if(i||n)return $(o.Asymmetric);var S=F.c1.clone().sub(c),g=F.c2.clone().sub(c);return Math.abs(S.x*g.y-S.y*g.x)>1e-5||S.x*g.x>0?$(o.Disconnected):Math.abs(S.length()-g.length())>1e-5?$(o.Asymmetric):$(o.Mirrored)}},Dk.prototype.handle_keydown=function(V){var R=this;if(R._interactor.editDetail){var H=nc.Curve.PointType;"1"===V.key?R._setCurrentSelectionStatus(H.Straight):"2"===V.key?R._setCurrentSelectionStatus(H.Mirrored):"3"===V.key?R._setCurrentSelectionStatus(H.Disconnected):"4"===V.key&&R._setCurrentSelectionStatus(H.Asymmetric)}},Dk.prototype.setCurrentSelectionStatus=function(s){var g=this,M=g._interactor;if(M){var h=M.gv;h.dm().beginTransaction(),this._setCurrentSelectionStatus(s),h.dm().endTransaction()}},Dk.prototype._setCurrentSelectionStatus=function(H){var I=this,E=I.activing;if(E){var K=I.getCurrentSelectintStatus();if(null!==K&&K!==H){E.status=H;var c=I.activing.point,M=I.activing.pairs;if(M&&1===M.length){var R=M[0],T=I.screenInfo.curve,x=nc.Curve.PointType,l=function(){I._writeToHt(),I._interactor.fp("shapePointStatus",K,H)};if(H===x.Straight)return T.moveCtrlPoint(R,c,"c1"),T.moveCtrlPoint(R,c,"c2"),l(),void 0;if(K===x.Straight){var N=T.findPairs(c,!0),$=N[0],k=$.r1||c,L=$.r2||c,F=L.clone().sub(k).multiplyScalar(.25);return T.moveCtrlPoint(R,c.clone().sub(F),"c1"),T.moveCtrlPoint(R,c.clone().add(F),"c2"),l(),void 0}var b=R.c1,Q=R.c2;if(b&&Q){if(H===x.Mirrored)return T.moveCtrlPoint(R,c.clone().multiplyScalar(2).sub(Q),"c1"),l(),void 0;if(H===x.Asymmetric&&K===x.Disconnected){var V=b.clone().sub(c).length(),F=c.clone().sub(Q).setLength(V).add(c);return T.moveCtrlPoint(R,F,"c1"),l(),void 0}}E._firePointChange(),I._interactor.fp("shapePointStatus",K,H)}}}},Dk.prototype._handleDataChanged=function(C){var I=this;if(I.screenInfo&&I.target){var k=I._interactor;I.gatherSingleTarget(k.gv,I.target,!0),I.check(k.gv,null,C?k._getLogicalPoint(C):new nc.Math.Vector2(k._lastClientPoint)),k._42()}},Dk.prototype.gatherSingleTarget=function(B,q,w){var W,e,u=this;u.screenInfo&&u.screenInfo.curve&&(e=u.screenInfo.curve._curves);var a=u.editing;W=a?u.screenInfo:u.screenInfo={};var n,h,t=q instanceof K.Edge;t?(n=q.s("edge.segments"),h=q.s("edge.points")||new K.List):(n=q._58O,h=q._59O),W.S=n;var $,f=W.P=[],X=nc.getDataMatrix(q);if(q instanceof K.Polyline&&($=q.getElevation()||0,W.E=[]),h.each(function(d){W.E&&W.E.push(d.e||$),d=X.apply(d);var r=nc.toScreenPosition(B,d);f.push(r.x,r.y)}),t){var P=nc.toScreenPosition(B,q._lastSourcePoint),N=nc.toScreenPosition(B,q._lastTargetPoint);f.splice(0,0,P.x,P.y),f.push(N.x,N.y)}if(!W.S||!W.S.size()){W.S=new K.List,W.S.add(1);for(var p=0;p<f.length/2-1;p++)W.S.add(2)}if((!a||w)&&u.convertToCubicBezier(e),u.activing&&(w||!u.editing||"realPoint"===u.editing.type)){var v=W.curve.findPairs(u.activing.point);u.activing.pairs=v}t&&"points"!==q.s("edge.type")&&u._writeToHt()},Dk.prototype._convertToNewPoint=function(i,a,O){var r,P,b;for(r=0,P=a.length;P>r;r++){if(b=a[r],b._p1.isNearEnough(i))return b._p1;if(b._p4.isNearEnough(i))return b._p4}if(O)for(r=0,P=Math.min(O.length,P);P>r;r++){if(b=O[r],b._p1===i)return a[r]._p1;if(b._p4===i)return a[r]._p4}},Dk.prototype.convertToCubicBezier=function(j){var _,r,S=this,k=new nc.Math.Curve,P=S.screenInfo;if(k.createFromHtShape(P.P,P.S,P.E),P.curve=k,S.activing){var L=k._curves;if(_=S.activing.point,r=S._convertToNewPoint(_,L,j),r&&(S.activing.point=r),S.activing.selections){var A=-1,t=S.activing.selections;t.forEach(function(P){A++,r=S._convertToNewPoint(P,L,j),r&&(t[A]=r)})}}},Dk.prototype.check=function(Q,x,f){if(!x||K.Default.isLeftButton(x)){var d=this;if(d._interactor.setCursor("default"),d.editing=null,d.highlight=null,d.tipInfo=null,d.screenInfo){if(Ni())return d._interactor._42(),!0;if(d._checkEditCtrlPoint(f))return d._interactor._42(),!0;if(d._checkEditRealPoint(f))return d._interactor._42(),!0;if(d._checkEditElevation(f))return d._interactor._42(),!0;var u=d.screenInfo.curve,M=u.checkPoint(f,d._interactor.getStyle("curveIntersectSize"));if(M){var t=d.highlight={};t.type="insertKnot",t.bezier=M.bezier,t.point=M.intersection}return d._interactor._42(),!0}}},Dk.prototype._checkEditRealPoint=function(H){var s,V,y,r,p,$,x=this,i=x.screenInfo.curve._curves,S=x._interactor.getStyle("curvePointIntersectSize"),z=1/0;for(S*=S,y=0,r=i.length;r>y;y++)s=i[y],p=s._p1,$=H.distanceToSquared(p),z>$&&(z=$,V=p),p=s._p4,$=H.distanceToSquared(p),z>$&&(z=$,V=p);if(z>S)return!1;var d=x.highlight={};return d.type="changeRealPoint",d.point=V,x.editing={type:"realPoint",point:V,shiftGuide:{point:V.clone(),dir:"x",limit:0}},x._interactor.setCursor("crosshair"),!0},Dk.prototype._checkEditElevation=function(E){var A=this;if(!A._interactor.getStyle("curveElevationVisible"))return!1;var $=A.activing;if(!$)return!1;var G=$.getCurrentEditingPoint();if(!G)return!1;var r=A._interactor,z=r.getStyle("curveElevationGuideShift"),n=r.getStyle("curveElevationIntersectSize"),U=E.distanceToSquared({x:G.x+z[0],y:G.y+z[1]});if(!(U>n*n)){var J=A.highlight={};J.type="elevation";var l=new nc.Math.Vector2(E.x,E.y,G.e);return A.editing={type:"elevation",startPoint:l},A._interactor.setCursor("crosshair"),!0}},Dk.prototype._checkEditCtrlPoint=function(f){var X=this;if(X.activing&&!X.activing.selections){var l=X.getCurrentSelectintStatus();if(l!==nc.Curve.PointType.Straight){var s=X.activing.pairs;if(s){var Z=X._interactor.getStyle("curvePointIntersectSize");Z*=Z;var A,j,b,q,M,E,c,K,G,T=1/0;for(c=0,G=s.length;G>c;c++)for(q=s[c],K=0;2>K;K++)M=0===K?"c1":"c2",q[M]&&(E=f.distanceToSquared(q[M]),T>E&&(T=E,A=q,j=c,b=M));if(T>Z)return!1;X.activing.hlpair=A,X.activing.hltype=b;var o=X.highlight={};return o.type="changeCtrlPoint",o.point=A[b],X.editing={type:"ctrlPoint",pair:A,pairId:j,ctrlType:b,direction:A[b].clone().sub(X.activing.point).normalize()},X._interactor.setCursor("crosshair"),!0}}}},Dk.prototype.startEdit=function(o,X){o.startDragging(X);var L=this;L.highlight&&"insertKnot"===L.highlight.type&&(L.insertKnot(),L.gatherSingleTarget(L._interactor.gv,L.target),L.activing=null,L._checkEditRealPoint(L._interactor._getLogicalPoint(X)));var j=L._activing;if(j){var Z=L.editing?L.editing.type:null;"ctrlPoint"===Z?j.editingCtrl={pairId:L.editing.pairId,type:j.hltype}:"realPoint"===Z&&(j.editingCtrl=!1)}var P=L.highlight,q=K.Default.isCtrlDown(X);if(!P||Ni()){var l=L._interactor.gv;if(!l.setFocus(X)||l._scrolling)return;return l.isPannable()&&Tl(X)&&!q&&(L._pan={tx:l.tx(),ty:l.ty()},o.fi({kind:"beginPan",event:X})),void 0}if("changeRealPoint"===P.type){var e,O=L.activing?L.activing.point:null,d=L.activing?L.activing.selections:null;if(q&&L.activing)O===P.point?(d?(L.activing={point:d[0]},d.length>1&&(d.splice(0,1),L.activing.selections=d)):L.activing=null,L.editing=null):d&&(e=d.indexOf(P.point))>=0?(d.length>1?d.splice(e,1):delete L.activing.selections,L.editing=null):d?(d.push(O),L.activing={point:P.point,selections:d}):L.activing={point:P.point,selections:[O]};else if(d)O===P.point||((e=d.indexOf(P.point))>=0?(d.splice(e,1,O),L.activing={point:P.point,selections:d}):L.activing={point:P.point});else{var c;O===P.point&&(c=L.activing.status),L.activing={point:P.point},c&&(L.activing.status=c)}o.fi({kind:"beginEditPoint",event:X})}},Dk.prototype.insertKnot=function(){var W=this,P=W.highlight,M=W.screenInfo.curve;M.insertKnot(P.bezier,P.point.t),W._writeToHt()},Dk.prototype._writeToHt=function(){var r,O,g,c,x=this,Y=x.screenInfo.curve,k=Y.toHtShape(),e=k.points,T=[],I=k.segments,J=x._interactor.gv,m=x.target,n=m instanceof K.Edge,s=nc.getDataMatrix(m).invert();c=m instanceof K.Polyline,c&&(g=m.getElevation());for(var B=0,w=e.length;w>B;B++)r=e[B],O=nc.toWorldPosition(J,r),O=s.apply(O),r.e!=z&&r.e!==g&&(O.e=r.e),T.push(O);if(m._writing=!0,n){m.s("edge.type","points"),m.setStyle("edge.segments",I),m.setStyle("edge.points",T.slice(1,T.length-1)),m.setStyle("edge.source.offset.x",0),m.setStyle("edge.source.offset.y",0),m.setStyle("edge.target.offset.x",0),m.setStyle("edge.target.offset.y",0);var d=x._nextChangeEdgeHost;delete x._nextChangeEdgeHost,d&&("source"===d.type?m.setSource(d.host):m.setTarget(d.host)),x._writeEdgeHostAnchor("source",T[0]),x._writeEdgeHostAnchor("target",T[T.length-1])}else T.length?(m.setSegments(I),m.setPoints(T,!0)):m.removeFromDataModel();delete m._writing},Dk.prototype._writeEdgeHostAnchor=function(o,c){var k=this,m=k.target,D=k._calcHostAnchor(m,o,c);m.s("edge."+o+".anchor.x",D.x),m.s("edge."+o+".anchor.y",D.y)},Dk.prototype._calcHostAnchor=function(T,K,V,W){W||(W="source"===K?T.getSource():T.getTarget());var X=W.getRotation(),n=W.getAnchor(),S=this._interactor.gv;if(Nj(W,S)&&(X=0),X){var R=W.getMatrix(),Q=R.tfi(V),M=W.getSize();return{x:Q.x/M.width+n.x,y:Q.y/M.height+n.y}}var y=Jk(S,W),E={x:(V.x-y.x)/y.width,y:(V.y-y.y)/y.height};return E},Dk.prototype._handlePanning=function(E){var V=this,n=V._pan;if(n){n.started=!0;var m=V._interactor,N=m.gv,_=m._lastClientPoint,g=Ac(E);N.setTranslate(n.tx+g.x-_.x,n.ty+g.y-_.y),V.gatherSingleTarget(m.gv,V.target),m._42(),m.fi({kind:"betweenPan",event:E})}},Dk.prototype.handleEdit=function(y,u){var h=this,S=h.editing;if(h._pan)return h._handlePanning(u),void 0;if(S){S.inEdit=!0;var k,o,$,H=h._interactor._getLogicalPoint(u),n=K.Default.isCtrlDown(u),l=K.Default.isShiftDown(u),v=S.type,N=h.activing;if(h._guideInfo=null,"ctrlPoint"===v&&l){var L=h.editing.direction.clone();k=N.point;var I=L.dot(H.clone().sub(k));H=L.setLength(I).add(k)}else if("ctrlPoint"===v||"realPoint"===v){var L;if("realPoint"===v&&l){var b=h.editing.shiftGuide;o=b.point;var D=Math.abs(H.x-o.x),T=Math.abs(H.y-o.y);D>T&&D>b.limit&&"y"===b.dir&&(b.dir="x"),T>D&&T>b.limit&&"x"===b.dir&&(b.dir="y"),L=b.dir,"x"===L?(H.y=o.y,b.limit=Math.max(b.limit,D)):"y"===L&&(H.x=o.x,b.limit=Math.max(b.limit,T))}var E=h._isEditEdgeSourceTarget();if(E){var e=h._editEdgeSourceTarget(E,H,n);e&&($=e.tipText)}else if(!n){var J=h._guidingToEdit(H,L),a="realPoint"===v?h._interactor.gridGuide.findClosest(H,L,!0):null,G=1/0,V=1/0;a&&(a.x&&(G=a.x),a.y&&(V=a.y));var p=!1;J&&(J.xList&&(Math.abs(J.x)<=Math.abs(G)?(p=!0,G=J.x):delete J.xList),J.yList&&(Math.abs(J.y)<=Math.abs(V)?(p=!0,V=J.y):delete J.yList),p&&(h._guideInfo=J)),isFinite(G)&&(H.x+=G),isFinite(V)&&(H.y+=V),p&&(J.v=H)}}var M=h.screenInfo.curve;if("realPoint"===S.type){k=S.point,k.e!==z&&(H.e=k.e),M.moveRealPoint(k,H),S.point=H,h.highlight.point=H;var q=N.status,Y=N.selections;if(h.activing={point:H,status:q},Y){var g=H.clone().sub(k),t=0;Y.forEach(function(R){var k=R.clone().add(g);M.moveRealPoint(R,k),Y[t++]=k}),h.activing.selections=Y}}else if("ctrlPoint"===S.type){var r=N.pairs,F=r[S.pairId];M.moveCtrlPoint(F,H,S.ctrlType);var U=N.status,W=nc.Curve.PointType;if((U===W.Mirrored||U===W.Asymmetric)&&F.c1&&F.c2){var k=new nc.Math.Vector2(N.point),A="c1"===S.ctrlType?"c2":"c1";if(U===nc.Curve.PointType.Mirrored)M.moveCtrlPoint(F,k.clone().multiplyScalar(2).sub(H),A);else if(U===W.Asymmetric){var I=F[A].clone().sub(k).length(),s=k.clone().sub(F[S.ctrlType]).setLength(I).add(k);isNaN(s.x)||M.moveCtrlPoint(F,s,A)}}N._firePointChange()}else if("elevation"===S.type){o=S.startPoint;var i=o.e+(o.y-H.y)/y._zoom;h._setCurrentPointImpl("e",i),N._firePointChange(),$="E: "+nc.toFixed(i)}var f=K.Default.getLogicalPoint(u,h._interactor._canvas);if(f.x+=nc.Icons.TipShiftX,f.y+=nc.Icons.TipShiftY,!$){var w=nc.toWorldPosition(y,H);$=""+nc.toFixed(w.x)+", "+nc.toFixed(w.y)}h.tipInfo={helperPos:f,text:$,size:$.length},h._writeToHt(),h._interactor.fi({kind:"betweenEditPoint",event:u})}},Dk.prototype._setCurrentPointImpl=function(l,f){var y=this,p=y._activing;if(!p)return!1;var o=y.target;if(!o)return!1;var h=p.getCurrentEditingPoint();if(!h)return!1;var w=p.editingCtrl;if(!w)var R=h.clone();if("e"===l)h.e=f;else{var x;if("x"===l||"y"===l){var Z=p._lastFirePoint;x="x"===l?{x:f,y:Z?Z.y:0}:{x:Z?Z.x:0,y:f}}else"object"==typeof l?(x=l,l.e!==z&&(h.e=l.e)):(x={x:arguments[0],y:arguments[1]},arguments[2]!==z&&(h.e=arguments[2]));var u=nc.getDataMatrix(o);x=nc.toScreenPosition(y._interactor.gv,u.apply(x)),h.x=x.x,h.y=x.y}if(!w){var n=R.multiplyScalar(-1).add(h);h.e&&R.e&&(n.e=h.e-R.e),y.screenInfo.curve.moveCtrlDueToRealPointMovement(h,n)}return!0},Dk.prototype.setCurrentPoint=function(S,Q){return this._setCurrentPointImpl(S,Q)?(this._writeToHt(),!0):!1},Dk.prototype._isEditEdgeSourceTarget=function(){var $=this,u=$.target;if(!(u instanceof K.Edge))return!1;var O=$.editing.point,V=$.screenInfo.curve._curves;return O===V[0]._p1?"source":O===V[V.length-1]._p4?"target":!1},Dk.prototype._editEdgeSourceTarget=function(k,z,V){var R,f=this,C=f.target;if(R="source"===k?C.getSource():C.getTarget()){var D=f._interactor.gv,m=nc.toWorldPosition(D,z),g=f._calcHostAnchor(C,k,m,R);if(!V){var p=f._interactor.getStyle("anchorRound"),u=f._interactor.getStyle("anchorSensitivity");g.x=nc.roundTo(g.x,p,u),g.y=nc.roundTo(g.y,p,u)}if(f._interactor.getStyle("edgeHostDetectPerFrame")||g.x<0||g.x>1||g.y<0||g.y>1){var G=D.getDataAt(m,function(I){return D.isSelectable(I)?gp(I)?!0:!1:!1});if(G){var $=f._calcHostAnchor(C,k,m,G);R=G,f._nextChangeEdgeHost={type:k,host:G},g=$,V||(g.x=nc.roundTo(g.x,p,u),g.y=nc.roundTo(g.y,p,u))}}if(!V){var H=zj(D,R,0,0,0,g.x,g.y),P=nc.toScreenPosition(D,H);z.x=P.x,z.y=P.y}return f._edgeHostGuideInfo=nc.getTargetCornersOnScreen(D,R),{host:R,anchor:g,tipText:""+g.x.toFixed(2)+", "+g.y.toFixed(2)}}},Dk.prototype._guidingToEdit=function(A,J){var F,w,t=this;if(F=t.screenInfo.curve){w=F._curves;var u,l,b,z,j,B,T,Z,e=1/0,M=1/0,$=[];for(t.editing&&"realPoint"===t.editing.type&&(Z=t.editing.point),j=0,B=2*w.length;B>j;j++)T=w[Math.floor(j/2)][j%2?"_p4":"_p1"],$.indexOf(T)>=0||($.push(T),Z&&Z===T||(b=T.x-A.x,z=T.y-A.y,Math.abs(b)<Math.abs(e)?(e=b,u=[T]):b===e&&u.push(T),Math.abs(z)<Math.abs(M)?(M=z,l=[T]):z===M&&l.push(T)));var r=t._interactor.getStyle("smartGuideSensitivity");if((Math.abs(e)>r||"y"===J)&&(u=null),(Math.abs(M)>r||"x"===J)&&(l=null),u||l){var n=!1,o={};if(u&&(n=!0,o.xList=u,o.x=e),l&&(n=!0,o.yList=l,o.y=M),n)return o}}},Dk.prototype._46O=function(C){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditPoint",event:C})),v._guideInfo=null,v._edgeHostGuideInfo=null,v._pan&&(v._pan=null,v._interactor.fi({kind:"endPan",event:C})),v.tipInfo=null},Dk.prototype._canDeletePoint=function(u,T){var g=this.target;if(!(g instanceof K.Edge))return!0;var N=u._curves[0],R=u._curves[u._curves.length-1];return N._p1===T||R._p4===T?!1:!0},Dk.prototype.handleDelete=function(){var h=this;if(h.activing&&h.screenInfo){var B=K.Default.isShiftDown(),J=h.screenInfo.curve;h._canDeletePoint(J,h.activing.point)&&J.deleteRealPoint(h.activing.point,B),h.activing.selections&&h.activing.selections.forEach(function(N){h._canDeletePoint(J,N)&&J.deleteRealPoint(N,B)}),h.activing=null,delete h.editing,delete h.tipInfo,delete h._pan,h._writeToHt(),h._interactor.fp("deleteShapePoint",!1,!0)}},Dk.prototype.handleDoubleClick=function(V){var t=this,H=t._interactor._getLogicalPoint(V);if(t.screenInfo&&t._checkEditRealPoint(H)){var C=t.getCurrentSelectintStatus(),X=nc.Curve.PointType;return C=C===X.Mirrored?X.Straight:X.Mirrored,t._setCurrentSelectionStatus(C),t._interactor._42(),!0}},Dk.prototype._drawHighlight=function($){var F=this,v=F.highlight;if(v){var n=v.bezier,t=F._interactor;n&&nc.Icons.DrawIcon(t,$,nc.Icons.ShapeHighlightCurve,[n._p1.x,n._p1.y,n._p2.x,n._p2.y,n._p3.x,n._p3.y,n._p4.x,n._p4.y]);var S=v.point;S&&"insertKnot"===v.type&&nc.Icons.DrawIcon(t,$,nc.Icons.ShapeHighlighPoint,S)}},Dk.prototype._drawGuide=function(m){var R=this,h=R._guideInfo;if(h){var B,N,u,I,r=h.v;for(B=0;2>B;B++)if(I=0===B?h.xList:h.yList)for(N=0,u=I.length;u>N;N++)nc.Icons.DrawIcon(R._interactor,m,nc.Icons.ShapeGuideLine,[r.x,r.y,I[N].x,I[N].y])}},Dk.prototype._drawCurrentPoint=function(J){var D=this;if(D.activing){var v=D.activing,R=D.getCurrentSelectintStatus(),s=D._interactor;if(R!==nc.Curve.PointType.Straight){var f=v.pairs;v.hlpair,v.hltype;var k=v.selections,Q=v.editingCtrl;if(f&&!k){var o,j,g;for(j=0,g=f.length;g>j;j++)o=f[j],Q&&j===Q.pairId&&o[Q.type]?nc.Icons.DrawIcon(s,J,nc.Icons.ShapeActivingCtrl,{point:o.point,c1:o.c1,c2:o.c2,hl:Q.type}):nc.Icons.DrawIcon(s,J,nc.Icons.ShapeActivingCtrl,o)}}nc.Icons.DrawIcon(s,J,nc.Icons.ShapeHighlighRealPoint,D.activing.point),k&&k.forEach(function(K){nc.Icons.DrawIcon(s,J,nc.Icons.ShapeHighlighRealPoint,K)})}},Dk.prototype.clear=function(){var v=this;v.editing=null,v._guideInfo=null,v.activing=null,v.highlight=null},Dk.prototype._42=function(g){var r=this;r.info={},r.editing||(r.screenInfo=null);var C=r._interactor;if(!C.editDetail)return r.clear(),void 0;if(!r.target||!r._interactor.gv.isSelected(r.target)||!r._interactor.gv.isVisible(r.target))return C.editDetail=!1,r.clear(),void 0;if(r.gatherSingleTarget(C.gv,r.target),nc.Icons.DrawIcon(C,g,nc.Icons.ShapeBgCurve,r.screenInfo),r._drawHighlight(g),r._drawCurrentPoint(g),r._getRealPoint().forEach(function(j){nc.Icons.DrawIcon(C,g,nc.Icons.ShapePoint,j)}),r._drawGuide(g),r.tipInfo&&nc.Icons.DrawIcon(C,g,nc.Icons.TipHelper,r.tipInfo),r._edgeHostGuideInfo&&nc.Icons.DrawIcon(C,g,nc.Icons.NodeHoverGuide,r._edgeHostGuideInfo),r._interactor.getStyle("curveElevationVisible")&&r.target instanceof K.Polyline&&r.activing){var T=r.activing.getCurrentEditingPoint();T&&nc.Icons.DrawIcon(C,g,nc.Icons.EdgeElevationGuide,T)}},Dk.prototype._getRealPoint=function(){var w,Q=this.screenInfo,n=Q.P,z=Q.S,O=-1,h=[],r=-1,b=z.length;return z.each(function(B){r++;var v=1;if(3===B)v=2;else if(4===B)v=3;else if(5===B)return;O+=v,w=r+1>=b?!0:1===z.get(r+1)?!0:!1,h.push({point:{x:n[2*O],y:n[2*O+1]},isEnd:w})}),h};var Vq=nc.MoveHelper=function(x){var X=this;X.catalog="Move",X._interactor=x};Vq.prototype={},Vq.prototype.constructor=Vq,Vq.prototype.calcShift=function(p,T,q){var Y,$,c=this,f=c._interactor.gv,l=f.lp(T);if("beginMove"===p&&c._gatherGridInfo(q._lastLogicalPoint||l),Y=c._target){var L=Y.downPosition;if(L){var t=c._interactor.getStyle("moveSensitivity")/f._zoom;if(L.distanceTo(l)<t)return{x:0,y:0};delete Y.downPosition}var s;$=K.Default.isShiftDown(T),$&&(l=c._dealShiftDown(l),s=Y.shiftGuide.dir);var d,k=Y.rawPos={x:Y.pos.x+l.x-Y.lp.x,y:Y.pos.y+l.y-Y.lp.y};if(K.Default.isCtrlDown(T)){if(d=c._calcShiftByAddon(),c._target.node instanceof nc.Group){var y=c._target.node;y._position.x+=d.x,y._position.y+=d.y}return d}for(var u,x=Y.x+k.x,N=Y.y+k.y,e={x:x,y:N},A={x:x+Y.w/2,y:N+Y.h/2},m={x:x+Y.w,y:N+Y.h},J=c._interactor.rectGuide,w=c._interactor.gridGuide,W=[J.findClosest(e,s),J.findClosest(A,s),J.findClosest(m,s),w.findClosest(e,s),w.findClosest(A,s),w.findClosest(m,s)],r=1/0,U=1/0,_=0,n=W.length;n>_;_++)u=W[_],u&&(x=u.x,N=u.y,isFinite(x)&&Math.abs(x)<Math.abs(r)&&(r=x),isFinite(N)&&Math.abs(N)<Math.abs(U)&&(U=N));if(isFinite(r)||(r=0),isFinite(U)||(U=0),d=c._calcShiftByAddon(r,U),c._target.node instanceof nc.Group){var y=c._target.node;y._position.x+=d.x,y._position.y+=d.y}var X=Y.node;if(!Nj(X,f)){var I=k.x+r,O=k.y+U;c._interactor.rectGuide.gatherLines({node:X,x:Y.x+I,y:Y.y+O,w:Y.w,h:Y.h},s)}return d}},Vq.prototype._calcShiftByAddon=function(J,k){var _=this._target,P=_.rawPos,j=_.node.getPosition();return J=J||0,k=k||0,{x:P.x-j.x+J,y:P.y-j.y+k}},Vq.prototype._dealShiftDown=function(f){var v=this,R=v._target.shiftGuide,k=v._target.lp,h=Math.abs(f.x-k.x),F=Math.abs(f.y-k.y);h>F&&h>R.limit&&"y"===R.dir&&(R.dir="x"),F>h&&F>R.limit&&"x"===R.dir&&(R.dir="y");var Y=R.dir;return"x"===Y?(f.y=k.y,R.limit=Math.max(R.limit,h)):"y"===Y&&(f.x=k.x,R.limit=Math.max(R.limit,F)),f},Vq.prototype._gatherGridInfo=function(m){var d,C=this,h=C._interactor,_=h._getValidSelection();if(1===_.length){if(d=_[0],!d.getRect)return C._target=null,void 0}else if(d=nc.Group.findOrCreateGroup(_),!d)return C._target=null,void 0;var o=d.getPosition(),l=d.getRect();C._target={node:d,x:l.x-o.x,y:l.y-o.y,w:l.width,h:l.height,lp:{x:m.x,y:m.y},pos:{x:o.x,y:o.y},shiftGuide:{dir:"x",limit:0},downPosition:new nc.Math.Vector2(m)},h.rectGuide.gatherRects()},Vq.prototype.clear=function(){var P=this;P._interactor.rectGuide.clear(),P._interactor._42()};var Gp="directional",bc="point",Bq="spot",Mg="light.color",Cq=function(m,M){ed(M)&&Zj.test(M)?Ik(m,M):ag(M)&&M.modelType?Hb(m,M):en[m]=M},Wg=function(e){if(ag(e))return e;var M=en[e];return e&&M===z&&Zj.test(e)&&(Oj&&Oj[e]||Ik(e,e)),M};Sm(V,{graph3dViewAttributes:G,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:C/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Ih,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:C/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Cq,getShape3dModel:Wg,createMatrix:function(n,k){Ul(n)||(n=[n]);for(var r=n.length-1;r>=0;r--){var w=n[r];k=Ki(w.mat,w.s3,w.r3,w.rotationMode,w.t3,k)}return k},transformVec:function(R,e){return Kb(R,e)},createBoxModel:function(){return{vs:rm,ns:Je,uv:Qq,is:ao}},createRoundRectModel:function(g,V){return Dh.roundRect(g,V)},createStarModel:function(v,a){return Dh.star(v,a)},createRectModel:function(O,M){return Dh.rect(O,M)},createTriangleModel:function(c,t){return Dh.triangle(c,t)},createRightTriangleModel:function(_,e){return Dh.rightTriangle(_,e)},createParallelogramModel:function(y,R){return Dh.parallelogram(y,R)},createTrapezoidModel:function(U,T){return Dh.trapezoid(U,T)},createSmoothSphereModel:function(P,r,i,V,v,b,p){return Lb(new Lr(P,r,i,V,v,b,p))},createSphereModel:function(F,B,m,g,T,A){return F?bf(F,B,m,g,T,A):V.createSmoothSphereModel()},createSmoothConeModel:function(J,B,Y,V,E){return Xl(J,B,Y,V,E)},createConeModel:function(S,d,J,o,b,c){return S?Ud(S,d,J,o,b,c):Xl(c)},createSmoothCylinderModel:function($,N,z,o,d,S,P,h){return Lb(new we($,N,z,o,d,S,P,h))},createCylinderModel:function(H,E,k,c,z,X,O){return H?Yj(H,E,k,c,z,X,O):Fj(X,O)},createSmoothTorusModel:function(k,y,$,b,U,E){return Lb(new wi(k,y,$,b,U,E))},createTorusModel:function(P,H,O,X,V,f,q){return P?js(P,H,O,X,V,f,q):zd(f,q)},createExtrusionModel:function(Q,Y,v,V,z,B,b,p){return go(Q,Y,v,V,z,B,b,p)},createSmoothRingModel:function(p,K,v,r,$,h){for(var V=[],l=0;l<p.length-1;l+=2)V.push({x:p[l],y:p[l+1]});for(p=Ie(V,K,v)[0],V=[],l=0;l<p.length;l++){var E=p[l];V.push(new gk(E.x,0,E.y))}return Lb(new lr(V,h,r,$))},createTextGeometry:function(x,r){return Lb(new hn(x,r))},loadFontFace:function(g,u){V.xhrLoad(g,function(X){if(!X)return u();var q;try{q=JSON.parse(X)}catch(Q){q=JSON.parse(X.substring(65,X.length-2))}$e.loadFace(q),u&&u(q.familyName.toLowerCase())},u?null:{sync:!0})},createRingModel:function(h,f,u,N,r,Y,k,A,M,$){for(var v=[],I=0;I<h.length-1;I+=2)v.push({x:h[I],y:h[I+1]});Y=Y||V.shapeSide,k=k||0,A=A||Y;var i,S,j,P,b,z,R,g,q,y,I,U,K,B,_,O,l,Q,D=[],X=[],x=M?[]:G,w=M?[]:G,n=$?[]:G,d=$?[]:G,c=N?[]:G,C=N?[]:G,t=r?[]:G,L=r?[]:G,h=Ie(v,f,u),E=Di(h),e=0,m=2*Math.PI/Y;return h.forEach(function(v){if(j=v.length,j>1){if(P=v[0],N)for(z=P.x,g=P.y,I=k;A>I;I++)U=I+1,K=I*m,B=U*m,_=F(K),O=s(K),l=F(B),Q=s(B),c.push(_*z,g,-O*z,l*z,g,-Q*z,0,g,0),C.push(.5-.5*_,.5-.5*O,.5-.5*l,.5-.5*Q,.5,.5);for(y=0;j>y;y++){for(b=v[y],z=P.x,R=b.x,g=P.y,q=b.y,i=e/E,e+=Li(P,b),S=e/E,I=k;A>I;I++)U=I+1,K=I*m,B=U*m,_=F(K),O=s(K),l=F(B),Q=s(B),D.push(_*R,q,-O*R,l*R,q,-Q*R,_*z,g,-O*z,l*R,q,-Q*R,l*z,g,-Q*z,_*z,g,-O*z),X.push(I/Y,S,U/Y,S,I/Y,i,U/Y,S,U/Y,i,I/Y,i),M&&I===k&&(x.push(0,g,0,0,q,0,_*R,q,-O*R,_*R,q,-O*R,_*z,g,-O*z,0,g,0),w.push(0,.5-g,0,.5-q,2*R,.5-q,2*R,.5-q,2*z,.5-g,0,.5-g)),$&&U===A&&(n.push(0,g,0,l*R,q,-Q*R,0,q,0,l*R,q,-Q*R,0,g,0,l*z,g,-Q*z),d.push(1,.5-g,1-2*R,.5-q,1,.5-q,1-2*R,.5-q,1,.5-g,1-2*z,.5-g));
P=b}if(r)for(z=P.x,g=P.y,I=k;A>I;I++)U=I+1,K=I*m,B=U*m,_=F(K),O=s(K),l=F(B),Q=s(B),t.push(l*z,g,-Q*z,_*z,g,-O*z,0,g,0),L.push(.5-.5*l,.5+.5*Q,.5-.5*_,.5+.5*O,.5,.5)}}),{vs:D,uv:X,bottom_vs:t,bottom_uv:L,top_vs:c,top_uv:C,from_vs:x,from_uv:w,to_vs:n,to_uv:d}}},!0),Sm(r,{"3d.move.mode":z,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":z,"edge.gradient.color":z,"edge.source.t3":z,"edge.target.t3":z,"light.type":bc,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":C/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":vc,"wf.short":!1,"wf.mat":z,"wf.geometry":!1,batch:z,"transparent.mask":!1,brightness:z,"select.brightness":.7,"repeat.uv.length":z,alphaTest:.4,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","shape3d.vector.dynamic.maxsize":2048,"label.face":Gb,"label.t3":z,"label.r3":z,"label.texture.scale":2,"label.rotationMode":$k,"label.light":!1,"label.blend":z,"label.reverse.flip":!1,"label.reverse.color":dh,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Gb,"label2.t3":z,"label2.r3":z,"label2.texture.scale":2,"label2.rotationMode":$k,"label2.light":!1,"label2.blend":z,"label2.reverse.flip":!1,"label2.reverse.color":dh,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Gb,"note.t3":z,"note.r3":z,"note.texture.scale":2,"note.rotationMode":$k,"note.light":!1,"note.blend":z,"note.reverse.flip":!1,"note.reverse.color":dh,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Gb,"note2.t3":z,"note2.r3":z,"note2.texture.scale":2,"note2.rotationMode":$k,"note2.light":!1,"note2.blend":z,"note2.reverse.flip":!1,"note2.reverse.color":dh,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:z,"shape3d.color":zg,"shape3d.top.color":z,"shape3d.bottom.color":z,"shape3d.from.color":z,"shape3d.to.color":z,"shape3d.image":z,"shape3d.top.image":z,"shape3d.bottom.image":z,"shape3d.from.image":z,"shape3d.to.image":z,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":z,"shape3d.side.to":z,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":z,"shape3d.opacity":z,"shape3d.reverse.flip":!1,"shape3d.reverse.color":dh,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":z,"shape3d.uv.scale":z,"shape3d.top.uv.offset":z,"shape3d.top.uv.scale":z,"shape3d.bottom.uv.offset":z,"shape3d.bottom.uv.scale":z,"shape3d.from.uv.offset":z,"shape3d.from.uv.scale":z,"shape3d.to.uv.offset":z,"shape3d.to.uv.scale":z,"shape3d.top.cap":z,"shape3d.bottom.cap":z,"shape3d.start.angle":0,"shape3d.sweep.angle":O,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":z,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":zg,"all.image":z,"all.blend":z,"all.opacity":z,"all.reverse.flip":!1,"all.reverse.color":dh,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":z,"all.uv.offset":z,"all.uv.scale":z,"all.discard.selectable":!0,mat:z,"left.mat":z,"right.mat":z,"top.mat":z,"bottom.mat":z,"front.mat":z,"back.mat":z},!0);var bi,Tq=!1,ol=[0,0,0,0],of={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:kh,2:tq,3:Wj,4:Eh,5:Gb,6:Cb}},Jj=function(A,Q,$,y){if(Q.getFaceVisible(A,$)){Uc(Q,Tr(A,Q.getFaceMat(A,$)||Q.getMat(A)));var d=Q._26I;Q.getFaceReverseCull(A,$)?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),Zl(d,Q._prg.uFixPickReverseColor,of[$]),Sr(d),Cs(d,y,6),Ld(d),Ek(Q)}},fh=function(W){return W instanceof pc},Yi=function(P){return[P.x,P.e||0,P.y]},th=function(f,N,$){for(var N=So(N),t=N[0],v=N[1],W=N[2];$--;)f.push(t,v,W)},fn=function(e,C,N){for(var C=So(C),Q=C[0],d=C[1],u=C[2],o=C[3];N--;)e.push(Q,d,u,o)},us=function(k,q,u){if(q)for(var O,I,E,g=q[0],w=q[1],Q=q[2],J=q[4],B=q[5],j=q[6],H=q[8],L=q[9],d=q[10],x=q[12],C=q[13],T=q[14],A=u.length,_=0,_=0;A>_;_+=3)O=u[_],I=u[_+1],E=u[_+2],k.push(g*O+J*I+H*E+x,w*O+B*I+L*E+C,Q*O+j*I+d*E+T);else ml(k,u)},kk=function(g,E){var w=E.s("light.intensity"),y=So(E.s(Mg)),z=y[0],I=y[1],S=y[2];1!==w&&(z*=w,I*=w,S*=w),g.push(z,I,S,E.s("light.disabled")?1:0)},$i=function(j,t,K){Zl(t,K.uHeadlightRange,j._headlightRange);var C=j._headlightIntensity,g=So(j._headlightColor);1!==C&&(g=[g[0]*C,g[1]*C,g[2]*C]),Zl(t,K.uHeadlightColor,[g[0],g[1],g[2],j._headlightDisabled?1:0]);var E=j._59O,e=j._spots,s=j._dirs;if(E.length){var r=[],f=[],D=[];E.forEach(function(_){kk(r,_),ml(f,j._transformPointToViewSpace(_.p3())),D.push(_.s("light.range"))}),t.uniform4fv(K.uPointColor,r),t.uniform1fv(K.uPointRange,D),t.uniform3fv(K.uPointPosition,f)}if(e.length){var Q=[],o=[],n=[],a=[],Z=[],k=[];e.forEach(function(p){kk(Q,p),ml(o,j._transformPointToViewSpace(p.p3())),ml(Z,j._transformDirectionToViewSpace(p.p3(),p.s("light.center"))),n.push(p.s("light.range")),a.push(F(p.s("light.angle")/2)),k.push(p.s("light.exponent"))}),t.uniform4fv(K.uSpotColor,Q),t.uniform1fv(K.uSpotRange,n),t.uniform1fv(K.uSpotAngle,a),t.uniform1fv(K.uSpotExponent,k),t.uniform3fv(K.uSpotPosition,o),t.uniform3fv(K.uSpotDirection,Z)}if(s.length){var x=[],G=[];s.forEach(function(a){kk(x,a),ml(G,j._transformDirectionToViewSpace(a.p3()))}),t.uniform4fv(K.uDirColor,x),t.uniform3fv(K.uDirDirection,G)}},nl=function(M){return M>0&&0===(M-1&M)},co=function(K){return K=W(0,$(C,K)),K=W(Mm,$(C-Mm,K))},Cf=function(){return.05+Z()/2},Ff=function(c,H,j,g){var R,z=c.getEye();return c.isOrtho()?(R=bd(c.getCenter(),z),R[0]+=g[0],R[1]+=g[1],R[2]+=g[2]):R=z,Vf(H,j,g,R)},Vf=function(Z,W,k,p){var A=Ao(Z,W),z=bd(p,k,!0),V=Ao(z,W);if(D(V)<Mm)return G;var T=(A-Ao(k,W))/V;return[k[0]+z[0]*T,k[1]+z[1]*T,k[2]+z[2]*T]},Td=function(h,t){return{x:2*h.x-t.x,y:2*h.y-t.y}},vk=function(J,B,Y,O){var e,R;if(!J)return e=x(B.y-Y.y,Y.x-B.x),{x:B.x+O*s(e),y:B.y+O*F(e)};if(!Y)return e=x(J.y-B.y,B.x-J.x),{x:B.x+O*s(e),y:B.y+O*F(e)};var A=bd([J.x,J.y,0],[B.x,B.y,0],!0),g=bd([Y.x,Y.y,0],[B.x,B.y,0],!0),f=-(A[0]+g[0])/2,d=-(A[1]+g[1])/2,V=H(f*f+d*d);if(Mm>V)return e=x(J.y-B.y,B.x-J.x),{x:B.x+O*s(e),y:B.y+O*F(e)};var U=J.x-B.x,w=J.y-B.y,I=Y.x-B.x,$=Y.y-B.y,C=H(U*U+w*w),_=H(I*I+$*$);e=t(Ao(A,g))/2,R=A[1]*g[0]-A[0]*g[1]>0?-1:1,f/=V,d/=V;var P=O/s(e),m=W(C,_)/F(e);V=Math.min(P,m);var a={x:B.x+R*V*f,y:B.y+R*V*d};return Y.b&&P>_/F(e)&&(a.adjust=!0),a},ar=function(t){var c=t[1],z=t[2],m=t[3],J=t[6],D=t[7],V=t[11];t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=c,t[6]=t[9],t[7]=t[13],t[8]=z,t[9]=J,t[11]=t[14],t[12]=m,t[13]=D,t[14]=V},dn=function(g){var h=g[0],I=g[1],X=g[2],c=g[3],w=g[4],R=g[5],Z=g[6],k=g[7],O=g[8],T=g[9],o=g[10],b=g[11],U=g[12],A=g[13],s=g[14],p=g[15],J=h*R-I*w,F=h*Z-X*w,H=h*k-c*w,r=I*Z-X*R,L=I*k-c*R,D=X*k-c*Z,K=O*A-T*U,v=O*s-o*U,e=O*p-b*U,q=T*s-o*A,a=T*p-b*A,t=o*p-b*s,$=J*t-F*a+H*q+r*e-L*v+D*K;return $?($=1/$,g[0]=(R*t-Z*a+k*q)*$,g[1]=(X*a-I*t-c*q)*$,g[2]=(A*D-s*L+p*r)*$,g[3]=(o*L-T*D-b*r)*$,g[4]=(Z*e-w*t-k*v)*$,g[5]=(h*t-X*e+c*v)*$,g[6]=(s*H-U*D-p*F)*$,g[7]=(O*D-o*H+b*F)*$,g[8]=(w*a-R*e+k*K)*$,g[9]=(I*e-h*a-c*K)*$,g[10]=(U*L-A*H+p*J)*$,g[11]=(T*H-O*L-b*J)*$,g[12]=(R*v-w*q-Z*K)*$,g[13]=(h*q-I*v+X*K)*$,g[14]=(A*F-U*r-s*J)*$,g[15]=(O*r-T*F+o*J)*$,void 0):G},mr=function(N,C){if(C){var X=C[0],G=C[1],p=C[2];N[12]=N[0]*X+N[4]*G+N[8]*p+N[12],N[13]=N[1]*X+N[5]*G+N[9]*p+N[13],N[14]=N[2]*X+N[6]*G+N[10]*p+N[14],N[15]=N[3]*X+N[7]*G+N[11]*p+N[15]}},cf=function(q,J){if(J){var o=J[0],p=J[1],f=J[2];q[0]=q[0]*o,q[1]=q[1]*o,q[2]=q[2]*o,q[3]=q[3]*o,q[4]=q[4]*p,q[5]=q[5]*p,q[6]=q[6]*p,q[7]=q[7]*p,q[8]=q[8]*f,q[9]=q[9]*f,q[10]=q[10]*f,q[11]=q[11]*f}},cr=function(N,F,O){var j=F[0],M=F[1],W=F[2],J=F[3],p=F[4],P=F[5],Y=F[6],z=F[7],Q=F[8],T=F[9],x=F[10],f=F[11],R=F[12],C=F[13],A=F[14],o=F[15],s=O[0],L=O[1],I=O[2],g=O[3];return N[0]=s*j+L*p+I*Q+g*R,N[1]=s*M+L*P+I*T+g*C,N[2]=s*W+L*Y+I*x+g*A,N[3]=s*J+L*z+I*f+g*o,s=O[4],L=O[5],I=O[6],g=O[7],N[4]=s*j+L*p+I*Q+g*R,N[5]=s*M+L*P+I*T+g*C,N[6]=s*W+L*Y+I*x+g*A,N[7]=s*J+L*z+I*f+g*o,s=O[8],L=O[9],I=O[10],g=O[11],N[8]=s*j+L*p+I*Q+g*R,N[9]=s*M+L*P+I*T+g*C,N[10]=s*W+L*Y+I*x+g*A,N[11]=s*J+L*z+I*f+g*o,s=O[12],L=O[13],I=O[14],g=O[15],N[12]=s*j+L*p+I*Q+g*R,N[13]=s*M+L*P+I*T+g*C,N[14]=s*W+L*Y+I*x+g*A,N[15]=s*J+L*z+I*f+g*o,N},ms=function(C,u,K,f){var S,J,y,x,e,s,R,z,d,o,p=u[0],r=u[1],U=u[2],h=f[0],T=f[1],g=f[2],w=K[0],Q=K[1],Y=K[2];return D(p-w)<Mm&&D(r-Q)<Mm&&D(U-Y)<Mm?bn(C):(R=p-w,z=r-Q,d=U-Y,o=1/H(R*R+z*z+d*d),R*=o,z*=o,d*=o,S=T*d-g*z,J=g*R-h*d,y=h*z-T*R,o=H(S*S+J*J+y*y),o?(o=1/o,S*=o,J*=o,y*=o):(S=0,J=0,y=0),x=z*y-d*J,e=d*S-R*y,s=R*J-z*S,o=H(x*x+e*e+s*s),o?(o=1/o,x*=o,e*=o,s*=o):(x=0,e=0,s=0),C[0]=S,C[1]=x,C[2]=R,C[3]=0,C[4]=J,C[5]=e,C[6]=z,C[7]=0,C[8]=y,C[9]=s,C[10]=d,C[11]=0,C[12]=-(S*p+J*r+y*U),C[13]=-(x*p+e*r+s*U),C[14]=-(R*p+z*r+d*U),C[15]=1,C)},_e=function(_,k,e,x,z){var X=1/g(k/2),n=1/(x-z);return _[0]=X/e,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=X,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=(z+x)*n,_[11]=-1,_[12]=0,_[13]=0,_[14]=2*z*x*n,_[15]=0,_},ec=function(h,A,X,c,z,d,C){var P=1/(A-X),I=1/(c-z),S=1/(d-C);return h[0]=-2*P,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*I,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*S,h[11]=0,h[12]=(A+X)*P,h[13]=(z+c)*I,h[14]=(C+d)*S,h[15]=1,h},am=function(x,y){var A=y[0],a=y[1],Z=y[2],q=y[3],R=A*A+a*a+Z*Z+q*q,K=R?1/R:0;return x[0]=-A*K,x[1]=-a*K,x[2]=-Z*K,x[3]=q*K,x},ak=function(t,U){var I=U[0]+U[5]+U[10],L=0;return I>0?(L=2*Math.sqrt(I+1),t[3]=.25*L,t[0]=(U[6]-U[9])/L,t[1]=(U[8]-U[2])/L,t[2]=(U[1]-U[4])/L):U[0]>U[5]&U[0]>U[10]?(L=2*Math.sqrt(1+U[0]-U[5]-U[10]),t[3]=(U[6]-U[9])/L,t[0]=.25*L,t[1]=(U[1]+U[4])/L,t[2]=(U[8]+U[2])/L):U[5]>U[10]?(L=2*Math.sqrt(1+U[5]-U[0]-U[10]),t[3]=(U[8]-U[2])/L,t[0]=(U[1]+U[4])/L,t[1]=.25*L,t[2]=(U[6]+U[9])/L):(L=2*Math.sqrt(1+U[10]-U[0]-U[5]),t[3]=(U[1]-U[4])/L,t[0]=(U[8]+U[2])/L,t[1]=(U[6]+U[9])/L,t[2]=.25*L),t},Vc=function(n,h,w){var v=h[0],U=h[1],k=h[2],H=h[3],B=v+v,S=U+U,y=k+k,X=v*B,i=v*S,G=v*y,m=U*S,$=U*y,s=k*y,d=H*B,C=H*S,r=H*y;return n[0]=1-(m+s),n[1]=i+r,n[2]=G-C,n[3]=0,n[4]=i-r,n[5]=1-(X+s),n[6]=$+d,n[7]=0,n[8]=G+C,n[9]=$-d,n[10]=1-(X+m),n[11]=0,n[12]=w[0],n[13]=w[1],n[14]=w[2],n[15]=1,n},bg=function(){var S=[0,0,0],e=[0,0,0],b=[0,0,0],Q=function(d,e,W){d[0]=e[1]*W[2]-e[2]*W[1],d[1]=e[2]*W[0]-e[0]*W[2],d[2]=e[0]*W[1]-e[1]*W[0]},a=function(F){return F[0]*F[0]+F[1]*F[1]+F[2]*F[2]},N=function(b){var t=Math.sqrt(a(b));b[0]/=t,b[1]/=t,b[2]/=t},s=function(H,Y,r){H[0]=Y[0]-r[0],H[1]=Y[1]-r[1],H[2]=Y[2]-r[2]};return function(A,C,P){var V=Qh();return s(b,A,C),0===a(b)&&(b[2]=1),N(b),Q(S,P,b),0===a(S)&&(1===Math.abs(P[2])?b[0]+=1e-4:b[2]+=1e-4,N(b),Q(S,P,b)),N(S),Q(e,b,S),V[0]=S[0],V[4]=e[0],V[8]=b[0],V[1]=S[1],V[5]=e[1],V[9]=b[1],V[2]=S[2],V[6]=e[2],V[10]=b[2],V}}(),Fl=function(H,Y){if(H.vr.enable){var M=H.vr.getViewMatrix(Y);if(M)return M}return ms(Y?Y:Qh(),H._eye,H._center,H._up)},yo=function(R){if(R.vr.enable){var U=R.vr.getProjectMatrix();if(U)return U}var L=R.getAspect(),W=R._near,M=R._far,t=Qh();if(R._ortho){var w=R._orthoWidth/2,z=w/L;ec(t,-w,w,-z,z,W,M)}else _e(t,R._fovy,L,W,M);return t},Io=function(K,s){if(!K)return G;var i=0,k=1,I=2,v=[],b=0,Y=K.length,Q=Y/3;if(s){for(;Y>b;b++)v[b]=0;for(b=0;b<s.length;b+=3){var p=[],h=[],J=[];p[i]=K[3*s[b+1]+i]-K[3*s[b]+i],p[k]=K[3*s[b+1]+k]-K[3*s[b]+k],p[I]=K[3*s[b+1]+I]-K[3*s[b]+I],h[i]=K[3*s[b+2]+i]-K[3*s[b+1]+i],h[k]=K[3*s[b+2]+k]-K[3*s[b+1]+k],h[I]=K[3*s[b+2]+I]-K[3*s[b+1]+I],J[i]=p[k]*h[I]-p[I]*h[k],J[k]=p[I]*h[i]-p[i]*h[I],J[I]=p[i]*h[k]-p[k]*h[i];for(var A=0;3>A;A++)v[3*s[b+A]+i]+=J[i],v[3*s[b+A]+k]+=J[k],v[3*s[b+A]+I]+=J[I]}}else for(b=0;Q>b;b+=3){var p=[],h=[],J=[];p[i]=K[3*(b+1)+i]-K[3*b+i],p[k]=K[3*(b+1)+k]-K[3*b+k],p[I]=K[3*(b+1)+I]-K[3*b+I],h[i]=K[3*(b+2)+i]-K[3*(b+1)+i],h[k]=K[3*(b+2)+k]-K[3*(b+1)+k],h[I]=K[3*(b+2)+I]-K[3*(b+1)+I],J[i]=p[k]*h[I]-p[I]*h[k],J[k]=p[I]*h[i]-p[i]*h[I],J[I]=p[i]*h[k]-p[k]*h[i];for(var A=0;3>A;A++)v[3*(b+A)+i]=J[i],v[3*(b+A)+k]=J[k],v[3*(b+A)+I]=J[I]}for(b=0;Y>b;b+=3){var S=[];S[i]=v[b+i],S[k]=v[b+k],S[I]=v[b+I];var N=H(S[i]*S[i]+S[k]*S[k]+S[I]*S[I]);0===N&&(N=Mm),S[i]=S[i]/N,S[k]=S[k]/N,S[I]=S[I]/N,v[b+i]=S[i],v[b+k]=S[k],v[b+I]=S[I]}return new nj(v)},Zr=function(q,T,h,$){if(h||(h=q.createTexture()),T){var Z=q.TEXTURE_2D,x=q.REPEAT,a=q.CLAMP_TO_EDGE,t=q.TEXTURE_MIN_FILTER;$!==q.NEAREST&&($=q.LINEAR),Me(q,h),q.texImage2D(Z,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,T),Xq(q,q.TEXTURE_MAG_FILTER,$);var m=T.naturalWidth||T.width,y=T.naturalHeight||T.height;nl(m)&&nl(y)&&!T.clampToEdge?(Xq(q,q.TEXTURE_WRAP_S,x),Xq(q,q.TEXTURE_WRAP_T,x),Xq(q,t,q.LINEAR_MIPMAP_LINEAR),q.generateMipmap(Z)):(Xq(q,q.TEXTURE_WRAP_S,a),Xq(q,q.TEXTURE_WRAP_T,a),Xq(q,t,$)),Me(q,G)}return h},ib=function(F,B){var N=new Uint8Array(3);return B=B||F.createTexture(),Me(F,B),Xq(F,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texImage2D(F.TEXTURE_2D,0,F.RGB,1,1,0,F.RGB,F.UNSIGNED_BYTE,N),B},gm=function(u){u._26I&&u._prg&&(u._26I.deleteProgram(u._prg),u._prg=G)},wn=function(r,L,V,U){var F=r.createShader(V);return r.shaderSource(F,U),r.compileShader(F),r.attachShader(L,F),F},Kd=function(A){return A.createBuffer()},Me=function($,k){$.bindTexture($.TEXTURE_2D,k)},Ji=function($,n){$.bindFramebuffer($.FRAMEBUFFER,n)},Xq=function(l,E,P){l.texParameteri(l.TEXTURE_2D,E,P)},Ck=function(N,r){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(r[0],r[1])},pe=function(J){J.disable(J.POLYGON_OFFSET_FILL)},Sl=function(P,Y){if(Y){var Y=So(Y);P.clearColor(Y[0],Y[1],Y[2],Y[3])}},fj=function($,v){Zl($,v.uFix,!0),Qj($,v.aNormal)},ic=function(S,s){Zl(S,s.uFix,!1),Mn(S,s.aNormal)},Kj=function(_,F,c,D,g,E,v,K){_._picking||(c?(Zl(_,F.uBlend,!0),Zl(_,F.uBlendColor,c)):Zl(_,F.uBlend,!1),Zl(_,F.uLight,D==G?!0:D),Mj(g)&&1!==g&&Zl(_,F.uPartOpacity,g),Zl(_,F.uReverseFlip,E==G?!1:E),Zl(_,F.uFixPickReverseColor,v||dh)),K?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE)},xd=function(u,e){u._picking||Zl(u,e.uPartOpacity,1)},Sr=function(W,A,X,q,z,Q,B,K,k){if(!X)return W.activeTexture(W.TEXTURE0),Me(W,W._emptyTexture),W.activeTexture(W.TEXTURE1),Me(W,W._emptyBlendTexture),void 0;Zl(W,A.uTexture,!0),Zl(W,A.uDiscardSelectable,Rk(q)?q:!0),Mn(W,A.aUv),xc(W,z,Q,A.aUv,2),k?(Zl(W,A.uBlendTexture,!0),W.activeTexture(W.TEXTURE1),Me(W,k),W.uniform1i(A.uBlendSampler,1)):(Zl(W,A.uBlendTexture,!1),W.activeTexture(W.TEXTURE1),Me(W,W._emptyBlendTexture)),W.activeTexture(W.TEXTURE0),Me(W,X),W.uniform1i(A.uSampler,0);var C=[0,0,1,1];B&&(C[0]=B[0],C[1]=B[1]),K&&(C[2]=K[0],C[3]=K[1]),Zl(W,A.uOffsetScale,C)},Ld=function(Q,n,P){Q.activeTexture(Q.TEXTURE0),Me(Q,G),Q.activeTexture(Q.TEXTURE1),Me(Q,G),P&&(Qj(Q,n.aUv),Zl(Q,n.uTexture,!1),Zl(Q,n.uBlendTexture,!1))},Vn=function(c,V,T,o,P,b){!T||u||$o||c.lineWidth(T),o&&!c._picking&&Zl(c,V.uFixPickReverseColor,o),P&&xc(c,P,b,V.aPosition)},mn=function(H,L,$,r){bi&&(r=H[bi]),H.drawArrays(r==G?H.TRIANGLES:r,L,$);var b=H._renderInfo;b&&(b.calls++,b.vertices+=$,(r==G||r===H.TRIANGLES)&&(b.faces+=$/3),r===H.LINES&&(b.lines+=$/2))},Cs=function(c,y,q,$){bi&&($=c[bi]),c.drawElements($==G?c.TRIANGLES:$,q,c.UNSIGNED_SHORT,y==G?0:2*y);var X=c._renderInfo;X&&(X.calls++,X.vertices+=q,($==G||$===c.TRIANGLES)&&(X.faces+=q/3),$===c.LINES&&(X.lines+=q/2))},di=function(P,m,s,Q,F){var w=P.ARRAY_BUFFER;P.bindBuffer(w,m),s&&P.bufferData(w,s,P.STATIC_DRAW),Q!=G&&P.vertexAttribPointer(Q,F?F:3,P.FLOAT,!1,0,0)},xc=function(i,A,r,D,y){return r?(fr(i,i.ARRAY_BUFFER,A,r),D!=G&&i.vertexAttribPointer(D,y?y:3,i.FLOAT,!1,0,0),void 0):di(i,A,r,D,y)},Pl=function(f,v,h){var m=f.ELEMENT_ARRAY_BUFFER;f.bindBuffer(m,v),h&&f.bufferData(m,h,f.STATIC_DRAW)},tm=function(K,z,V){fr(K,K.ELEMENT_ARRAY_BUFFER,z,V)},fr=function(o,W,A,S){var V=S._bufId;V||(V=S._bufId=K.Math.generateIncreasingID());var A,Z=o._bufPool;(A=Z[V])&&A._buf?o.bindBuffer(W,A._buf):(A=Z[V]={_buf:Kd(o)},o.bindBuffer(W,A._buf),o.bufferData(W,S,o.STATIC_DRAW)),A._fid=o._renderInfo.frame},Zl=function(M,R,t){if(t!=G&&R!=G){t=So(t);var f=t.length;3===f?M.uniform3fv(R,t):4===f?M.uniform4fv(R,t):16===f?M.uniformMatrix4fv(R,!1,t):Rk(t)?M.uniform1i(R,t?1:0):2===f?M.uniform2fv(R,t):M.uniform1f(R,t)}},Mn=function(c,W){W!=G&&W>=0&&c.enableVertexAttribArray(W)},Qj=function(l,s){s!=G&&s>=0&&l.disableVertexAttribArray(s)},Ek=function(g,y){var j=g.getGL(),i=g._prg;g._7O=g._8O.pop(),y&&(Zl(j,i.uMVMatrix,g._7O),g._6O=y,Zl(j,i.uNMatrix,y))},br=function(L,P){return P||(P=Qh()),ik(P,L),dn(P),ar(P),P},Uc=function(Y,n){var q=Y.getGL(),v=Y._prg,i=Y._7O;n&&(Y._8O.push(Ve(i)),Zl(q,v.uMMatrix,n),cr(i,i,n),Y._7O=i),Zl(q,v.uMVMatrix,i),Zl(q,v.uNMatrix,br(i,Y._6O))},Hj=function(v,I,p,R,M,l){if(p){if(R){var N=p.value++,P=2147483648|N,j=[(255&P>>16)/255,(255&P>>8)/255,(255&P)/255,(255&P>>24)/255];p[N]={data:M,part:l}}else j=ol;return Zl(v,I.uFixPickReverseColor,j),j}},Bj=function(){var H={center:function(L,J,v,o,V){var a=-J[1]/2,m={x:-J[0]/2,y:a,width:J[0],height:J[1]},D=Zb(L,m,v);return[D.x+o,-D.y-V,Cf()]},front:function(O,E,X,c,$){var w=-E[1]/2,C={x:-E[0]/2,y:w,width:E[0],height:E[1]},b=Zb(O,C,X);return[b.x+c,-b.y-$,E[2]/2+Cf()]},back:function(B,m,w,e,l){var n=-m[0]/2,q=-m[1]/2,P={x:n,y:q,width:m[0],height:m[1]},K=Zb(B,P,w);return[-K.x-e,-K.y-l,-m[2]/2-Cf()]},left:function(L,z,W,Q,m){var S=-z[1]/2,J={x:-z[2]/2,y:S,width:z[2],height:z[1]},r=Zb(L,J,W);return[-z[0]/2-Cf(),-r.y-m,r.x+Q]},right:function(D,M,v,V,k){var o=-M[2]/2,u=-M[1]/2,H={x:o,y:u,width:M[2],height:M[1]},B=Zb(D,H,v);return[M[0]/2+Cf(),-B.y-k,-B.x-V]},top:function(A,Y,D,e,_){var R={x:-Y[0]/2,y:-Y[2]/2,width:Y[0],height:Y[2]},S=Zb(A,R,D);return[S.x+e,Y[1]/2+Cf(),S.y+_]},bottom:function(M,S,H,d,g){var C=-S[2]/2,Y={x:-S[0]/2,y:C,width:S[0],height:S[2]},l=Zb(M,Y,H);return[l.x+d,-S[1]/2-Cf(),-l.y-g]}};return function(i,O,x,h,j,W){return H[h](i,O,x,j||0,W||0)}}(),Ei=function(e,V,M,g,a,y,n,N,w,J){if(a&&(V[0]+=a[0],V[1]+=a[1],V[2]+=a[2]),mr(e,M),N){var D=Qh();if(le(D,w,J),Kb(V,D),mr(e,V),e.auto=N,e.pos=Kb([0,0,0],e),y){var F=e.mat2=Qh();le(F,y,n)}}else le(e,w,J),mr(e,V),g===kh?fd(e,-Y):g===tq?fd(e,Y):g===Wj?xn(e,-Y):g===Eh?xn(e,Y):g===Cb&&fd(e,C),le(e,y,n);return e},se=function(M,w){var G=w.auto,s=w.mat2,u=M.gv;if(G){var x,l=Qh(),R=[0,0,0,0];x="string"==typeof G?[G.indexOf("x")<0?u._eye[0]:u._center[0],G.indexOf("y")<0?u._eye[1]:u._center[1],G.indexOf("z")<0?u._eye[2]:u._center[2]]:u._eye,ak(R,ms(Qh(),x,u._center,u._up)),Vc(l,am(R,R),w.pos),s&&cr(l,l,s),Uc(u,l)}else Uc(u,w)},kf=function(S,T,w,s,Z){var n=S.s,p=S.gv,B=p.getGL(),C=p._prg,I=p._buffer,t=p._1O;Zr(B,Lf,t),se(S,w),Kj(B,C,n(T+".blend"),n(T+".light"),n(T+".opacity"),n(T+".reverse.flip"),n(T+".reverse.color"),n(T+".reverse.cull")),Sr(B,C,t,Z,I.uv,Zn),xc(B,I.vs,s,C.aPosition),xc(B,I.ns,Hh,C.aNormal),tm(B,I.is,Wo),Cs(B,0,Wo.length),Ld(B,C,t),xd(B,C),Ek(p)},ub=function(t,T,_){var r=t.gv,j=t.data,y=t[T]={blend:r.getBodyColor(j)||r.getFaceBlend(j,T),light:r.getFaceLight(j,T),color:r.getFaceColor(j,T),opacity:r.getFaceOpacity(j,T),transparent:r.getFaceTransparent(j,T),reverseFlip:r.getFaceReverseFlip(j,T),reverseColor:r.getFaceReverseColor(j,T),reverseCull:r.getFaceReverseCull(j,T),texture:r.getFaceImage(j,T),blendTexture:r.getFaceBlendImage(j,T),discardSelectable:r.getFaceDiscardSelectable(j,T)};if("csg"!==T){y.uv=r.getFaceUv(j,T)||_&&_[T+"Uv"],y.uvScale=r.getFaceUvScale(j,T)||_&&_[T+"UvScale"],y.uvOffset=r.getFaceUvOffset(j,T)||_&&_[T+"UvOffset"];var u=r.getFaceMat(j,T);u&&(y.mat=Tr(j,u))}return y},xl=function(O,u,l,$,N){if($){if(!N($.transparent))return;var r=O.data,h=O.gv,A=h._buffer,v=h.getTexture($.texture,r),F=h.getTexture($.blendTexture,r);Sr(u,l,v,$.discardSelectable,A.uv,$.tuv,$.uvOffset,$.uvScale,F),Kj(u,l,$.blend,$.light,$.opacity,$.reverseFlip,$.reverseColor,$.reverseCull),Zl(u,l.uDiffuse,$.color),xc(u,A.vs,$.vs,l.aPosition),xc(u,A.ns,$.ns,l.aNormal),mn(u,0,$.vs.length/3),xd(u,l),Ld(u,l,v)}},Mb=function(m,k,b,R,O,W){var D,E,u,g,h,o,N,B,f,n,y,C=[R-k,O-b],L=m?m.length:0;for(u=0;L>u;u++){for(g=2,D=m[u],h=D[0],o=D[1];g+1<D.length;){if(N=D[g],B=D[g+1],E=Tm(k,b,R,O,h,o,N,B,!0)){f=[N-h,B-o],n=Li(f),f[0]/=n,f[1]/=n,n=Ao(C,f),n=n>0?W:-W,y=[f[0]*n,f[1]*n];break}h=N,o=B,g+=2}if(y)break}if(y)for(R=k+y[0],O=b+y[1],u=0;L>u;u++)for(g=2,D=m[u],h=D[0],o=D[1];g+1<D.length;){if(N=D[g],B=D[g+1],E=Tm(k,b,R,O,h,o,N,B,!0))return[0,0];h=N,o=B,g+=2}return y?y:[R-k,O-b]},Ak=K.graph3d={},jj=function(C,D,$){ne(q+".graph3d."+C,D,$)},Ph="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Jr="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Sm(V,{setBatchInfo:function(l,c){Zo[l]=c},getBatchInfo:function(M){return Zo[M]}},!0);var wj=[1,1,1],Aj=[1,0,0,0,0,1,0,1,1,1,1,0],Mf=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Tj=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],vm=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],on=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Go=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Lm=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Gj=function(W,v){pl(W,v,"_batchModelMap","_batchIndexMap"),Kc(W,v,"_wireframeModelMap","_wireframeIndexMap"),Kc(W,v,"_polylineModelMap","_polylineIndexMap"),Kc(W,v,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Kc(W,v,"_polylineModelMapSwap","_polylineIndexMapSwap")},pl=function(N,u,R,_){if(!u)return N[R]={},N[_]={},void 0;var K=u._id,o=N[_],r=o[K];if(r){var c=N[R],C=r.batch,p=c[C],q=p.ds,X=r.index;if(p.invalidate=!0,delete o[K],q.splice(X,1),wr(q))return delete c[C],void 0;for(var O=r.begin,w=r.size,f=3*O,z=3*w,U=4*O,i=4*w,S=p.vs,v=p.ps,d=p.uv,H=p.cs,l=p.bs,n=p.rs,h=p.ns,E=p.ls;X<q.length;X++)r=o[q[X]._id],r.index--,r.begin-=w;S.splice(f,z),v.splice(U,i),d&&d.splice(2*O,2*w),H&&H.splice(U,i),l&&l.splice(f,z),n&&n.splice(O,w),h&&h.splice(f,z),E&&E.splice(O,w)}},Kc=pl,Be=function(B,p,x,d){if(!d)return G;var k=p[d];if(!k){var M=Zo[d]||Er,u=M.image?[]:G;k=p[d]={vs:[],ns:[],uv:u,cs:u?G:M.color?G:[],bs:M.blend?[]:G,ps:[],rs:M.brightness?[]:G,ds:[]}}return k.invalidate=!0,B[x._id]={index:k.ds.length,begin:k.vs.length/3,batch:d},k.ds.push(x),k},as=function(w,o){return o!=G&&1!==o?[w[0]*o,w[1]*o,w[2]*o,w[3]]:w},_k=function(s,e,h){var q=s.getBrightness(e),l=So(h.color||"white"),G=l[3]<1,R=Math.ceil(h.width)||1,u=(G?"T":"O")+R,X=s._wireframeIndexMap,B=s._wireframeModelMap,z=B[u];z||(z=B[u]={vs:[],cs:[],ps:[],ds:[],T:G,W:R});var i,U=s.getData3dUI(e),k=hm(U);if(h.geometry){if(!k)return;if(i=xj(k),!i)return}else i=h.short?tf:ti;z.invalidate=!0;var b=z.vs,V=z.cs,A=z.ds,y=X[e._id]={index:A.length,begin:b.length/3,batch:u};A.push(e);var g=Tr(e,h.mat),r=U._calcAnchorMat(e);r&&cr(g,g,r),us(b,g,i);var j=y.size=b.length/3-y.begin;fn(V,as(l,q),j)},io=function(C,j,n,z,J,a,r,T,Z){var V=C.getBrightness(j);V==G&&(V=1);var B=as(So(z),V),D=B[3]<1;a=Math.ceil(a)||1;var t=(D?"T":"O")+a;if(r){var H=r[0],F=(r[1]||H)+H;t+="-"+H+"-"+F,Z&&(t+="-"+gr(Z)+"-"+V,Z=as(So(Z),V))}var Y=C._polylineIndexMap,P=C._polylineModelMap,h=P[t];h||(h=P[t]={vs:[],cs:[],ps:[],ds:[],ls:r?[]:G,T:D,W:a},r&&(h.D=H,h.G=F,h.A=Z)),h.invalidate=!0;var p,y=h.vs,b=h.cs,A=h.ds,O=h.ls,d=Y[j._id]={index:A.length,begin:y.length/3,batch:t};A.push(j),ml(y,n);var M,Q=d.size=y.length/3-d.begin,s=n.length,c=0,W=[];if(r||J)for(p=0;s>p;p+=6)M=Li([n[p],n[p+1],n[p+2]],[n[p+3],n[p+4],n[p+5]]),W.push(M),c+=M;if(c&&J){var S,U=as(So(J),V),m=[U[0]-B[0],U[1]-B[1],U[2]-B[2],U[3]-B[3]],L=0;for(p=0;s>p;p+=6)S=L/c,fn(b,[B[0]+m[0]*S,B[1]+m[1]*S,B[2]+m[2]*S,B[3]+m[3]*S],1),L+=W[p/6],S=L/c,fn(b,[B[0]+m[0]*S,B[1]+m[1]*S,B[2]+m[2]*S,B[3]+m[3]*S],1)}else fn(b,B,Q);if(r)for(L=T||0,p=0;s>p;p+=6)O.push(L),L+=W[p/6],O.push(L)},dr=function(l,h,C){if(h)for(var b=4*h.begin,q=C[h.batch].ps,N=0;N<h.size;N++)q[b++]=l[0],q[b++]=l[1],q[b++]=l[2],q[b++]=l[3]},To=function(D,I){var y=I+["32"],x=D[I],Q=D[y];x?Q&&Q.length===x.length?(Q.set(x),Q._bufId=null):D[y]=new nj(x):delete D[y]},Yb=function(y,t,N,H,G,g,c,Y,P){if(Ul(N))N.forEach(function(Z){Yb(y,t,Z,H,G,g,c,Y,P)});else if(ed(N))Yb(y,t,hm(H,N),H,G,g,c,Y,P);else if(ag(N)){var m,M=Qb(N.mat,t,y),l=Qb(N.s3,t,y),k=Qb(N.t3,t,y),R=Qb(N.r3,t,y);if((l||R||k||M)&&(m=Ki(M,l,R,Qb(N.rotationMode,t,y),k),g.push(m)),N.shape3d)Yb(y,t,N.shape3d,H,G,g,c,Y,N);else{var D=H.s;P=P||Er;var v=g[0],d=g.length,a=D("shape3d.color",N.color,P.color);if(G||(G=D("shape3d.blend",N.blend,P.blend)),d>1){v=Ve(v);for(var h=1;d>h;h++)cr(v,v,g[h])}N.vs&&D(Qn,N.visible,P.visible)&&xb(v,c,Y,N.vs,N.uv,N.is,G,a),N.top_vs&&D(Mq,N.topVisible,P.topVisible)&&xb(v,c,Y,N.top_vs,N.top_uv,N.top_is,G,D("shape3d.top.color",N.topColor,P.topColor)||a),N.bottom_vs&&D(Fg,N.bottomVisible,P.bottomVisible)&&xb(v,c,Y,N.bottom_vs,N.bottom_uv,N.bottom_is,G,D("shape3d.bottom.color",N.bottomColor,P.bottomColor)||a),N.from_vs&&D(xg,N.fromVisible,P.fromVisible)&&xb(v,c,Y,N.from_vs,N.from_uv,N.from_is,G,D("shape3d.from.color",N.fromColor,P.fromColor)||a),N.to_vs&&D(Nn,N.toVisible,P.toVisible)&&xb(v,c,Y,N.to_vs,N.to_uv,N.to_is,G,D("shape3d.to.color",N.toColor,P.toColor)||a)
}m&&g.pop()}},xb=function($,f,U,p,y,n,X,A){var g,J=f.cs,m=f.uv,c=f.bs;if(n){g=n.length;for(var C=0;g>C;C++){var r=n[C];us(U,$,[p[3*r],p[3*r+1],p[3*r+2]]),m&&ml(m,[y[2*r],y[2*r+1]])}}else g=p.length/3,us(U,$,p),m&&ml(m,y);J&&fn(J,A,g),c&&(X?th(c,X,g):ml(c,wj,g))},Ed=function(E,f,G,b){var y=[];b?Yb(E.gv,E.data,b,E,E.getBodyColor(),[f],G,y):(bk(E,kh,f,G,y),bk(E,tq,f,G,y),bk(E,Gb,f,G,y),bk(E,Cb,f,G,y),bk(E,Wj,f,G,y),bk(E,Eh,f,G,y),bk(E,"csg",f,G,y)),y.length&&(ml(G.vs,y),ml(G.ns,Io(y)))},bk=function($,z,H,L,Z){var p=$[z];if(p){var l=p.tuv;if(l){var t,j,Q,S,J=p.uvScale,k=p.uvOffset;if(J)for(t=l.length,j=J[0],Q=J[1],S=0;t>S;S+=2)l[S]*=j,l[S+1]*=Q;if(k)for(t=l.length,j=k[0],Q=k[1],S=0;t>S;S+=2)l[S]+=j,l[S+1]+=Q}xb(H,L,Z,p.vs,l,G,p.blend,p.color)}},ll=function(L,p,_,M,S,J,g,Z){var H,s=_.cs,T=_.uv,P=_.bs;if(L.getFaceVisible(p,J)){var X=L.getFaceMat(p,J);if(X&&(S=Tr(p,X)),us(g,S,Z),s&&fn(s,L.getFaceColor(p,J),6),T){var F=L.getFaceUv(p,J)||M[J+"Uv"],D=L.getFaceUvScale(p,J)||M[J+"UvScale"],c=L.getFaceUvOffset(p,J)||M[J+"UvOffset"];F=F?[F[6],F[7],F[0],F[1],F[2],F[3],F[2],F[3],F[4],F[5],F[6],F[7]]:Aj;var Y=F[0],q=F[1],x=F[2],O=F[3],K=F[4],m=F[5],e=F[6],U=F[7],l=F[8],C=F[9],$=F[10],B=F[11];if(D){var f=D[0],Q=D[1];Y*=f,q*=Q,x*=f,O*=Q,K*=f,m*=Q,e*=f,U*=Q,l*=f,C*=Q,$*=f,B*=Q}if(c){var y=c[0],N=c[1];Y+=y,q+=N,x+=y,O+=N,K+=y,m+=N,e+=y,U+=N,l+=y,C+=N,$+=y,B+=N}T.push(Y,q,x,O,K,m,e,U,l,C,$,B)}P&&(H=L.getBodyColor(p)||L.getFaceBlend(p,J),H?th(P,H,6):ml(P,wj,6))}},Mi=function(P,d,p,V){var o=P.getGL(),L=P._prg,v=P._buffer;if(!P.drawFilter&&!Oc(d)){Uc(P),fj(o,L);for(var S in d){var w=d[S];if(!(V&&!w.T||!V&&w.T)){w.invalidate?(w.invalidate=!1,To(w,"vs"),To(w,"cs"),To(w,"ls"),To(w,"ps")):p&&To(w,"ps");var O=w.vs32,j=p?w.ps32:w.cs32;Vn(o,L,w.W,G,v.vs,O);var i=w.D,R=!P._dashDisabled&&i;Zl(o,L.uAlphaTest,r.alphaTest),R&&(Zl(o,L.uDash,!0),Zl(o,L.uDashDistance,i),Zl(o,L.uDashGapDistance,w.G),Mn(o,L.aLineDistance),xc(o,v.lineDistance,w.ls32,L.aLineDistance,1),Zl(o,L.uDiffuse,w.A||ps));var b=!P._batchColorDisabled;b&&(Zl(o,L.uBatchColor,!0),Mn(o,L.aBatchColor),xc(o,v.batchColor,j,L.aBatchColor,4)),Sr(o),mn(o,0,O.length/3,o.LINES),Ld(o),b&&(Zl(o,L.uBatchColor,!1),Qj(o,L.aBatchColor)),R&&(Zl(o,L.uDash,!1),Qj(o,L.aLineDistance))}}ic(o,L)}},ul=function(x,v,c){var B,C,U,y,j,F,$,o,K,I,T,s=x.getGL(),E=x._prg,w=x._buffer,R=x._batchModelMap;if(!Oc(R)){Uc(x);for(B in R)if(C=Zo[B]||Er,!(c&&!C.transparent||!c&&C.transparent)&&(U=R[B],v||!C.transparentMask)){var X=c&&C.autoSort!==!1&&(x._33Q||U.invalidate);if(U.invalidate?(U.invalidate=!1,To(U,"vs"),To(U,"ns"),To(U,"cs"),To(U,"rs"),To(U,"ps"),To(U,"bs"),To(U,"uv")):v&&To(U,"ps"),j=U.vs32,F=v?U.ps32:U.cs32,K=U.uv32,$=U.bs32,o=U.rs32,T=j.length/3,X&&(U.is=Ip(j,x.getEye())),T){y=C.light,I=x.getTexture(C.image),Kj(s,E,G,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),F?x._batchColorDisabled||(Zl(s,E.uBatchColor,!0),Mn(s,E.aBatchColor),xc(s,w.batchColor,F,E.aBatchColor,4)):Zl(s,E.uDiffuse,C.color||ps);var b=C.alphaTest;Zl(s,E.uAlphaTest,b===z?r.alphaTest:b);var t=$&&!x._batchBlendDisabled;t&&(Zl(s,E.uBatchBlend,!0),Mn(s,E.aBatchBlend),xc(s,w.batchBlend,$,E.aBatchBlend));var f=o&&!x._batchBrightnessDisabled;f&&(Zl(s,E.uBatchBrightness,!0),Mn(s,E.aBatchBrightness),xc(s,w.batchBrightness,o,E.aBatchBrightness,1)),K?Sr(s,E,I,C.discardSelectable,w.uv,K,C.uvOffset,C.uvScale):Sr(s),xc(s,w.vs,j,E.aPosition),xc(s,w.ns,U.ns32,E.aNormal),U.is?(Pl(s,w.is,U.is),Cs(s,0,T)):mn(s,0,T),K?Ld(s,E,I):Ld(s),F&&!x._batchColorDisabled&&(Zl(s,E.uBatchColor,!1),Qj(s,E.aBatchColor)),t&&(Zl(s,E.uBatchBlend,!1),Qj(s,E.aBatchBlend)),f&&(Zl(s,E.uBatchBrightness,!1),Qj(s,E.aBatchBrightness)),xd(s,E)}}}},Ip=function(t,v){for(var l=t.length/3,Y=new Array(l),n=l/3,X=new Array(n),z=0;n>z;z++)X[z]=z;X.sort(function(M,D){var j=9*M,_=[(t[j]+t[j+3]+2*t[j+6])/4,(t[j+1]+t[j+4]+2*t[j+7])/4,(t[j+2]+t[j+5]+2*t[j+8])/4];j=9*D;var W=[(t[j]+t[j+3]+2*t[j+6])/4,(t[j+1]+t[j+4]+2*t[j+7])/4,(t[j+2]+t[j+5]+2*t[j+8])/4],R=Li(v,_)-Li(v,W);return R>0?-1:0>R?1:0});for(var z=0;n>z;z++){var P=3*z,c=3*X[z];Y[P]=c,Y[P+1]=c+1,Y[P+2]=c+2}return new sc(Y)},cn={obj:function(B,W){var y={mat:B.mat,s3:B.s3,r3:B.r3,rotationMode:B.rotationMode,t3:B.t3,cube:B.cube==G?!0:B.cube,center:B.center==G?!0:B.center,ignoreMtls:B.ignoreMtls,ignoreTransparent:B.ignoreTransparent,ignoreColor:B.ignoreColor,ignoreImage:B.ignoreImage,ignoreNormal:B.ignoreNormal,prefix:B.prefix,flipY:B.flipY,flipFace:B.flipFace,reverseFlipMtls:B.reverseFlipMtls,finishFunc:function(A,R){if(A){var R=[];for(var L in A){var J=A[L];R.rawS3=J.rawS3,R.push(J),B.eachModel&&B.eachModel(L,J)}R.json=B,W(R)}else W()}};V.loadObj(B.obj,B.mtl,y)}};V.getModelTypeHandlers=function(){return cn},V.setModelTypeHandler=function(X,t){cn[X]=t},V.getModelTypeHandler=function(L){return cn[L]},V.handleModelLoaded=function(){},V.handleUnfoundModel=function(){};var Oj=G,dc=G,Qm=function(i){Oj&&!i._loadingModelView_&&(dc||(dc={}),dc[i._loadingModelView_=Jn()]=i)},Ik=function(f,L){Oj||(Oj={});var $=Oj[f];if($){if($.url===L)return;$.request.onload=ts,$.request.onerror=ts}var Z=new We;if(Oj[f]={request:Z,url:L},L=V.beforeLoadURL(L),L.data){var c=V.parse(L.data);Hb(f,c,L)}else{Z.onload=function(q){if(200===this.status||0===this.status){var B=V.parse(q.target.response||q.target.responseText);Hb(f,B,L)}else sq(f,V.handleUnfoundModel(f,L)||G)},Z.onerror=function(){sq(f,V.handleUnfoundModel(f,L)||G)};var W={};W.url=encodeURI(L),W.sync=!1,Z.send(W)}},Hb=function(m,N,R){var u=N.modelType;if(!u)return sq(m,N),V.handleModelLoaded(m,N),void 0;var D=V.getModelTypeHandler(u);if(D){var E=function(M){M?(sq(m,M),V.handleModelLoaded(m,M)):sq(m,V.handleUnfoundModel(m,R)||G)};D(N,E)}else sq(m,V.handleUnfoundModel(m,R)||G)},sq=function(A,c){if(en[A]=c,delete Oj[A],Oc(Oj)&&(Oj=G,dc)){for(var w in dc){var n=dc[w];n._2O&&(n._2O={}),n.invalidateAll&&n.invalidateAll(z,"modelLoaded",A),n.redraw&&n.redraw(),n.iv(),delete n._loadingModelView_}dc=G}if(c&&dc)for(var w in dc){var n=dc[w];n.invalidateAll&&n.invalidateAll(z,"modelLoading",A),n.redraw&&n.redraw(),n.iv()}},Zn=new nj([0,0,0,1,1,1,1,0]),Hh=new nj([0,0,1,0,0,1,0,0,1,0,0,1]),Wo=new sc([0,1,2,2,3,0]),rm=new nj([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),ao=new sc([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Qq=new nj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Je=Io(rm,ao),ob=(new nj([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new sc([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[kh,Gb,tq,Cb,Wj,Eh]),ti=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],tf=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],bf=function(p,v,W,r,Y,q){q=q||16,p=p||16,v=v||0,W=W||p;var M,A,h,u,c,a,i,L,U=.5,Q=[],g=[],Z=O/p,e=C/q;for(M=0;q>M;M++)for(c=M+1,u=M*e,L=c*e,A=v;W>A;A++)a=A+1,h=A*Z,i=a*Z,Q.push(U*s(u)*F(h),U*F(u),-U*s(u)*s(h),U*s(L)*F(i),U*F(L),-U*s(L)*s(i),U*s(u)*F(i),U*F(u),-U*s(u)*s(i),U*s(u)*F(h),U*F(u),-U*s(u)*s(h),U*s(L)*F(h),U*F(L),-U*s(L)*s(h),U*s(L)*F(i),U*F(L),-U*s(L)*s(i)),g.push(A/p,M/q,a/p,c/q,a/p,M/q,A/p,M/q,A/p,c/q,a/p,c/q);if(r){var m=[],y=[];for(h=v*Z,M=0;q>M;M++)c=M+1,u=M*e,L=c*e,m.push(0,0,0,U*s(L)*F(h),U*F(L),-U*s(L)*s(h),U*s(u)*F(h),U*F(u),-U*s(u)*s(h)),y.push(0,.5,v/p,c/q,v/p,M/q)}if(Y){var S=[],j=[];for(h=W*Z,M=0;q>M;M++)c=M+1,u=M*e,L=c*e,S.push(0,0,0,U*s(u)*F(h),U*F(u),-U*s(u)*s(h),U*s(L)*F(h),U*F(L),-U*s(L)*s(h)),j.push(1,.5,W/p,M/q,W/p,c/q)}return{vs:Q,uv:g,from_vs:m,from_uv:y,to_vs:S,to_uv:j}},zd=function(e,l,N){e=e||.17,l=l||12,N=N||18,0>e?e=0:e>.25&&(e=.25);var P,H,D,G,j,V,E,g=.5,$=[],B=[],w=[],S=O/N,f=O/l,h=g-e;for(H=0;l>=H;H++)for(G=-C+H*f,V=F(G),j=s(G),P=0;N>=P;P++)D=P*S,E=h+e*V,$.push(F(D)*E,j*e,-s(D)*E),B.push(P/N,1-H/l);for(H=0;l>H;H++){var R=H*(N+1),A=(H+1)*(N+1);for(P=0;N>P;P++)w.push(R+P,A+P+1,A+P,R+P,R+P+1,A+P+1)}return{vs:$,uv:B,is:w}},js=function(Q,Y,I,T,t,J,L){L=L||12,Q=Q||18,Y=Y||0,I=I||Q,J=J||.17,0>J?J=0:J>.25&&(J=.25);var A,c,e,X,r,h,g,f,v,B,P=.5,_=[],u=[],w=O/Q,j=O/L,n=P-J;for(e=0;L>e;e++)for(X=e+1,g=-C+e*j,f=-C+X*j,A=Y;I>A;A++)c=A+1,r=A*w,h=c*w,v=n+J*F(g),B=n+J*F(f),_.push(F(r)*v,s(g)*J,-s(r)*v,F(h)*v,s(g)*J,-s(h)*v,F(h)*B,s(f)*J,-s(h)*B,F(r)*v,s(g)*J,-s(r)*v,F(h)*B,s(f)*J,-s(h)*B,F(r)*B,s(f)*J,-s(r)*B),u.push(A/Q,1-e/L,c/Q,1-e/L,c/Q,1-X/L,A/Q,1-e/L,c/Q,1-X/L,A/Q,1-X/L);if(T){var R=[],x=[];for(e=0;L>e;e++)X=e+1,g=-C+e*j,f=-C+X*j,r=Y*w,v=n+J*F(g),B=n+J*F(f),R.push(F(r)*v,s(g)*J,-s(r)*v,F(r)*B,s(f)*J,-s(r)*B,F(r)*n,0,-s(r)*n),x.push(.5+.5*F(g),.5-.5*s(g),.5+.5*F(f),.5-.5*s(f),.5,.5)}if(t){var G=[],p=[];for(e=0;L>e;e++)X=e+1,g=-C+e*j,f=-C+X*j,r=I*w,v=n+J*F(g),B=n+J*F(f),G.push(F(r)*v,s(g)*J,-s(r)*v,F(r)*n,0,-s(r)*n,F(r)*B,s(f)*J,-s(r)*B),p.push(.5-.5*F(g),.5-.5*s(g),.5,.5,.5-.5*F(f),.5-.5*s(f))}return{vs:_,uv:u,from_vs:R,from_uv:x,to_vs:G,to_uv:p}},Fj=function(b,w){for(var R,l,L,x=.5,K=16,M=[],H=[],E=[],k=O/K,V=0;K>=V;V++)R=V*k,l=F(R)*x,L=s(R)*x,M.push(l,-x,L,l,x,L),H.push(1-V/K,1,1-V/K,0);for(V=0;K>V;V++)E.push(2*V,2*V+1,2*V+3,2*V,2*V+3,2*V+2);if(w){var J=[],f=[],e=[];for(J.push(0,-x,0),f.push(.5,.5),V=0;K>=V;V++)R=V*k,l=F(R),L=s(R),J.push(l*x,-x,-L*x),f.push(.5+.5*l,.5+.5*L);for(V=0;K>V;V++)e.push(0,V+2,V+1)}if(b){var N=[],W=[],I=[];for(N.push(0,x,0),W.push(.5,.5),V=0;K>=V;V++)R=V*k,l=F(R),L=s(R),N.push(l*x,x,-L*x),W.push(.5+.5*l,.5-.5*L);for(V=0;K>V;V++)I.push(0,V+1,V+2)}return{vs:M,uv:H,is:E,bottom_vs:J,bottom_uv:f,bottom_is:e,top_vs:N,top_uv:W,top_is:I}},Yj=function(p,g,u,d,b,i,z){p=p||12,g=g||0,u=u||p;for(var C,Q,U,l,H,M,V,N,v=.5,o=[],t=[],B=O/p,w=g;u>w;w++)C=w+1,Q=w*B,U=C*B,l=F(Q)*v,H=s(Q)*v,M=F(U)*v,V=s(U)*v,o.push(l,-v,-H,M,-v,-V,l,v,-H,M,-v,-V,M,v,-V,l,v,-H),t.push(w/p,1,C/p,1,w/p,0,C/p,1,C/p,0,w/p,0);if(z){var x=[],K=[];for(w=g;u>w;w++)Q=B*w,U=B*(w+1),l=F(Q),H=s(Q),M=F(U),V=s(U),x.push(l*v,-v,-H*v,0,-v,0,M*v,-v,-V*v),K.push(.5+.5*l,.5+.5*H,.5,.5,.5+.5*M,.5+.5*V)}if(i){var a=[],r=[];for(w=g;u>w;w++)Q=B*w,U=B*(w+1),l=F(Q),H=s(Q),M=F(U),V=s(U),a.push(l*v,v,-H*v,M*v,v,-V*v,0,v,0),r.push(.5+.5*l,.5-.5*H,.5+.5*M,.5-.5*V,.5,.5)}if(d){var I=[],_=[];Q=B*g,l=F(Q)*v,H=s(Q)*v,N=g/p,I.push(0,v,0,0,-v,0,l,-v,-H,l,-v,-H,l,v,-H,0,v,0),_.push(0,0,0,1,N,1,N,1,N,0,0,0)}if(b){var Z=[],j=[];Q=B*u,l=F(Q)*v,H=s(Q)*v,N=u/p,Z.push(0,-v,0,0,v,0,l,v,-H,l,v,-H,l,-v,-H,0,-v,0),j.push(1,1,1,0,N,0,N,0,N,1,1,1)}return{vs:o,uv:t,bottom_vs:x,bottom_uv:K,top_vs:a,top_uv:r,from_vs:I,from_uv:_,to_vs:Z,to_uv:j}},Xl=function(B,X,b,N,l){X=X||18,b=b||0,N=N==G?O:N,l=l==G?.5:l;for(var k,P,c,Z,q,I,h=[0,.5,.75,.875,.9375],t=[],K=[],Y=[],D=N/X,C=0;C<h.length;C++){var a=0===C%2?0:.5;for(k=0;X>=k;k++)P=(k+a)*D+b,c=1-h[C],t.push(F(P)*l*c,-l+2*h[C]*l,-s(P)*l*c),K.push((k+a)/X,c)}for(C=0;C<h.length-1;C++){var R=C*(X+1),$=(C+1)*(X+1);for(k=0;X>k;k++)Y.push(R+k,$+k+1,$+k,R+k,R+k+1,$+k+1)}for(I=t.length/3-(X+1),k=0;X>k;k++)t.push(0,l,0),K.push((k+.5)/X,0);for(k=0;X>k;k++)Y.push(I+k,I+k+1,I+(X+1)+k);if(B){var r=[],H=[],p=[];for(r.push(0,-l,0),H.push(.5,.5),k=0;X>=k;k++)P=k*D+b,Z=F(P),q=s(P),r.push(Z*l,-l,-q*l),H.push(.5+.5*Z,.5+.5*q);for(k=0;X>k;k++)p.push(0,k+2,k+1)}return{vs:t,uv:K,is:Y,bottom_vs:r,bottom_uv:H,bottom_is:p}},Ud=function(Y,m,v,b,C,V){Y=Y||16,m=m||0,v=v||Y;for(var S=.5,i=[],X=[],Q=O/Y,N=m;v>N;N++){var p=N+1,z=Q*N,T=Q*p;i.push(F(z)*S,-S,-s(z)*S,F(T)*S,-S,-s(T)*S,0,S,0),X.push(N/Y,1,p/Y,1,(N+p)/2/Y,0)}if(V){var w=[],I=[];for(N=m;v>N;N++){z=Q*N,T=Q*(N+1);var Z=F(z),A=s(z),g=F(T),r=s(T);w.push(Z*S,-S,-A*S,0,-S,0,g*S,-S,-r*S),I.push(.5+.5*Z,.5+.5*A,.5,.5,.5+.5*g,.5+.5*r)}}if(b){var U=[],t=[];z=Q*m,U.push(0,S,0,0,-S,0,F(z)*S,-S,-s(z)*S),t.push(0,0,0,1,m/Y,1)}if(C){var B=[],u=[];z=Q*v,B.push(0,-S,0,0,S,0,F(z)*S,-S,-s(z)*S),u.push(1,1,1,0,v/Y,1)}return{vs:i,uv:X,bottom_vs:w,bottom_uv:I,from_vs:U,from_uv:t,to_vs:B,to_uv:u}},go=function(J,v,p,j,N,G,u,_){for(var U=[],M=0;M<J.length-1;M+=2)U.push({x:J[M],y:J[M+1]});return mj(U,v,p,j,N,G,u,_,!1)},Dh={roundRect:function(G,u){return go([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],G,u,3)},star:function(m,x){return go([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],m,x)},rect:function(U,G){return go([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],U,G)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(E,t){return go([0,-.5,.5,.5,-.5,.5],[1,2,2,5],E,t)},rightTriangle:function(J,s){return go([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],J,s)},parallelogram:function(u,M){return go([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],u,M)},trapezoid:function(N,n){return go([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],N,n)}},Al={sphere:1,cylinder:1,cone:1,torus:1},dj={torus:1,sphere:1},Xp=Sm(Cn(Dh),{cylinder:1}),sl=Sm(Cn(Dh),{cylinder:1,cone:1}),Sb=function(d,K,q){var F,B=Qb(d.anchor3d,q,K),$=Qb(d.mat,q,K),l=Qb(d.s3,q,K),Y=Qb(d.t3,q,K),A=Qb(d.r3,q,K),j=l||A||Y||$;if(B||j){F=Ve(K._6O);var J=j?Ki($,l,A,Qb(d.rotationMode,q,K),Y):Qh();B&&mr(J,[.5-B[0],.5-B[1],.5-B[2]]),Uc(K,J)}return F},he=function(M,s,S,x,O,d,b){if(Ul(S))S.forEach(function(y){he(M,s,y,x,O,d,b)});else if(ed(S))he(M,s,hm(x,S),x,O,d,b);else if(ag(S))if(S.shape3d){var t=Sb(S,M,s);he(M,s,S.shape3d,x,O,d,S),t&&Ek(M,t)}else rr(M,s,S,x.s,O,d,b)},rr=function(P,O,K,p,B,j,Y){if(Y=Y||Er,!j||j(p("shape3d.transparent",K.transparent,Y.transparent))){var l=Sb(K,P,O);oe(K);var s=P._26I,T=P._prg,S=P._buffer,n=p("shape3d.color",K.color,Y.color);B||(B=p("shape3d.blend",K.blend,Y.blend));var q,A=K.opacity==G?Y.opacity:K.opacity,M=p("shape3d.opacity");q=M!=G&&A!=G?A*M:A!=G?A:M,Kj(s,T,B,p("shape3d.light",K.light,Y.light),q,p("shape3d.reverse.flip",K.reverseFlip,Y.reverseFlip),p("shape3d.reverse.color",K.reverseColor,Y.reverseColor),p("shape3d.reverse.cull",K.reverseCull,Y.reverseCull)),K.vs&&p(Qn,K.visible,Y.visible)&&rs(s,T,S,n,P.getTexture(p("shape3d.image",K.image,Y.image),O),p("shape3d.discard.selectable",K.discardSelectable,Y.discardSelectable),K.vs,K.uv,K.ns,K.is,p("shape3d.uv.offset",K.uvOffset,Y.uvOffset),p("shape3d.uv.scale",K.uvScale,Y.uvScale),p("shape3d.polygonOffset",K.polygonOffset,Y.polygonOffset)),K.top_vs&&p(Mq,K.topVisible,Y.topVisible)&&rs(s,T,S,p("shape3d.top.color",K.topColor,Y.topColor)||n,P.getTexture(p("shape3d.top.image",K.topImage,Y.topImage),O),p("shape3d.top.discard.selectable",K.topDiscardSelectable,Y.topDiscardSelectable),K.top_vs,K.top_uv,K.top_ns,K.top_is,p("shape3d.top.uv.offset",K.topUvOffset,Y.topUvOffset),p("shape3d.top.uv.scale",K.topUvScale,Y.topUvScale),p("shape3d.top.polygonOffset",K.topPolygonOffset,Y.topPolygonOffset)),K.bottom_vs&&p(Fg,K.bottomVisible,Y.bottomVisible)&&rs(s,T,S,p("shape3d.bottom.color",K.bottomColor,Y.bottomColor)||n,P.getTexture(p("shape3d.bottom.image",K.bottomImage,Y.bottomImage),O),p("shape3d.bottom.discard.selectable",K.bottomDiscardSelectable,Y.bottomDiscardSelectable),K.bottom_vs,K.bottom_uv,K.bottom_ns,K.bottom_is,p("shape3d.bottom.uv.offset",K.bottomUvOffset,Y.bottomUvOffset),p("shape3d.bottom.uv.scale",K.bottomUvScale,Y.bottomUvScale),p("shape3d.bottom.polygonOffset",K.bottomPolygonOffset,Y.bottomPolygonOffset)),K.from_vs&&p(xg,K.fromVisible,Y.fromVisible)&&rs(s,T,S,p("shape3d.from.color",K.fromColor,Y.fromColor)||n,P.getTexture(p("shape3d.from.image",K.fromImage,Y.fromImage),O),p("shape3d.from.discard.selectable",K.fromDiscardSelectable,Y.fromDiscardSelectable),K.from_vs,K.from_uv,K.from_ns,K.from_is,p("shape3d.from.uv.offset",K.fromUvOffset,Y.fromUvOffset),p("shape3d.from.uv.scale",K.fromUvScale,Y.fromUvScale),p("shape3d.from.polygonOffset",K.fromPolygonOffset,Y.fromPolygonOffset)),K.to_vs&&p(Nn,K.toVisible,Y.toVisible)&&rs(s,T,S,p("shape3d.to.color",K.toColor,Y.toColor)||n,P.getTexture(p("shape3d.to.image",K.toImage,Y.toImage),O),p("shape3d.to.discard.selectable",K.toDiscardSelectable,Y.toDiscardSelectable),K.to_vs,K.to_uv,K.to_ns,K.to_is,p("shape3d.to.uv.offset",K.toUvOffset,Y.toUvOffset),p("shape3d.to.uv.scale",K.toUvScale,Y.toUvScale),p("shape3d.to.polygonOffset",K.toPolygonOffset,Y.toPolygonOffset)),xd(s,T),l&&Ek(P,l)}},rs=function(t,N,k,F,z,Y,r,X,T,p,I,y,K){r&&(K&&Ck(t,K),Zl(t,N.uDiffuse,F),X?Sr(t,N,z,Y,k.uv,X,I,y):Sr(t),xc(t,k.vs,r,N.aPosition),xc(t,k.ns,T,N.aNormal),p?(tm(t,k.is,p),Cs(t,0,p.length)):mn(t,0,r.length/3),X?Ld(t,N,z):Ld(t),K&&pe(t))},hm=function(s,C){var W=s.s;if(C||(C=W(mm)),!C)return G;var n=Wg(C);if(n)return n;if("text"===C){var i={amount:W("shape3d.text.amount"),size:W("shape3d.text.size"),font:W("shape3d.text.font"),style:W("shape3d.text.style"),weight:W("shape3d.text.weight"),fill:W("shape3d.text.fill"),curveSegments:W("shape3d.text.curveSegments"),spacing:W("shape3d.text.spacing")},y=s.gv.getShape3dText(s.data),L=y;for(var F in i)L+="_"+(i[F]===z?"U":i[F]);return s._cachedTextKey===L?s._cachedTextGeometry:(s._cachedTextKey=L,s._cachedTextGeometry=V.createTextGeometry(y,i))}var F=C;if(Al[C]){var U=W("shape3d.side"),r=W("shape3d.side.from"),x=W("shape3d.side.to"),Y=W(xg),S=W(Nn);3>U?(U=0,r=0,x=0,Y=!1,S=!1):((r==G||0>r)&&(r=0),(x==G||x>U)&&(x=U),0===r&&x===U&&(Y=!1,S=!1)),F+="-"+U+"-"+r+"-"+x+"-"+Y+"-"+S}if(Xp[C]){var T=W(Mq);F+="-"+T}if(sl[C]){var q=W(Fg);F+="-"+q}if("torus"===C){var m=W("shape3d.torus.radius");0>m?m=0:m>.25&&(m=.25),F+="-"+m}if(dj[C]){var w=W(Pk);F+="-"+w}return n=oq[F],n||("box"===C?n=V.createBoxModel():Dh[C]?n=Dh[C](T,q):"sphere"===C?n=V.createSphereModel(U,r,x,Y,S,w):C===Te?n=V.createCylinderModel(U,r,x,Y,S,T,q):"cone"===C?n=V.createConeModel(U,r,x,Y,S,q):"torus"===C&&(n=V.createTorusModel(U,r,x,Y,S,m,w)),oq[F]=n),n},oe=function(){var o=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],G=["is","top_is","bottom_is","from_is","to_is"];return L=Sq(Ph.substr(Ph.indexOf("^#")+2)),is(V[Lc(ek+o[15]+"n"+o[16])]())&&cj()?function(v){v&&!v._complete_&&(v._complete_=!0,v.vs&&wr(v.ns)&&(v.ns=Io(v.vs,v.is)),v.top_vs&&wr(v.top_ns)&&(v.top_ns=Io(v.top_vs,v.top_is)),v.bottom_vs&&wr(v.bottom_ns)&&(v.bottom_ns=Io(v.bottom_vs,v.bottom_is)),v.from_vs&&wr(v.from_ns)&&(v.from_ns=Io(v.from_vs,v.from_is)),v.to_vs&&wr(v.to_ns)&&(v.to_ns=Io(v.to_vs,v.to_is)),o.forEach(function(B){var l=v[B];Ul(l)&&(v[B]=new nj(l))}),G.forEach(function(y){var X=v[y];Ul(X)&&(v[y]=new sc(X))}))}:void 0}(),Gf=function(c,I){var T=c[I];Ul(T)&&(c[I]=new nj(T))};Sm(Xm,{_25Q:function(w){w._16O=function(E,L,U,u,H,t,K,f,h){var O=this.info;if(O){var N,a,_,M,n,I,R=Qh();if(Zq[L]?(N=O.p3,a=O.c1,_=O.c2):kd[L]?(a=O.s1||O.c1,_=O.s2||O.c2):(a=O.t1||O.c1,_=O.t2||O.c2),N)I=Bj(L,ie,U,u,f,h);else{var s=bd(_,a),V=Li(a,_);M=[0,-x(s[2],s[0]),S(s[1]/V)],n="zyx",N=[(a[0]+_[0])/2,(a[1]+_[1])/2,(a[2]+_[2])/2],I=Bj(L,[V,0,0],U,u,f,h)}return Ei(R,I,N,u,H,t,K,E,M,n)}return gg},w._80o=function(l,S,E){var i=this,k=i.shapeModel;if(k){var m=i.gv;Uc(m),he(m,i.data,k,i,i.getBodyColor(),E)}},w.createLineModel=function(K,T,p,e,i){for(var j=this,U=j.s,F=Ur(K,T,U(Pk)),A=[],X=0;X<F.length;X++){var n=F[X],h=n.length;if(h>1){var $=n[0];A.push($.x,$.y,$.z);for(var l=1;h-1>l;l++)$=n[l],A.push($.x,$.y,$.z),A.push($.x,$.y,$.z);$=n[h-1],A.push($.x,$.y,$.z)}}var Q,L,r,u=U(e+".color"),Y=U(i),f=0;return Y&&(L=U(i+".color"),Q=U(i+".pattern"),f=U(i+".offset"),r=u),io(j.gv,j.data,A,L||u,r?G:U(e+".gradient.color"),p,Q||U(e+".pattern"),f,r),F},w.createTubeModel=function(m,t,l,U){for(var u=this,F=u.s,d=F("shape3d.side")||eo,v=F("shape3d.start.angle"),y=F("shape3d.sweep.angle"),M=F(Mq)?F("shape3d.top.cap"):G,D=F(Fg)?F("shape3d.bottom.cap"):G,A="flat"===M,e="flat"===D,I=A&&(U?U.uv:F("shape3d.top.image")),Y=e&&(U?U.uv:F("shape3d.bottom.image")),N=U?U.uv:F("shape3d.image"),E={vs:[],uv:N?[]:G,top_vs:A?[]:G,top_uv:I?[]:G,bottom_vs:e?[]:G,bottom_uv:Y?[]:G},K=Ur(m,t,F(Pk),l),B=0,h=K.length;h>B;B++)Pn(E,K[B],F(bp),l,d,v,y,M,D);if(U){var p=[];Yb(u.gv,u.data,E,u,u.getBodyColor(),[],U,p),p.length&&(ml(U.vs,p),ml(U.ns,Io(p)))}else u.shapeModel=E;return K},w.getCache=function(){var Q=this.info;if(Q){var C=Q.list;if(C){var N=Q.cache;return N||(N=Q.cache=gf(C)),N}}return G}}});var Ir=function(j,x){for(var X,i=0,J=j.length,F=0,Y=J-1;Y>=F;)if(i=y(F+(Y-F)/2),X=j[i].length-x,0>X)F=i+1;else{if(!(X>0)){Y=i;break}Y=i-1}i=Y;var U=j[i],C=U.point;return i===J-1||U.length===x||(C=(new gk).subVectors(j[i+1].point,C).normalize().multiplyScalar(x-U.length).add(C)),{point:C,tangent:U.tangent}},gf=function(Y){for(var w,c,h=[],d=0,v=0;v<Y.length;v++){for(var f=Y[v],F=0;F<f.length;F++){w=f[F],c&&(d+=c.distanceTo(w));var u=new gk,D=f[F+1];D?u.subVectors(D,w):c?u.subVectors(w,c):u.x=1,u.normalize(),h.push({point:w,length:d,tangent:u}),c=w}c=null}return h},Ur=function(w,X,I,W){I=I||sk;for(var O=[],J=0,e=w.size();e>J;J++){var N=w.get(J);O.push(new gk(N.x,N.e||0,N.y))}X&&(mb(X)&&(X=X._as),X.length||(X=null));for(var h,Y,l,s,g,m=[],D=0,b=0,j=X?X.length:e;j>b;b++)if(g=X?X[b]:0===b?1:2,1===g)m.push(l=[]),l.push(O[D++]);else if(2===g||5===g)if(s=2===g?O[D++]:l[0],W){var c=X?X[b+1]:j>b+1?2:G;if(2===c||5===c){var L=l[l.length-1],Q=2===c?O[D]:l[0],o=(new gk).subVectors(L,s),R=(new gk).subVectors(Q,s),C=o.length(),i=R.length();if(C&&i)if(W>C/2&&W>i/2)l.push(s);else for(o.multiplyScalar($(W,C/2)/C).add(s),R.multiplyScalar($(W,i/2)/i).add(s),h=new Xr(o,s,R).getPoints(I),Y=0;I>=Y;Y++)l.push(h[Y])}else l.push(s)}else l.push(s);else if(3===g)for(h=new Xr(l[l.length-1],O[D++],O[D++]).getPoints(I),Y=1;I>=Y;Y++)l.push(h[Y]);else if(4===g)for(h=new Kp(l[l.length-1],O[D++],O[D++],O[D++]).getPoints(I),Y=1;I>=Y;Y++)l.push(h[Y]);return m},ke=function(U){for(var P,J,H=new gk,d=[],O=[],o=[],I=0,a=U.length;a>I;I++)P=U[I],J=U[I+1],J?H.subVectors(J,P):H.subVectors(P,U[I-1]),d.push(H.normalize().clone());var n,c,g,R,m=new gk,q=new gk,k=new jr,K=1e-4,v=Number.MAX_VALUE,p=d[0],y=O[0]=new gk,X=o[0]=new gk;for(c=D(p.x),g=D(p.y),R=D(p.z),v>=c&&(v=c,m.set(1,0,0)),v>=g&&(v=g,m.set(0,1,0)),v>=R&&m.set(0,0,1),q.crossVectors(p,m).normalize(),y.crossVectors(p,q),X.crossVectors(p,y),I=1;a>I;I++)O[I]=O[I-1].clone(),o[I]=o[I-1].clone(),q.crossVectors(d[I-1],d[I]),q.length()>K&&(q.normalize(),n=t(xh(d[I-1].dot(d[I]),-1,1)),O[I].applyMatrix4(k.makeRotationAxis(q,n))),o[I].crossVectors(d[I],O[I]);return{B:o,T:d,N:O}},Pn=function(){var r=function(c){for(var f=1;f<arguments.length;f++){var T=arguments[f];c.push(T.x,T.y,T.z)}},S=function(P){for(var L=1;L<arguments.length;L++){var K=arguments[L].uv;P.push(K[0],K[1])}},b=function(X,K,D,$,m){var Z=-$*F(m),g=$*s(m);return new gk(X.x+Z*D.x+g*K.x,X.y+Z*D.y+g*K.y,X.z+Z*D.z+g*K.z)},Z=function(w,W,v,q,N,h,f,I){f=f||O;for(var L=[],l=f/N,$=0;N>=$;$++){var S=b(w,W,v,q,$*l+h);L.push(S),I!=G&&(S.uv=[I,$/N])}return L},M=function(d,i,j,J,$,N,I,e,m){m=m||O;var P=i?d.top_vs:d.bottom_vs;if(P)for(var z=i?d.top_uv:d.bottom_uv,V=m/I,W=0;I>W;W++){var o,g;i?(o=W*V+e,g=(W+1)*V+e):(g=W*V+e,o=(W+1)*V+e),r(P,b(j,J,$,N,o),b(j,J,$,N,g),j),z&&z.push(.5-.5*F(o),.5-.5*s(o),.5-.5*F(g),.5-.5*s(g),.5,.5)}};return function(c,W,v,h,x,t,O,A,o){var F=W.length;if(F>1){var s,T,l,$,m,D,U,R=ke(W),X=R.T,E=R.N,g=R.B;"flat"===A&&M(c,!0,W[0],g[0],E[0],h,x,t,O),"flat"===o&&M(c,!1,W[F-1],g[F-1],E[F-1],h,x,t,O);var n,y,Q=[],f=j(x/2),i="round"===A,B="round"===o,q=W[0],Y=X[0],b=g[0],I=E[0],V=W[F-1],N=X[F-1],e=g[F-1],k=E[F-1];if(i){for(l=1;f>=l;l++)E.splice(0,0,I),g.splice(0,0,b),X.splice(0,0,Y),y=-l/f*h,W.splice(0,0,Y.clone().multiplyScalar(y).add(q)),Q[f-l]=H(h*h-y*y);F+=f}if(B){for(l=1;f>=l;l++)E.push(k),g.push(e),X.push(N),y=l/f*h,W.push(N.clone().multiplyScalar(y).add(V)),Q[W.length-1]=H(h*h-y*y);F+=f}if(c.uv){var C=0,J=0,a=[];for(v&&(C=v),m=W[0],a[0]=0,l=1;F>l;l++)$=W[l],a[l]=m.distanceTo($),m=$,v||(C+=a[l]);for(n=[],l=0;F>l;l++)J+=a[l],n[l]=C?J/C:0}for(l=0;F>l;l++){if($=W[l],D=g[l],U=E[l],s=Z($,D,U,Q[l]===z?h:Q[l],x,t,O,n?n[l]:G),T)for(var L=0;x>L;L++){var K=T[L],u=T[L+1]||T[0],w=s[L],P=s[L+1]||s[0];r(c.vs,u,K,w,w,P,u),c.uv&&S(c.uv,u,K,w,w,P,u)}T=s}}}}();Sm(V,{getLineLength:function(k){return k[k.length-1].length},getLineOffset:function(P,i){return Ir(P,i)},getLineCacheInfo:function(U,A,D,g){return gf(Ur(U,A,D,g))}});var Xf={},xs=new ArrayBuffer(0),_j=Xf.Buffer=function(g,Y,T,u){this.gl=g,this.buffer=g.createBuffer(),this.type=Y||g.ARRAY_BUFFER,this.drawType=u||g.STATIC_DRAW,this.data=xs,T&&this.upload(T)};_j.prototype.upload=function(Z,$,V){V||this.bind();var p=this.gl;Z=Z||this.data,$=$||0,this.data.byteLength>=Z.byteLength?p.bufferSubData(this.type,$,Z):p.bufferData(this.type,Z,this.drawType),this.data=Z},_j.prototype.bind=function(){var G=this.gl;G.bindBuffer(this.type,this.buffer)},_j.createVertexBuffer=function(g,x,j){return new _j(g,g.ARRAY_BUFFER,x,j)},_j.createIndexBuffer=function(s,i,A){return new _j(s,s.ELEMENT_ARRAY_BUFFER,i,A)},_j.create=function(O,M,k,x){return new _j(O,M,x)},_j.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var ng=Xf.Shader=function(R,T,Z){this.gl=R,this.program=Qg(R,T,Z),this.attributes=ab(R,this.program);var $=Oq(R,this.program);this.uniforms=Cg(R,$)};ng.prototype.bind=function(){this.gl.useProgram(this.program)},ng.prototype.destroy=function(){this.gl};var Qg=function(w,W,g){var V=eg(w,w.VERTEX_SHADER,W),d=eg(w,w.FRAGMENT_SHADER,g);w.getShaderParameter(d,w.COMPILE_STATUS)||console.error(w.getError());var h=w.createProgram();return w.attachShader(h,V),w.attachShader(h,d),w.linkProgram(h),w.getProgramParameter(h,w.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",w.getProgramParameter(h,w.VALIDATE_STATUS)),console.error("gl.getError()",w.getError()),""!==w.getProgramInfoLog(h)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",w.getProgramInfoLog(h)),w.deleteProgram(h),h=null),w.deleteShader(V),w.deleteShader(d),h},eg=function(b,B,V){var M=b.createShader(B);return b.shaderSource(M,V),b.compileShader(M),b.getShaderParameter(M,b.COMPILE_STATUS)?M:(console.log(b.getShaderInfoLog(M)),null)},Oq=function(o,r){for(var V={},H=o.getProgramParameter(r,o.ACTIVE_UNIFORMS),E=0;H>E;E++){var K=o.getActiveUniform(r,E),n=K.name.replace(/\[.*?\]/,""),F=rg(o,K.type);V[n]={type:F,size:K.size,location:o.getUniformLocation(r,n),value:Vr(F,K.size)}}return V},ab=function(E,m){for(var D={},n=E.getProgramParameter(m,E.ACTIVE_ATTRIBUTES),z=0;n>z;z++){var i=E.getActiveAttrib(m,z),$=rg(E,i.type);D[i.name]={type:$,size:ac($),gl:E,location:E.getAttribLocation(m,i.name),pointer:Pd}}return D},Pd=function(z,L,C,W,w){var k=this.gl;k.enableVertexAttribArray(this.location),k.bindBuffer(z.type,z.buffer),k.vertexAttribPointer(this.location,this.size,L||k.FLOAT,C||!1,W||0,w||0)},ac=function($){return _f[$]},_f={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},rg=function(j,C){if(!ur){var n=m.keys(wp);ur={};for(var P=0;P<n.length;++P){var A=n[P];ur[j[A]]=wp[A]}}return ur[C]},ur=null,wp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Vr=function(G,l){switch(G){case"float":return 0;case"vec2":return new Float32Array(2*l);case"vec3":return new Float32Array(3*l);case"vec4":return new Float32Array(4*l);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*l);case"ivec3":return new Int32Array(3*l);case"ivec4":return new Int32Array(4*l);case"bool":return!1;case"bvec2":return rd(2*l);case"bvec3":return rd(3*l);case"bvec4":return rd(4*l);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},rd=function(p){for(var o=new Array(p),k=0;k<o.length;k++)o[k]=!1;return o},Cg=function(j,Z){var J={data:{}};J.gl=j;for(var f=m.keys(Z),E=0;E<f.length;E++){var L=f[E],U=L.split("."),n=U[U.length-1],y=og(U,J),d=Z[L];y.data[n]=d,y.gl=j,m.defineProperty(y,n,{get:Wq(n),set:In(n,d)})}return J},Wq=function(V){var X=Cr.replace("%%",V);return new Function(X)},In=function(P,g){var u,T=sf.replace(/%%/g,P);return u=1===g.size?sr[g.type]:Jp[g.type],u&&(T+="\nthis.gl."+u+";"),new Function("value",T)},og=function(j,y){for(var F=y,U=0;U<j.length-1;U++){var $=F[j[U]]||{data:{}};F[j[U]]=$,F=$}return F},Cr=["return this.data.%%.value;"].join("\n"),sf=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),sr={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Jp={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},pc=K.Light=function(){Dr(pc,this),this.s(Mg,r[Mg]),this.s(mm,"sphere"),this.s3(20,20,20)};uj("Light",hi,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(Z,b,t){pc.superClass.onStyleChanged.apply(this,arguments),Z===Mg&&this.s("shape3d.color",t)}});var Fn=Ak.Graph3dView=function(T,U){var o=this;o._attributes=U||V.graph3dViewAttributes,o._25I={},o._view=yn(1,o);var B=o._canvas=$p(o._view);B.addEventListener("webglcontextlost",function(e){e.preventDefault(),gm(o),o._26I&&o._doBufferGC(o._26I,!0),o._26I=G,o._1o.texture=G,o._35O=!0},f),B.addEventListener("webglcontextrestored",function(){o._35O=!1,o.iv()},f),o._batchIndexMap={},o._batchModelMap={},o._wireframeIndexMap={},o._wireframeModelMap={},o._wireframeIndexMapSwap={},o._wireframeModelMapSwap={},o._polylineIndexMap={},o._polylineIndexMap={},o._polylineIndexMapSwap={},o._polylineIndexMapSwap={},o._8O=[],o._7O=Qh(),o._6O=Qh(),o._1o=new hb(o),o._30O=new Op(o),o._31O=new zk(o),o._32O=new qc(o),o._raycaster=new Hf(o),o._highlightHelper=new kj(o),o._postProcessing=new pf(o),o.vr=new Jq(o),o._33Q=!0,o._eye=Cn(V.graph3dViewEye),o._center=Cn(V.graph3dViewCenter),o._up=Cn(V.graph3dViewUp),o._lightChanged=!1,o._59O=[],o._spots=[],o._dirs=[],o._frameId=0,o.overlappingBox=new Gk(o),o.dm(T?T:new rl),o._coreInteractor=new rj(this),o.setInteractors([new xe(o)])
},Gq={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},zq=0;jj("Graph3dView",m,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Km,hl,"firstPersonMode",Kg,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Gd,Ng,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:V.graph3dViewEditHelperDisabled,_devicePixelRatio:z,_boundaries:z,_moveStep:V.graph3dViewMoveStep,_rotateStep:V.graph3dViewRotateStep,_pannable:V.graph3dViewPannable,_rotatable:V.graph3dViewRotatable,_walkable:V.graph3dViewWalkable,_resettable:V.graph3dViewResettable,_zoomable:V.graph3dViewZoomable,_firstPersonMode:V.graph3dViewFirstPersonMode,_mouseRoamable:V.graph3dViewMouseRoamable,_gridVisible:V.graph3dViewGridVisible,_gridSize:V.graph3dViewGridSize,_gridGap:V.graph3dViewGridGap,_gridColor:V.graph3dViewGridColor,_originAxisVisible:V.graph3dViewOriginAxisVisible,_centerAxisVisible:V.graph3dViewCenterAxisVisible,_axisXColor:V.graph3dViewAxisXColor,_axisYColor:V.graph3dViewAxisYColor,_axisZColor:V.graph3dViewAxisZColor,_ortho:V.graph3dViewOrtho,_orthoWidth:V.graph3dViewOrthoWidth,_fovy:V.graph3dViewFovy,_near:V.graph3dViewNear,_far:V.graph3dViewFar,_headlightColor:V.graph3dViewHeadlightColor,_headlightIntensity:V.graph3dViewHeadlightIntensity,_headlightRange:V.graph3dViewHeadlightRange,_headlightDisabled:V.graph3dViewHeadlightDisabled,_rectSelectable:V.graph3dViewRectSelectable,_rectSelectBackground:V.graph3dViewRectSelectBackground,_editSizeColor:V.graph3dViewEditSizeColor,_autoMakeVisible:Bf,_fogDisabled:V.graph3dViewFogDisabled,_fogColor:V.graph3dViewFogColor,_fogNear:V.graph3dViewFogNear,_fogFar:V.graph3dViewFogFar,_dashDisabled:V.graph3dViewDashDisabled,_batchColorDisabled:V.graph3dViewBatchColorDisabled,_batchBlendDisabled:V.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:V.graph3dViewBatchBrightnessDisabled,setEye:function(o,M,V){1===arguments.length&&(M=o[1],V=o[2],o=o[0]);var w=this._eye;w[0]=o,w[1]=M,w[2]=V,this.fp(Gd,G,w)},setCenter:function(w,R,t){1===arguments.length&&(R=w[1],t=w[2],w=w[0]);var B=this._center;B[0]=w,B[1]=R,B[2]=t,this.fp(Ng,G,B)},setUp:function(n,F,_){1===arguments.length&&(F=n[1],_=n[2],n=n[0]);var t=this._up;t[0]=n,t[1]=F,t[2]=_,this.fp("up",G,t)},getDevicePixelRatio:function(){return this._devicePixelRatio||Hd},isTransparentMask:function(T){return T.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getAspect:function(){var z=this,D=z._aspect;return D?D:(D=z.getWidth()/z.getHeight(),D||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(c){var L=this,$=L._dataModel,F=L._selectionModel;$!==c&&($&&($.ump(L.handleDataModelPropertyChange,L),$.umm(L.handleDataModelChange,L),$.umd(L.handleDataPropertyChange,L),F||$.sm().ums(L.handleSelectionChange,L)),L._dataModel=c,c.mp(L.handleDataModelPropertyChange,L),c.mm(L.handleDataModelChange,L),c.md(L.handleDataPropertyChange,L),F?F._21I(c):c.sm().ms(L.handleSelectionChange,L),L._postProcessing.handleDataModleChange($,c),L.invalidateAll(!0),L.invalidateLight(),L.fp(Ob,$,c),L._canvas.style.background=c.getBackground()||"")},handleDataModelPropertyChange:function(j){if("background"===j.property){var Q=this._canvas.style.background,N=j.newValue||"";this._canvas.style.background=N,this.fp("canvasBackground",Q,N)}else"envmap"===j.property&&this.iv()},handleDataPropertyChange:function(r){var e=r.data;this.invalidateData(e),fh(e)&&"s:light.type"===r.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(m){var J=this,j=m.property;J.iv(),J._18Q=G,"eye"===j?J._33Q=!0:"devicePixelRatio"===j?J._42(G,J.getDevicePixelRatio()):Gq[j]&&gm(J)},_5O:function(F){var Q=F._22Q();return Q?new Q(this,F):G},getData3dUI:function(Q){var F=this._25I[Q._id];return F===z&&(F=this._5O(Q),this._25I[Q._id]=F),F},invalidateAll:function(P){var g=this;if(P){for(var E in g._25I){var n=g._25I[E];n&&n.dispose()}g._25I={},g.iv(),Gj(g)}else Gj(g),g.dm().each(function(Y){g.invalidateData(Y)})},invalidateSelection:function(){var F=this;F.sm().each(function(R){F.invalidateData(R)})},invalidateData:function(Z){var _=this,E=_.getData3dUI(Z);E&&(E.iv(),_.iv()),Gj(_,Z)},getShape3dText:function(w){return w.getStyle("shape3d.text")||this.getLabel(w)},invalidateBatch:function(S){var K=this,h=K._batchModelMap,o=h[S],Z=[],N={};if(o){o.ds.forEach(function(N){var X=K.getData3dUI(N);X&&X.iv(),delete K._batchIndexMap[N._id],Z.push(N._id)}),delete h[S];for(var r,A,J,E,i,H,G,O,n,s=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],X=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],m=0;m<s.length;m++){var p=K[s[m]],q=K[X[m]];for(N={},O=0;O<Z.length;O++){var c=q[Z[O]];if(c){delete q[Z[O]],n=c.batch,r=p[n];var I=c.begin,$=c.size,j=3*I,Y=3*$,f=4*I,R=4*$;for(A=r.ds,J=r.vs,E=r.cs,i=r.ps,H=r.ls,G=c.index,r.invalidate=!0,A[G]=z,G=j;j+Y>G;G++)J[G]=z;for(G=f;f+R>G;G++)E[G]=z;for(G=f;f+R>G;G++)i[G]=z;if(H)for(G=j;j+Y>G;G++)H[G]=z;N[n]=!0}}for(n in N){r=p[n],A=r.ds,J=r.vs,E=r.cs,i=r.ps,H=r.ls;var P=[];for(G=0;G<A.length;G++)A[G]!==z&&P.push(A[G]);if(0===P.length)delete p[n];else{for(r.ds=P,P=[],G=0;G<J.length;G++)J[G]!==z&&P.push(J[G]);for(r.vs=P,P=[],G=0;G<E.length;G++)E[G]!==z&&P.push(E[G]);for(r.cs=P,P=[],G=0;G<i.length;G++)i[G]!==z&&P.push(i[G]);if(r.ps=P,H){for(P=[],G=0;G<H.length;G++)H[G]!==z&&P.push(H[G]);r.ls=P}}}}K.iv()}},handleDataModelChange:function(a){var B=this,g=a.kind,z=a.data;if("add"===g)B.invalidateData(z),Zc(z)&&z.getEdgeGroup()&&z.getEdgeGroup().eachSiblingEdge(B.invalidateData,B),fh(z)&&B.invalidateLight();else if(g===fk){var s=z._id,d=B._25I[s];d&&(d.dispose(),delete B._25I[s],B.iv()),z===B._currentSubGraph&&B.setCurrentSubGraph(G),Gj(B,z),fh(z)&&B.invalidateLight()}else g===Bd&&(B.invalidateAll(!0),B.setCurrentSubGraph(G),Gj(B),B.invalidateLight())},toCanvas:function(e,R,X){var i=this,S=i.getGL();if(i.validate(),e){var t=S.getParameter(S.COLOR_CLEAR_VALUE);Sl(S,e)}i._42(G,1);var D=i.getWidth(),J=i.getHeight(),b=new Uint8Array(4*D*J),k=$p(),U=k.getContext("2d");S.readPixels(0,0,D,J,S.RGBA,S.UNSIGNED_BYTE,b),Hp(k,D,J,1);for(var d=U.getImageData(0,0,D,J),Z=d.data,O=0;O<Z.length;O+=4){var o=O/4,P=y(o/D),C=o-P*D;o=4*((J-1-P)*D+C),Z[o]=b[O],Z[o+1]=b[O+1],Z[o+2]=b[O+2],Z[o+3]=b[O+3]}if(U.putImageData(d,0,0),e&&Sl(S,t),i._42(G,i.getDevicePixelRatio()),R&&X){var v=$p(),B=v.getContext("2d");return R=R,X=X,Hp(v,R,X,1),V.drawImage(B,k,0,0,R,X),v}return k},toDataURL:function(J,h){var n=this,S=n.getGL();if(n.validate(),J){var e=S.getParameter(S.COLOR_CLEAR_VALUE);Sl(S,J)}n._42(G,1);var U=n._canvas.toDataURL(h||"image/png",1);return J&&Sl(S,e),n._42(G,n.getDevicePixelRatio()),U},getGL:function(){var K=this,$=K._26I;if(K._prg,!$)try{K._2O={},$=K._26I=K._canvas.getContext("webgl",K._attributes)||K._canvas.getContext("experimental-webgl",K._attributes),$._emptyTexture=ib($),$._emptyBlendTexture=ib($),$._bufPool={},$._id=++zq,K._buffer={vs:Kd($),ns:Kd($),is:Kd($),uv:Kd($),batchColor:Kd($),batchBlend:Kd($),batchBrightness:Kd($),lineDistance:Kd($)},K._1O=Zr($);var t=K._cube={vs:Kd($),ns:Kd($),is:Kd($),uv:Kd($)};di($,t.vs,rm),di($,t.ns,Je),di($,t.uv,Qq),Pl($,t.is,ao)}catch(x){}return K.acquireProgram(),$},acquireProgram:function(){var A=this,c=A._26I;if(c){var L=K.Default.getImage(A.dm().getEnvmap())?!0:!1,Y=A._prg&&A._prg.envMapFlag?!0:!1;if(!A._prg||L!==Y){var J=A._prg=c.createProgram();if(!J)return G;J.envMapFlag=L;var b=A._dirs.length,d=A._spots.length,V=A._59O.length,N=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];b&&N.push("uDirColor","uDirDirection"),d&&N.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),V&&N.push("uPointColor","uPointRange","uPointPosition"),Sl(c,[0,0,0,0]),c.clearDepth(1),c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),c.enable(c.BLEND),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA),Tq||(Ph=Sq(Ph.substring(0,Ph.indexOf("^#"))),Jr=Sq(Jr),Tq=!0);var i=["#define MAX_DIR "+b,"#define MAX_SPOT "+d,"#define MAX_POINT "+V,A._fogDisabled?"":"#define FOG",A._dashDisabled?"":"#define DASH",L?"#define USE_ENVMAP":"",A._batchColorDisabled?"":"#define BATCHCOLOR",A._batchBlendDisabled?"":"#define BATCHBLEND",A._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),O=wn(c,J,c.VERTEX_SHADER,Ph.replace("PREFIX",i));c.getShaderParameter(O,c.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",c.getShaderInfoLog(O));var k=wn(c,J,c.FRAGMENT_SHADER,Jr.replace("PREFIX",i));c.getShaderParameter(k,c.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",c.getShaderInfoLog(k)),u?N.push("aPosition"):(J.aPosition=0,c.bindAttribLocation(J,0,"aPosition")),c.linkProgram(J),N.forEach(function(U){J[U]=/^u/.test(U)?c.getUniformLocation(J,U):c.getAttribLocation(J,U)}),c.useProgram(J),c.deleteShader(O),c.deleteShader(k)}}},getBrightness:function(S){var F=S.s("brightness"),e=this.isSelected(S)?S.s("select.brightness"):G;return F==G?e:e==G?F:F*e},bindEnvMap:function(V){var t=this,f=t._prg,u=5,l=t.dm().getEnvmap(),r=K.Default.getImage(l);if(r){if(l!==t._lastEnvMap){t._envMapTexture&&V.deleteTexture(t._envMapTexture);var R=t._envMapTexture=V.createTexture();V.bindTexture(V.TEXTURE_CUBE_MAP,R),V.texParameteri(V.TEXTURE_CUBE_MAP,V.TEXTURE_MAG_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_CUBE_MAP,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,r),V.bindTexture(V.TEXTURE_CUBE_MAP,null),t._lastEnvMap=l}V.activeTexture(V.TEXTURE0+u),V.bindTexture(V.TEXTURE_CUBE_MAP,t._envMapTexture),V.uniform1i(f.uEnvMap,u)}},getWireframe:function(L){var n=L.s("wf.visible"),A=L.s("wf.width");return n===!0||A>0&&"selected"===n&&this.isSelected(L)?{color:L.s("wf.color"),width:A,"short":L.s("wf.short"),mat:L.s("wf.mat")}:void 0},_transformPointToViewSpace:function(o){var Q=[o[0],o[1],o[2]];return Kb(Q,this._viewMatrix),Q},_transformDirectionToViewSpace:function(R,x){var i=[R[0],R[1],R[2]];Kb(i,this._viewMatrix);var n=x?[x[0],x[1],x[2]]:[0,0,0];Kb(n,this._viewMatrix);var N=n[0]-i[0],G=n[1]-i[1],k=n[2]-i[2],H=Math.sqrt(N*N+G*G+k*k);return H?[N/H,G/H,k/H]:[N,G,k]},getWireframeGeometry:function(y){return y.s("wf.geometry")?{color:y.s("wf.color"),width:y.s("wf.width"),mat:y.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(_){return _.s("body.color")},getMat:function(I){return I.getMat?I.getMat():I.s("mat")},getFaceMat:function(j,y){return j.getFaceMat?j.getFaceMat(y):j.s(y+".mat")},getFaceBlend:function(H,M){return H.s(M+".blend")||H.s("all.blend")},getFaceColor:function(k,O){return k.s(O+".color")||k.s("all.color")},getFaceImage:function(i,C){return i.s(C+".image")||i.s("all.image")},getFaceBlendImage:function(n,m){return n.s(m+".blend.image")||n.s("all.blend.image")},getFaceDiscardSelectable:function(T,J){var _=T.s(J+".discard.selectable");return _==G?T.s("all.discard.selectable"):_},getFaceUv:function(u,_){return u.s(_+".uv")||u.s("all.uv")},getFaceUvOffset:function(n,C){return n.s(C+".uv.offset")||n.s("all.uv.offset")},getFaceUvScale:function(k,I){return k.s(I+".uv.scale")||k.s("all.uv.scale")},getFaceLight:function(_,F){var Z=_.s(F+".light");return Z==G?_.s("all.light"):Z},getFaceVisible:function(V,H){var a=V.s(H+".visible");return a==G?V.s("all.visible"):a},getFaceOpacity:function(k,e){var W=k.s(e+".opacity");return W==G?k.s("all.opacity"):W},getFaceTransparent:function(A,s){var v=A.s(s+".transparent");return v==G?A.s("all.transparent"):v},getFaceReverseColor:function(l,C){return l.s(C+".reverse.color")||l.s("all.reverse.color")},getFaceReverseFlip:function(w,A){var $=w.s(A+".reverse.flip");return $==G?w.s("all.reverse.flip"):$},getFaceReverseCull:function(p,j){var U=p.s(j+".reverse.cull");return U==G?p.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function(W){var q=this,M=q._2O[W];M&&(delete q._2O[W],q.getGL().deleteTexture(M))},invalidateShape3dCachedImage:function(S){var E=this.getData3dUI(S);E.invalidateCachedTexture(this.getGL())},isInteractive:function(g){return g.s("interactive")},getTexture:function(y,U){if(!y)return G;var d=this,Q=d.getGL(),A=d._2O[y];if(!A){var O=tn(y);if(O)if(O.tagName){if(O.dynamic)return Zr(Q,O,d._1O);A=d._2O[y]=Zr(Q,O)}else{var n,p=U&&U.s("shape3d.image.cache")&&!d.isInteractive(U),K=d.vr.isPresenting();K&&(U._textureUpdateFrame===Q._renderInfo.frame?p=!0:U._textureUpdateFrame=Q._renderInfo.frame),p&&(n=d.getData3dUI(U),A=n.getCachedTexture());var H;if(!A){var l=U&&U.s("shape3d.fixSizeOnScreen"),V=l?Q.NEAREST:Q.LINEAR;l||U&&U.s("shape3d.vector.dynamic")&&(n||(n=d.getData3dUI(U)),l=n.getVectorDynamicSize(),l&&(H=d.getDevicePixelRatio(),l[0]*=H,l[1]*=H));var g,w,x=U&&U.s("shape3d.texture.scale")||1;if(l?(H||(H=d.getDevicePixelRatio()),g=l[0]>0?l[0]:x*dq(O,U)*H,w=l[1]>0?l[1]:x*Am(O,U)*H):(g=x*dq(O,U),w=x*Am(O,U)),g>=1&&w>=1){var t=Iq(g,w);if(!n&&U&&(n=d.getData3dUI(U)),n&&n.interactiveInfo){var m=n.interactiveInfo[y]={};t.interactiveInfo=m.bodyInfo={compInfos:[],matrix:new gb,rect:{x:0,y:0,width:g,height:w}}}Ar(t,O,0,0,g,w,U,d),t.interactiveInfo&&(t.interactiveInfo=null),t.restore(),(p||K)&&Se(O,U)?(A=Zr(Q,Lf,null,V),n.setCachedTexture(A),Lf=null):A=Zr(Q,Lf,d._1O,V)}}}}return A},redraw:function(){this.iv()},validateImpl:function(){var y=this;if(y._lightChanged){y._lightChanged=!1;var W=[],B=[],L=[];y.dm().each(function(V){if(fh(V)){var P=V.s("light.type");P===bc?W.push(V):P===Bq?B.push(V):P===Gp&&L.push(V)}}),(W.length!==y._59O.length||B.length!==y._spots.length||L.length!==y._dirs.length)&&gm(y),y._59O=W,y._spots=B,y._dirs=L}y._42(),y._1o.iv()},getRenderInfo:function(){var d=this.getGL();return d?d._renderInfo:void 0},showDebugTip:function(){var B=this,d=B._debugDiv;if(!d){d=B._debugDiv=I.createElement("div"),d.style.position="absolute",d.style.overflow="hidden",d.style.backgroundColor="white",d.style.color="black";var j=B.getView();B._79O?j.insertBefore(d,B._79O):j.appendChild(d),B._debugTipTimerId=setInterval(function(){var J=B.getRenderInfo();if(J){var e=B.getGL()._validBufCount||0,C="Draw Calls: "+J.calls+"<br/>"+"Vertices: "+J.vertices+"<br/>"+"Faces: "+J.faces+"<br/>"+"Lines: "+J.lines+"<br/>"+"Buffer Count: "+e;d.innerHTML=C}},10)}},hideDebugTip:function(){var p=this,N=p._debugDiv;N&&(delete p._debugDiv,cancelAnimationFrame(p._debugTipTimerId),delete p._debugTipTimerId,p.getView().removeChild(N))},_42:function(J,d){var f=this;if(!f._35O&&(!Ec||Em(Ec))){var s,p;J&&(J instanceof hi?p=J:s=J);var x=f._canvas,$=f.getGL(),w=f._prg;if($){var m=f.getWidth(),I=f.getHeight();d?J||Hp(x,m,I,d):(d=f.getDevicePixelRatio(),J||m===x.clientWidth&&I===x.clientHeight||Hp(x,m,I,d)),$.clear($.COLOR_BUFFER_BIT),$._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:J?f._frameId:++f._frameId};var M=function(){if(f.overlappingBox.clear(),f._81O=G,$.clear($.DEPTH_BUFFER_BIT),Zl($,w.uBrightness,1),Zl($,w.uOpacity,1),Zl($,w.uPartOpacity,1),$._picking=!!J,Zl($,w.uPick,!!J),Zl($,w.uTexture,!1),Zl($,w.uBlendTexture,!1),Zl($,w.uAlphaTest,r.alphaTest),Zl($,w.uTransparent,!1),Zl($,w.uFix,!1),Zl($,w.uBatchColor,!1),Zl($,w.uBatchBlend,!1),Zl($,w.uBatchBrightness,!1),Zl($,w.uReflectivity,f._envmapReflectivity||.5),Zl($,w.uCameraPosition,f.getEye()),Zl($,w.uPMatrix,f._projectMatrix=yo(f)),Zl($,w.uViewMatrix,Fl(f,f._7O)),f.bindEnvMap($),f._viewMatrix=Ve(f._7O),J||($i(f,$,w),f._fogDisabled||(Zl($,w.uFogColor,f._fogColor),Zl($,w.uFogNear,f._fogNear),Zl($,w.uFogFar,f._fogFar))),Mn($,w.aPosition),Mn($,w.aNormal),Qj($,w.aUv),Qj($,w.aBatchColor),Qj($,w.aBatchBlend),Qj($,w.aBatchBrightness),Qj($,w.aLineDistance),p){var Z=$.getParameter($.COLOR_CLEAR_VALUE);$.clearColor(0,0,0,0),$.disable($.BLEND),Qj($,w.aNormal),di($,f._cube.vs,G,w.aPosition),Pl($,f._cube.is),Jj(p,f,kh,0),Jj(p,f,Gb,6),Jj(p,f,tq,12),Jj(p,f,Cb,18),Jj(p,f,Wj,24),Jj(p,f,Eh,30),Mn($,w.aNormal),Sl($,Z)}else if(s){s.value=2;var Z=$.getParameter($.COLOR_CLEAR_VALUE);$.clearColor(0,0,0,0),$.disable($.BLEND),f._95I($,w,s),ul(f,s),Mi(f,f._polylineModelMap,s),Mi(f,f._wireframeModelMap,s),Zl($,w.uTransparent,!0),f._95I($,w,s,!0),ul(f,s,!0),Mi(f,f._polylineModelMap,s,!0),Mi(f,f._wireframeModelMap,s,!0),Zl($,w.uTransparent,!1),$.clear($.DEPTH_BUFFER_BIT),f._swapLineMap(),f._95I($,w,s,!1,!0),Mi(f,f._polylineModelMap,s),Mi(f,f._wireframeModelMap,s),f._swapLineMap(),$.disable($.DEPTH_TEST),f.drawFilter||f._30O._42($,w,s),$.enable($.DEPTH_TEST),Sl($,Z)}else $.disable($.BLEND),f.drawSky($,w),f._31O._42($,w),f._95I($,w),ul(f),Mi(f,f._polylineModelMap),Mi(f,f._wireframeModelMap),$.enable($.BLEND),Zl($,w.uTransparent,!0),$.depthMask(!1),f._95I($,w,G,!0),ul(f,G,!0),Mi(f,f._polylineModelMap,G,!0),Mi(f,f._wireframeModelMap,G,!0),$.depthMask(!0),Zl($,w.uTransparent,!1),$.clear($.DEPTH_BUFFER_BIT),f._swapLineMap(),f._95I($,w,G,!1,!0),Mi(f,f._polylineModelMap),Mi(f,f._wireframeModelMap),f._swapLineMap(),$.disable($.DEPTH_TEST),$.disable($.BLEND),f._32O._42($,w),f._30O._42($,w),f._highlightHelper._42($,w),$.enable($.DEPTH_TEST);di($,G),Pl($,G)},C=!1,Y=m*d,u=I*d,R=f.vr;R.enable&&R._42($,Y,u,M)&&(C=!0);var _=f.envRenderer;_&&_.enable&&_._42($,Y,u,M)&&(C=!0);var F=f._postProcessing;F._42($,Y,u,M,J)&&(C=!0),C||(f.setViewport($,0,0,m*d,I*d),M()),f._33Q=!1,f._doBufferGC($)}}},enablePostProcessing:function(t,Z){return this._postProcessing.enableModule(t,Z)},getPostProcessingModule:function(S){return this._postProcessing.getModule(S)},setViewport:function(A,Z,N,Y,x){this._viewport=[Z,N,Y,x],A.viewport(Z,N,Y,x)},getViewport:function(){return this._viewport},setBufferGCInterval:function(m){this._bufferGCInterval=m},_doBufferGC:function(w,X){var J,n,i=w._bufPool,d=0,C=0,K=w._renderInfo.frame,h=this._bufferGCInterval||10;for(J in i)d++,n=i[J],n&&(X||K-n._fid>h?(w.deleteBuffer(n._buf),n._buf=null,i[J]=null):C++);if(d/2>C&&d>128){var q={};for(J in i)i[J]&&(q[J]=i[J]);w._bufPool=q}w._validBufCount=C},_swapLineMap:function(){var L=this;T=L._polylineModelMap,L._polylineModelMap=L._polylineModelMapSwap,L._polylineModelMapSwap=T,T=L._wireframeModelMap,L._wireframeModelMap=L._wireframeModelMapSwap,L._wireframeModelMapSwap=T,T=L._polylineIndexMap,L._polylineIndexMap=L._polylineIndexMapSwap,L._polylineIndexMapSwap=T,T=L._wireframeIndexMap,L._wireframeIndexMap=L._wireframeIndexMapSwap,L._wireframeIndexMapSwap=T},_updateSkyBoxPosition:function(i){if(this._skyBox&&i&&"eye"===i.property){var A=i.newValue;this._skyBox.p3(A[0],A[1],A[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(h){var R=this._skyBox;R&&this._skyBoxStyleMap&&(R.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null),this._skyBox=h,this.ump(this._updateSkyBoxPosition,this),h&&(h.dm()&&h.dm().remove(h),this._skyBoxStyleMap=K.Default.clone(h.getStyleMap()),h.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition({property:"eye",newValue:this.getEye()})),this.fp("skyBox",R,h)},drawSky:function(y,Z,P){var X=this,n=X._skyBox;if(n){var K=X._headlightIntensity,h=So(X._headlightColor),Z=X._prg;1!==K&&(h=[h[0]*K,h[1]*K,h[2]*K]),Zl(y,Z.uHeadlightColor,[h[0],h[1],h[2],1]);var Y=X.getData3dUI(n);Y&&Y._42(y,Z,P,function(){return!0}),y.clear(y.DEPTH_BUFFER_BIT),Zl(y,Z.uHeadlightColor,[h[0],h[1],h[2],X._headlightDisabled?1:0])}},_95I:function(S,P,B,p,e){function E(d){if(!!d.s("shape3d.alwaysOnTop")==!!e&&_.isVisible(d)&&(!J||n)){if(!B&&_.isTransparentMask(d))return;var N=_.getData3dUI(d);N&&N._42(S,P,B,g)}}var _=this,g=function(V){return p?V:!V};_.sky&&S.clear(S.DEPTH_BUFFER_BIT);var f=_.drawFilter;f?_.dm().each(function(D){f(D)||E(D)}):_.dm().each(function(u){E(u)})},getLogicalPoint:function(D){return ch(D,this._canvas)},isRectOverlapping:function(w){var M=this.getData3dUI(w);return M._rectOverlapping},getHitFaceInfo:function(X){X.target&&(X=this.lp(X));var n=this.getDataInfoAt(X);if(n){var P=this._1o.face(n.data,jd(X.x,X.y));if(P)return{data:n.data,face:P}}return G},unproject:function(e,F){var m=this,V=m.getWidth(),g=m.getHeight(),k=e.target?m.lp(e):e,p=k.x-V/2,J=k.y-g/2,E=2*(p/V),W=2*(-1*J/g);F=F||0;var o=Qh(),R=yo(m),D=Fl(m);cr(o,R,D),dn(o);var A=Ci([E,W,F,1],o);return[A[0]/A[3],A[1]/A[3],A[2]/A[3]]},getDataAt:function(T){var r=this.getDataInfoAt(T);return r?r.data:G},getDataInfoAt:function(T,P){return T.target&&(T=this.lp(T)),this._1o.get(jd(T.x,T.y,P),!0)},getDatasInRect:function(C){return this._1o.get(C)},setEditable:function(N){var H=this,O=H._editable;H._editable=N,this.fp(zb,O,N)},isEditable:function(G){var b=this;return b._editable?gp(G)?G.s("3d.editable")?b._editableFunc?b._editableFunc(G):!0:!1:!1:!1},isSelectable:function(z){return z.s("3d.selectable")&&this.sm().isSelectable(z)},isMovable:function(I){var N=this;return Zc(I)&&I.getStyle(Oe)!==Wp?!1:I.s("3d.movable")?N._movableFunc?N._movableFunc(I):!0:!1},isSizeEditable:function(G){return gp(G)?this._sizeEditableFunc?this._sizeEditableFunc(G):!0:!1},isRotationEditable:function(c){return gp(c)&&c.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(c):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(z){this.setZoom(yd,z)},zoomOut:function(w){this.setZoom(1/yd,w)},setZoom:function(X,j){if(1!==X){var $=this;if($._ortho)return $.setOrthoZoom(X,j),void 0;$._14o&&$._14o.stop(!0);var b=1/X,S=$._eye,i=$._center,C=i[0]+(S[0]-i[0])*b-S[0],Q=i[1]+(S[1]-i[1])*b-S[1],e=i[2]+(S[2]-i[2])*b-S[2];if(!(Li(S,i)<$._moveStep&&1>b)){if(j=Jm(j)){var x=Cn(S);return j.action=function(m){$.fi({kind:$._zooming?"betweenZoom":"beginZoom"}),$._zooming=1,S[0]=x[0]+C*m,S[1]=x[1]+Q*m,S[2]=x[2]+e*m,$.fp(Gd,G,S)},j._37o=function(){delete $._14o,delete $._zooming,$.fi({kind:"endZoom"}),$.onZoomEnded()},$._14o=Gg(j)}S[0]+=C,S[1]+=Q,S[2]+=e,$.fp(Gd,G,S)}}},setOrthoZoom:function(G,q){if(1!==G){var M=this;M._14o&&M._14o.stop(!0);var O=M._orthoWidth,S=O/G-O;if(!(O<M._moveStep&&G>1))return(q=Jm(q))?(q.action=function(z){M.fi({kind:M._zooming?"betweenZoom":"beginZoom"}),M._zooming=1,M.setOrthoWidth(O+S*z)},q._37o=function(){delete M._14o,delete M._zooming,M.fi({kind:"endZoom"}),M.onZoomEnded()},M._14o=Gg(q)):(M.setOrthoWidth(O/G),void 0)}},getPositionInfo:function(C){var G=this,X=G._eye,J=G._center,q=G.getAspect(),Q=C?Ao(bd(J,X,!0),bd(C,X)):Li(X,J);if(G._ortho){var n=G._orthoWidth;return{length:Q,height:n/q,width:n}}var f=2*g(G._fovy/2)*Q;return{length:Q,height:f,width:f*q}},getCenterInfo:function(){var F=this;return F._81O||(F._81O=F.getPositionInfo()),Cn(F._81O)},rotate:function(B,t,D,C){var R=this;if(B||t){C==G&&(C=R._firstPersonMode),R._88O&&R._88O.stop(!0);var a=R._center,N=R._eye,h=R.getCenterInfo().length,O=C?a:N,_=C?N:a,Y=bd(O,_),d=x(Y[0],Y[2]),A=x(H(Y[0]*Y[0]+Y[2]*Y[2]),Y[1]),I=C?Ng:Gd;return C&&(t=-t),(D=Jm(D))?(D.action=function(o){R.fi({kind:R._rotating?"betweenRotate":"beginRotate"}),R._rotating=1;var k=d+B*o,E=A+t*o;E=co(E),Y[0]=h*s(E)*s(k),Y[1]=h*F(E),Y[2]=h*s(E)*F(k),O[0]=_[0]+Y[0],O[1]=_[1]+Y[1],O[2]=_[2]+Y[2],R.fp(I,G,O)},D._37o=function(){delete R._88O,delete R._rotating,R.fi({kind:"endRotate"}),R.onRotateEnded()},R._88O=Gg(D)):(d+=B,A+=t,A=co(A),Y[0]=h*s(A)*s(d),Y[1]=h*F(A),Y[2]=h*s(A)*F(d),O[0]=_[0]+Y[0],O[1]=_[1]+Y[1],O[2]=_[2]+Y[2],R.fp(I,G,O),void 0)}},pan:function(x,l,v,a){if(x||l){var o=this;a==G&&(a=o._firstPersonMode),o._89O&&o._89O.stop(!0);var e=Fl(o),I=[e[0]*x,e[4]*x,e[8]*x],r=[e[1]*l,e[5]*l,e[9]*l],w=I[0]+r[0],n=I[1]+r[1],s=I[2]+r[2],Z=o._center,T=o._eye;if(a){var U=Mb(o.getBoundaries(),T[0],T[2],T[0]+w,T[2]+s,H(w*w+s*s));w=U[0],s=U[1]}if(v=Jm(v)){var O=Cn(T),i=Cn(Z);return v.action=function(y){o.fi({kind:o._panning?"betweenPan":"beginPan"}),o._panning=1,Z[0]=i[0]+w*y,Z[1]=i[1]+n*y,Z[2]=i[2]+s*y,T[0]=O[0]+w*y,T[1]=O[1]+n*y,T[2]=O[2]+s*y,o.fp(Gd,G,T),o.fp(Ng,G,Z)},v._37o=function(){delete o._89O,delete o._panning,o.fi({kind:"endPan"}),o.onPanEnded()},o._89O=Gg(v)}Z[0]+=w,Z[1]+=n,Z[2]+=s,T[0]+=w,T[1]+=n,T[2]+=s,o.fp(Gd,G,T),o.fp(Ng,G,Z)}},walk:function(r,A,V){if(r){var $=this;V==G&&(V=$._firstPersonMode),$._90O&&$._90O.stop(!0);var u=$._center,y=$._eye,N=bd(u,y,!0);if(V){var o=Mb($.getBoundaries(),y[0],y[2],y[0]+N[0]*r,y[2]+N[2]*r,D(r));if(r=Li(o),!r)return;N=[o[0]/r,0,o[1]/r]}if(A=Jm(A)){var B=Cn(y),F=Cn(u);return A.action=function(U){$.fi({kind:$._walking?"betweenWalk":"beginWalk"}),$._walking=1;var l=r*U;y[0]=B[0]+N[0]*l,y[1]=B[1]+N[1]*l,y[2]=B[2]+N[2]*l,u[0]=F[0]+N[0]*l,u[1]=F[1]+N[1]*l,u[2]=F[2]+N[2]*l,$.fp(Gd,G,y),$.fp(Ng,G,u)},A._37o=function(){delete $._90O,delete $._walking,$.fi({kind:"endWalk"}),$.onWalkEnded()},$._90O=Gg(A)}y[0]+=N[0]*r,y[1]+=N[1]*r,y[2]+=N[2]*r,u[0]+=N[0]*r,u[1]+=N[1]*r,u[2]+=N[2]*r,$.fp(Gd,G,y),$.fp(Ng,G,u)}},handleScroll:function(t,O){t.preventDefault();var J=this,p=J._moveStep;J.isFirstPersonMode()?J.isPannable()&&J.pan(0,O>0?p:-p):J.isZoomable()&&J.setZoom(0>O?1/eh:eh)},handlePinch:function(s,$){this.isZoomable()&&this.setZoom($>s?1/si:si)},reset:function(){this.setCenter(V.graph3dViewCenter),this.setEye(V.graph3dViewEye),this.setUp(V.graph3dViewUp)},moveSelection:function(o,n,F){var y=this;y.dm().beginTransaction(),Wc(this.sm().toSelection(this.isMovable,this),o,n,F),y.dm().endTransaction()},getMoveMode:function(i,H){var Z=H.s("3d.move.mode");if(Z)return Z;var a="88",V="89",h="90";return lm(i)||Yr[a]&&Yr[V]&&Yr[h]?"xyz":Yr[a]&&Yr[V]?"xy":Yr[a]&&Yr[h]?"xz":Yr[V]&&Yr[h]?"yz":Yr[a]?"x":Yr[V]?"y":Yr[h]?"z":"xz"},handleTick:function(){var h=this,$=!1,d=h._moveStep,z=d,V=!1,g=!0,J=h._rotateStep*(g?-1:1);if(h.isWalkable()||(z=0),h.isPannable()||(d=0),h.isRotatable()||(J=0),h._32Q){var W=(Un()-h._32Q)/50;z*=W,d*=W,J*=W}h._31Q&&(En(h._31Q),delete h._31Q,delete h._32Q),ih()&&($=!0,h.pan(-d,0,V,g)),qo()&&($=!0,h.pan(d,0,V,g)),Df()&&($=!0,lm()?h.pan(0,d,V,g):h.walk(z,V,g)),ap()&&($=!0,lm()?h.pan(0,-d,V,g):h.walk(-z,V,g)),Ko()&&($=!0,h.rotate(-J,0,V,g)),Wr()&&($=!0,h.rotate(J,0,V,g)),_g()&&($=!0,h.rotate(0,-J/2,V,g)),pg()&&($=!0,h.rotate(0,J/2,V,g)),$&&(h._32Q=Un(),h._31Q=ln(h.handleTick,h))},handleKeyDown:function(t){var y=this;!Rj(t)&&tk[t.keyCode]?y.handleTick():xr(t)?y.selectAll():ui(t)?y.handleDelete(t):Ni(t)&&this.isResettable()&&y.reset()},checkDoubleClickOnNote:function($,z,Q){var T=this;if(Q===qs){if(z.s("note.toggleable"))return z.s(pk,!z.s(pk)),T.fi({kind:"toggleNote",event:$,data:z,part:Q}),!0}else if(Q===Kn&&z.s("note2.toggleable"))return z.s(hk,!z.s(hk)),T.fi({kind:"toggleNote2",event:$,data:z,part:Q}),!0;return!1},checkDoubleClickOnRotation:function(J,Y,n){return n===Dm?(Y.setRotationX(0),!0):n===yb?(Y.setRotationY(0),!0):n===mq?(Y.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(u){var c=this;if(c.isOrtho())return c.getWidth()/c.getOrthoWidth();var t=c.getCenter(),N=c.getHeight(),K=c.getEye(),f=[t[0]-K[0],t[1]-K[1],t[2]-K[2]],h=[u[0]-K[0],u[1]-K[1],u[2]-K[2]],i=Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]),p=1/Math.tan(c.getFovy()/2);return N*i*p/(h[0]*f[0]+h[1]*f[1]+h[2]*f[2])},inViewSpace:function(v){var A,l=this,F=l._transformPointToViewSpace(v),t=l.getAspect(),f=l.getNear(),g=l.getFar();return-F[2]<f||-F[2]>g?!1:l.isOrtho()?(A=l.getOrthoWidth()/2,Math.abs(F[0])<=A&&Math.abs(F[1]*t)<=A):(A=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2])*Math.tan(l.getFovy()/2),Math.abs(F[1]<=A)&&Math.abs(F[0])<=A*t)},toViewPosition:function(U){var w=this,i=w.getWidth()/2,h=w.getHeight()/2,r=w._18Q;return r&&r._wh===i/h||(r=yo(w),w._18Q=cr(r,r,Fl(w)),w._18Q._wh=i/h),U=Ci([U[0],U[1],U[2],1],r),{x:i+i*U[0]/U[3],y:h-h*U[1]/U[3]}},getHitPosition:function(N,u,M){var _=this,Z=_.getWidth(),A=_.getHeight(),l=N.target?_.lp(N):N,V=l.x-Z/2,g=l.y-A/2,z=_.getCenterInfo(),i=Fl(_);u=u?u:[0,0,0],M=M?M:[0,1,0],V=V/Z*z.width,g=-1*g/A*z.height;var s=[i[0]*V,i[4]*V,i[8]*V],X=[i[1]*g,i[5]*g,i[9]*g],H=[s[0]+X[0],s[1]+X[1],s[2]+X[2]],G=_.getCenter(),I=Ff(_,u,M,[H[0]+G[0],H[1]+G[1],H[2]+G[2]]);return I?I:[0,0,0]},intersectObject:function(m,x){return this._raycaster.intersectObject(m,x)},intersectObjects:function(f,P,d){return this._raycaster.intersectObjects(f,P,d)},getLineLength:function(Y){this.validate();var W=this.getData3dUI(Y);if(W&&W.getCache){var M=W.getCache();if(M)return M[M.length-1].length}return 0},getLineOffset:function(L,r){var _=this.getData3dUI(L);if(_&&_.getCache){var N=_.getCache();if(N)return Ir(N,r)}return G},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function m($,c,f){if(f instanceof K.Node){X.fromArray(Tr(f,c.getMat(f)));var V=f.getAnchor3d();$.push((new cl).set(0-V.x,0-V.y,0-V.z).applyMatrix4(X)),$.push((new cl).set(0-V.x,0-V.y,1-V.z).applyMatrix4(X)),$.push((new cl).set(0-V.x,1-V.y,0-V.z).applyMatrix4(X)),$.push((new cl).set(0-V.x,1-V.y,1-V.z).applyMatrix4(X)),$.push((new cl).set(1-V.x,0-V.y,0-V.z).applyMatrix4(X)),$.push((new cl).set(1-V.x,0-V.y,1-V.z).applyMatrix4(X)),$.push((new cl).set(1-V.x,1-V.y,0-V.z).applyMatrix4(X)),$.push((new cl).set(1-V.x,1-V.y,1-V.z).applyMatrix4(X))}}var C=new cl,o=new cl,d=new cl,I=new cl,X=new vl,P=new K.Math.Quaternion,B=new vh;return function(J,p,q){var V=this;if(q!==z)p={animation:p,ratio:q};else{var S=typeof p;("boolean"===S||"object"===S&&p.duration)&&(p={animation:p})}p=p||{},C.fromArray(V.getEye()),o.fromArray(V.getCenter());var Q,N,b=[],$=p.center,g=p.distance===z;if($&&d.fromArray($),J instanceof K.Node)$||d.fromArray(J.p3()),g&&(m(b,V,J),Q=b.length);else{if(J||(J=V.dm().getDatas()),!J.length)return;if((g||!$)&&(b=[],J.forEach(function(x){m(b,V,x)}),Q=b.length),!Q)return;if(!$){for(d.set(0,0,0),N=0;Q>N;N++)d.add(b[N]);d.multiplyScalar(1/Q)}}if(V.setCenter(d.x,d.y,d.z),I.subVectors(C,o),p.direction||p.worldDirection){!p.worldDirection&&J instanceof K.Node?P.setFromEuler(B.set(J.r3(),J.getRotationMode(),!0)):P.set(0,0,0,1);var v=I.length();I.fromArray(p.worldDirection||p.direction).applyQuaternion(P).setLength(v)}if(g){for(var f,Z,w,M,R,G=V.getNear(),H=10,q=p.ratio||.8;H--;){for(V._eye[0]=I.x+d.x,V._eye[1]=I.y+d.y,V._eye[2]=I.z+d.z,f=yo(V),cr(f,f,Fl(V)),M=!0,R=-1/0,N=0;Q>N;N++){if(w=b[N],Z=Ci([w.x,w.y,w.z,1],f),Z[3]<G&&H){I.multiplyScalar(2),M=!1;break}R=Math.max(R,Math.max(Math.abs(Z[0]),Math.abs(Z[1]))/q-Z[3])}if(M)break}I.setLength(R+I.length()).add(d)
}else I.setLength(p.distance).add(d);V._flyAnim&&V._flyAnim.stop(!0);var t=Jm(p.animation);if(t){V.setEye(C.x,C.y,C.z),V.setCenter(o.x,o.y,o.z);var y=(new cl).subVectors(I,C),T=(new cl).subVectors(d,o),r=new cl,X=new cl;return t.action=function(A){r.copy(C).addScaledVector(y,A),X.copy(o).addScaledVector(T,A),V.setCenter(X.x,X.y,X.z),V.setEye(r.x,r.y,r.z)},t._37o=function(){delete V._flyAnim},{lastEye:C,lastCenter:o,eye:I,center:d,animation:V._flyAnim=Gg(t)}}return V.setEye(I.x,I.y,I.z),{lastEye:C,lastCenter:o,eye:I,center:d}}}(),getBoundingBox:function(){function o(Y,r,Q){M.fromArray(Tr(Q,r.getMat(Q)));var h=Q.getAnchor3d();Y.push((new cl).set(0-h.x,0-h.y,0-h.z).applyMatrix4(M)),Y.push((new cl).set(0-h.x,0-h.y,1-h.z).applyMatrix4(M)),Y.push((new cl).set(0-h.x,1-h.y,0-h.z).applyMatrix4(M)),Y.push((new cl).set(0-h.x,1-h.y,1-h.z).applyMatrix4(M)),Y.push((new cl).set(1-h.x,0-h.y,0-h.z).applyMatrix4(M)),Y.push((new cl).set(1-h.x,0-h.y,1-h.z).applyMatrix4(M)),Y.push((new cl).set(1-h.x,1-h.y,0-h.z).applyMatrix4(M)),Y.push((new cl).set(1-h.x,1-h.y,1-h.z).applyMatrix4(M))}var M=new vl;return function(u){if(u=u||this.sm().getSelection(),u instanceof K.Node&&(u=[u]),0===u.length)return G;var p=[];u.forEach(function(B){o(p,this,B)},this);var f=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];return p.forEach(function(O){f[0]=Math.min(O.x,f[0]),f[1]=Math.min(O.y,f[1]),f[2]=Math.min(O.z,f[2]),s[0]=Math.max(O.x,s[0]),s[1]=Math.max(O.y,s[1]),s[2]=Math.max(O.z,s[2])}),{min:f,max:s}}}()}),Ak.RenderEnv=function(C){this.gv=C,this.enable=!1},m.defineProperties(Ak.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(p){this._debugOn=p,this.capture&&this.capture()}}}),m.assign(Ak.RenderEnv.prototype,{renderEnvToCube:function(k,M,B,X){var N=this,r=N.gv;if(!k||!M||!B)return N.enable=!1,N._42=null,void 0;N.enable=!0;var s=Math.floor(X/k*M),d=r.getGL(),V=N._renderTargets;V?V.length<B&&(V=N._renderTargets=V.concat(new Array(B-V.length))):V=N._renderTargets=new Array(B);for(var u=0;B>u;u++)V[u]?V[u].setSize(d,X,s):V[u]=new Ak.RenderTarget(r,d,X,s);var C=!1;N.capture=function(){C=!0,r._42(),C=!1};var a=new cl,n=new cl,I=new cl,c=new cl,g=(new cl).setY(0),o=2*Math.PI/B,J=k/2/Math.tan(Math.PI/B),x=2*Math.atan2(M/2,J),Y=k/M;N._42=function(A,s,f,t){var H=N._debugOn;if(!C&&!H)return!1;a.copy(r.getEye()),c.copy(r.getCenter()).sub(a);var u=Math.atan2(c.z,c.x),$=r.getNear(),y=r.getFovy(),F=r.getAspect();n.copy(r.getCenter());for(var i,w=0;B>w;w++)if(i=V[w],g.setZ(Math.cos(u)).setX(Math.sin(u)).multiplyScalar(J),u-=o,I.addVectors(a,g),r.setNear(J),r.setCenter([I.x,I.y,I.z]),r.setFovy(x),r.setAspect(Y),H){var K=Math.round(s/B);A.viewport(K*w,0,K,f),t()}else Ji(A,i.frame),A.viewport(0,0,i.width,i.height),A.clear(A.COLOR_BUFFER_BIT),t(),Ji(A,G),i.assureTexture();return r.setNear($),r.setCenter([n.x,n.y,n.z]),r.setFovy(y),r.setAspect(F),!0},N.capture()},getTextureInfo:function(Y){var C=this._renderTargets;if(!C)return null;var l=this._renderTargets[Y];return l?{index:Y,texture:l.texture,textureName:l.uuid}:null}}),m.assign(Ak.Graph3dView.prototype,{renderEnvToCube:function(D,l,m,e){var y=this;y.envRenderer||(y.envRenderer=new Ak.RenderEnv(y)),y.envRenderer.renderEnvToCube(D,l,m,e)}}),Ak.RenderTarget=function(y,q,P,n,e){var C=this;e=e||{},C.uuid=K.Math.generateUUID(),C.gv=y,C.init(y,q,e),C.setSize(q,P,n)},m.assign(Ak.RenderTarget.prototype,{init:function(G,e,p){var S=this,u=S.texture=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,p.minFilter||e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,p.magFilter||e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),S.render=e.createRenderbuffer(),S.frame=e.createFramebuffer(),G._2O[S.uuid]=u},assureTexture:function(){var q=this,u=q.uuid,e=q.gv._2O;e[u]||(e[u]=q.texture)},setSize:function(i,k,U){var p=this;if(p.width!==k||p.height!==U){var $=i.RGBA,t=i.TEXTURE_2D,H=i.RENDERBUFFER,Q=i.FRAMEBUFFER;Me(i,p.texture),i.texImage2D(t,0,$,k,U,0,$,i.UNSIGNED_BYTE,G),i.bindRenderbuffer(H,p.render),i.renderbufferStorage(H,i.DEPTH_COMPONENT16,k,U),Ji(i,p.frame),i.framebufferTexture2D(Q,i.COLOR_ATTACHMENT0,t,p.texture,0),i.framebufferRenderbuffer(Q,i.DEPTH_ATTACHMENT,H,p.render),Me(i,G),i.bindRenderbuffer(H,G),Ji(i,G),p.width=k,p.height=U}},toCanvas:function(){var R=this,K=R.gv.getGL();K.bindFramebuffer(K.FRAMEBUFFER,R.frame);var P=R.width,Q=R.height,S=new Uint8Array(4*P*Q);K.readPixels(0,0,P,Q,K.RGBA,K.UNSIGNED_BYTE,S),K.bindFramebuffer(K.FRAMEBUFFER,null);var k=I.createElement("canvas");k.width=P,k.height=Q;var A=k.getContext("2d"),o=A.createImageData(P,Q);return o.data.set(S),A.putImageData(o,0,0),k}});var _n=Ak.Interactor=function(z){this.gv=z};jj("Interactor",m,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var xe=Ak.DefaultInteractor=function(J){Dr(xe,this,[J])};jj("DefaultInteractor",_n,{handle_contextmenu:function(f){Jd(f)},handle_mousewheel:function(e){this.gv.handleScroll(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(e){2===e.axis&&this.gv.handleScroll(e,-e.detail)},handle_keydown:function(z){this.gv.handleKeyDown(z)},handle_mousedown:function(t){this.handle_touchstart(t)},handle_touchstart:function(Q){Jd(Q);var A=this,J=A.gv,h=Tl(Q),l=J.getDataInfoAt(Q),r=l?l.data:G,O=l?l.part:G,c=J.sm(),I=Xn(Q),m=tl(Q);J.setFocus(Q)&&(A._62O=G,A._57I=G,r?Rj(Q)?c.co(r)?c.rs(r):c.as(r):c.co(r)||c.ss(r):h&&(Rj(Q)?J.isRectSelectable()&&(A._62O=ks):A._57I=Ac(Q)),A._31Q&&(En(A._31Q),delete A._31Q,delete A._32Q),A._62O||(J.isFirstPersonMode()&&(lm(Q)||m>2?A._62O="pan":J.isMouseRoamable()||Ai?(A._62O="roaming",A.foward=I&&Tl(Q),A._32Q=Un(),A._31Q=ln(A.tick,A)):h||(A._62O="roaming")),A._62O||(h&&I&&lf[O]?(A._62O=O,A.p3=r.p3()):h&&I&&gp(r)&&J.isSelected(r)?J.isMovable(r)?(A._62O="move",A.p3=r.p3(),A.movedata=r):J.isInteractive(r)&&(A._62O="none"):Ai&&(m>2?A._62O="pan":2===m&&(A.dist=Zg(Q),A._62O="pinch")))),A.point=J.lp(Q),Hl(A,Q),Rc(Q)?J.handleDoubleClick(Q,r,O):J.handleClick(Q,r,O))},tick:function(){var u=this,e=u.gv,B=e._moveStep;u.point&&e.isWalkable()&&(u._32Q&&(B*=(Un()-u._32Q)/50),e.walk(u.foward?B:-B),u._32Q=Un(),u._31Q=ln(u.tick,u))},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(e){var N=this._57I;N&&(Li(N,Ac(e))<=1&&this.gv.sm().cs(),this._57I=G)},handleWindowMouseMove:function(S){this.handleWindowTouchMove(S)},handleWindowTouchMove:function(d){var l,k,F=this,f=F.gv,T=F._62O,y=F.point,o=f.dm(),j=f.lp(d),g=j.x-y.x,B=j.y-y.y,C=f.getWidth(),e=f.getHeight();if(C&&e){var A=-O*g/C,W=-O*B/e;if("roaming"===T)F.rotate(d,A/2,W/2);else if(T===Dm||T===yb||T===mq)f._86O||o.beginTransaction(),f.fi({kind:f._86O?"betweenEditRotation":"beginEditRotation",event:d}),f._86O=1,f.sm().each(function(Q){if(gp(Q)&&f.isRotationEditable(Q)){var g=D(A)>D(W)?A:W;T===Dm?Q.setRotationX(Q.getRotationX()+g):T===yb?Q.setRotationY(Q.getRotationY()+g):T===mq&&Q.setRotationZ(Q.getRotationZ()+g)}});else if("move"===T||lf[T]){T===jn||T===Ah||T===ir?(f._87O||o.beginTransaction(),f.fi({kind:f._87O?"betweenEditScale":"beginEditScale",event:d}),f._87O=1):(f._moving||o.beginTransaction(),f.fi({kind:f._moving?"betweenMove":"beginMove",event:d}),f._moving=1);var G,r=F.p3,w=f.getPositionInfo(r),I=Fl(f);G=T===Nq?"x":T===Ml?"y":T===$r?"z":T===jn?"sx":T===Ah?"sy":T===ir?"sz":f.getMoveMode(d,F.movedata),g=g/C*w.width,B=-1*B/e*w.height;var m,R,J=[I[0]*g,I[4]*g,I[8]*g],U=[I[1]*B,I[5]*B,I[9]*B],N=J[0]+U[0],u=J[1]+U[1],_=J[2]+U[2],x=[r[0]+N,r[1]+u,r[2]+_],X=bd(f.getEye(),x,!0);if("xyz"===G?(m=x,f.moveSelection(N,u,_)):"xz"===G?(m=Ff(f,r,[0,1,0],x),m&&f.moveSelection(m[0]-r[0],0,m[2]-r[2])):"xy"===G?(m=Ff(f,r,[0,0,1],x),m&&f.moveSelection(m[0]-r[0],m[1]-r[1],0)):"yz"===G?(m=Ff(f,r,[1,0,0],x),m&&f.moveSelection(0,m[1]-r[1],m[2]-r[2])):"x"===G||"sx"===G?(X[0]=0,m=Ff(f,r,X,x),m&&(R=m[0]-r[0],"x"===G?f.moveSelection(R,0,0):f.sm().each(function(N){gp(N)&&f.isSizeEditable(N)&&(l=N.getScaleX()+R/100,k=l/N.getScaleX(),N.setScaleX(l),lm(d)&&(N.setScaleY(N.getScaleY()*k),N.setScaleTall(N.getScaleTall()*k)))}))):"y"===G||"sy"===G?(X[1]=0,m=Ff(f,r,X,x),m&&(R=m[1]-r[1],"y"===G?f.moveSelection(0,R,0):f.sm().each(function(b){gp(b)&&f.isSizeEditable(b)&&(l=b.getScaleTall()+R/100,k=l/b.getScaleTall(),b.setScaleTall(l),lm(d)&&(b.setScaleY(b.getScaleY()*k),b.setScaleX(b.getScaleX()*k)))}))):("z"===G||"sz"===G)&&(X[2]=0,m=Ff(f,r,X,x),m&&(R=m[2]-r[2],"z"===G?f.moveSelection(0,0,R):f.sm().each(function($){gp($)&&f.isSizeEditable($)&&(l=$.getScaleY()+R/100,k=l/$.getScaleY(),$.setScaleY(l),lm(d)&&($.setScaleX($.getScaleX()*k),$.setScaleTall($.getScaleTall()*k)))}))),!m)return;F.p3=m}else if(T===ks){var Z=F.div;Z||(Z=F.div=Rm(),Mk(F.getView(),Z),Z.op=y,Z.style.background=f.getRectSelectBackground()),f.fi({kind:f._rectSelecting?"betweenRectSelect":"beginRectSelect",event:d}),f._rectSelecting=1,Z.rect=Gr(Z.op,j),op(Z,Z.rect)}else if("pinch"===T&&2===tl(d)){f.fi({kind:f._pinching?"betweenPinch":"beginPinch",event:d}),f._pinching=1;var R=Zg(d);f.handlePinch(R,F.dist),F.dist=R}else"pan"===T||lm(d)?F.pan(d,g,B):"none"===T||f.isFirstPersonMode()||(Tl(d)?F.rotate(d,A,W):(F.pan(d,g,0),f.isWalkable()&&(f.fi({kind:f._walking?"betweenWalk":"beginWalk",event:d}),f._walking=1,f.walk(B/f.getHeight()*f.getCenterInfo().height))));F.point=j}},pan:function(V,w,l){var S=this.gv;if(S.isPannable()){var f=S.getWidth(),$=S.getHeight();if(!f||!$)return;var d=S.getCenterInfo(),P=w/f*d.width,r=-1*l/$*d.height;S.fi({kind:S._panning?"betweenPan":"beginPan",event:V}),S._panning=1,S.pan(-P,-r)}},rotate:function(V,w,f){var A=this.gv;A.isRotatable()&&(A.fi({kind:A._rotating?"betweenRotate":"beginRotate",event:V}),A._rotating=1,A.rotate(w,f))},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(r){var h=this,o=h.gv,U=o.dm(),A=h.div;if(A){var f=o.getDatasInRect(A.rect);if(!f.isEmpty()){var b=o.sm(),u=b.toSelection();f.each(function(C){b.co(C)?u.remove(C):u.add(C)}),b.ss(u)}Nl(A)}o._moving&&(delete o._moving,o.fi({kind:"endMove",event:r}),o.onMoveEnded(),U.endTransaction()),o._panning&&(delete o._panning,o.fi({kind:"endPan",event:r}),o.onPanEnded()),o._rotating&&(delete o._rotating,o.fi({kind:"endRotate",event:r}),o.onRotateEnded()),o._86O&&(delete o._86O,o.fi({kind:"endEditRotation",event:r}),U.endTransaction()),o._87O&&(delete o._87O,o.fi({kind:"endEditScale",event:r}),U.endTransaction()),o._pinching&&(delete o._pinching,o.fi({kind:"endPinch",event:r}),o.onPinchEnded()),o._rectSelecting&&(delete o._rectSelecting,o.fi({kind:"endRectSelect",event:r}),o.onRectSelectEnded()),o._walking&&(delete o._walking,o.fi({kind:"endWalk",event:r}),o.onWalkEnded()),h.dist=h.point=h._62O=h.p3=h.movedata=h.div=h._57I=h._32Q=h._31Q=h.foward=G}});var Sh=Ak.MapInteractor=function(O){Dr(Sh,this,[O]),this._minPhi=0,this._maxPhi=5*C/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};jj("MapInteractor",_n,{handle_contextmenu:function(q){Jd(q)},handle_mousewheel:function(b){this.gv.handleScroll(b,b.wheelDelta/40)},handle_DOMMouseScroll:function(b){2===b.axis&&this.gv.handleScroll(b,-b.detail)},handle_keydown:function(J){this.gv.handleKeyDown(J)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(c){Jd(c);var l=this,Z=l.gv;if(Z.setFocus(c)){Z.lp(c);var s=Z.getDataInfoAt(c),f=s?s.data:G,M=s?s.part:G;if(!f||!Z.isInteractive(f)){var P=l.editing={point:Z.lp(c)};Ai?P.touch=!0:(P.touch=!1,P.pan=Tl(c)),Hl(l,c)}Rc(c)?Z.handleDoubleClick(c,f,M):Z.handleClick(c,f,M)}},handle_mouseup:function(w){this.handle_touchend(w)},handle_touchend:function(){},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(s){var X=this,W=X.gv,L=X.editing;if(L){var h=W.lp(s),d=L.point,$=h.x-d.x,J=h.y-d.y;if(!L.moved){if(Math.abs($)<X.threshold&&Math.abs(J)<X.threshold&&!(s.touches&&s.touches.length>1))return;L.moved=!0}if(L.point=h,L.touch){var N=s.touches.length;if(2!==N)X.pan(s,$,J);else{if(1>=N)return;var x=s.touches,M={x:x[0].clientX,y:x[0].clientY},m={x:x[1].clientX,y:x[1].clientY},S={x:m.x-M.x,y:m.y-M.y},z=L.lastCenter,e=Math.atan2(S.y,S.x),f=L.theta,c=0;f==G?f=L.theta=e:(c=e-f,L.thetaStarted||Math.abs(c)>X.touchRotateThreshold?(L.thetaStarted=!0,L.theta=e):c=0);var B=C*(M.y+m.y)/2/W.getHeight(),g=L.phi,Q=0;g==G?g=L.phi=B:(Q=B-g,L.phiStarted||Math.abs(Q)>X.touchRotateThreshold?(L.phiStarted=!0,L.phi=B):Q=0);var H,F=Math.sqrt(S.x*S.x+S.y*S.y),t=L.vlen;if(t){var n=M.x-z.x,K=M.y-z.y,T=m.x-z.x,U=m.y-z.y,V=Math.sqrt(n*n+K*K),i=Math.sqrt(T*T+U*U),E=t/2,u=X._sign2(V-E),R=X._sign2(i-E);0>u*R||0===u&&0===R?(H=1,L.vlen=F):(H||(H=F/t),L.scaleStarted||Math.abs(H-1)>X.touchScaleThreshold?(L.vlen=F,L.scaleStarted=!0):H=1)}else t=L.vlen=F,H=1;1!==H&&W.setZoom(H),(Q||c)&&X.rotate(s,c,-Q),L.lastCenter={x:(m.x+M.x)/2,y:(m.y+M.y)/2}}}else if(L.pan)X.pan(s,$,J);else{var b=W.getWidth(),l=W.getHeight();if(!b||!l)return;var Y=-O*$/b,o=-O*J/l;X.rotate(s,Y,o)}}},_sign2:function(R){return Math.abs(R)<this._touchScaleCheckAccuracy?0:R>0?1:-1},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(O){var F=this,I=F.editing;if(F.editing=null,I){var y=F.gv;if(!I.moved&&I.pan){var Z=y.getDataAt(O);Z?y.sm().setSelection([Z]):y.sm().clearSelection()}else y._panning=null,y._rotating=null,y.fi({kind:I.pan?"endPan":"endRotate",event:O})}},pan:function(t,E,L){var H=this,z=H.gv;if(z.isPannable()){var I=z.getWidth(),B=z.getHeight();if(I&&B){var T=z.getCenterInfo(),Z=-E/I*T.width,C=1*L/B*T.height;z.fi({kind:z._panning?"betweenPan":"beginPan",event:t}),z._panning=1;var p=H.keepHorizon,U=H.editing.touch;if((U&&t.touches&&t.touches.length>1||!U&&lm(t))&&(p=!p),!p)return z.pan(Z,C);if(Z||C){var P=Fl(z),S=[P[0]*Z,P[4]*Z,P[8]*Z],d=[P[1],0,P[9]],A=Math.sqrt(d[0]*d[0]+d[2]*d[2]);A&&(d=[d[0]/A*C,0,d[2]/A*C]);var w=S[0]+d[0],o=S[1]+d[1],c=S[2]+d[2],q=z._center,y=z._eye;q[0]+=w,q[1]+=o,q[2]+=c,y[0]+=w,y[1]+=o,y[2]+=c,z.fp(Gd,G,y),z.fp(Ng,G,q)}}}},rotate:function(t,q,b){var T=this,m=T.gv;if(m.isRotatable()){var K=m._center,s=m._eye,Z=bd(s,K),Q=x(H(Z[0]*Z[0]+Z[2]*Z[2]),Z[1]),W=Q+b;W=Math.max(T.minPhi,Math.min(T.maxPhi,W)),b=W-Q,m.fi({kind:m._rotating?"betweenRotate":"beginRotate",event:t}),m._rotating=1,m.rotate(q,b)}}}),m.defineProperties(Sh.prototype,{minPhi:{get:function(){return this._minPhi},set:function(Z){this._minPhi=Z}},maxPhi:{get:function(){return this._maxPhi},set:function($){this._maxPhi=$}},keepHorizon:{get:function(){return this._keepHorizon},set:function(G){this._keepHorizon=G}},threshold:{get:function(){return this._threshold},set:function(j){this._threshold=j}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(D){this._touchScaleThreshold=D}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(S){this._touchRotateThreshold=S}}});var hb=function(d){this.gv=d};ne(hb,m,{_iv:!0,iv:function(){this._iv=!0},face:function(M,I){var h=this,c=h.gv.getGL();if(!c||!gp(M))return G;var s=I.x,Z=I.width,g=I.height,K=h.height-I.y-g,t=y(Z/2),R=new Uint8Array(4*Z*g),P=0;for(h.iv(),h.validate(M),Ji(c,h.frame),c.readPixels(s,K,Z,g,c.RGBA,c.UNSIGNED_BYTE,R),Ji(c,G),h.iv();t>=P;P++)for(var W=t-P,N=t+P,S=W;N>=S;S++)for(var q=W;N>=q;q++)if(S===W||S===N||q===W||q===N){var j=of.m[R[4*(S*Z+q)]];if(j)return j}},get:function(u,I){this.validate();var i=this,X=i.gv.getGL();if(!X)return G;var l,p,F=u.x,M=u.width,m=u.height,J=i.height-u.y-m,v=y(M/2),N=new Uint8Array(4*M*m),f=0,L=N.length,k=I?G:new fl,P=I?G:{};if(Ji(X,i.frame),X.readPixels(F,J,M,m,X.RGBA,X.UNSIGNED_BYTE,N),Ji(X,G),I){for(;v>=f;f++)for(var d=v-f,b=v+f,V=d;b>=V;V++)for(var a=d;b>=a;a++)if((V===d||V===b||a===d||a===b)&&(l=i.info(N,4*(V*M+a))))return l}else for(;L>f;f+=4)l=i.info(N,f),l&&(p=l.data,P[p._id]||(k.add(p),P[p._id]=p));return k},info:function(q,m){return this.colorMap[(q[m]<<16)+(q[m+1]<<8)+q[m+2]+((127&q[m+3])<<24)]},validate:function(w){var O=this,S=O.gv,J=S.getGL();if(J){var R=S.getWidth(),i=S.getHeight(),h=J.RGBA,A=J.TEXTURE_2D,k=J.RENDERBUFFER,u=J.FRAMEBUFFER;O.texture||(O.texture=Zr(J),O.render=J.createRenderbuffer(),O.frame=J.createFramebuffer()),(O.width!==R||O.height!==i)&&(Me(J,O.texture),J.texImage2D(A,0,h,R,i,0,h,J.UNSIGNED_BYTE,G),Xq(J,J.TEXTURE_MIN_FILTER,J.LINEAR),J.bindRenderbuffer(k,O.render),J.renderbufferStorage(k,J.DEPTH_COMPONENT16,R,i),Ji(J,O.frame),J.framebufferTexture2D(u,J.COLOR_ATTACHMENT0,A,O.texture,0),J.framebufferRenderbuffer(u,J.DEPTH_ATTACHMENT,k,O.render),Me(J,G),J.bindRenderbuffer(k,G),Ji(J,G),O.width=R,O.height=i),O._iv&&(O._iv=!1,Ji(J,O.frame),S._42(w||(O.colorMap={}),1),Ji(J,G))}}});var zk=function(b){this.gv=b};ne(zk,m,{gap:0,size:0,_42:function(F,Y){var j=this,y=j.gv,P=y._gridGap,t=y._gridSize;if(y._gridVisible){if(j.gap!==P||j.size!==t){for(var q=[],k=y._gridSize/2,J=P*k,u=0;2*k+1>u;u++){var B=6*u,T=6*(2*k+1)+B;q[B]=-J,q[B+1]=0,q[B+2]=-J+u*P,q[B+3]=J,q[B+4]=0,q[B+5]=-J+u*P,q[T]=-J+u*P,q[T+1]=0,q[T+2]=-J,q[T+3]=-J+u*P,q[T+4]=0,q[T+5]=J}j.vs=new nj(q),j.gap=P,j.size=t}Uc(y),fj(F,Y),Sr(F),Vn(F,Y,1,y._gridColor,y._buffer.vs,j.vs),mn(F,0,j.vs.length/3,F.LINES),Ld(F),ic(F,Y)}else j.vs=j.gap=j.size=G}});var qc=function(j){this.gv=j};ne(qc,m,{_42:function(P,m){var _=this.gv,n=_._buffer.vs,l=_._axisXColor,U=_._axisYColor,e=_._axisZColor,X=_._originAxisVisible,R=_._centerAxisVisible;if(X||R){var J=u?P.TRIANGLES:P.TRIANGLE_FAN,a=P.LINES;if(Uc(_),fj(P,m),Sr(P),X){var O=_.getCenterInfo(),k=$(O.width,O.height)/5,j=.8*k,L=.05*k;Vn(P,m,1.5,l,n,new nj([0,0,0,k,0,0,j,L,0,j,0,L,j,-L,0,j,0,-L,j,L,0,0,0,0,0,k,0,L,j,0,0,j,L,-L,j,0,0,j,-L,L,j,0,0,0,0,0,0,k,L,0,j,0,L,j,-L,0,j,0,-L,j,L,0,j])),mn(P,0,2,a),mn(P,1,6,J),Vn(P,m,G,U),mn(P,7,2,a),mn(P,8,6,J),Vn(P,m,G,e),mn(P,14,2,a),mn(P,15,6,J)}if(R){var c=_._center,q=c[0],W=c[1],E=c[2],O=_.getPositionInfo(c);k=$(O.width,O.height)/20,Vn(P,m,1.5,l,n,new nj([q,W,E,q+k,W,E,q,W,E,q,W+k,E,q,W,E,q,W,E+k])),mn(P,0,2,a),Vn(P,m,G,U),mn(P,2,2,a),Vn(P,m,G,e),mn(P,4,2,a)}Ld(P),ic(P,m)}}});var kj=function(Q){this.gv=Q,this.onMouseOver=this.onMouseOver.bind(this),this.mode=2};kj.Mode={Disable:0,Selection:1,MouseOver:2},ne(kj,m,{onMouseOver:function(x){V.preventDefault(x);var W=this.gv.getDataAt(x);W!==this.mouseOverData&&(this.mouseOverData=W,this.gv.iv())},setFetchTargetFunc:function(w){this.fetchTargetFunc=w},_42:function(O,p){var M,T=this,k=T._mode;if(k!==kj.Mode.Disable&&(k===kj.Mode.Selection?M=T.gv.sm().getSelection().toArray():k===kj.Mode.MouseOver&&T.mouseOverData&&(M=[T.mouseOverData]),T.fetchTargetFunc&&(M=T.fetchTargetFunc(M)),M&&M.length)){var R=T.gv,_=R.vr.isPresenting(),C=R.getWidth();if(_){var H=R.getWidth;C/=2,R.getWidth=function(){return C};var m=R.getViewport()}var V,Y=R.getDevicePixelRatio(),c=C*Y,j=R.getHeight()*Y;(V=T._renderTarget)?V.setSize(O,c,j):T._renderTarget=V=new Ak.RenderTarget(R,O,c,j),Ji(O,V.frame),R.drawFilter=function(Q){return M.indexOf(Q)<0?!0:void 0},R._42({}),R.drawFilter=null,Ji(O,G),_&&(R.getWidth=H,R.setViewport(O,m[0],m[1],m[2],m[3])),T.shader||(T.shader=new Xf.Shader(O,_d.vs,_d.fs));var Z=T.shader;if(T.shader.bind(),O.enable(O.BLEND),O.activeTexture(O.TEXTURE0+0),O.bindTexture(O.TEXTURE_2D,V.texture),Z.uniforms.image=0,Z.uniforms.textureSize=[c,j],Z.uniforms.edgeWidth=r["highlight.width"],T.highlightColor!==r["highlight.color"]){var e=gr(T.highlightColor=r["highlight.color"]);T.highlightColorData=[e[0]/255,e[1]/255,e[2]/255,e[3]/255]}Z.uniforms.edgeColor=T.highlightColorData,T.ibuffer?(T.ibuffer.upload(),T.vbuffer.upload()):(T.ibuffer=Xf.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),T.vbuffer=Xf.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1]))),Z.attributes.pos.pointer(T.vbuffer),O.drawElements(O.TRIANGLES,6,O.UNSIGNED_SHORT,0),O.disable(O.BLEND),O.bindTexture(O.TEXTURE_2D,null),O.useProgram(p)}}}),m.defineProperties(kj.prototype,{mode:{get:function(){return this._mode},set:function(w){var D=this._mode;w!==D&&(this._mode=w,w===kj.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):D===kj.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var _d={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Op=function(M){this.gv=M},Nq="edit_tx",Ml="edit_ty",$r="edit_tz",Dm="edit_rx",yb="edit_ry",mq="edit_rz",jn="edit_sx",Ah="edit_sy",ir="edit_sz",lf={};lf[Nq]=1,lf[Ml]=1,lf[$r]=1,lf[Dm]=1,lf[yb]=1,lf[mq]=1,lf[jn]=1,lf[Ah]=1,lf[ir]=1,ne(Op,m,{_42:function(X,M,b){var L=this,I=L.gv,Q=I.sm().ld();if(I.isEditable(Q)&&!I.isEditHelperDisabled()&&gp(Q)&&(!I.isFirstPersonMode()||!I.isMouseRoamable()&&!Ai)){Uc(I);var j,i,k=I.isMovable(Q),Y=I.isRotationEditable(Q),f=I.isSizeEditable(Q),O=I._axisXColor,v=I._axisYColor,E=I._axisZColor,d=I._editSizeColor,K=Q.p3(),B=Li(I.getEye(),K)/10,C=B/(b?5:10),q=.7*B,c=.4*q,R=K[0],G=K[1],$=K[2];j=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&L._17O(X,M,Q,b,Nq,O,j,[R,G-C,$,R+q,G-C,$,R+q,G,$,R+q,G,$,R,G,$,R,G-C,$,R,G-C,$+C,R+q,G-C,$+C,R+q,G-C,$,R+q,G-C,$,R,G-C,$,R,G-C,$+C]),i=R+q,f&&L._17O(X,M,Q,b,jn,d,j,[i,G-C,$,i+c,G-C,$,i+c,G,$,i+c,G,$,i,G,$,i,G-C,$,i,G-C,$+C,i+c,G-C,$+C,i+c,G-C,$,i+c,G-C,$,i,G-C,$,i,G-C,$+C]),i+=c,Y&&L._17O(X,M,Q,b,Dm,O,j,[i,G-C,$,i+c,G-C,$,i+c,G,$,i+c,G,$,i,G,$,i,G-C,$,i,G-C,$+C,i+c,G-C,$+C,i+c,G-C,$,i+c,G-C,$,i,G-C,$,i,G-C,$+C]),j=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],k&&L._17O(X,M,Q,b,Ml,v,j,[R,G,$,R,G+q,$,R-C,G+q,$,R-C,G+q,$,R-C,G,$,R,G,$,R,G,$,R,G,$-C,R,G+q,$-C,R,G+q,$-C,R,G+q,$,R,G,$]),i=G+q,f&&L._17O(X,M,Q,b,Ah,d,j,[R,i,$,R,i+c,$,R-C,i+c,$,R-C,i+c,$,R-C,i,$,R,i,$,R,i,$,R,i,$-C,R,i+c,$-C,R,i+c,$-C,R,i+c,$,R,i,$]),i+=c,Y&&L._17O(X,M,Q,b,yb,v,j,[R,i,$,R,i+c,$,R-C,i+c,$,R-C,i+c,$,R-C,i,$,R,i,$,R,i,$,R,i,$-C,R,i+c,$-C,R,i+c,$-C,R,i+c,$,R,i,$]),j=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&L._17O(X,M,Q,b,$r,E,j,[R,G,$,R,G,$+q,R,G-C,$+q,R,G-C,$+q,R,G-C,$,R,G,$,R,G-C,$,R-C,G-C,$,R-C,G-C,$+q,R-C,G-C,$+q,R,G-C,$+q,R,G-C,$]),i=$+q,f&&L._17O(X,M,Q,b,ir,d,j,[R,G,i,R,G,i+c,R,G-C,i+c,R,G-C,i+c,R,G-C,i,R,G,i,R,G-C,i,R-C,G-C,i,R-C,G-C,i+c,R-C,G-C,i+c,R,G-C,i+c,R,G-C,i]),i+=c,Y&&L._17O(X,M,Q,b,mq,E,j,[R,G,i,R,G,i+c,R,G-C,i+c,R,G-C,i+c,R,G-C,i,R,G,i,R,G-C,i,R-C,G-C,i,R-C,G-C,i+c,R-C,G-C,i+c,R,G-C,i+c,R,G-C,i])}},_17O:function(d,E,W,x,S,K,H,F){var q=this.gv._buffer;Hj(d,E,x,!0,W,S),Kj(d,E,G,!0,G,!0,G,!1),Zl(d,E.uDiffuse,K),di(d,q.vs,new nj(F),E.aPosition),di(d,q.ns,new nj(H),E.aNormal),Sr(d),mn(d,0,12),Ld(d),xd(d,E)}});var Hf=K.Raycaster=function($){this.gv=$};uj("Raycaster",m,{intersect:function(M){var T=this,x=T.gv,L=x.getDataAt(M);return L?T.intersectObject(M,L):null},intersectObjects:function(U,Z,d){var g,e,i,l,k=this,G=1/0,b=U.origin||(new cl).fromArray(k.gv.getEye());return Z.forEach(function(M){d&&d(M)===!1||M.s("intersect")!==!1&&(g=k.intersectObject(U,M),g&&(e=b.distanceToSquared(g.world),G>e&&(i=M,l=g,G=e)))}),{data:i,intersect:l}},intersectObject:function(w,v){if(w instanceof Ok)return this._intersectObjectImpl(w,v);var Q,t,G=this,O=G.gv;t=O.unproject(w);var D=O.getEye();O.isOrtho()?(Q=bd(O.getCenter(),D),Q[0]+=Q[0],Q[1]+=Q[1],Q[2]+=Q[2]):Q=D,Q=new cl(Q);var n=new cl(t).sub(Q).normalize(),i=new K.Math.Ray(Q,n);return G._intersectObjectImpl(i,v)},_intersectObjectImpl:function(){function G(){var r=new cl;return r.subVectors(c,Q),x.subVectors(Y,Q),r.cross(x).normalize(),r}function E(c,k,M,v,e,E,U){return lk.barycoordFromPoint(c,k,M,v,I),e.multiplyScalar(I.x),E.multiplyScalar(I.y),U.multiplyScalar(I.z),e.add(E).add(U),e.clone()}var e=new vl,W=new vl,Z=new Ok,S=new cl,v=new cl,N=new cl,R=new cl,f=new cl,Y=new cl,Q=new cl,c=new cl,O=new Vk,D=new Vk,j=new Vk,x=new cl,w={vs:rm,is:ao,uv:Qq},I=new cl;return function(d,H){var p=this.gv.getData3dUI(H),b=H.mat||p.mat;if(b){e.fromArray(b),W.getInverse(e),Z.copy(d).applyMatrix4(W);var X,m,F="body",g=p.shapeModel;if(g||(g=hm(p)),g||(H instanceof K.Node&&!(H instanceof K.Shape)?(X=!0,g=w):(m=!0,g=[p.left,p.front,p.right,p.back,p.top,p.bottom])),!g)return console.log("Can not find shape model."),null;Ul(g)||(g=[g]);var P,I,T,q,V,a,A,$,l,n,C,s,B,y,o=1/0,z=["","top_","bottom_"],k=!1;for(P=0,I=g.length;I>P;P++)if(s=g[P])for(T=0,q=z.length;q>T;T++)if(B=z[T],A=s[B+"vs"],$=s[B+"is"],l=s[B+"uv"]||s[B+"tuv"],A){if(y=s[B+"boundingBox"]){if(!Z.intersectBox(y))continue}else s[B+"boundingBox"]=y=new K.Math.Box3;for(V=0,a=$?$.length:A.length/3;a>V;V+=3)$?(v.fromArray(A,3*$[V]),N.fromArray(A,3*$[V+1]),R.fromArray(A,3*$[V+2])):(v.fromArray(A,3*V),N.fromArray(A,3*(V+1)),R.fromArray(A,3*(V+2))),y.expandByPoint(v),y.expandByPoint(N),y.expandByPoint(R),n=Z.intersectTriangle(v,N,R,!1,S),n&&(C=Z.origin.distanceTo(n),o>C&&(o=C,f.copy(n),Y.copy(v),Q.copy(N),c.copy(R),""!==B?F=B.slice(0,-1):X?F=ob[Math.floor(V/6)]:m&&(F=ob[P]),l&&(k=!0,$?(O.fromArray(l,2*$[V]),D.fromArray(l,2*$[V+1]),j.fromArray(l,2*$[V+2])):(O.fromArray(l,2*V),D.fromArray(l,2*(V+1)),j.fromArray(l,2*(V+2))))))}if(!isFinite(o))return null;var L,h=f.clone().applyMatrix4(e);k&&(L=E(f,Y,Q,c,O,D,j));var J=G(Y,Q,c),x=G(Y.applyMatrix4(e),Q.applyMatrix4(e),c.applyMatrix4(e)),t=Z.direction.dot(J);return t>0&&(J.multiplyScalar(-1),x.multiplyScalar(-1)),{world:h,local:f.clone(),worldNormal:x,normal:J,uv:L,part:F}}}}()});var ve=function(X,Q){this.gv=X,this.s=function(s,j,q){return j==G&&(j=q),j==G?Q.getStyle(s):Qb(j,Q,X)},this.data=Q};ne(ve,m,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(r,o,e,x){var Z=this,T=Z.data;if(!(T instanceof Ro)){var X,S,f,n,W,C,O,$=Z.gv,N=T._id,s=Z.s("shape3d.alwaysOnTop")?null:Z.s("batch"),R=$._batchIndexMap,U=$._batchModelMap,i=$.isSelectable(T),M=$.getBrightness(T),I=M!=G&&1!==M;if(Z.needValidate(r)){if(f=Be(R,U,T,s),Z.validate(f,s?Zo[s]||Er:G),f&&(n=R[N],W=n.size=f.vs.length/3-n.begin,O=f.rs))for(M=I?M:1,C=0;W>C;C++)O.push(M);if(gp(T)){var j=$.getWireframeGeometry(T);if(j)_k($,T,j);else{var F=$.getWireframe(T);F&&_k($,T,F)}}Z.labelInfo=Z.label2Info=Z.noteInfo=Z.note2Info=Z._38o=G,Z._24O(Fo,"getLabel"),Z._24O(Or,"getLabel2"),Z._26O(qs,"getNote"),Z._26O(Kn,"getNote2"),Z._15O(),Z.interactiveInfo=$.isInteractive(T)?{}:G,Z._iv=!1}I&&Zl(r,o.uBrightness,M),Zl(r,o.uAlphaTest,Z.s("alphaTest")),S=Hj(r,o,e,i,T,Yg),S&&(dr(S,R[N],U),dr(S,$._polylineIndexMap[N],$._polylineModelMap),dr(S,$._wireframeIndexMap[N],$._wireframeModelMap)),R[N]||Z._80o(r,o,x),$.isLabelVisible(T)&&((X=Z.labelInfo)&&(Hj(r,o,e,i,T,Fo),Z._28O(X,Fo,x)),(X=Z.label2Info)&&(Hj(r,o,e,i,T,Or),Z._28O(X,Or,x))),$.isNoteVisible(T)&&((X=Z.noteInfo)&&(Hj(r,o,e,i,T,qs),Z._29O(X,qs,x)),(X=Z.note2Info)&&(Hj(r,o,e,i,T,Kn),Z._29O(X,Kn,x))),(X=Z._38o)&&Z._99O(r,o,X,e,i,x),I&&Zl(r,o.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return gg},_80o:function(){},dispose:function(){},_calcAnchorMat:function(T){if(T.hasOwnProperty("_anchor")||T.hasOwnProperty("_anchorElevation")){var B=T.getAnchor3d(),r={x:B.x-.5,y:B.y-.5,z:B.z-.5},z=Qh();return mr(z,[-r.x,-r.y,-r.z]),z}},getBodyColor:function(J){var x=this.data,s=this.gv.getBodyColor(x);return s?s:J?x.getStyle(J):G},_24O:function(T,q){var b=this,A=b.data,B=b.gv,X=b.s,L=B[q](A);if(L!=G){var v=X(T+".scale"),c=X(T+".max"),f=b[T+"Info"]={label:L,textureScale:X(T+".texture.scale"),color:B[q+"Color"](A),font:X(T+".font"),align:X(T+".align"),background:B[q+"Background"](A)},x=f.rect=Id(f,L);c>0&&c<x.width&&(f.labelWidth=x.width,x.width=c),x.x=x.y=0,x.width*=v,x.height*=v,f.mat=b._16O(X(T+".autorotate"),X(T+".position"),x,X(T+".face"),X(T+".t3"),X(T+".r3"),X(T+".rotationMode"));var P=x.width/2,$=x.height/2;f.vs=new nj([-P,$,0,-P,-$,0,P,-$,0,P,$,0]),x.width/=v,x.height/=v}},_26O:function(T,z){var q=this,B=q.data,d=q.gv,N=q.s,n=d[z](B);if(n!=G){var x=N(T+".scale"),h=this[T+"Info"]={note:n,textureScale:N(T+".texture.scale"),expanded:N(T+".expanded"),font:N(T+".font"),color:N(T+".color"),align:N(T+".align"),borderWidth:N(T+".border.width"),borderColor:N(T+".border.color"),background:d[z+"Background"](B)};if(h.expanded){var v=N(T+".max"),W=Id(h,n);W.width+=6,W.height+=2,v>0&&v<W.width&&(h.labelWidth=W.width,W.width=v);var M={x:-W.width/2,y:-8-W.height,width:W.width,height:W.height+8}}else M={x:-6,y:-18,width:12,height:18};h.mat=q._16O(N(T+".autorotate"),N(T+".position"),G,N(T+".face"),N(T+".t3"),N(T+".r3"),N(T+".rotationMode")),h.rect=M,1!==x&&(M=Cn(M),M.x*=x,M.height*=x,M.y=-M.height,M.width*=x);var Y=M.x,Z=M.y,b=M.width,j=M.height;h.vs=new nj([Y,-Z,0,Y,-Z-j,0,Y+b,-Z-j,0,Y+b,-Z,0])}},_28O:function(B,k,G){if(G(this.s(k+".transparent"))){var I=B.rect,N=B.textureScale,y=I.width*N,b=I.height*N;if(y>=1&&b>=1){var h=Iq(y,b);1!==N&&(h.translate(h,I.x,I.y),h.scale(N,N),h.translate(h,-I.x,-I.y)),Lh(h,B),h.restore(),kf(this,k,B.mat,B.vs,!0)}}},_29O:function(y,N,X){if(X(this.s(N+".transparent"))){var n=y.rect,l=y.textureScale,F=n.x,P=n.y,G=n.width*l,z=n.height*l;if(G>=1&&z>=1){n.x=n.y=0;var K=Iq(G,z);1!==l&&K.scale(l,l),td(K,y),K.restore(),n.x=F,n.y=P,kf(this,N,y.mat,y.vs,!1)}}},_99O:function(c,H,h,x,J,T){if(h){var U=this,D=U.gv,X=U.data,P=D._buffer,W=D._1O,A=h.icons;for(var k in A){var S=A[k],b=h.rects[k];if(b&&T(Qb(S.transparent,X,D))){Hj(c,H,x,J,X,k);var B=Qb(S.shape3d,X,D),r=B?[B]:Qb(S.names,X,D),n=r?r.length:0,$=Qb(S.textureScale,X,D)||1,I=Qb(S.light,X,D);I==G&&(I=B?!0:!1),Kj(c,H,Qb(S.blend,X,D),I,Qb(S.opacity,X,D),Qb(S.reverseFlip,X,D),Qb(S.reverseColor,X,D),Qb(S.reverseCull,X,D));for(var t=0;n>t;t++){var p=r[t],Z=b[t];if(se(U,Z.mat),B)he(D,X,hm(U,B),U);else{var q=tn(p);if(q){var L=Z.width*$,e=Z.height*$;if(L>=1&&e>=1){var g=Iq(L,e);sm(g,q,Qb(S.stretch,X,D),0,0,L,e,X,D),g.restore(),Zr(c,Lf,W),Sr(c,H,W,Qb(S.discardSelectable,X,D),P.uv,Zn),di(c,P.vs,Z.vs,H.aPosition),xc(c,P.ns,Hh,H.aNormal),tm(c,P.is,Wo),Cs(c,0,Wo.length),Ld(c,H,W)}}}Ek(D)}xd(c,H)}}}}});var Rf=function(R,y){Dr(Rf,this,[R,y])};ne(Rf,ve,{_16O:function($,s,E,F,H,G,z,r,k){var v=this.data,q=v.getFinalScale3d(),P=Bj(s,q,E,F,r,k);if(v.hasOwnProperty("_anchor")||v.hasOwnProperty("_anchorElevation")){var j=v.getAnchor3d();P[0]-=(j.x-.5)*q[0],P[1]-=(j.y-.5)*q[1],P[2]-=(j.z-.5)*q[2]}return Ei(Qh(),P,v.p3(),F,H,G,z,$,v.getFinalRotation3d(),v.getRotationMode())},clear:function(){var m=this;m.faceMat=m.mat=m.shapeModel=m.left=m.right=m.front=m.back=m.top=m.bottom=m.csg=G},needValidate:function(b){if(this._iv)return this._validateFrameId=b._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var q=b._renderInfo.frame;if(this._validateFrameId!==q)return this._validateFrameId=q,!0}return!1},validate:function(E,u){var o=this,p=o.gv,y=o.data,c=hm(o);o._updateAutoRotation(),o._updateFixSize2d(),o._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Kc(p,y,"_wireframeModelMap","_wireframeIndexMap"),Kc(p,y,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));
var q=Tr(y,p.getMat(y),c?o.s("shape3d.scaleable"):!0),G=o._calcAnchorMat(y);if(G&&cr(q,q,G),y.mat=q,o.clear(),E){var M=[];c?Yb(p,y,c,o,o.getBodyColor(),[q],E,M):(ll(p,y,E,u,q,kh,M,Mf),ll(p,y,E,u,q,tq,M,Tj),ll(p,y,E,u,q,Wj,M,vm),ll(p,y,E,u,q,Eh,M,on),ll(p,y,E,u,q,Gb,M,Go),ll(p,y,E,u,q,Cb,M,Lm)),M.length&&(ml(E.vs,M),ml(E.ns,Io(M)))}else o.mat=q,(o.shapeModel=c)||(o._cubeUvs=null,o.vf(kh,0),o.vf(tq,16),o.vf(Gb,8),o.vf(Cb,24),o.vf(Wj,32),o.vf(Eh,40))},_updateAutoRotation:function(){var g=new vh;return function(){var j=this,N=j.data,k=j.s("shape3d.autorotate");if(!k)return N._dynamicRotation&&delete N._dynamicRotation,void 0;var I,s=j.gv;I="string"==typeof k?[k.indexOf("x")<0?s._eye[0]:s._center[0],k.indexOf("y")<0?s._eye[1]:s._center[1],k.indexOf("z")<0?s._eye[2]:s._center[2]]:s._eye;var a=s._center,w=N.p3(),P=bg([w[0]+I[0]-a[0],w[1]+I[1]-a[1],w[2]+I[2]-a[2]],w,s._up),t=N.r3();g.set(0,0,0,N.getRotationMode(),!0).setFromRotationMatrix(P),Math.abs(t[0]-g.x)<1e-5&&Math.abs(t[1]-g.y)<1e-5&&Math.abs(t[2]-g.z)<1e-5||(N._dynamicRotation=[g.x,g.y,g.z])}}(),_updateFixSize2d:function(){var c=this,O=c.data,P=c.s("shape3d.fixSizeOnScreen");if(!P)return O._dynamicScale3d&&delete O._dynamicScale3d,void 0;var w=c.gv;O.getFinalScale3d();var s=Tr(O,w.getMat(O)),y=Kb([0,0,0],s),i=w.toViewPosition(y);if(!isNaN(i.x)&&!isNaN(i.y)){var V=Kb([1,0,0],s),C=w.toViewPosition(V),Y=Kb([0,1,0],s),F=w.toViewPosition(Y),n=C.x-i.x,p=F.y-i.y,d=O._dynamicScale3d||[1,1,1],b=tn(O.s("shape3d.image")),N=P[0]>0?P[0]:b?dq(b,c):20,Q=P[1]>0?P[1]:b?Am(b,c):20,q=Math.abs(n/N),R=Math.abs(p/Q);Math.abs(q-1)<.001&&Math.abs(R-1)<.001||(O._dynamicScale3d=[d[0]/q,d[1]/R,d[2]])}},_updateOverlapping:function(){var V=this,d=V.s("hide.overlapping.group");if(!d)return V._rectOverlapping&&(V._rectOverlapping=z),void 0;var l,N,$,u=V.gv,x=V.data,F=Tr(x,u.getMat(x)),E=1/0,M=1/0,_=-1/0,P=-1/0,s=x.getAnchor3d(),K=s.x,J=s.y,m=s.z;for(l=0;8>l;l++){if(N=Kb([(l>>2)-K,(1&l>>1)-J,(1&l)-m],F),$=u.toViewPosition(N),isNaN($.x)||isNaN($.y))return;E=Math.min(E,$.x),_=Math.max(_,$.x),M=Math.min(M,$.y),P=Math.max(P,$.y)}var W={x:E,y:M,w:_-E,h:P-M};V._rectOverlapping=u.overlappingBox.isOverlapping(d,W)},getVectorDynamicSize:function(){var L,Q=this,g=Q.s("shape3d"),M=Q.data;if("billboard"===g||"plane"===g||(L=M._currentCubeElementId)!=G){var t,Y,W=Q.gv,k=Tr(M,W.getMat(M)),K=M.getAnchor3d(),R=.5-K.x,p=.5-K.y,j=.5-K.z,n=Q.s("shape3d.vector.dynamic.maxsize"),y=function(l,O){l[0]+=R,l[1]+=p,l[2]+=j,O[0]+=R,O[1]+=p,O[2]+=j;var A=W.toViewPosition(Kb(l,k)),u=W.toViewPosition(Kb(O,k)),Y=A.x-u.x,m=A.y-u.y;return Math.min(n,Math.sqrt(Y*Y+m*m))};if("billboard"===g)t=y([-.5,0,0],[.5,0,0]),Y=y([0,-.5,0],[0,.5,0]);else if("plane"===g)t=y([-.5,0,0],[.5,0,0]),Y=y([0,0,-.5],[0,0,.5]);else if(M._currentCubeElementId!=G){var C=3*ao[L+1],q=3*ao[L],z=3*ao[L+2];t=y([rm[C],rm[C+1],rm[C+2]],[rm[z],rm[z+1],rm[z+2]]),Y=y([rm[C],rm[C+1],rm[C+2]],[rm[q],rm[q+1],rm[q+2]])}return[t,Y]}},getCachedTexture:function(){var H=this,N=H.data,L=N._currentCubeElementId;return L!=G?H._cubeCachedImage?H._cubeCachedImage[L]:null:H._shape3dCachedImage},setCachedTexture:function(P){var n=this,D=n.data,I=D._currentCubeElementId;if(I!=G){if(!n._cubeCachedImage)return n._cubeCachedImage={};n._cubeCachedImage[I]=P}else n._shape3dCachedImage=P},invalidateCachedTexture:function(k){var N,S,G,F=this;if((G=F._shape3dCachedImage)&&(k.deleteTexture(G),F._shape3dCachedImage=null),S=F._cubeCachedImage){for(N in S)k.deleteTexture(S[N]);F._cubeCachedImage=null}},vf:function(Q,Y){var L=this;if(L.gv.getFaceVisible(L.data,Q)){var z=ub(L,Q);z.mat&&(L.faceMat=!0);var M=z.uv;if(M){var P=L._cubeUvs;P||(P=L._cubeUvs=new nj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var _=0;8>_;_++)P[Y+_]=M[_]}return z}},_80o:function(h,e,U){var W=this;if(W._rectOverlapping)return!0;var r=W.gv,w=W.data,J=r._cube,T=W.shapeModel;Uc(r,W.mat),Zl(h,e.uUseEnvMap,w.s("envmap")?!0:!1),Zl(h,e.uReflectivity,w.s("envmap")||.01),T?he(r,w,T,W,W.getBodyColor(),U):(di(h,J.vs,G,e.aPosition),di(h,J.ns,G,e.aNormal),Pl(h,J.is),W._18O(h,e,W.left,0,U),W._18O(h,e,W.front,6,U),W._18O(h,e,W.right,12,U),W._18O(h,e,W.back,18,U),W._18O(h,e,W.top,24,U),W._18O(h,e,W.bottom,30,U)),Ek(r),W.faceMat&&(W._18O(h,e,W.left,0,U,!0),W._18O(h,e,W.front,6,U,!0),W._18O(h,e,W.right,12,U,!0),W._18O(h,e,W.back,18,U,!0),W._18O(h,e,W.top,24,U,!0),W._18O(h,e,W.bottom,30,U,!0))},_18O:function(Y,v,i,r,g,m){if(i){if(!g(i.transparent))return;if(m&&!i.mat||!m&&i.mat)return;m&&Uc(this.gv,i.mat);var D=this,A=D.data;A._currentCubeElementId=r;var V=D.gv,s=V.getTexture(i.texture,A),y=i.uv,q=i.uvScale,U=i.uvOffset,h=i.discardSelectable;s?y?Sr(Y,v,s,h,V._buffer.uv,D._cubeUvs,U,q):Sr(Y,v,s,h,V._cube.uv,G,U,q):Sr(Y),Kj(Y,v,i.blend,i.light,i.opacity,i.reverseFlip,i.reverseColor,i.reverseCull),Zl(Y,v.uDiffuse,i.color),Cs(Y,r,6),xd(Y,v),Ld(Y,v,s),m&&Ek(V),A._currentCubeElementId=null}}});var pm=function(v,S){Dr(pm,this,[v,S])};ne(pm,ve,{_25Q:1,validate:function(S){var M=this,B=M.gv,N=M.data,T=M.s,r=T("edge.width"),h=N._40I,f=N._41I;if(M.shapeModel=M.info=G,h&&f){var X,J,I,D,u,P,d,Z,q,j,b=N.isLooped(),p=T(Oe),R=V.getEdgeType(p);if(R){var n=R(N,Qc(M,B,N,b,p),B,M._19Q);if(!n.points||n.points.isEmpty())return;P=M.info={},d=n.segments,u=n.points,Z=u.size();for(var m=h.getElevation(),x=f.getElevation(),l=0;Z>l;l++){var O=u.get(l);O.e==G&&(O.e=m+(x-m)*l/(Z-1))}q=Yi(u.get(0)),j=Yi(u.get(Z-1));var A=Z%2;0===A?(P.c1=Yi(u.get(Z/2-1)),P.c2=Yi(u.get(Z/2))):P.p3=Yi(u.get((Z-A)/2)),P.s1=q,P.s2=Yi(u.get(1)),P.t1=Yi(u.get(Z-2)),P.t2=j}else{u=new fl,P=M.info={};var Q=T("edge.offset"),a=T("edge.center"),F=T("edge.source.t3"),e=T("edge.target.t3"),C=h.p3(),W=f.p3();if(F&&(C[0]+=F[0],C[1]+=F[1],C[2]+=F[2]),e&&(W[0]+=e[0],W[1]+=e[1],W[2]+=e[2]),p===Wp){d=T("edge.segments");var E=P.points=T(id)||eq;if(Z=E.size()){q=Yi(E.get(0)),j=Yi(E.get(Z-1)),!a&&Q&&(I=bd(q,C,!0),Q=$(Q,Li(C,q)),C=[C[0]+I[0]*Q,C[1]+I[1]*Q,C[2]+I[2]*Q],I=bd(W,j,!0),Q=$(Q,Li(j,W)),W=[W[0]-I[0]*Q,W[1]-I[1]*Q,W[2]-I[2]*Q]);var A=Z%2;0===A?(X=Yi(E.get(Z/2-1)),J=Yi(E.get(Z/2))):P.p3=Yi(E.get((Z-A)/2)),P.s1=C,P.s2=q,P.t1=j,P.t2=W}else!a&&Q&&(I=bd(W,C,!0),D=Li(C,W),Q=ld(Q,D),C=[C[0]+I[0]*Q,C[1]+I[1]*Q,C[2]+I[2]*Q],W=[W[0]-I[0]*Q,W[1]-I[1]*Q,W[2]-I[2]*Q]),X=C,J=W;u.add({x:C[0],y:C[2],e:C[1]}),u.addAll(E),u.add({x:W[0],y:W[2],e:W[1]})}else{var s=Qc(M,B,N,b,p);if(M._19Q||(s=-s),b){var K=C[0],U=C[1],w=C[2],L=h.getTall()/2+s;X=[K-s,U+L,w],J=[K+s,U+L,w],u.add({x:K-s,y:w,e:U}),u.add({x:K-s,y:w,e:U+L}),u.add({x:K+s,y:w,e:U+L}),u.add({x:K+s,y:w,e:U})}else{I=bd(W,C,!0),D=Li(C,W);var g={x:C[0],y:C[2]},v={x:W[0],y:W[2]},t=vk(G,g,v,s),o=t.x-g.x,i=t.y-g.y;Q=ld(Q,D),I[0]*=Q,I[1]*=Q,I[2]*=Q,X=[C[0]+I[0]+o,C[1]+I[1],C[2]+I[2]+i],J=[W[0]-I[0]+o,W[1]-I[1],W[2]-I[2]+i],a?(u.add({x:C[0],y:C[2],e:C[1]}),u.add({x:X[0],y:X[2],e:X[1]}),u.add({x:J[0],y:J[2],e:J[1]}),u.add({x:W[0],y:W[2],e:W[1]})):(u.add({x:X[0],y:X[2],e:X[1]}),u.add({x:J[0],y:J[2],e:J[1]}))}}P.c1=X,P.c2=J}P.list=T(mm)===Te?M.createTubeModel(u,d,r/2,S):M.createLineModel(u,d,r,"edge","edge.dash")}}});var Pq=function(B,h){Dr(Pq,this,[B,h])};ne(Pq,Rf,{_80o:function(J,S,X){var R=this,Z=R.gv,c=R.shapeModel;Uc(Z,R.mat),c?he(Z,R.data,c,R,R.getBodyColor(),X):(xl(R,J,S,R.left,X),xl(R,J,S,R.front,X),xl(R,J,S,R.right,X),xl(R,J,S,R.back,X),xl(R,J,S,R.top,X),xl(R,J,S,R.bottom,X)),Ek(Z)},validate:function(y,v){var H,X,h=this,g=h.s,$=h.data,E=$.p3(),u=$._thickness/2,o=$.isClosePath(),S=$.getPoints(),D=$.getSegments(),r=g(Pk),Q=y&&y.uv;if(h.clear(),0>u)X=h.shapeModel=mj(S,D,g(Mq),g(Fg),r,g(bp),$.getTall(),$.getShapeElevation(),o),g(Qn)?g("shape3d.image")||delete X.uv:(delete X.vs,delete X.ns,delete X.uv),g("shape3d.top.image")||delete X.top_uv,g("shape3d.bottom.image")||delete X.bottom_uv;else if(g(mm)===Te)H=Ie(S,D,r,o),X=h.shapeModel={vs:[]},g("shape3d.image")&&(X.uv=[],X.sum=g(bp)||Di(H)||1,X.len=0),g(Mq)&&!o&&(X.top_vs=[],g("shape3d.top.image")&&(X.top_uv=[])),g(Fg)&&!o&&(X.bottom_vs=[],g("shape3d.bottom.image")&&(X.bottom_uv=[])),h._12O(H,u);else{var Z,A,W,s,m,J,F,x,K,Y;if(H=Ie(S,D,r,o),m=h.vf(Gb,Q,!1,v),u&&(J=h.vf(Cb,Q,!1,v),F=o?G:h.vf(kh,Q,!1,v),x=o?G:h.vf(tq,Q,!1,v),K=h.vf(Wj,Q,!1,v),Y=h.vf(Eh,Q,!1,v)),u){for(var B=0,w=H.length;w>B;B++)H[B]=h._tryRemoveBezierPoints(H[B],u);h._12O(H,u)}else m&&H.forEach(function(E){if(s=E.length,s>0)for(Z=E[0],W=1;s>W;W++)A=E[W],h.addV(m.vs,Z,A),Z=A});h._20Q(H),y||(m&&(m.ns=Io(m.vs),Gf(m,"vs"),Gf(m,$b)),u&&(J&&(J.ns=Io(J.vs),Gf(J,"vs"),Gf(J,$b)),F&&(F.ns=Io(F.vs),Gf(F,"vs"),Gf(F,$b)),x&&(x.ns=Io(x.vs),Gf(x,"vs"),Gf(x,$b)),K&&(K.ns=Io(K.vs),Gf(K,"vs"),Gf(K,$b)),Y&&(Y.ns=Io(Y.vs),Gf(Y,"vs"),Gf(Y,$b))))}var b=h.mat=Qh();mr(b,E),le(b,$.getFinalRotation3d(),$.getRotationMode());var M=$.getScale3d(),L=$._dynamicScale3d;L&&(M[0]*=L[0],M[1]*=L[1],M[2]*=L[2]),cf(b,M),mr(b,cp(E)),y&&(Ed(h,b,y,X),h.clear())},_20Q:function(e){var T,H,w,f,p,Y,I,V=this,P=V.front,m=V.back,_=V.top,E=V.bottom,r=P?P.tuv:G,y=m?m.tuv:G,M=_?_.tuv:G,Z=E?E.tuv:G,N=0;(r||y||M||Z)&&(T=V.s(bp)||Di(e)||1,e.forEach(function(y){if(H=y.length,H>0)for(Y=y[0],w=1;H>w;w++)I=y[w],f=N/T,N+=Li(Y,I),p=N/T,V._14O(P,f,p),V._14O(m,1-p,1-f),V._14O(_,f,p),V._14O(E,f,p),Y=I}))},_14O:function(E,T,k){if(E){var e=E.uv,Y=E.tuv;if(Y){if(e)var G=e[0]+(e[6]-e[0])*T,J=e[1]+(e[7]-e[1])*T,t=e[2]+(e[4]-e[2])*T,Z=e[3]+(e[5]-e[3])*T,Q=e[2]+(e[4]-e[2])*k,c=e[3]+(e[5]-e[3])*k,v=e[0]+(e[6]-e[0])*k,y=e[1]+(e[7]-e[1])*k;else G=T,J=0,t=T,Z=1,Q=k,c=1,v=k,y=0;Y.push(t,Z,Q,c,v,y,v,y,G,J,t,Z)}}},_13O:function(u){var Z=u.uv,j=u.tuv;j&&(Z?j.push(Z[2],Z[3],Z[4],Z[5],Z[6],Z[7],Z[6],Z[7],Z[0],Z[1],Z[2],Z[3]):j.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(P,F){var I=P.length;if(4>I)return P;var h,T,M,Q,c,Y,o=!1,J=function(p){return P[p]},W=function(Q){return P[I-1-Q]};for(c=0;1>=c;c++)for(Y=c?W:J,T=Y(0),M=Y(1),h=2;I-1>h;h++)if(Q=Y(h),!Q.remove)if(Q.b){var t=vk(T,M,Q,F);t.adjust?(Q.remove=!0,o=!0):(T=M,M=Q)}else T=M,M=Q;if(!o)return P;var v=[];for(h=0;I>h;h++)P[h].remove||v.push(P[h]);return v},_12O:function(y,g){var p,K,t,b,E,l=this;y.forEach(function(T){if(E=T.length,E>0)for(p={p:T[0],n:!0},b=1;E>b;b++)K=T[b],t=E-1>b?T[b+1]:G,l.addPoint(p,K,t,g,T)})},addPoint:function(r,n,Q,g,x){var _,X,w,E,D,B,q,M,O,T=this,R=r.p,h=r.f,i=r.b,J=T.s("shape3d.side")||eo,I=T.s("shape3d.start.angle"),W=T.s("shape3d.sweep.angle"),s=T.shapeModel,j=T.data.isClosePath();if(r.n&&(r.n=!1,h=j&&x.length>2?vk(x[x.length-2],R,n,g):vk(G,R,n,g),i=Td(R,h),s?s.top_vs&&T._10O(i,h,J,I,W,s.top_vs,s.top_uv):(_=T.left)&&(T.addV(_.vs,i,h),T._13O(_))),X=Q?vk(R,n,Q,g):j&&x.length>2?vk(R,n,x[1],g):vk(R,n,G,g),w=Td(n,X),s){var t,N,F=s.vs,e=s.uv,H=s.sum;for(e&&(t=s.len/H,s.len+=Li(R,n),N=s.len/H),B=T._9O(i,h,J,I,W),q=T._9O(w,X,J,I,W),M=0;J>M;M++)O=M+1,ml(F,B[O]),ml(F,q[M]),ml(F,B[M]),ml(F,q[M]),ml(F,B[O]),ml(F,q[O]),e&&(E=M/J,D=O/J,e.push(t,D,N,E,t,E,N,E,t,D,N,D));!Q&&s.bottom_vs&&T._10O(w,X,J,I,W,s.bottom_vs,s.bottom_uv,!0)}else!Q&&(_=T.right)&&(T.addV(_.vs,X,w),T._13O(_)),(_=T.front)&&T.addV(_.vs,h,X),(_=T.back)&&T.addV(_.vs,w,i),(_=T.top)&&T.addH(_.vs,h,X,w,i,!0),(_=T.bottom)&&T.addH(_.vs,i,w,X,h);r.p=n,r.f=X,r.b=w},_10O:function(k,f,v,V,$,D,J,P){var b,g,d=this,W=d.data,z=d._9O(k,f,v,V,$),S=(k.x+f.x)/2,A=(k.y+f.y)/2,T=W.getShapeElevation(),U=0;for(U=0;v>U;U++)P?(ml(D,z[U]),ml(D,z[U+1])):(ml(D,z[U+1]),ml(D,z[U])),ml(D,[S,T,A]),J&&(P?(b=O*(U+1)/v+V,g=O*U/v+V):(b=O*U/v+V,g=O*(U+1)/v+V),J.push(.5-.5*F(g),.5-.5*s(g),.5-.5*F(b),.5-.5*s(b),.5,.5))},_9O:function(w,K,j,r,e){var c,Q,l=this,D=l.data,m=[],u=(w.x+K.x)/2,E=(w.y+K.y)/2,v=D.getTall()/2,P=D.getShapeElevation(),B=0;for(e=e||O;j>=B;B++)c=e*B/j+r,Q=F(c),m.push([u+(w.x-u)*Q,P+v*s(c),E+(w.y-E)*Q]);return m},addV:function(B,C,$){var F=C.x,p=C.y,E=$.x,j=$.y,y=this.data,b=y.getShapeElevation(),d=y.getTall()/2;B.push(F,b-d,p,E,b-d,j,E,b+d,j,E,b+d,j,F,b+d,p,F,b-d,p)},addH:function(s,j,D,m,W,p){var R=this.data,H=R.getTall()/2,F=R.getShapeElevation()+(p?H:-H);s.push(j.x,F,j.y,D.x,F,D.y,m.x,F,m.y,m.x,F,m.y,W.x,F,W.y,j.x,F,j.y)},vf:function(p,A,b,i){var K,d=this,F=d.gv.getFaceVisible(d.data,p);return(b||F)&&(K=ub(d,p,i),K.vs=[],K.tuv=F&&(K.texture||A)?[]:G,K.visible=F),K}});var Pm=function(p,l){Dr(Pm,this,[p,l])};ne(Pm,ve,{_25Q:1,validate:function(k){var J=this,y=J.data,l=J.s,$=y.getPoints(),j=$.size();if(J.shapeModel=J.info=G,j>1){var W=J.info={},q=y.getSegments(),U=y.getThickness(),s=Yi($.get(0)),m=Yi($.get(j-1)),H=j%2;0===H?(W.c1=Yi($.get(j/2-1)),W.c2=Yi($.get(j/2))):W.p3=Yi($.get((j-H)/2)),W.s1=s,W.s2=Yi($.get(1)),W.t1=Yi($.get(j-2)),W.t2=m,W.list=l(mm)===Te?J.createTubeModel($,q,U/2,k):J.createLineModel($,q,U,"shape.border","shape.dash")}var f=y.p3(),g=J.mat=Qh();mr(g,f),le(g,y.getFinalRotation3d(),y.getRotationMode());var B=y.getScale3d(),D=y._dynamicScale3d;D&&(B[0]*=D[0],B[1]*=D[1],B[2]*=D[2]),cf(g,B),mr(g,cp(f))},_80o:function(o,t,w){var Q=this,z=Q.shapeModel;if(z){var J=Q.gv;Uc(J,Q.mat),he(J,Q.data,z,Q,Q.getBodyColor(),w),Ek(J)}}});var Jq=K.graph3d.VR=function(d){var w=this;w.gv=d,w._controllers=[],w.switch=new sh(w),w._enable=!1,w._defaultCallLater=K.Default.callLater,"undefined"!=typeof p&&"VRFrameData"in p&&(w._frameData=new p.VRFrameData),w.measureOflength=1,w.eyesOffset=[0,0,0],w._orientation=new K.Math.Quaternion,w._lastHeadPose=[0,0,0],w._offsetToBeAdd=[0,0,0]};ne(Jq,m,{ms_fire:!0,_42:function($,n,h,j){var X=this,Z=X.gv;if(!Z.drawFilter&&X._deviceInAction){var M=X._device;if(M){var i=X._measureOflength;M.depthNear=Z.getNear()*i,M.depthFar=Z.getFar()*i;var F=X._offsetToBeAdd;if(X.eyesOffset[0]+=F[0],X.eyesOffset[1]+=F[1],X.eyesOffset[2]+=F[2],F[0]=0,F[1]=0,F[2]=0,M.isPresenting===!1)return X._controllers.forEach(function(g){g&&g.update()}),Z.iv(),!1;var K=X._frameData;M.getFrameData(K);var w=K.pose.position;return w&&(Z.setEye(X.toViewPosition(w)),X._orientation.fromArray(K.pose.orientation)),X._controllers.forEach(function(U){U&&U.update()}),Z.setViewport($,0,0,n/2,h),X._viewMatrix=X._copyViewMatrix(K.leftViewMatrix),X._projectMatrix=X._copyProjectMatrix(K.leftProjectionMatrix),j(),Z.setViewport($,n/2,0,n/2,h),X._viewMatrix=X._copyViewMatrix(K.rightViewMatrix),X._projectMatrix=X._copyProjectMatrix(K.rightProjectionMatrix),j(),X._lastViewMatrix=X._viewMatrix,X._lastProjectMatrix=X._projectMatrix,X._viewMatrix=null,X._projectMatrix=null,X.submitFrame(),!0}}},onVRDisplayPresentChange:function(){var X=this.isPresenting();this._injectGraphView(X),this.fp("present",!X,X)},getOrientation:function(){return this._orientation},addController:function(R){R=R||0;var Y=this,S=Y.getController(R);return S?S:(S=new lg(Y,R),Y._controllers.push(S),S)},getController:function(d){d=d||0;for(var M=this._controllers,o=0,g=M.length;g>o;o++)if(M[o]&&M[o].id===d)return M[o];return null},removeController:function(f){f=f||0;for(var N=this._controllers,X=0,H=N.length;H>X;X++)if(N[X]&&N[X].id===f)return N.splice(X,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(n,d){var Z=this,P=Z._scaleFactor,k=Z._eyesOffset,p=Z._lastHeadPose;return p[0]=n[0]*P,p[1]=n[1]*P,p[2]=n[2]*P,d?(d[0]=p[0]+k[0],d[1]=p[1]+k[1],d[2]=p[2]+k[2],d):[p[0]+k[0],p[1]+k[1],p[2]+k[2]]},addEyesOffset:function(B,a,L){var R=this._offsetToBeAdd;R[0]+=B,R[1]+=a,R[2]+=L},_copyViewMatrix:function(D){var Q=this.dup(D),M=this._scaleFactor;Q[12]*=M,Q[13]*=M,Q[14]*=M;var i=this._eyesOffset;if(i&&(i[0]||i[1]||i[2])){var l=i[0],C=i[1],T=i[2];Q[12]-=Q[0]*l+Q[4]*C+Q[8]*T,Q[13]-=Q[1]*l+Q[5]*C+Q[9]*T,Q[14]-=Q[2]*l+Q[6]*C+Q[10]*T}return Q},shutdown:function(){var d=this._device;d&&d.isPresenting&&d.exitPresent()},isPresenting:function(){var o=this._device;return o&&o.isPresenting},_copyProjectMatrix:function(W){var G=this.dup(W),o=this._scaleFactor;return G[14]*=o,G},dup:function(Z,S){for(var z=Z.length,d=S||new Array(z);z--;)d[z]=Z[z];return d},getViewMatrix:function(g){var m=this._viewMatrix;return m?this.dup(m,g):void 0},getProjectMatrix:function(){var i=this._projectMatrix;return i?this.dup(i):void 0},submitFrame:function(){var x=this;if(x._enable&&x._deviceInAction){var L=x._device;L&&L.isPresenting&&(L.submitFrame(),x.gv.iv())}},intersectWorld:function(h){var y=this.gv;return y.intersectObjects(h,y.dm().getDatas())},setDevice:function(H){var Z=this;Z._device=H},_injectGraphView:function(){var y,Z,D;return function(F){var k=this.gv;if(!F)return y&&(k.getWidth=y,k.getHeight=Z,k.getDevicePixelRatio=D),void 0;var n=this._device,U=n.getEyeParameters("left"),i=U.renderWidth,Q=U.renderHeight;y=k.getWidth,Z=k.getHeight,D=k.getDevicePixelRatio,k.getWidth=function(){return 2*i},k.getHeight=function(){return Q},k.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(u){var y=this;if(!u)return ln=K.Default.callLater=y._defaultCallLater,void 0;var y=this;ln=K.Default.callLater=function(L,c,e,R){var U=y._device;return U&&U.isPresenting?R?o(function(){ln(L,c,e)},R):U.requestAnimationFrame(function(){y._deviceInAction=!0,L.apply(c,e),y._deviceInAction=!1}):y._defaultCallLater(L,c,e,e)}}}),m.defineProperties(Jq.prototype,{enable:{get:function(){return this._enable},set:function(u){var f=this;f._enable!==u&&(f._enable=u,u?(f.switch.showButton(),f._injectCallLaterFunc(!0)):(f.shutdown(),f.switch.hideButton(),f._injectCallLaterFunc(!1)),f.fp("enable",!u,u))}},measureOflength:{get:function(){return this._measureOflength},set:function(h){this._measureOflength=h;var e=this._scaleFactor=1/h;this._controllers.forEach(function(J){J&&J._setScaleFactor(e)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(b){this._eyesOffset=b}},controllerModel:{get:function(){return this._controllerModel},set:function(m){var $;"object"==typeof m?($=m.mtl,m=m.obj):($=m+".mtl",m+=".obj");var k=this,a=k._controllerModel;a&&a.obj===m&&a.mtl===$||(a=k._controllerModel={obj:m,mtl:$},V.loadObj(m,$,{finishFunc:function(f,J){k._controllerModel===a&&V.setShape3dModel("vrControllerModel",J)}}))}},interactive:{get:function(){return!!this._interactive},set:function(V){!!V!=!!this._interactive&&(this._interactive=V,V&&this.addController(0),this.gv.getCoreInteractor().enableVR(V))}}});var lg=function(H,s){function g(Y){var T=navigator.getGamepads&&navigator.getGamepads();if(T)for(var f=0,C=0,v=T.length;v>f;f++){var F=T[f];if(F){var l=F.id;if("OpenVR Gamepad"===l||"OpenVR Controller"===l||0===l.indexOf("Oculus Touch")||0===l.indexOf("Spatial Controller")){if(C===Y)return F;C++}}}}function P(A,t,q){return Math.abs(A[0]-t[0])<q&&Math.abs(A[1]-t[1])<q&&Math.abs(A[2]-t[2])<q?!0:!1}var n=this;n.vr=H,n.id=s;var N,y,U=[0,0],I=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],o=new hi;o.s("shape3d","vrControllerModel"),o.isController=!0,o.s("intersect",!1),n.getGamepad=function(){return y},n.getButtonState=function(l){I.forEach(function(Q){return Q.id===l?Q.pressed:void 0})},n.getNode=function(){return o};var B=.003;n.setRotationEpsilon=function(t){B=t};var j=5e-4,a=j;n.setPositionEpsilon=function(Z){j=Z,a=Z*n.vr._scaleFactor},n._setScaleFactor=function(w){o.s3(w,w,w),a=j*w},n._setScaleFactor(n.vr._scaleFactor);var Z,Y=new Sp,w=new vl,F=[0,0,0],_=[0,0,0],e=new vh,A=new cl,x=new Ok;n.getRay=function(){return Z?(x.origin.fromArray(F),x.direction.copy(A),Z=!1,x):x},n.update=function(){if(N=y,y=g(s),N!=y&&console.log("gamepad changed",y),!y||y.pose===z)return y=null,o.s("3d.visible",!1),void 0;if(V.getShape3dModel("vrControllerModel")){o.dm()||H.gv.dm().add(o),o.s("3d.visible",!0);var x=y.pose;if(null!==x){x.position&&(n.vr.toViewPosition(x.position,F),P(o.p3(),F,a)||(Z=!0,o.p3(F))),x.orientation&&(Y.fromArray(x.orientation),A.set(0,0,-1).applyQuaternion(Y).normalize(),w.makeRotationFromQuaternion(Y),e.set(0,0,0,o.getRotationMode(),!0).setFromRotationMatrix(w),_[0]=e.x,_[1]=e.y,_[2]=e.z,P(o.r3(),_,B)||(Z=!0,o.r3(_))),Z&&H.fp("gamepad.pose",null,{position:F,rotation:_,id:s});var b=y.axes;(U[0]!==b[0]||U[1]!==b[1])&&(U=[b[0],b[1]],H.fp("gamepad.axes",null,{id:s,axes:U}));var k,l,q,R,j=y.buttons;for(k=0,l=j.length;l>k;k++)q=j[k],R=q.pressed,R!==I[k].pressed&&(I[k].pressed=R,H.fp("gamepad.button."+I[k].id,null,{id:s,_62O:R?"down":"up"}))}}}},sh=function(G){this.vr=G,this._button=null};ne(sh,m,{showButton:function(){var K=this.assureButton();if(!K.parentNode){var r=this.vr.gv,v=r.getView();r._79O?v.insertBefore(K,r._79O):v.appendChild(K)}},hideButton:function(){var K=this._button;K&&K.parentNode&&K.parentNode.removeChild(K)},assureButton:function(){var z=this._button;return z?z:this._button=this.createButton(this.vr.gv)},createButton:function(W){function T(s,k){s.textContent=k&&k.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function J(b){L.style.display="",L.style.cursor="pointer",L.style.left="calc(50% - 50px)",L.style.width="100px",T(L,b),L.onmouseenter=function(){L.style.opacity="1.0"},L.onmouseleave=function(){L.style.opacity="0.5"},L.onclick=function(){b.isPresenting?b.exitPresent():b.requestPresent([{source:W.getCanvas()}])},W.vr.setDevice(b)}function n(){L.style.display="",L.style.cursor="auto",L.style.left="calc(50% - 75px)",L.style.width="150px",T(L,null),L.onmouseenter=null,L.onmouseleave=null,L.onclick=null,W.vr.setDevice(null)}function H(r){r.style.position="absolute",r.style.bottom="20px",r.style.padding="12px 6px",r.style.border="1px solid #fff",r.style.borderRadius="4px",r.style.color="#000",r.style.font="normal 13px sans-serif",r.style.textAlign="center",r.style.opacity="0.5",r.style.outline="none",r.style.zIndex="999"}if("getVRDisplays"in navigator){var L=this._button=I.createElement("button");return L.style.display="none",H(L),p.addEventListener("vrdisplayconnect",function(W){J(W.display)},f),p.addEventListener("vrdisplaydisconnect",function(){n()},f),p.addEventListener("vrdisplaypresentchange",function(m){T(L,m.display),W.vr.onVRDisplayPresentChange()},f),navigator.getVRDisplays().then(function(C){C.length>0?J(C[0]):n()}),L}var o=I.createElement("a");return o.href="https://webvr.info",o.innerHTML="当前不支持 webvr",o.style.left="calc(50% - 90px)",o.style.width="180px",o.style.textDecoration="none",H(o),o}}),m.defineProperties(sh.prototype,{});var pf=K.graph3d.PostProcessing=function(E){function x(){if(!r){var B=E.getGL();r=new Ak.RenderTarget(E,B),W=new Xf.Shader(B,w.vs,w.fs),g=Xf.Buffer.createIndexBuffer(B,new Uint16Array([0,2,1,1,2,3])),v=Xf.Buffer.createVertexBuffer(B,new Float32Array([0,0,1,0,0,1,1,1]))}}var r,W,g,v,b=this,t={},o=!1;!function(){var U;for(U in pf)t[U]=new pf[U](E)}(),b.getModule=function(T){return T?t[T]:t},b.getModuleList=function(){return m.keys(t)},b.handleDataModleChange=function(L,K){L&&(L.setPostProcessingData(b.serialize()),L.ump(b.onDataModelPropertyChange,b)),K&&(K.mp(b.onDataModelPropertyChange,b),b.deserialize(K.getPostProcessingData()))},b.onDataModelPropertyChange=function(U){"serialize"===U.property?E.dm().setPostProcessingData(b.serialize()):"deserialize"===U.property&&b.deserialize(E.dm().getPostProcessingData())},b.serialize=function(){var A,G,L,y={};for(A in t)G=t[A],y[A]={enable:G.enable},L=G.serializeProperties,L&&L.forEach(function(V){y[A][V]=G[V]});return y},b.deserialize=function(v){if(v){var z,D,d,_;for(z in v){D=t[z],d=v[z],b.enableModule(z,d.enable);for(_ in d)"enable"!==_&&(D[_]=d[_])}}else{var z,D;for(z in t)D=t[z],D.enable=!1,D.resetProperties&&D.resetProperties()}},b.enableModule=function(H,A){var V,L,Q,c=H.split(",");for(V=0,L=c.length;L>V;V++)Q=c[V].trim(),t[Q]&&(t[Q].enable=A);o=!1;for(Q in t)if(t[Q].enable){o=!0;break}o&&x()};var w={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};b._42=function(d,p,n,U,B){if(o&&!B){r.setSize(d,p,n),Ji(d,r.frame),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),E.setViewport(d,0,0,p,n),U();var a,q=r;for(a in t)q=t[a]._42(d,q)||q;return Ji(d,null),E.setViewport(d,0,0,p,n),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),W.bind(),d.activeTexture(d.TEXTURE0+0),d.bindTexture(d.TEXTURE_2D,q.texture),W.uniforms.image=0,g.upload(),v.upload(),W.attributes.pos.pointer(v),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),d.bindTexture(d.TEXTURE_2D,null),d.useProgram(E._prg),!0}}},Xb=K.graph3d.PostProcessing.Bloom=function(c){function j(){T=!0,P=[c.getWidth(),c.getHeight()];var H,$=c.getGL(),V=Math.round(P[0]/2),w=Math.round(P[1]/2);for(Y=new Ak.RenderTarget(c,$,V,w),H=0;f>H;H++)n.push(new Ak.RenderTarget(c,$,V,w)),M.push(new Ak.RenderTarget(c,$,V,w)),V=Math.round(V/2),w=Math.round(w/2);k=new Xf.Shader($,Xb.highPassShader.vs,Xb.highPassShader.fs);for(var H=0;f>H;H++)u[H]=new Xf.Shader($,Xb.blurShader.vs,Xb.blurShader.fs.replace(/DEFINE_VALUE/g,r[H]));I=new Xf.Shader($,Xb.compositeShader.vs,Xb.compositeShader.fs.replace(/NUM_MIPS/g,f)),b=new Xf.Shader($,Xb.finalShader.vs,Xb.finalShader.fs),N=Xf.Buffer.createIndexBuffer($,new Uint16Array([0,2,1,1,2,3])),U=Xf.Buffer.createVertexBuffer($,new Float32Array([0,0,1,0,0,1,1,1]))}var o,K,X,N,U,B=this,D=!1,T=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){o=1.5,K=.55,X=.4},m.defineProperties(B,{enable:{get:function(){return D},set:function(i){!!D!=!!i&&(D=i,i&&!T&&j())}},strength:{get:function(){return o},set:function(S){o=S}},threshold:{get:function(){return K},set:function(L){K=L}},radius:{get:function(){return X},set:function(U){X=U}}}),this.resetProperties();var Y,k,I,b,P=[256,256],n=[],M=[],f=5,r=[3,5,7,9,11],u=[];B._42=function(B,h){function w(L,$,S,s){Ji(B,$.frame),c.setViewport(B,0,0,$.width,$.height),s?s(B):B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT),V!==L&&L.bind();var p=0;for(var C in S){var v=S[C];v instanceof WebGLTexture&&(B.activeTexture(B.TEXTURE0+p),B.bindTexture(B.TEXTURE_2D,v),v=p,p++),L.uniforms[C]=v}for(V!==L&&(N.upload(),U.upload(),L.attributes.pos.pointer(U),V=L),B.drawElements(B.TRIANGLES,6,B.UNSIGNED_SHORT,0);p--;)B.activeTexture(B.TEXTURE0+p),B.bindTexture(B.TEXTURE_2D,null)}if(D){var V;w(k,Y,{smoothWidth:.01,luminosityThreshold:K,tDiffuse:h.texture});var t,$=Y,x=Math.round(P[0]/2),F=Math.round(P[1]/2);for(t=0;f>t;t++)w(u[t],n[t],{colorTexture:$.texture,direction:[1,0],texSize:[x,F]}),w(u[t],M[t],{colorTexture:n[t].texture,direction:[0,1],texSize:[x,F]}),x=Math.round(x/2),F=Math.round(F/2),$=M[t];return w(I,n[0],{blurTexture1:M[0].texture,blurTexture2:M[1].texture,blurTexture3:M[2].texture,blurTexture4:M[3].texture,blurTexture5:M[4].texture,bloomStrength:o,bloomRadius:X,bloomTintColor:[1,1,1]}),w(b,h,{image:n[0].texture},function(s){s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.SRC_ALPHA,s.ONE)}),B.blendEquationSeparate(B.FUNC_ADD,B.FUNC_ADD),B.blendFuncSeparate(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA),h}}};Xb.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},Xb.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},Xb.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},Xb.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};var $m=K.graph3d.PostProcessing.Fxaa=function(e){function h(){i=!0;var t=e.getGL();K=new Xf.Shader(t,$m.ShaderSource.vs,$m.ShaderSource.fs),R=Xf.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),N=Xf.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1])),s=new Ak.RenderTarget(e,t)}var R,N,K,s,c=this,z=!1,i=!1;m.defineProperties(c,{enable:{get:function(){return z},set:function(G){!!z!=!!G&&(z=G,G&&!i&&h())}}}),c._42=function(p,d){function j(T,G,Y,r){Ji(p,G.frame),e.setViewport(p,0,0,G.width,G.height),r?r(p):p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),T.bind();var Z=0;for(var t in Y){var j=Y[t];j instanceof WebGLTexture&&(p.activeTexture(p.TEXTURE0+Z),p.bindTexture(p.TEXTURE_2D,j),j=Z,Z++),T.uniforms[t]=j}for(R.upload(),N.upload(),T.attributes.pos.pointer(N),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0);Z--;)p.activeTexture(p.TEXTURE0+Z),p.bindTexture(p.TEXTURE_2D,null)}if(z){var C=d.width,G=d.height;return s.setSize(p,C,G),j(K,s,{tDiffuse:d.texture,resolution:[1/C,1/G]}),s}}};$m.ShaderSource={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immedates.","    // Immedates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},Sm(V,{accordionViewExpandIcon:pp(Im),accordionViewCollapseIcon:pp(Im,!0),accordionViewLabelColor:de,accordionViewLabelFont:Fh,accordionViewTitleBackground:Bi,accordionViewSelectBackground:vc,accordionViewSelectWidth:3,accordionViewSeparatorColor:z,splitViewDividerSize:1,splitViewDividerBackground:Bi,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:zs,rect:[2,2,12,12],background:Im}]},propertyViewLabelColor:Lg,propertyViewLabelSelectColor:de,propertyViewLabelFont:Fh,propertyViewExpandIcon:pp(Od),propertyViewCollapseIcon:pp(Od,!0),propertyViewBackground:Mr,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Vb,propertyViewColumnLineColor:Vb,propertyViewSelectBackground:vc,listViewLabelColor:Lg,listViewLabelSelectColor:de,listViewLabelFont:Fh,listViewRowLineVisible:!1,listViewRowLineColor:Vb,listViewSelectBackground:vc,treeViewLabelColor:Lg,treeViewLabelSelectColor:de,treeViewLabelFont:Fh,treeViewExpandIcon:pp(ss),treeViewCollapseIcon:pp(ss,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Vb,treeViewSelectBackground:vc,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Lg,tableViewLabelSelectColor:de,tableViewLabelFont:Fh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Vb,tableViewColumnLineColor:Vb,tableViewSelectBackground:vc,treeTableViewLabelColor:Lg,treeTableViewLabelSelectColor:de,treeTableViewLabelFont:Fh,treeTableViewExpandIcon:pp(ss),treeTableViewCollapseIcon:pp(ss,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Vb,treeTableViewColumnLineColor:Vb,treeTableViewSelectBackground:vc,tableHeaderLabelColor:Lg,tableHeaderLabelFont:Fh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:hs,tableHeaderBackground:Mr,tableHeaderMoveBackground:vs,tableHeaderInsertColor:vc,tableHeaderSortDescIcon:mp(Od,!0),tableHeaderSortAscIcon:mp(Od),tabViewTabGap:1,tabViewLabelColor:de,tabViewLabelFont:Fh,tabViewTabBackground:Bi,tabViewSelectWidth:3,tabViewSelectBackground:vc,tabViewMoveBackground:vs,tabViewInsertColor:vc,toolbarLabelColor:Lg,toolbarLabelSelectColor:de,toolbarLabelFont:Fh,toolbarBackground:Mr,toolbarSelectBackground:vc,toolbarItemGap:8,toolbarSeparatorColor:Oi},!0);
var lo={translateX:1,sortColumn:1},On={sortable:1,sortOrder:1,sortFunc:1},Co={focusData:1},lj={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},gl={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},qj=function(G,X){X.add(G),G.hasChildren()&&G.eachChild(function(J){qj(J,X)})},el=function($,Q,q,R,a,U,E,m,f,S,j){var d,h=q.getValueType(S),N=q.getAlign(S);if(q.getEnumValues(S)){var v=q.toEnumLabel(Q,S),u=vg||0,p=0,L=U,W=V.getTextSize(R,v).width;return d=tn(q.toEnumIcon(Q,S)),d&&(p=U+vg/2,"center"===N?p+=(m-(u+W))/2:"right"===N&&(p=p+m-(u+W)),Uo($,d,p,E+f/2,S,j),L=p+vg/2),v!=G&&(d?bl($,v,R,a,L,E,m-(L-U),f):bl($,v,R,a,U,E,m,f,N)),void 0}return Q=q.formatValue(Q),Q!=G?h===ii?(Ig($,U,E,m,f,Q),void 0):h===Dc||!h&&Rk(Q)?(d=tn(Q?Pr:qe),Uo($,d,U+m/2,E+f/2,S,j),void 0):(bl($,Q,R,a,U,E,m,f,N),void 0):void 0},Xh=function(w,P){var Q=P.view,c=Zk(w),_=P.column||P.property;Q.getDataModel().beginTransaction(),P.editor=w,w.info=P,Q.setCurrentEditor(w),Q.getView().insertBefore(c,Q._79O),op(w,P.editorRect),w.setFocus?w.setFocus():Rg(w),w.commitValue=function(l,t){w._17Q&&(w=w._17Q),t||Q.setValue(P.data,_,w.getValue?w.getValue():w.value),w.close&&w.close(),Nl(c)},_.onEditorCreated&&_.onEditorCreated(P)},Cm=function(z,J,h,d,U){var c=vn(z,h),b=J.value,g=J.view,l=U.getValueType(J.data);return c.onblur=c.onchange=function(){g.endEditing()},"input"===z?(b=U.formatValue(b),b!=G&&(c.value=b),c.onkeydown=function(M){Nd(M)?g.endEditing():me(M)&&g.endEditing(!0)},(l===ek||l===Fq)&&c.addEventListener(Bo,V.numberListener,f)):z===ks&&d.forEach(function(m){var f=I.createElement("option");f.innerHTML=U.toEnumLabel(m),f.value=m,U.isEnumEqual(b,m)&&(f.selected=!0),Mk(c,f)}),Xh(c,J),c},ee=K.widget={},hj=function(I,b,r){ne(q+".widget."+I,b,r)};Sm(Xm,{ms_value:function(T){T.getValue=function(I){var o=this.getItemById(I),A=o.element;return ed(A)?A:A?A.getValue?A.getValue():A.value:o.selected},T.setValue=function(v,d){var q=this.getItemById(v);if(q){var c=q.element;c&&!ed(c)?c.setValue?c.setValue(d):c.value=d:Rk(d)?(q.selected=d,this.iv()):(q.element=d,this.iv())}},T.v=function(d,r){var N=this;if(2===arguments.length)N.setValue(d,r);else{if(!ag(d))return N.getValue(d);for(var V in d)N.setValue(V,d[V])}return N}},_46o:function(b){b._icon=G,b._accessType=G,b._valueType=G,b._editable=!1,b._batchEditable=!0,b._align=kh,b._nullable=!0,b._emptiable=!1,b.setParent=dm,b.formatValue=function(S){var p=this,o=p._valueType;return p.getEnumValues()?p.toEnumLabel(S):o===Dc?!!S:S!=G&&o===ek?a(S):S},b.setEnum=function(O,r,M,h,k,e,f){var U=this;O&&!Ul(O)&&O.values&&(h=O.editable,M=O.icons,r=O.labels,k=O.strict,e=O.maxHeight,f=O.dropDownWidth,O=O.values),mb(O)&&(O=O._as),mb(r)&&(r=r._as),mb(M)&&(M=M._as),U._enumValues=O,U._enumLabels=r,U._enumIcons=M,U._enumEditable=h,U._enumStrict=k==G?!0:k,U._enumMaxHeight=e,U._enumDropDownWidth=f,O&&O.length&&Mj(O[0])&&(U._valueType=Fq),U.fp("enum",!1,!0)},b.getEnumDropDownWidth=function(){return this._enumDropDownWidth},b.getEnumMaxHeight=function(){return this._enumMaxHeight},b.isEnumEditable=function(){return this._enumEditable},b.getEnumValues=function(){return this._enumValues},b.getEnumLabels=function(){return this._enumLabels},b.getEnumIcons=function(){return this._enumIcons},b.isEnumStrict=function(){return this._enumStrict},b.isEnumEqual=function(h,L){return this._enumStrict?h===L:h==L},b.toEnumLabel=function(Z,W){var D=this,T=D.getEnumValues(W),S=D.getEnumLabels(W);if(T&&S)for(var a=0;a<T.length;a++)if(D.isEnumEqual(Z,T[a]))return S[a];return Z},b.toEnumIcon=function(f,l){var s=this,O=s.getEnumValues(l),A=s.getEnumIcons(l);if(O&&A)for(var p=0;p<O.length;p++)if(s.isEnumEqual(f,O[p]))return A[p];return z}},_45o:function(V){V._87o=function(N,L,h,u,i,_){if(N){var X=this,n=X._90I,t=Rm(1);X._columnLineVisible&&(i-=1),X._rowLineVisible&&(_-=1),0>=i||0>=_||(X._90I||(n=X._90I={}),n[L]||(n[L]=new fl),op(t,X.tx()+h,X.ty()+u,i,_),Mk(t,N),X._view.insertBefore(t,X._79O),N.onParentAdded&&N.onParentAdded(t),n[L].add(t))}},V._76o=function(){var n=this,$=n._90I;if($){for(var z in $)$[z].each(function(c){Nl(c)});delete n._90I}},V._77o=function(E){var l=this;if(l._90I){var t=l._90I[E];t&&(t.each(function(w){Nl(w)}),delete l._90I[E])}}},_47o:function(T){T.getValue=function(S,h){return h.getValue?h.getValue(S,h,this):Yq(S,h.getAccessType(),h.getName())},T.setValue=function(p,R,s){if(R.isEmptiable(p)||""!==s||(s=z),R.isNullable(p)||s!=G){var v=this,b=R.getName(p),Y=R.getAccessType(p),I=R.getValueType(p);I===ek&&ed(s)?s=_(s):I===Fq&&ed(s)?s=parseFloat(s):I===Dc&&ed(s)&&(s="true"===s),v._batchEditable&&R._batchEditable&&v.isSelected(p)?v.sm().each(function(D){R.setValue?R.setValue(D,R,s,v):cb(D,Y,b,s)}):R.setValue?R.setValue(p,R,s,v):cb(p,Y,b,s)}},T.setCurrentEditor=function(L){this.endEditing(),this._currentEditor=L,this.redraw()},T.isEditing=function(C,s){var O=this,N=O._currentEditor;if(!N)return!1;if(s){var l=N.info;return l?(l.column||l.property)===s&&l.data===C:!1}return!0},T.endEditing=function(K){var E=this,t=E._currentEditor;t&&(delete E._currentEditor,t.commitValue&&t.commitValue(t.info,K),E.redraw(),E.getDataModel().endTransaction())},T.beginEditing=function(S){this.endEditing();var a=this,x=S.column||S.property;if(x.beginEditing)x.beginEditing(S);else{var E=S.data,o=S.value,H=a.getSelectBackground(E),L=x.getEnumValues(E),c=x.getSlider(E),O=x.getColorPicker(E);if(c){var d=Wd(ee.Slider,c);return d.setValue(o),d.getView().onblur=function(){a.endEditing()},d.isInstant()&&(d.onValueChanged=function(){a.setValue(E,x,d.getValue())}),Xh(d,S),void 0}if(O||x.getValueType(E)===ii){var h=Wd(ee.ColorPicker,O);return h.setValue(o),h.onClosed=function(){a.endEditing()},h.isInstant()&&(h.onValueChanged=function(R,u){a.setValue(E,x,u)}),Xh(h,S),h.open(),void 0}if(L){if(ee.ComboBox){var _=new ee.ComboBox;_.setValue(o),_.setValues(L),_.setLabels(x.getEnumLabels(E)),_.setIcons(x.getEnumIcons(E)),_.setEditable(x.isEnumEditable(E)),_.setStrict(x.isEnumStrict(E)),_.setMaxHeight(x.getEnumMaxHeight(E)),_.setDropDownWidth(x.getEnumDropDownWidth(E)),_.onClosed=function(){a.endEditing()},Xh(_,S),_.open()}else Cm(ks,S,H,L,x);return}var m=x.getValueType(E);if(m===Dc||Rk(o))return a.setValue(E,x,!o),void 0;if(x.getItemEditor(E)){var M=ah(x.getItemEditor(E)),V=new M(E,x,a,S),q=V.getView();return q._17Q=V,V.setValue(o),_r(q),Xh(q,S),V.editBeginning&&V.editBeginning(),void 0}Cm("input",S,H,G,x)}}},_44o:function(v){v.init=function(w){var g=this,m=g.th=new Aq(w),i=g._view=yn(1,g);g.tv=g._tableView=w,Mk(i,m.getView()),Mk(i,w.getView()),m.mp(function(H){H.property===dd&&g.iv()}),g.iv()},v.getTableView=function(){return this.tv},v.getTableHeader=function(){return this.th},v.getDataModel=function(){return this.tv.dm()},v.getColumnModel=function(){return this.tv.getColumnModel()},v.setColumns=function(J){this.tv.setColumns(J)},v.addColumns=function(g){this.tv.addColumns(g)},v.endEditing=function(){this.tv.endEditing()},v.validateImpl=function(){var L=this,e=L.th,t=Zd(e),R={x:0,y:0,width:L.getWidth(),height:t};op(e,R),R.y=t,R.height=W(0,L.getHeight()-t),op(L.tv,R)}},ms_vs:function(I){I._41o=function(){return this._29I.height<this._59I},I._43o=function(){var q=this;q._41o()&&(q._58I||(o(function(){q._94O()},Gi),q.iv()),q._58I=new Date)},I._94O=function(){var v=this;if(v._58I){var w=new Date;w.getTime()-v._58I.getTime()>=Gi?(delete v._58I,v.iv()):o(function(){v._94O()},Gi)}},I._93I=function(){var F=this,D=F._27I;if(F._58I||!F._autoHideScrollBar){D||Mk(F._79O,D=F._27I=Rm());var K=F._29I,O=K.height,Z=F._59I,z=F.getScrollBarSize(),P=K.width-z-2,j=O*(-F.ty()/Z),U=O*(O/Z),V=D.style;Z>O?(Bc>U&&(j=j+U/2-Bc/2,0>j&&(j=0),j+Bc>O&&(j=O-Bc),U=Bc),V.visibility=Re,V.background=F.getScrollBarColor(),V.borderRadius=z/2+un,op(D,P,j,z,U)):V.visibility=Db}else D&&(D.style.visibility=Db)}},ms_hs:function(m){m._40o=function(){return this._29I.width<this._91I},m._42o=function(){var y=this;y._40o()&&(y._95O||(o(function(){y._94I()},Gi),y.iv()),y._95O=new Date)},m._94I=function(){var e=this;if(e._95O){var S=new Date;S.getTime()-e._95O.getTime()>=Gi?(delete e._95O,e.iv()):o(function(){e._94I()},Gi)}},m._92I=function(){var W=this,i=W._28I;if(W._95O||!W._autoHideScrollBar){i||Mk(W._79O,i=W._28I=Rm());var o=W._29I,J=o.width,K=W._91I,Y=W.getScrollBarSize(),S=o.height-Y-2,X=J*(-W.tx()/K),u=J*(J/K),v=i.style;K>J?(Bc>u&&(X=X+u/2-Bc/2,0>X&&(X=0),X+Bc>J&&(X=J-Bc),u=Bc),v.visibility=Re,v.background=W.getScrollBarColor(),v.borderRadius=Y/2+un,op(i,X,S,u,Y)):v.visibility=Db}else i&&(i.style.visibility=Db)}}}),dp(Pr,Cl(16,16,[{type:zn,rect:[1,1,14,14],background:vc},{type:iq,rect:[1,1,14,14],width:1,color:Dj},{type:nh,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),dp(qe,Cl(16,16,{type:iq,rect:[1,1,14,14],width:1,color:Dj})),dp(Bm,Cl(16,16,[{type:Xe,rect:[2,2,12,12],borderWidth:1,borderColor:Dj,background:"#FFF"},{type:Xe,rect:[4,4,8,8],background:vc}])),dp(Lo,Cl(16,16,{type:Xe,rect:[2,2,12,12],borderWidth:1,borderColor:Dj})),Xm._15Q=function(O){O._29I=ai,O._59I=0,O._91I=0,O._5o=function(c){var k=this;k._30I=new fl,k._rows=new fl,k._rowMap={},k._31I=0,k._14I=0,k._view=yn(1,k),k._canvas=$p(k._view),Mk(k._view,k._79O=Rm()),k.dm(c?c:new rl)},O.getCheckIcon=function(t){var s=this.sm(),u=s.co(t);return s.sg()?tn(u?Bm:Lo):tn(u?Pr:qe)},O.checkData=function(o){var L=this.sm(),J=L.co(o);L.sg()&&J||(this._32o=1,J?L.rs(o):L.as(o),delete this._32o)},O.getDataAt=function(C){C.target&&(C=this.lp(C));var D=y(C.y/this._rowHeight),a=this._rows;return 0>D||D>=a.size()?G:a.get(D)},O.onDataDoubleClicked=function(){},O.onDataClicked=function(){},O.adjustTranslateX=function(){return 0},O.adjustTranslateY=function(x){var d=this.getHeight()-this._59I;return d>x&&(x=d),x>0?0:a(x)},O.onPropertyChanged=function(F){var h=this,Q=F.property;lj[Q]?h.ivm():Co[Q]||h.redraw(),Q===Tg?h._42o():Q===oh&&h._43o()},O.getLabel=function(C){return C.toLabel()},O.getLabelFont=function(){return this._labelFont},O.getLabelColor=function(m){var z=this;if(z.isCheckMode()){if(z._focusData===m)return z._labelSelectColor}else if(z.isSelected(m))return z._labelSelectColor;return z._labelColor},O.getStartRowIndex=function(){return this._31I},O.getEndRowIndex=function(){return this._14I},O.getRowDatas=function(){return this._rows},O.getRowIndex=function(r){return this._rowMap[r._id]},O.getRowSize=function(){return this._rows.size()},O.getViewRect=function(){return Cn(this._29I)},O.isVisible=function(w){return this._visibleFunc?this._visibleFunc(w):!0},O.getCurrentSortFunc=function(){return this._sortFunc},O.setDataModel=function(U){var d=this,f=d._dataModel,I=d._selectionModel;f!==U&&(f&&(f.umm(d.handleDataModelChange,d),f.umd(d.handleDataPropertyChange,d),f.umh(d.handleHierarchyChange,d),I||f.sm().ums(d.handleSelectionChange,d)),d._dataModel=U,U.mm(d.handleDataModelChange,d),U.md(d.handleDataPropertyChange,d),U.mh(d.handleHierarchyChange,d),I?I._21I(U):U.sm().ms(d.handleSelectionChange,d),d.fp("dataModel",f,U))},O.validateModel=function(){var r=this;r._rows.clear(),r._rowMap={},r.buildChildren(r._dataModel._roots);var t=r._rows=r._rows.toList(r.isVisible,r),A=0,G=r.getCurrentSortFunc(),P=t.size();for(G&&t.sort(G);P>A;A++)r._rowMap[t.get(A)._id]=A},O.buildChildren=function(l){var Q=this;l.each(function(W){Q._rows.add(W),Q.buildChildren(W._children)})},O.handleDataModelChange=function(){this.ivm()},O.handleDataPropertyChange=function(G){"parent"===G.property?this.ivm():this.invalidateData(G.data)},O.handleHierarchyChange=function(){this.ivm()},O.handleSelectionChange=function($){$.datas.each(this.invalidateData,this),this.onSelectionChanged($)},O.onSelectionChanged=function(n){var $=this,e=$.sm();!$.isAutoMakeVisible()||1!==e.size()||"set"!==n.kind&&"append"!==n.kind||$._32o||$.makeVisible(e.ld())},O.handleBackgroundClick=function(l){Tl(l)&&!this.isCheckMode()&&this.sm().cs()},O.makeVisible=function(T){T&&(this._23I=T,this.iv())},O.scrollToIndex=function(S){var $=this,r=$._29I,C=r.height,Y=$._rowHeight,F=Y*S;S>=0&&S<$._rows.size()&&C>0&&(F+Y>r.y+C?$.ty(-F+C-Y):F<r.y&&$.ty(-F))},O.autoScroll=function(r,I){var h=this,f=h._rowHeight,e=f,d=f/4,T=h._29I,y=h.lp(r),C={x:h.tx(),y:h.ty()};return f>0&&T&&(y.x-T.x<e?h.translate(d,0):T.x+T.width-y.x<e&&h.translate(-d,0),y.y-T.y<e?h.translate(0,d):T.y+T.height-y.y<e&&h.translate(0,-d)),C.x=h.tx()-C.x,C.y=h.ty()-C.y,I&&(I.x+=C.x,I.y+=C.y),C},O.getTopRowOrderSelection=function(){var j=this.sm().getTopSelection(),Z={},O=new fl;return j.each(function(w){Z[w._id]=w}),this._rows.each(function(b){Z[b._id]&&O.add(b)}),O},O.getRowOrderSelection=function(){var Y=new fl;return this._rows.each(function(l){this.isSelected(l)&&Y.add(l)},this),Y},O.ivm=function(){this.invalidateModel()},O.invalidateModel=function(){var u=this;u._96I||(u._96I=1,u._32I=1,delete u._24I),u.iv()},O.redraw=function(){var E=this;E._32I||(E._32I=1,delete E._24I,E.iv())},O.invalidateData=function(t){var b=this;X?b.redraw():b._32I||(b._24I||(b._24I={}),b._24I[t._id]=t,b.iv())},O.getFocusData=function(){return this._focusData},O.setFocusDataById=function(e){this.setFocusData(this.dm().getDataById(e))},O.setFocusData=function(Z){var o=this,$=o._focusData;$!==Z&&(o._focusData=Z,o.fp("focusData",$,Z),$&&o.invalidateData($),Z&&(o.invalidateData(Z),o.isAutoMakeVisible()&&o.makeVisible(Z)))},O.drawRowBackground=function(g,p,J,k,T,i,F){var a=this,A=a.isCheckMode();(p===a._focusData&&A||J&&!A)&&Ig(g,k,T,i,F,a.getSelectBackground(p))},O.drawData=function(v,L,x){var n=this,j=n._rowHeight,_=j*x,o=n._29I,M=o.x,P=o.width;v.save(),v.beginPath(),v.rect(M,_,P,j),v.clip(),n._87o(n.drawRow(v,L,n.isSelected(L),M,_,P,j),x,M,_,P,j),v.restore(),n._rowLineVisible&&Ig(v,M,_+j-1,P,1,n._rowLineColor)},O._12I=function(e){var Y=this,k=Y._31I,z=Y._29I,b=z.x,g=z.y,P=z.width,p=z.height;for(e.beginPath(),e.rect(b,g,P,p),e.clip(),e.clearRect(b,g,P,p),Y._76o(),Y._93db(e);k<Y._14I;k++)Y.drawData(e,Y._rows.get(k),k);Y._92db(e)},O._13I=function($){for(var M,d=this,O=d._rowHeight,z=d._29I,X=z.x,Y=z.width,x=d._31I,w=d._30I;x<d._14I;x++)M=d._rows.get(x),d._24I[M._id]&&w.add({data:M,index:x});w.isEmpty()||($.beginPath(),w.each(function(v){$.rect(X,v.index*O,Y,O)}),$.clip(),w.each(function(j){$.clearRect(X,j.index*O,Y,O)}),w.each(function(n){d._77o(n.index)}),d._93db($),w.each(function(g){d.drawData($,g.data,g.index)}),d._92db($),w.clear())},O.preValidateModel=function(){this.endEditing&&this.endEditing()},O.validateImpl=function(){var M=this,p=M._canvas,U=M.getWidth(),I=M.getHeight(),Z=M._rowHeight,B=M._32I;(U!==p.clientWidth||I!==p.clientHeight)&&(Hp(p,U,I),B=1);var z=J&&!n;M._96I&&!z&&(M.preValidateModel(),M.validateModel());var e=M._29I,A={x:-M.tx(),y:-M.ty(),width:U,height:I},g=M._rows.size(),r=vd(p),x=M._23I;B||Hn(A,e)||(B=1),M._29I=A,M._59I=g*Z,M._31I=y(A.y/Z),M._14I=j((A.y+A.height)/Z),M._31I<0&&(M._31I=0),M._14I>g&&(M._14I=g),M._99I&&B&&M._99I(),df(r,M.tx(),M.ty(),1),B?M._12I(r):M._24I&&M._13I(r),M._93I(),M._92I(),r.restore(),M._32I=M._24I=M._96I=G,x&&(M.scrollToIndex(M.getRowIndex(x)),delete M._23I),M.tx(M.tx()),M.ty(M.ty())}},Xm._48o=function(Q){Q._rootVisible=!0,Q._rootData=G,Q._35o=function(){this._expandMap={},this._levelMap={}},Q.validateModel=function(){var g=this,r=g._rootData;g._rows.clear(),g._levelMap={},g._rowMap={},g._currentLevel=0,r?g._rootVisible?g.isVisible(r)&&g.buildData(r):g.buildChildren(r):g.buildChildren(),delete g._currentLevel},Q.buildData=function(E){var _=this,i=E._id,H=_._rows;_._rowMap[i]=H.size(),H.add(E),_._levelMap[i]=_._currentLevel,_.isExpanded(E)&&(_._currentLevel++,_.buildChildren(E),_._currentLevel--)},Q.buildChildren=function(u){var J=this,v=u?u._children:J._dataModel._roots,o=J.getCurrentSortFunc();o&&J.isChildrenSortable(u)?v.toList(J.isVisible,J).sort(o).each(J.buildData,J):v.each(function($){J.isVisible($)&&J.buildData($)})},Q.getLevel=function(i){return this._levelMap[i._id]},Q.getToggleIcon=function(V){var l=this,i=l._loader,Y=l._collapseIcon;return i&&!i.isLoaded(V)?Y:V.hasChildren()?l.isExpanded(V)?l._expandIcon:Y:G},Q.isCheckMode=function(){return this._checkMode!=G},Q.isChildrenSortable=function(){return!0},Q.handleDataModelChange=function(U){var z=this;U.kind===fk?delete z._expandMap[U.data._id]:U.kind===Bd&&(z._expandMap={}),z.ivm()},Q.toggle=function(b){var E=this;E.isExpanded(b)?E.collapse(b):E.expand(b)},Q.isExpanded=function(z){return 1===this._expandMap[z._id]},Q.expand=function(F){var $=this,v=$._loader;$.isExpanded(F)||(v&&!v.isLoaded(F)&&v.load(F),$._expandMap[F._id]=1,$.ivm(),$.onExpanded(F))},Q.onExpanded=function(){},Q.collapse=function(b){var e=this;e.isExpanded(b)&&(delete e._expandMap[b._id],e.ivm(),e.onCollapsed(b))},Q.onCollapsed=function(){},Q.expandAll=function(Q){if(Q)this.expand(Q),Q.eachChild(function(m){this.expandAll(m)},this);else{var l=this;l._dataModel.each(function(W){W.hasChildren()&&(l._expandMap[W._id]=1)}),l.ivm()}},Q.collapseAll=function(){this._expandMap={},this.ivm()},Q.makeVisible=function(c){if(c){var w=this;if(!w._rootData||c.isDescendantOf(w._rootData)){for(var K=c._parent;K;)w.expand(K),K=K._parent;w._23I=c,w.iv()}}},Q.checkData=function(y){var E,w=this,r=w._checkMode,s=w.sm(),l=s.co(y);if(!s.sg()||!l){if(w._32o=1,r===Ll)l?s.rs(y):s.as(y);else if(r===Bn)E=new fl(y),E.addAll(y._children);else if("descendant"===r)E=new fl,qj(y,E);else if("all"===r&&(E=new fl,qj(y,E),!l))for(var m=y._parent;m;)E.add(m),m=m._parent;E&&(l?s.rs(E):s.as(E)),delete w._32o}},Q._97I=function(K,w,s,r,u,Z,n){var S=this,O=S._indent,o=S._levelMap[w._id],c=S.getIconWidth(w),G=tn(S.getToggleIcon(w));G?(r+=O*o,Uo(K,G,r+O/2,u+n/2,w,S),r+=O):r+=O*(o+1),S._checkMode&&(Uo(K,S.getCheckIcon(w),r+O/2,u+n/2,w,S),r+=O),S.drawIcon(K,w,r,u,c,n),S.drawLabel(K,w,r+c,u,n)}},Xm._14Q=function(X){X.getIcon=function(x){return x.getIcon()},X.getIconWidth=function(o){return this.getIcon(o)?this._indent:0},X.drawIcon=function(P,_,b,d,B,O){if(B){var l=this,J=l.getBodyColor(_),u=tn(l.getIcon(_),J);u&&(O-=l.isRowLineVisible()?1:0,sm(P,u,Bb,b,d,B,O,_,l,J),Wl(P,l.getBorderColor(_),b,d,B,O))}},X.drawLabel=function(S,W,G,v,j){var C=this;bl(S,C.getLabel(W),C.getLabelFont(W),C.getLabelColor(W),G,v,0,j)}},Xm._50o=function(j){j._98I=function(){var Z=this,r=Z._39o=new rl;Z._60I=new fl,r.mm(Z._17o,Z),r.md(Z._18o,Z),r.mh(Z._19o,Z)},j.setColumns=function(L){this._39o.clear(),this.addColumns(L)},j.addColumns=function(X){var n=this._39o;X.forEach(function(S){if(!(S instanceof $f)){var M=ah(S.className);S=Wd(M?M:$f,S)}n.add(S)})},j.onColumnClicked=function(){},j.onCheckColumnClicked=function(){},j._3Q=function(p){for(var X,S=0,L=this._60I,r=L.size();r>S;S++)if(X=L.get(S),X.column===p)return X;return G},j.getColumnAt=function(u){var f=this._4Q(u);return f?f.column:G},j._4Q=function(E){for(var d=this,V=E.target?d.lp(E).x:E.x,m=d._60I,h=0;h<m.size();h++){var W=m.get(h),Q=W.startX;if(V>=Q&&V<Q+W.column.getWidth())return W}return G},j.getToolTip=function(g){var j=this,f=j.getDataAt(g),s=j.getColumnAt(g);return f&&s?s.getToolTip(f,j):G},j.adjustTranslateX=function(Q){var g=this.getWidth()-this._91I;return g>Q&&(Q=g),Q>0?0:a(Q)},j._99I=function(){var Y=this,X=Y._29I,U=Y._60I;U.clear(),Y._91I=0,Y._39o._roots.each(function(y){if(y.isVisible()){var D=Y._91I+y.getWidth();Y._91I<=X.x+X.width&&D>=X.x&&U.add({column:y,startX:Y._91I}),Y._91I=D}})},j.drawData=function(n,B,m){var Y=this,b=Y._rowHeight,e=b*m,g=Y.isSelected(B),Z=Y._29I,F=Z.x,T=Z.width;Y.drawRowBackground(n,B,g,F,e,T,b),Y._60I.each(function(v){var T=v.column,Z=v.startX,y=T.getWidth();y>0&&!Y.isEditing(B,T)&&(n.save(),n.beginPath(),n.rect(Z,e,y,b),n.clip(),Y._87o(Y.drawCell(n,B,g,T,Z,e,y,b),m,Z,e,y,b),Y._columnLineVisible&&Ig(n,Z+y-1,e,1,b,Y._columnLineColor),n.restore())}),Y._rowLineVisible&&Ig(n,F,e+b-1,T,1,Y._rowLineColor)},j.drawCell=function(R,D,_,m,J,Z,w,j){var S=this;if(m.drawCell)return m.drawCell(R,D,_,m,J,Z,w,j,S);var Y=S.getValue(D,m);el(R,Y,m,S.getLabelFont(D,m,Y),S.getLabelColor(D,m,Y),J,Z,w,j,D,S)},j.getColumnModel=function(){return this._39o},j._17o=function(){this.redraw()},j._18o=function(i){var Y=this;i.data===Y._sortColumn&&On[i.property]?Y.ivm():(Y._42o(),Y.redraw())},j._19o=function(){this.redraw()},j.getCurrentSortFunc=function(){var e=this,G=e._sortColumn;if(G&&G.isSortable()){var Z=G.getSortFunc(),F=Ag===G.getSortOrder()?1:-1;return Z||(Z=sb),function(q,y){return Z.call(e,e.getValue(q,G),e.getValue(y,G),q,y)*F}}return e._sortFunc},j.isCellEditable=function(i,r,n){return r.isEditable()&&this.isEditable()?r.isCellEditable?r.isCellEditable(i,r,n,this):!0:!1},j._37O=function(k,E){if(Tl(E))for(var D=this,U=D.lp(E),Y=D._60I,L=D._rowHeight,Z=D._29I,m=Z.x,V=Z.y,C=Z.width,q=Z.height,c=0;c<Y.size();c++){var T=Y.get(c),b=T.startX,S=T.column,I=S.getWidth();if(S!==D._31o&&S!==D._4o&&U.x>=b&&U.x<b+I&&D.isCellEditable(k,S,E)){var $={x:b,y:D.getRowIndex(k)*L,width:I,height:L},Q={x:$.x+D.tx(),y:$.y+D.ty(),width:$.width,height:$.height},x=0,t=0;return $.x<m?x=$.x-m:$.x+$.width>m+C&&(x=$.x+$.width-m-C),x&&(D.tx(D.tx()-x),Q.x-=x),$.y<V?t=$.y-V:$.y+L>V+q&&(t=$.y+L-V-q),t&&(D.ty(D.ty()-t),Q.y-=t),D.beginEditing({data:k,column:S,value:D.getValue(k,S),event:E,rect:$,editorRect:Q,view:D}),void 0}}}},ee.BaseItemEditor=function(r,Z,I,R){this._data=r,this._column=Z,this._master=I,this._editInfo=R},hj("BaseItemEditor",m,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var il=K.Tab=function(){Dr(il,this)};uj("Tab",wf,{ms_ac:["view","closable","disabled"],_icon:G,_closable:!1,_disabled:!1,setParent:dm});var $f=K.Column=function(){Dr($f,this)};uj("Column",wf,{_46o:1,ms_ac:["accessType","valueType",Re,zb,wo,zp,"align",ii,"sortOrder",Oo,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Ag,_sortFunc:G,_sortable:!0,_clickable:!0,setWidth:function(x){16>x&&(x=16);var o=this._width;this._width=x,this.fp(zp,o,x)},getToolTip:function(k,v){return this.formatValue(v.getValue(k,this))}});var Ri=K.Property=function(){Dr(Ri,this)};uj("Property",wf,{_46o:1,ms_ac:["accessType","valueType",zb,wo,"categoryName",ii,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:G,getToolTip:function(t,n,M){var c=this;return n?c.formatValue(M.getValue(t,c)):M.getPropertyName(c)}}),ee.AccordionView=function(){var M=this;M._20o={},M._21o=new fl,M._10o=G,M._9o=G,M._11o=G,M._view=yn(0,M),M.iv()},hj("AccordionView",m,{ms_v:1,ms_fire:1,ms_ac:[Hm,Hk,"titleHeight",Yc,fp,"titleBackground","selectWidth",Uh,"orientation","separatorColor"],_expandIcon:V.accordionViewExpandIcon,_collapseIcon:V.accordionViewCollapseIcon,_titleHeight:ym,_labelColor:V.accordionViewLabelColor,_labelFont:V.accordionViewLabelFont,_titleBackground:V.accordionViewTitleBackground,_selectBackground:V.accordionViewSelectBackground,_selectWidth:V.accordionViewSelectWidth,_orientation:"v",_separatorColor:V.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Y,V,z,T){var M=this,w=Rm();if(M._20o[Y])throw Y+" already exists";w.onmousedown=Jd,w.style.cursor=Dg,w.addEventListener(Ai?Xc:Eo,function(K){Jd(K)},f),w.addEventListener(Ai?Xi:Vo,function(J){Jd(J),Tl(J)&&(M._10o===Y?M.collapse():M.expand(Y))},f),Mk(M._view,w),M._20o[Y]={content:V,div:w,canvas:$p(w),icon:T},M._21o.add(Y),z&&M.expand(Y),M.iv()},remove:function(r){var W=this,I=W._20o[r];I&&(Nl(I.div),delete W._20o[r],W._21o.remove(r),W.iv())},clear:function(){var k=this;k._21o.toArray().forEach(k.remove,k),k._20o={},k._21o.clear(),k.iv()},isExpanded:function(M){return this._10o===M},expand:function(w){var x=this;x._20o[w]&&x._10o!==w&&(x._10o=w,x.onExpanded(w),x.iv())},onExpanded:function(){},collapse:function(){var M=this;M._10o&&(M.onCollapsed(M._10o),delete M._10o,M.iv())},onCollapsed:function(){},initCanvas:function(O,o,A){Hp(O,o,A);var f=vd(O);return df(f,0,0,1),f.clearRect(0,0,o,A),f},drawTitle:function(S,G,M,H,b){var F=this,O=tn(b.icon),V=F.isExpanded(G),I=F._titleHeight,u=F._titleBackground,v=F._selectWidth,p=F._separatorColor,f=tn(V?F._expandIcon:F._collapseIcon),W=v+4;Ig(S,0,0,M,H,u),V&&v&&Ig(S,0,0,v,H,F._selectBackground),(V||F._21o.get(F._21o.size()-1)!==G)&&Ig(S,0,H-1,M,1,p?p:qk(u)),O&&(Uo(S,O,W+dq(O)/2,I/2),W+=dq(O)+2),bl(S,G,F.getLabelFont(G),F.getLabelColor(G),W,0,0,I),f&&Uo(S,f,M-dq(f)/2-4,I/2)},validateImpl:function(){var G=this,x=G._view,X=0,n=0,q=G.getWidth(),u=G.getHeight(),Q=G._titleHeight,E=G._21o.size()*Q,j=G._11o,p=G._9o;delete G._11o,delete G._9o,G._21o.each(function(I){var l,b,g=G._20o[I],A=g.content,O=G._10o===I;yj(G)?(op(g.div,X,0,Q,u),l=G.initCanvas(g.canvas,Q,u),Pe(l,0,u),ej(l,-Y),G.drawTitle(l,I,u,Q,g),l.restore(),O?(b=W(0,q-E),A&&(G._11o=A,G._9o=Zk(A),op(A,X+Q,0,b,u)),X+=Q+b):X+=Q):(op(g.div,0,n,q,Q),l=G.initCanvas(g.canvas,q,Q),G.drawTitle(l,I,q,Q,g),l.restore(),O?(b=W(0,u-E),A&&(G._11o=A,G._9o=Zk(A),op(A,0,n+Q,q,b)),n+=Q+b):n+=Q)});var N=G._9o;j&&j!==G._11o&&j.endEditing&&j.endEditing(),N&&N!==p&&Mk(x,N),p&&p!==N&&Nl(p)}}),ee.SplitView=function(O,B,N,b){var r=this,Y=r._dividerDiv=Rm(),t=r._60O=$p(),Q=r._61O=$p(),K=t.style,x=Q.style;r._view=yn(1,r),Mk(r._view,Y),K.msTouchAction=po,K.pointerEvents=po,K.cursor=Dg,x.msTouchAction=po,x.pointerEvents=po,x.cursor=Dg,O&&r.setLeftView(O),B&&r.setRightView(B),N&&r.setOrientation(N),b!=G&&r.setPosition(b),r.setStatus(Hg),new Mo(r)},hj("SplitView",m,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:V.splitViewDividerSize,_dividerBackground:V.splitViewDividerBackground,_dragOpacity:V.splitViewDragOpacity,_toggleIcon:V.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(f,o){var O=this,x=O._position;isNaN(f)||(o||(O._82O=0>f?-1:f>1?1:0),O._position=f,O.fp(Hr,x,f))},getLeftView:function(){return this._leftView},setLeftView:function(y){var Q=this,R=Q._leftView,Z=Q._view;if(Q._leftView!==y){if(R&&R!==Q._rightView){var o=Zk(R);o.parentNode===Z&&Nl(o)}if(Q._leftView=y,y){var V=Zk(y);V.parentNode!==Z&&Z.insertBefore(V,Q._dividerDiv)}Q.fp("leftView",R,y)}},getRightView:function(){return this._rightView},setRightView:function(Z){var M=this,K=M._rightView,p=M._view;if(M._rightView!==Z){if(K&&K!==M._leftView){var r=Zk(K);r.parentNode===p&&Nl(r)}if(M._rightView=Z,Z){var G=Zk(Z);G.parentNode!==p&&p.insertBefore(G,M._dividerDiv)}M.fp("rightView",K,Z)}},validateImpl:function(){var n=this,y=n._draggable,o=n._position,F=n.getWidth(),L=n.getHeight(),m=n._dividerSize,c=n._dividerBackground,G=Ai?18:8,i=n._dividerDiv,p=n._82O,r=n._60O,H=n._61O,P=n._toggleIcon,Q=n._status,A=i.style,d=null,z=Ai?20:4,f=P.comps[0];m>=G||0===m?n._coverDiv&&(Nl(n._coverDiv),delete n._coverDiv):n._coverDiv||(n._coverDiv=Rm(),u&&(n._coverDiv.style.background=wb),Mk(i,n._coverDiv)),n._togglable?r.parentNode||(Mk(i,r),Mk(i,H)):(Nl(r),Nl(H));var q=n._coverDiv,S=n._leftView,l=n._rightView;if(yj(n)){if(m>F&&(m=F),Q===Hg)if(1===p)var e=$(o,F),O=W(0,F-m-e);else-1===p?(O=$(-o,F),e=W(0,F-m-O)):(e=a((F-m)*o),O=W(0,F-m-e));else"cl"===Q?(e=0,O=W(0,F-m)):"cr"===Q&&(O=0,e=W(0,F-m));S&&op(S,0,0,e,L),l&&op(l,e+m,0,O,L),op(i,e,0,m,L),n._22o=e,q&&(op(q,m/2-G/2,0,G,L),q.style.cursor=y?Nm:""),i.style.cursor=y?Nm:"";var J=i.clientHeight/2,Z=i.clientWidth;Hp(r,Z,Z),op(r,0,J-Z-z,Z,Z),d=vd(r),df(d,0,0,1),f.rotation=-Y,Ar(d,P,0,0,Z,Z),d.restore(),Hp(H,Z,Z),op(H,0,J+z,Z,Z),d=vd(H),df(d,0,0,1),f.rotation=Y,Ar(d,P,0,0,Z,Z),d.restore()}else{if(m>L&&(m=L),Q===Hg)if(1===p)var t=$(o,L),b=W(0,L-m-t);else-1===p?(b=$(-o,L),t=W(0,L-m-b)):(t=a((L-m)*o),b=W(0,L-m-t));else"cl"===Q?(t=0,b=W(0,L-m)):"cr"===Q&&(b=0,t=W(0,L-m));S&&op(S,0,0,F,t),l&&op(l,0,t+m,F,b),op(i,0,t,F,m),n._22o=t,q&&(op(q,0,m/2-G/2,F,G),q.style.cursor=y?uh:""),A.cursor=y?uh:"";var R=i.clientWidth/2,Z=i.clientHeight;Hp(r,Z,Z),op(r,R-Z-z,0,Z,Z),d=vd(r),df(d,0,0,1),f.rotation=0,Ar(d,P,0,0,Z,Z),d.restore(),Hp(H,Z,Z),op(H,R+z,0,Z,Z),d=vd(H),df(d,0,0,1),f.rotation=C,Ar(d,P,0,0,Z,Z),d.restore()}A.background=c}});var Mo=function(z){this.sv=z,this.addListeners()};ne(Mo,m,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(I){var n=this,y=n.sv,s=y._dividerDiv,x=y._60O,W=y._61O,U=y._status,L=I.target;if(L===x)U===Hg?y.setStatus("cl"):"cr"===U&&y.setStatus(Hg);else if(L===W)U===Hg?y.setStatus("cr"):"cl"===U&&y.setStatus(Hg);else if(Xn(I)&&(L===s||L===y._coverDiv)&&(Jd(I),y.isDraggable())){y.getLeftView(),y.getRightView();var g=n.maskDiv=Rm();if(g.style.left=0,g.style.top=0,g.style.width=y.getWidth()+"px",g.style.height=y.getHeight()+"px",y.getView().appendChild(g),!y.isContinuousLayout()){var $=n.resizeDiv=Rm();$.style.left=s.style.left,$.style.top=s.style.top,$.style.width=s.style.width,$.style.height=s.style.height,$.style.opacity=y.getDragOpacity(),$.style.background=y.getDividerBackground(),Mk(n.getView(),$)}n._lastAbsPosition=y._22o,n._86o=yj(y)?Ac(I).x:Ac(I).y,Hl(n,I)}},handleWindowTouchMove:function(t){Xn(t)&&this.update(t,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(v){var k=this;k.update(v,!0),k.sv.setStatus(Hg),k.maskDiv&&Nl(k.maskDiv),k.resizeDiv&&Nl(k.resizeDiv),k.maskDiv=k.resizeDiv=G},handle_mousedown:function(H){Tl(H)&&this.handle_touchstart(H)},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},update:function(F,l){var I=this,$=I.sv,U=yj($)?$.getWidth():$.getHeight(),N=$._dividerSize,w=I._lastAbsPosition-I._86o;yj($)?(w+=Ac(F).x,w>U-N&&(w=U-N),0>w&&(w=0),I.resizeDiv&&(I.resizeDiv.style.left=w+un)):(w+=Ac(F).y,w>U-N&&(w=U-N),0>w&&(w=0),I.resizeDiv&&(I.resizeDiv.style.top=w+un)),l&&U!==N&&(1===$._82O?$.setPosition(w,1):-1===$._82O?$.setPosition(w-U+N,1):$.setPosition(w/(U-N),1))}}),ee.TabView=function(){var j=this,l=j._view=yn(1,j),c=j._91O=Rm(1),Y=j._tabModel=new rl,a=Y.sm(),u=j.invalidate;j._7o=new fl,j._canvas=$p(c),Mk(l,c),Mk(l,j._92O=Rm(1)),a.setSelectionMode(nf),a.ms(j.handleSelectionChange,j),Y.mm(u,j),Y.md(u,j),Y.mh(u,j),j._interactor=new ad(j),j.iv()},hj("TabView",m,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Yc,fp,"tabBackground","selectWidth",Uh,"moveBackground","insertColor"],_tabPosition:Wj,_tabHeight:ym,_tabGap:V.tabViewTabGap,_labelColor:V.tabViewLabelColor,_labelFont:V.tabViewLabelFont,_tabBackground:V.tabViewTabBackground,_selectWidth:V.tabViewSelectWidth,_selectBackground:V.tabViewSelectBackground,_moveBackground:V.tabViewMoveBackground,_insertColor:V.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(Z,i,U){var M=new il,N=this._tabModel;return M.setName(Z),M.setView(i),N.add(M),U&&N.sm().ss(M),M},getLabel:function(Y){return Y.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(U){this._23o=U,this.iv()},get:function(V){var g=this,B=g._tabModel;if(Mj(V))return B._roots.get(V);if(ed(V)){var K;return B.each(function(E){V===g.getLabel(E)&&(K=E)}),K}return V instanceof il?V:G},select:function(y){this._tabModel.sm().ss(this.get(y))},remove:function(x){var z=this;if(x=z.get(x)){var j=z._tabModel,$=j._roots.indexOf(x);z._tabModel.remove(x),z.selectByIndex(--$)}},getCurrentTab:function(){return this._8o},hideTabView:function(d,F){F.parentNode===this._92O&&(aq(F)?(F.style.display=Jg,F._tab_=d):Nl(F),um())},showTabView:function(v,e){aq(e)&&(e.style.display="block",e._tab_=v),e.parentNode!==this._92O&&(Mk(this._92O,e),um())},_24o:function(){var i,d=this,$=d._8o,c=d._9o,s=d._tabModel.sm().ld();s&&(i=Zk(s.getView())),i!==c&&(c&&($.getView()&&$.getView().endEditing&&$.getView().endEditing(),d.hideTabView($,c)),i&&d.showTabView(s,i)),d._8o=s,d._9o=i,$!==s&&d.onTabChanged($,s)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(N,X){this.selectByIndex(--X)
},selectByIndex:function(e){var d=this,N=d._tabModel,_=N.size();if(_&&!N.sm().ld()){e==G&&(e=0),e>=_&&(e=_-1),0>e&&(e=0);for(var p=e;p>=0;p--){var M=d.get(p);if(!M.isDisabled())return d.select(M),M}for(p=e+1;_>p;p++)if(M=d.get(p),!M.isDisabled())return d.select(M),M}},getTabWidth:function(V){var y=4,x=tn(V.getIcon());x&&(y+=dq(x,V)+4);var h=this.getLabel(V);return h&&(y+=uk(this.getLabelFont(V),h).width+4),V.isClosable()&&(y+=10),y},drawTab:function(Z,X,n,_,z,h,B){var q,p=this,U=p._tabPosition,j=n+4,r=p._selectWidth,k=tn(X.getIcon()),l=X.isDisabled(),T=p.getLabelColor(X),W=p.getLabelFont(X),A=p.getLabel(X),D=p._selectBackground,s=U===kh+"-vertical",i=U===tq+"-vertical";(s||i)&&(j=_+4),l&&(Z.globalAlpha=Qp),Ig(Z,n,_,z,h,B),X===p._8o&&r&&(U===Wj?Ig(Z,n,_+h-r,z,r,D):U===kh?Ig(Z,n+z-r,_,r,h,D):U===tq?Ig(Z,n,_,r,h,D):s?Ig(Z,n+z-r,_,r,h,D):i?Ig(Z,n,_,r,h,D):Ig(Z,n,_,z,r,D));var g=z/2;if(s&&(Pe(Z,g,_+h/2),ej(Z,C),Pe(Z,-g,-_-h/2)),k){var Q=Am(k,X),S=dq(k,X);if(s||i){var y=n+z/2,w=j+Q/2;Pe(Z,y,w),ej(Z,Y),Pe(Z,-y,-w),Uo(Z,k,n+z/2,j+Q/2,X,p),Pe(Z,y,w),ej(Z,-Y),Pe(Z,-y,-w),j+=Q+4}else Uo(Z,k,j+S/2,_+h/2,X,p),j+=S+4}return s||i?(Pe(Z,z/2,j+z/2),ej(Z,Y),Pe(Z,-z/2,-j-z/2),bl(Z,A,W,T,n,j,h,z),Pe(Z,z/2,j+z/2),ej(Z,-Y),Pe(Z,-z/2,-j-z/2)):bl(Z,A,W,T,j,_,z,h),s&&(Pe(Z,g,_+h/2),ej(Z,-C),Pe(Z,-g,-_-h/2)),X.isClosable()&&(q=i?{x:n+z-12,y:_+h-12,width:12,height:12}:{x:n+z-12,y:_+2,width:12,height:12},this.drawCloseIcon(X,Z,T,q)),l&&(Z.globalAlpha=1),q},drawCloseIcon:function(T,u,f,j){var q=j.x,g=j.y;u.strokeStyle=f,u.lineWidth=1,u.beginPath(),u.moveTo(q+2,g+8),u.lineTo(q+8,g+2),u.moveTo(q+8,g+8),u.lineTo(q+2,g+2),u.stroke()},getTabAt:function(S){var Y=this._interactor._8Q(S);return Y?Y.tab:null},validateImpl:function(){var w=this;w._24o();var J,u=w._canvas,F=w._tabPosition,S=w._91O,Q=w._92O,z=w._tabModel,r=w.getWidth(),T=w.getHeight(),v=w._tabHeight,E=w._7o,g=w._tabGap,N=F===Wj,U=F===kh,l=F===tq,K=F===kh+"-vertical",y=F===tq+"-vertical",Z=w._23o,n=0;if((U||l)&&z._roots.each(function(I){n=W(w.getTabWidth(I),n)}),N?(op(S,0,0,r,v),J={x:0,y:v,width:r,height:W(0,T-v)}):U?(op(S,0,0,n,T),J={x:n,y:0,width:W(0,r-n),height:T}):l?(op(S,r-n,0,n,T),J={x:0,y:0,width:W(0,r-n),height:T}):K?(op(S,0,0,v,T),J={x:v,y:0,width:W(0,r-v),height:T}):y?(op(S,r-v,0,v,T),J={x:0,y:0,width:W(0,r-v),height:T}):(op(S,0,T-v,r,v),J={x:0,y:0,width:r,height:W(0,T-v)}),op(Q,J),K||y){w._9o&&(J.x=0,op(w._8o.getView(),J)),Hp(u,v,T);var b=vd(u),c=0;if(df(b,0,w.ty(),1),b.clearRect(0,0,v,T),E.clear(),z._roots.each(function(R){var B,j=w.getTabWidth(R);Z&&Z.tab===R||(B=w.drawTab(b,R,0,c,v,j,w._tabBackground)),E.add({_75o:B,tab:R,startY:c,endY:c+j,height:j}),c+=j+g}),w._23Q=W(0,c-g),Z){var h=Z.position;w.drawTab(b,Z.tab,0,Z.startY,v,Z.height,w._moveBackground),Ig(b,0,h,v,1,w._insertColor)}if(b.restore(),w._selectionChanged){w._selectionChanged=!1;for(var t=w.ty(),M=0;M<E.size();M++){var j=E.get(M);if(j.tab===w._8o){if(j.endY+t<0){w.ty(-j.startY);break}if(j.startY+t>T){w.ty(T-j.endY);break}}}}w.ty(w.ty())}else if(U||l){w._9o&&(J.x=0,op(w._8o.getView(),J)),Hp(u,n,T);var b=vd(u),c=0;if(df(b,0,w.ty(),1),b.clearRect(0,0,n,T),E.clear(),z._roots.each(function(G){var H;Z&&Z.tab===G||(H=w.drawTab(b,G,0,c,n,v,w._tabBackground)),E.add({_75o:H,tab:G,startY:c,endY:c+v,height:v}),c+=v+g}),w._23Q=W(0,c-g),Z){var h=Z.position;w.drawTab(b,Z.tab,0,Z.startY,n,Z.height,w._moveBackground),Ig(b,0,h,n,1,w._insertColor)}if(b.restore(),w._selectionChanged){w._selectionChanged=!1;for(var t=w.ty(),M=0;M<E.size();M++){var j=E.get(M);if(j.tab===w._8o){if(j.endY+t<0){w.ty(-j.startY);break}if(j.startY+t>T){w.ty(T-j.endY);break}}}}w.ty(w.ty())}else{w._9o&&(J.y=0,op(w._8o.getView(),J)),Hp(u,r,v);var b=vd(u),f=0;if(df(b,w.tx(),0,1),b.clearRect(0,0,r,v),E.clear(),z._roots.each(function(d){var G,$=w.getTabWidth(d);Z&&Z.tab===d||(G=w.drawTab(b,d,f,0,$,v,w._tabBackground)),E.add({_75o:G,tab:d,startX:f,endX:f+$,width:$}),f+=$+g}),w._64I=W(0,f-g),Z){var h=Z.position;w.drawTab(b,Z.tab,Z.startX,0,Z.width,v,w._moveBackground),Ye(b,w._insertColor,h,0,v)}if(b.restore(),w._selectionChanged){w._selectionChanged=!1;for(var L=w.tx(),M=0;M<E.size();M++){var j=E.get(M);if(j.tab===w._8o){if(j.endX+L<0){w.tx(-j.startX);break}if(j.startX+L>r){w.tx(r-j.endX);break}}}}w.tx(w.tx())}for(var B=[],x=Q.children,M=0;M<x.length;M++){var D=x[M],G=D._tab_;G&&!z.contains(G)&&B.push(D)}B.forEach(function(c){Q.removeChild(c)})}});var ad=function(y){this.tv=y,this.addListeners()};ne(ad,m,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(_){this.handleScroll(_,10*(_.wheelDelta/40))},handle_DOMMouseScroll:function(r){this.handleScroll(r,10*-r.detail)},handleScroll:function(q,c){Jd(q);var B=this.tv,l=B._tabPosition;!B._40o()||l!==Wj&&l!==Eh||B.tx(this.tv.tx()+c),!B._41o()||l!==kh&&l!==tq&&l!==kh+"-vertical"&&l!==tq+"-vertical"||B.ty(this.tv.ty()+c)},_8Q:function(n){var W,m,d=this.tv,V=d._tabPosition,T=d._7o;if(V===Wj||V===Eh){var Y=d.lp(n).x;for(W=0;W<T.size();W++)if(m=T.get(W),m.startX<=Y&&Y<=m.endX)return m}else if(V===kh||V===tq||V===kh+"-vertical"||V===tq+"-vertical"){var J=d.lp(n).y;for(W=0;W<T.size();W++)if(m=T.get(W),m.startY<=J&&J<=m.endY)return m}return G},isClickable:function(I){var B=this.tv,z=B._tabPosition,A=this._73o=this._8Q(I);return!B._40o()||z!==Wj&&z!==Eh?!B._41o()||z!==kh&&z!==tq&&z!==kh+"-vertical"&&z!==tq+"-vertical"?A&&(!A.tab.isDisabled()||B.isMovable()):!0:!0},handle_mousemove:function(R){var b=this;pj?b._74o=b._8Q(R):b.getView().style.cursor=b.isClickable(R)?Dg:""},handle_mousedown:function(u){this.handle_mousemove(u),this.handle_touchstart(u)},handle_touchstart:function(k){var S=this,m=S.tv,q=m._tabPosition;Jd(k),Tl(k)&&S.isClickable(k)&&(q===Wj||q===Eh?(S.x=Ac(k).x,S.lp=m.lp(k),S.tx=m.tx()):(S.y=Ac(k).y,S.lp=m.lp(k),S.ty=m.ty()),Hl(S,k))},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(m){var R,V=this,P=V.tv,K=P._tabPosition,r=V._73o;if(K===Wj||K===Eh){if(R=Ac(m).x-V.x,!V._25o&&!V.moving&&D(R)>2&&(P._40o()&&!Rj(m)?V._25o=1:r&&P.isMovable()&&(V.moving=1)),V._25o)P.tx(V.tx+R);else if(V.moving){var A=V.lp.x+R,s=P._tabGap/2;P._7o.each(function(Q){var g=Q.endX,l=A-Q.startX<g-A;A>=Q.startX&&g>=A&&P._7Q({tab:r.tab,startX:r.startX+R,width:r.width,front:l,insertTab:Q.tab,position:l?W(0,Q.startX-s):$(P._64I,g+s)})})}}else if(R=Ac(m).y-V.y,!V._25o&&!V.moving&&D(R)>2&&(P._41o()&&!Rj(m)?V._25o=1:r&&P.isMovable()&&(V.moving=1)),V._25o)P.ty(V.ty+R);else if(V.moving){var N=V.lp.y+R,s=P._tabGap/2;P._7o.each(function(v){var A=v.endY,z=N-v.startY<A-N;N>=v.startY&&A>=N&&P._7Q({tab:r.tab,startY:r.startY+R,height:r.height,front:z,insertTab:v.tab,position:z?W(0,v.startY-s):$(P._23Q,A+s)})})}},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(){var V=this,o=V.tv,a=o._tabPosition,C=o.getTabModel(),U=C._roots,K=V._73o;if(V.moving){var T=o._23o;if(T&&T.insertTab!==T.tab){var g=T.tab,S=U.remove(g),P=U.indexOf(T.insertTab);P>=0&&(T.front||P++,P<=U.size()&&(U.add(g,P),C._38I(g,S,P)))}o._7Q(G),delete V.moving}else if(!V._25o&&K){g=K.tab;var f=V._74o;if(!f||f.tab===g)if(!g.isDisabled()&&Wn(K._75o,V.lp)){var E=function(){var W=U.indexOf(g);C.remove(g),o.onTabClosed(g,W)};o.onTabClosing(g,E)&&E()}else g.isDisabled()||o._8o===g||C.sm().ss(g)}V._25o=V._73o=V._74o=a===Wj||a===Eh?V.x=V.lp=V.tx=G:V.y=V.lp=V.ty=G}}),ee.PropertyView=function(f){var p=this;p._view=yn(1,p),p._canvas=$p(p._view),Mk(p._view,p._79O=Rm()),p._rows=new fl,p._28o=new fl,p._26o={},p._26Q={};var M=p._propertyModel=new rl,c=p.ivm;M.mm(c,p),M.md(c,p),M.mh(c,p),p.dm(f?f:new rl),new nd(p)},hj("PropertyView",m,{ms_ac:[Yc,Jb,fp,zb,wo,"categorizable",wm,Oo,Kg,Hm,Hk,jm,os,xq,"selectRowIndex",Uh,"background",Cj,Pc,Vg,jc,Bl],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:ai,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:vg,_background:V.propertyViewBackground,_expandIcon:V.propertyViewExpandIcon,_collapseIcon:V.propertyViewCollapseIcon,_scrollBarColor:rc,_scrollBarSize:Og,_autoHideScrollBar:cg,_selectBackground:V.propertyViewSelectBackground,_rowHeight:rb,_rowLineVisible:V.propertyViewRowLineVisible,_rowLineColor:V.propertyViewRowLineColor,_10I:.5,_columnLineVisible:V.propertyViewColumnLineVisible,_columnLineColor:V.propertyViewColumnLineColor,_labelColor:V.propertyViewLabelColor,_labelSelectColor:V.propertyViewLabelSelectColor,_labelFont:V.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(A){0>A&&(A=0),A>1&&(A=1);var Z=this,k=Z._10I;Z._10I=A,Z.fp("columnPosition",k,A)},getPropertyName:function(P){return P.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(C,G,k){return k===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(m,r){return r===this._selectRowIndex?this._labelSelectColor:m.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(L){var c=this.getHeight()-this._59I;return c>L&&(L=c),L>0?0:a(L)},isExpanded:function(N){if(!N)return!0;var X=this._26o[N];return X?X.isExpanded:!(this._26Q[N]===!1)},toggle:function(n){var F=this;F.isExpanded(n)?F.collapse(n):F.expand(n)},expandAll:function(){this.validate();for(var U in this._26o)this.expand(U)},expand:function(u){if(u&&u!==Jg){var X=this,C=X._26o[u];C&&!C.isExpanded&&(C.isExpanded=!0,X.onExpanded(u),X.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var k in this._26o)this.collapse(k)},collapse:function(O){if(O&&O!==Jg){var B=this,x=B._26o[O];x&&x.isExpanded&&(x.isExpanded=!1,B.onCollapsed(O),B.ivm())}},onCollapsed:function(){},getCategoryName:function(a){if(!this.isCategorizable())return Jg;var n=a.getCategoryName();return n?n:Jg},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(B){var K=this,E=K._dataModel;E!==B&&(E&&(E.umd(K.handlePropertyChange,K),K._selectionModel||E.sm().ums(K.handleSelectionChange,K)),K._dataModel=B,B.md(K.handlePropertyChange,K),K._selectionModel?K._selectionModel._21I(B):B.sm().ms(K.handleSelectionChange,K),K.fp(Ob,E,B))},isVisible:function(V){return this._visibleFunc?this._visibleFunc(V):!0},onPropertyChanged:function(H){var Z=this,p=H.property;gl[p]?Z.ivm():Z.iv(),p===oh&&Z._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:eq},handlePropertyChange:function(b){this._27o===b.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var n=this;n._96I||(n.setSelectRowIndex(-1),n._96I=1,n.iv())},redraw:function(){this.iv()},validateModel:function(){var i=this,h=i._rows,u=i._28o,J={},l=new fl,V=i._27o;i.updateCurrentData(),V!==i._27o&&i.endEditing(),h.clear(),u.clear(),i.getRawProperties().each(function(f){if(i.isVisible(f)){l.add(f);var w=i.getCategoryName(f);J[w]||(u.add(w,w===Jg?0:z),J[w]={isExpanded:i.isExpanded(w),properties:new fl})}}),i._sortFunc&&l.sort(i._sortFunc);for(var H in i._26o)i._26Q[H]=i.isExpanded(H);i._26o=J,u.each(function(j){j!==Jg&&h.add(j);var k=J[j];k.isExpanded&&l.each(function(w){i.getCategoryName(w)===j&&(k.properties.add(w),h.add({property:w,data:i._27o}))},i)})},validateImpl:function(){var p=this;p._76o(),p._96I&&(p.validateModel(),delete p._96I);var F=p._canvas,f=p.getWidth(),u=p.getHeight(),T=-p.ty(),o=p._rowHeight,x=p._indent,O=f-x,v=p._rows,g=v.size(),e=p._9I=x+O*p._10I,k=p._59I=g*o;Hp(F,f,u),p._29I={x:0,y:T,width:f,height:u},p._31I=y(T/o),p._14I=j((T+u)/o),p._31I<0&&(p._31I=0),p._14I>g&&(p._14I=g);var S,z=vd(F),M=p._background;df(z,0,-T,1),z.beginPath(),z.rect(0,T,f,u),z.clip(),z.clearRect(0,T,f,u),p._93db(z),M&&Ig(z,0,0,x,k,M);for(var H=p._31I;H<p._14I;H++){var i=v.get(H),T=o*H;if(ed(i))M&&Ig(z,x,T,O,o,M),S=tn(p.isExpanded(i)?p._expandIcon:p._collapseIcon),S&&sm(z,S,Bb,0,T,x,o),z.save(),z.beginPath(),z.rect(x,T,O,o),z.clip(),p.drawCategoryName(z,i,H,x,T,O,o),z.restore();else{var P=i.property,K=i.data,S=tn(P.getIcon()),s=p._selectRowIndex===H?p.getSelectBackground():G;if(S&&sm(z,S,Bb,0,T,x,o),s&&Ig(z,x,T,O,o,s),z.save(),z.beginPath(),z.rect(x,T,e-x,o),z.clip(),p.drawPropertyName(z,P,H,x,T,e-x,o),z.restore(),!p.isEditing(K,P)){var D=e+1,X=f-e-1;z.save(),z.beginPath(),z.rect(D,T,X,o),z.clip(),p._87o(p.drawPropertyValue(z,P,p.getValue(K,P),H,D,T,X,o,K),H,D,T,X,o),z.restore()}}p._rowLineVisible&&Ig(z,x,T+o-1,O,1,p._rowLineColor)}p._columnLineVisible&&(Ig(z,e,0,1,k,p._columnLineColor),Ig(z,f-1,0,1,k)),p._92db(z),p._93I(),z.restore(),p.ty(p.ty())},drawCategoryName:function(h,P,m,O,y,G,k){bl(h,P,this.getCategoryFont(P),this.getCategoryColor(P),O,y,G,k)},drawPropertyName:function(V,f,W,U,S,o,G){return f.drawPropertyName?(f.drawPropertyName(V,f,W,U,S,o,G,this),void 0):(bl(V,this.getPropertyName(f),this.getPropertyFont(f,W),this.getPropertyColor(f,W),U,S,o,G),void 0)},drawPropertyValue:function(a,k,E,F,v,y,X,_,x){return k.drawPropertyValue?k.drawPropertyValue(a,k,E,F,v,y,X,_,x,this):(el(a,E,k,this.getLabelFont(k,E,F),this.getLabelColor(k,E,F),v,y,X,_,x,this),void 0)},isPropertyEditable:function(V){return V.isEditable()&&this.isEditable()},setProperties:function(V){this._propertyModel.clear(),this.addProperties(V)},addProperties:function(d){if(d){var v=this._propertyModel;d.forEach(function(Z){if(!(Z instanceof Ri)){var e=ah(Z.className);Z=Wd(e?e:Ri,Z)}v.add(Z)})}},getRowIndexAt:function(K){var G=this,M=y(G.lp(K).y/G._rowHeight);return M>=0&&M<G._rows.size()?M:-1},getPropertyAt:function(z){var h=this,j=h.getRowIndexAt(z);return j>=0?h._rows.get(j).property:G},getToolTip:function(q){var H=this,D=H.getPropertyAt(q),N=H._27o;return D&&N?D.getToolTip(N,H._9I<H.lp(q).x,H):G}});var nd=function(q){this.pv=q,this.addListeners()};ne(nd,m,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(c){this.getView().style.cursor=c},clear:function(){var x=this;x._62O=x.cp=x.ty=x.p=G,x.setCursor(Ll)},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(B){var y=this,J=y.pv;Jd(B),J.setFocus(B)&&(Tl(B)?(y.cp=Ac(B),y.ty=J.ty(),y.p=J.getColumnPosition(),y.handle_touchmove(B)):J.setSelectRowIndex(J.getRowIndexAt(B)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(K){var E=this;if(E.cp&&!E._62O){var L=E.pv,x=L.lp(K),X=x.x,i=x.y,U=L._indent,d=L.getRowIndexAt(K),b=L._9I;if(d>=0){var v=L._rowHeight,D=v*d,Q=L._rows.get(d),t=Q.property;if(ed(Q))tn(L.isExpanded(Q)?L._expandIcon:L._collapseIcon)&&X>=0&&U>=X&&i>=D&&D+v>=i?L.toggle(Q):Rc(K)&&L.toggle(Q);else if(X>b&&L.isPropertyEditable(t,K)){var S={x:b+1,y:D,width:L.getWidth()-b-1,height:v},H={x:S.x+L.tx(),y:S.y+L.ty(),width:S.width,height:S.height},h=0,$=L._29I;S.y<$.y?h=S.y-$.y:S.y+v>$.y+$.height&&(h=S.y+v-$.y-$.height),h&&(L.ty(L.ty()-h),H.y-=h),L.beginEditing({data:Q.data,property:t,value:L.getValue(Q.data,t),event:K,rect:S,editorRect:H,view:L})}}L.setSelectRowIndex(d)}E.clear()},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(M){var V=this,K=V.pv,c=V.ty,y=V.cp,i=Ac(M),J=V._62O;if("p"===J)K.setTranslateY(c+i.y-y.y);else if("c"===J){var j=K.getWidth()-K._indent;if(j>16){var r=V.p-(y.x-i.x)/j,f=16/j;f>r&&(r=f),r>1-f&&(r=1-f),K.setColumnPosition(r)}}else"s"===J&&K.setTranslateY(c+(y.y-i.y)*K._59I/K._29I.height)},handle_mousemove:function(C){this.handle_touchmove(C)},handle_touchmove:function(k){if(!pj&&Tl(k)){var c=this,I=c.pv,B=D(I.lp(k).x-I._9I)<=(Ai?8:3);c.cp?c._62O||(B?(c._62O="c",Hl(c)):D(Ac(k).y-c.cp.y)>=2&&(c._62O=c.isV(k)?"s":"p",Hl(c))):(B?c.setCursor(Nm):c.setCursor(Ll),c.isV(k)&&I._43o())}},isV:function(j){var u=this.pv,d=u._29I;return u._41o()&&d.x+d.width-u.lp(j).x<Um},handle_mousewheel:function(f){this.handleScroll(f,f.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(F,Z){var h=this.pv;Jd(F),h.endEditing(),h.translate(0,Z*h.getRowHeight())},handle_keydown:function(h){var w=this.pv,v=w._rows.size(),A=w._selectRowIndex+(_g(h)?-1:1);(_g(h)||pg(h))&&(0>A&&(A=0),A>=v&&(A=v-1),w.setSelectRowIndex(A))}}),ee.ListView=function(O){this._5o(O),new Do(this)},hj("ListView",m,{ms_ac:[Yc,Jb,fp,Cj,wm,Pc,Vg,Oo,Kg,jm,os,xq,hl,Uh],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:vg,_rowHeight:rb,_rowLineVisible:V.listViewRowLineVisible,_rowLineColor:V.listViewRowLineColor,_scrollBarColor:rc,_scrollBarSize:Og,_autoMakeVisible:Bf,_autoHideScrollBar:cg,_selectBackground:V.listViewSelectBackground,_labelColor:V.listViewLabelColor,_labelSelectColor:V.listViewLabelSelectColor,_labelFont:V.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(g){var F=this,y=F._checkMode;F._checkMode=g,F.fp(Ke,y,g)},drawRow:function(y,E,F,k,j,O,D){var c=this,m=0,n=c._indent,a=c.getIconWidth(E);c.drawRowBackground(y,E,F,k,j,O,D),c._checkMode&&(Uo(y,tn(c.getCheckIcon(E)),m+n/2,j+D/2,E,c),m+=n),c.drawIcon(y,E,m,j,a,D),c.drawLabel(y,E,m+a,j,D)}});var Do=function(y){this.list=y,this._lastSelectDataTime=Un(),this.addListeners()};ne(Do,m,{ms_listener:1,getView:function(){return this.list._view},clear:function(y){var A=this,w=A.list;y&&"d"===A._62O&&!A.dragCancel&&w.handleDragAndDrop(y,"end"),w.draggingData&&(w.draggingData=null,w.redraw()),A.dragCancel=A._62O=A._isV=A._isH=A.cp=A.tx=A.ty=G},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(B){var G=this,d=G.list;if(Jd(B),d.setFocus(B)){var h=d.getDataAt(B);G.cp=Ac(B),G.tx=d.tx(),G.ty=d.ty(),Tl(B)?h&&d.handleDragAndDrop&&!G.isV(B)&&!G.isH(B)&&(d.draggingData=h,d.redraw(),d.handleDragAndDrop(B,"prepare")):(h&&G._33o(B,h),G.clear(B))}},handleWindowMouseUp:function(P){this.clear(P)},handleWindowTouchEnd:function(M){this.clear(M)},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(S){var G=this,f=G.list;if(!G._isV&&!G._isH&&G.cp&&!G._62O){var F=f.getDataAt(S);F?(f.isCheckMode()?G._34o(S,F):G._33o(S,F),Rc(S)?f.onDataDoubleClicked(F,S):f.onDataClicked(F,S)):f.handleBackgroundClick(S)}G.clear(S)},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(q){var r=this,t=r.list,n=r._62O,$=r.tx,Y=r.ty,o=r.cp,C=Ac(q),K=t._29I;"p"===n?t.setTranslate($+C.x-o.x,Y+C.y-o.y):"v"===n?t.ty(Y+(o.y-C.y)*t._59I/K.height):"h"===n?t.tx($+(o.x-C.x)*t._91I/K.width):"d"===n&&(r.dragCancel||t.handleDragAndDrop(q,"between"))},handle_mousemove:function(f){this.handle_touchmove(f)},handle_touchmove:function(X){if(!pj&&Tl(X)){var h=this,J=h.list;if(h._isV=h.isV(X),h._isH=h.isH(X),h.cp){if(!h._62O){if(Li(Ac(X),h.cp)<2)return;h._isV?h._62O="v":h._isH?h._62O="h":J.draggingData&&!this.dragCancel?(h._62O="d",J.handleDragAndDrop(X,"begin")):h._62O="p",h._62O&&"d"!==h._62O&&J.draggingData&&(J.draggingData=null,J.redraw()),Hl(h)}}else h._isV&&J._43o(),h._isH&&J._42o()}},isV:function(q){var w=this.list,n=w._29I;return w._41o()&&n.x+n.width-w.lp(q).x<Um},isH:function(w){var d=this.list,O=d._29I;return d._40o()&&O.y+O.height-d.lp(w).y<Um},handle_mousewheel:function(O){this.handleScroll(O,O.wheelDelta/40,O.wheelDelta!==O.wheelDeltaX)},handle_DOMMouseScroll:function(i){this.handleScroll(i,-i.detail,1)},handleScroll:function(s,p,$){var Z=this.list;Jd(s),Z.endEditing&&Z.endEditing(),$&&Z._41o()?Z.translate(0,p*Z.getRowHeight()):Z._40o()&&Z.translate(10*p,0)},handle_keydown:function(z){if(!V.isInput(z.target)){var N,m=this.list,q=m.sm(),b=m._rows,X=b.size();if(xr(z))m.selectAll();else if(ui(z))m.handleDelete&&m.handleDelete(z);else if(me(z))"d"!==this._62O||this.dragCancel||(m.handleDragAndDrop(z,"cancel"),this.dragCancel=!0);else if(Ni(z))m.isCheckMode()&&(N=m.getFocusData(),N&&m.checkData(N));else if(_g(z)||pg(z)){var a=m.isCheckMode();if(N=a?m.getFocusData():q.ld()){var E=m.getRowIndex(N);E>=0&&(_g(z)?0!==E&&(N=b.get(E-1),a?m.setFocusData(N):q.ss(N)):E!==X-1&&(N=b.get(E+1),a?m.setFocusData(N):q.ss(N)))}else X>0&&(N=b.get(0),a?m.setFocusData(N):q.ss(N))}}},_34o:function(t,N){var s=this.list,G=s.lp(t).x;return G>=0&&G<=s._indent?(s.checkData(N),void 0):(s.setFocusData(N),void 0)},_33o:function(l,n){var M=this.list,$=M.sm(),r=$.ld();if(Rj(l))M.isSelected(n)?$.rs(n):$.as(n);else if(lm(l))if(r)for(var f=M.getRowIndex(r),b=M.getRowIndex(n);f!==b;)f+=b>f?1:-1,$.as(M._rows.get(f));else $.ss(n);else if(Tl(l)){var j=Un();if($.contains(n)){var i=j-this._lastSelectDataTime;M.handleDataDoubleSelect&&i>500&&1500>i&&M.handleDataDoubleSelect(l,n)}$.ss(n),this._lastSelectDataTime=j}else $.contains(n)||$.ss(n)}}),ee.TreeView=function(h){var V=this;V._35o(),V._5o(h),new Sg(V)},hj("TreeView",m,{ms_ac:[Yc,Jb,fp,"rootVisible",Ke,"rootData",Oo,Kg,jm,os,xq,wm,Cj,Pc,Vg,Hm,Hk,hl,Uh,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:G,_indent:vg,_rowHeight:rb,_rowLineVisible:V.treeViewRowLineVisible,_rowLineColor:V.treeViewRowLineColor,_scrollBarColor:rc,_scrollBarSize:Og,_autoHideScrollBar:cg,_expandIcon:V.treeViewExpandIcon,_collapseIcon:V.treeViewCollapseIcon,_autoMakeVisible:Bf,_selectBackground:V.treeViewSelectBackground,_labelColor:V.treeViewLabelColor,_labelSelectColor:V.treeViewLabelSelectColor,_labelFont:V.treeViewLabelFont,_doubleClickToToggle:V.treeViewDoubleClickToToggle,drawRow:function(Q,i,F,s,A,Z,W){var z=this;z.drawRowBackground(Q,i,F,s,A,Z,W),z._97I(Q,i,F,0,A,Z,W)},isOnToggleIcon:function(r){var $=this.getDataAt(r);if($){var z=this.getIndent(),U=this.lp(r).x;if(tn(this.getToggleIcon($))){var D=z*this.getLevel($);if(U>=D&&D+z>=U)return!0}}return!1}});var Sg=function(n){Dr(Sg,this,[n])};ne(Sg,Do,{toggle:function(w,C,L,y){var A=this.list,x=A.lp(w).x;if(tn(A.getToggleIcon(C))){var V=L*y;if(x>=V&&V+L>=x)return A.toggle(C),!0}return A.isDoubleClickToToggle()&&Rc(w)?(A.toggle(C),!0):!1},_34o:function(Z,r){var y=this.list,J=y.lp(Z).x,u=y._levelMap[r._id],M=y._indent,B=M*(u+1);return J>=B&&B+M>=J?(y.checkData(r),void 0):(this.toggle(Z,r,M,u)||y.setFocusData(r),void 0)},_33o:function(v,P){var $=this,F=$.list;$.toggle(v,P,F._indent,F.getLevel(P))||Sg.superClass._33o.call($,v,P)},handle_keydown:function(U){if(Ko(U)||Wr(U)){var x=this.list,$=x._rows,D=x.isCheckMode(),K=x.sm(),M=D?x.getFocusData():K.ld();M?M.hasChildren()&&(Ko(U)?x.collapse(M):x.expand(M)):$.size()>0&&(M=$.get(0),D?x.setFocusData(M):K.ss(M))}else Sg.superClass.handle_keydown.call(this,U)}});var Rn=ee.TableView=function(e){this._98I(),this._5o(e),new Wk(this)};hj("TableView",m,{ms_ac:[Yc,Jb,fp,"sortMode",zb,wo,Cj,Pc,Vg,jc,Bl,"sortColumn",Oo,Kg,jm,os,xq,hl,Uh],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:hg,_editable:!0,_batchEditable:!1,_rowHeight:rb,_rowLineVisible:V.tableViewRowLineVisible,_rowLineColor:V.tableViewRowLineColor,_columnLineVisible:V.tableViewColumnLineVisible,_columnLineColor:V.tableViewColumnLineColor,_scrollBarColor:rc,_scrollBarSize:Og,_autoHideScrollBar:cg,_autoMakeVisible:Bf,_selectBackground:V.tableViewSelectBackground,_labelColor:V.tableViewLabelColor,_labelSelectColor:V.tableViewLabelSelectColor,_labelFont:V.tableViewLabelFont,getCheckColumn:function(){var F=this;if(!F._31o){var k=F._31o=new $f;k.setEditable(!0),k.setWidth(40),k.getValue=F.getCheckColumValue,k.drawCell=F.drawCheckColumnCell}return F._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(l){var H=this,T=H._39o,c=H.getCheckColumn();l!==H.isCheckMode()&&(l?T.add(c,0):T.remove(c),H.fp(Ke,!l,l))},getCheckColumValue:function(Y,n,W){return W.isSelected(Y)},drawCheckColumnCell:function(R,$,S,c,l,O,e,H,I){Uo(R,I.getCheckIcon($),l+e/2,O+H/2,$,I)}});var Wk=function(B){Dr(Wk,this,[B])};ne(Wk,Do,{_34o:function(Y,L){var T=this.list,S=T._31o;if(T.isCellEditable(L,S,Y)){var p=T._3Q(S),F=T.lp(Y).x;if(p&&F>=p.startX&&F<p.startX+S.getWidth())return T.checkData(L),void 0}T._37O(L,Y),T.setFocusData(L)},_33o:function(v,N){this.list._37O(N,v),Wk.superClass._33o.apply(this,arguments)}});var qq=ee.TreeTableView=function(e){var W=this,v=W._4o=new $f;W._35o(),W._98I(),W._5o(e),v.setDisplayName("Name"),v.setEditable(!0),v.setWidth(180),v.drawCell=ko,v.getValue=pd,W._39o.add(v),new _l(W)},ko=function(k,x,S,g,K,e,B,j,C){C._97I(k,x,S,K,e,B,j)},pd=function(Z,j,J){return J.getLabel(Z)};hj("TreeTableView",m,{ms_ac:[Yc,Jb,fp,"sortMode",zb,wo,wm,Ke,"rootData","rootVisible",Oo,Kg,"sortColumn",Hm,Hk,jm,os,xq,hl,Vg,Cj,Pc,jc,Bl,Uh,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:hg,_checkMode:G,_editable:!0,_batchEditable:!1,_indent:vg,_rowHeight:rb,_rowLineVisible:V.treeTableViewRowLineVisible,_rowLineColor:V.treeTableViewRowLineColor,_columnLineVisible:V.treeTableViewColumnLineVisible,_columnLineColor:V.treeTableViewColumnLineColor,_expandIcon:V.treeTableViewExpandIcon,_collapseIcon:V.treeTableViewCollapseIcon,_scrollBarColor:rc,_scrollBarSize:Og,_autoHideScrollBar:cg,_autoMakeVisible:Bf,_selectBackground:V.treeTableViewSelectBackground,_labelColor:V.treeTableViewLabelColor,_labelSelectColor:V.treeTableViewLabelSelectColor,_labelFont:V.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var _l=function(W){Dr(_l,this,[W])};ne(_l,Do,{_34o:function(M,q){var t=this.list,e=t._4o,S=t._3Q(e),s=t.lp(M).x;if(S){var L=t._indent,g=S.startX+L*t.getLevel(q);if(tn(t.getToggleIcon(q))&&s>=g&&g+L>=s)return t.toggle(q),void 0;if(t.isCellEditable(q,e)&&(g+=L,s>=g&&g+L>=s))return t.checkData(q),void 0}t._37O(q,M),t.setFocusData(q)},_33o:function(n,c){var Y=this.list,p=Y.lp(n).x;if(tn(Y.getToggleIcon(c))){var l=Y._3Q(Y._4o);if(l){var k=Y._indent,v=l.startX+k*Y.getLevel(c);if(p>=v&&v+k>=p)return Y.toggle(c),void 0}}Y._37O(c,n),_l.superClass._33o.apply(this,arguments)}});var Aq=ee.TableHeader=function(m){var O=this,t=O._view=yn(1,O),j=O._39o=m.getColumnModel(),X=O.iv;O.tv=O._tableView=m,O._60I=new fl,O._canvas=$p(t),t.style.background=V.tableHeaderBackground||"",t.style.height=wh+un,j.mm(X,O),j.md(X,O),j.mh(X,O),m.mp(function(r){lo[r.property]&&O.iv()},O),new pi(O),O.iv()};hj("TableHeader",m,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Yc,fp,wm,"moveBackground","insertColor",jc,Bl,"resizable","movable"],_checkIcon:qe,_movable:!0,_resizable:!0,_labelColor:V.tableHeaderLabelColor,_labelFont:V.tableHeaderLabelFont,_columnLineColor:V.tableHeaderColumnLineColor,_columnLineVisible:V.tableHeaderColumnLineVisible,_sortDescIcon:V.tableHeaderSortDescIcon,_sortAscIcon:V.tableHeaderSortAscIcon,_moveBackground:V.tableHeaderMoveBackground,_insertColor:V.tableHeaderInsertColor,_indent:vg,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function($){return $.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(n){return n.getColor()||this._labelColor},getLabelAlign:function(z){return z._align},onPropertyChanged:function(){this.iv()},_5Q:function(S){this._61I=S,this.iv()},getLogicalPoint:function(O){return ch(O,this._canvas,this.tv.tx())},validateImpl:function(){var G=this,E=G._canvas,V=G.getWidth(),N=G.getHeight(),P=G.tv,D=G._60I,y=G._61I,l=-P.tx(),m=0;(V!==E.clientWidth||N!==E.clientHeight)&&Hp(E,V,N),D.clear(),G._39o._roots.each(function(s){if(s.isVisible()){var v=m+s.getWidth();l+V>=m&&v>=l&&D.add({column:s,startX:m}),m=v}});var S=vd(E);if(df(S,-l,0,1),S.beginPath(),S.rect(l,0,V,N),S.clip(),S.clearRect(l,0,V,N),D.each(function(h){var L=h.column,b=h.startX,x=L.getWidth();x>0&&(S.save(),S.beginPath(),S.rect(b,0,x,N),S.clip(),y&&y.column===L||G.drawColumn(S,L,b,0,x,N),G._columnLineVisible&&Ig(S,b+x-1,0,1,N,G._columnLineColor),S.restore())}),y){var c=y.column,m=y.startX,Q=y.position,A=c.getWidth();S.save(),S.beginPath(),S.rect(m,0,A,N),S.clip(),S.fillStyle=G._moveBackground,S.fill(),G.drawColumn(S,c,m,0,A,N),S.restore(),Ye(S,G._insertColor,Q,0,N)}S.restore()},_6Q:function(V){var f=this.tv;return f._31o===V&&f.sm().getSelectionMode()===cq},drawColumn:function(F,X,m,W,k,C){var D=this,b=D.tv,e=tn(X.getIcon()),p=D.getLabelAlign(X);if(D._6Q(X)){var d=tn(D._checkIcon);Uo(F,d,m+k/2,W+C/2,X,D)}else{var l=D.getLabel(X),u=D.getLabelFont(X),N=D.getLabelColor(X),Z=uk(u,l).width,g=e?D._indent:0;p===kh?(e&&sm(F,e,Bb,m,W,g,C),bl(F,l,u,N,m+g,W,k,C,kh)):p===tq?(e&&sm(F,e,Bb,m+k-Z-g,W,g,C),bl(F,l,u,N,m,W,k,C,tq)):(e&&sm(F,e,Bb,m+(k-Z-g)/2,W,g,C),bl(F,l,u,N,m+(k-Z+g)/2,W,0,C,kh))}if(X.isSortable()&&b.getSortColumn()===X&&(e=tn(X.getSortOrder()===Ag?D._sortAscIcon:D._sortDescIcon))){var V=dq(e,X)/2+2;Uo(F,e,p===tq?m+V:m+k-V,W+C/2,X,b)}}});var pi=function(R){var E=this;E.th=R,E.tv=R._tableView,E.addListeners()};ne(pi,m,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(l){this.getView().style.cursor=l},handle_mousemove:function(H){if(!pj){var t=this;delete t._29o,t.setCursor(Ll);for(var b=t.th,k=b._60I,I=b.lp(H).x,Y=k.size()-1;Y>=0;Y--){var N=k.get(Y),l=N.column,p=N.startX+l.getWidth();if(b.isResizable()&&D(p-I)<=(Ai?10:3))return t._29o=N,t.setCursor(Nm),void 0;I>N.startX&&p>I&&(t._29o=N),(l.isClickable()||l.isSortable()||b.isMovable()||t.tv.getCheckColumn&&l===t.tv.getCheckColumn())&&I>N.startX&&p>I&&t.setCursor(Dg)}}},handle_mousedown:function(r){this.handle_touchstart(r)},handle_touchstart:function(c){var e=this;Jd(c),e.tv.endEditing(),e.handle_mousemove(c),e._29o&&(e.x=Ac(c).x,e.lx=e.th.lp(c).x,e.w=e._29o.column.getWidth(),Hl(e,c))},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(k){var G=this,P=G.th,W=G.getView().style.cursor,L=G._29o,l=Ac(k).x-G.x;if(G.resizing||G.moving||(W===Nm?G.resizing=1:P.isMovable()&&W===Dg&&D(l)>2&&(G.moving=1)),G.resizing)L.column.setWidth(G.w+l);else if(G.moving){var i=G.lx+l;P._60I.each(function(r){var H=r.startX,W=H+r.column.getWidth();if(i>=H&&W>=i){var B={column:L.column,startX:L.startX+l,front:W-i>i-H,insertColumn:r.column};B.position=B.front?H:W,P._5Q(B)}})}},_16Q:function(t,J){var z=this,o=z.tv,k=z.th,i=k._checkIcon;if(k._6Q(t)){var E=tn(i),h=z.lx,F=t.getWidth(),R=dq(E,t);if(h>=J+F/2-R&&J+F/2+R>=h){k.setCheckIcon(i===Pr?qe:Pr);var I=o.sm(),H=o._rows;return i===Pr?I.rs(H):I.ss(H),o.onCheckColumnClicked(t),!0}}return!1},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},handleWindowTouchEnd:function(o){var u=this,t=u.tv,b=u.th,V=u._29o;if(u.moving){var J=b._61I;if(J&&J.insertColumn!==J.column){var B=J.column,i=t.getColumnModel()._roots,Y=i.remove(B),A=i.indexOf(J.insertColumn);A>=0&&(J.front||A++,A<=i.size()&&(i.add(B,A),t.getColumnModel()._38I(B,Y,A)))}b._5Q(G),delete u.moving}else if(!u.resizing&&V){B=V.column;var L=b.lp(o).x,M=V.startX,P=!0;if(b.onColumnClicked){var w=b.onColumnClicked(B,o,M);w===!1&&(P=!1)}if(P&&L>=M&&L<=M+B.getWidth()&&!u._16Q(B,M)){if(B.isSortable()){var T=t.getSortMode(),l=B.getSortOrder();T===hg?t.getSortColumn()===B?(l===qf&&t.setSortColumn(G),B.setSortOrder(l===Ag?qf:Ag)):t.setSortColumn(B):"bistate"===T&&(t.getSortColumn()===B?B.setSortOrder(l===Ag?qf:Ag):t.setSortColumn(B))}t.onColumnClicked(B,o,M)}}u._29o=u.resizing=u.x=u.lx=u.w=G}}),ee.TablePane=function(S){this.init(new Rn(S))},hj("TablePane",m,{ms_v:1,_44o:1}),ee.TreeTablePane=function(a){this.init(new qq(a))},hj("TreeTablePane",m,{ms_v:1,_44o:1}),ee.Toolbar=function(D){var k=this,B=k._view=yn(1,k),K=B.style;K.background=V.toolbarBackground||"",K.height=ym+un,k._canvas=$p(B),k._30o=new fl,k._90I=new fl,k.setItems(D||[]),B.handleGroupSelectedChanged=function(L){if(L.isSelected()){var V=L.getGroupId();null!=V&&k._items.forEach(function(A){var y=A.element;y&&y!==L&&y.setSelected&&y.getGroupId&&y.getGroupId()===V&&y.setSelected(!1)
})}},new pn(k)},hj("Toolbar",m,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[hf,Yc,fp,Jb,Uh,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:V.toolbarLabelColor,_labelSelectColor:V.toolbarLabelSelectColor,_labelFont:V.toolbarLabelFont,_selectBackground:V.toolbarSelectBackground,_itemGap:V.toolbarItemGap,_separatorColor:V.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(Z){var E=this.getItemInfoAt(Z);return E?E.item.toolTip:G},getLabelColor:function(e){return e&&e.selected&&e.type!==Pr&&e.type!==kc?this._labelSelectColor:this._labelColor},onPropertyChanged:function(i){this.iv(),i.property===hf&&this._items.forEach(function(g){fc(g)})},redraw:function(){this.iv()},addItem:function(J,L){var I=this._items;L==G?I.push(J):I.splice(L,0,J),this.fp(hf,G,I)},removeItem:function(u){if(u)for(var K=this._items,y=0;y<K.length;y++)u===K[y]&&(K.splice(y,1),this.fp(hf,G,K))},removeItemById:function(w){if(w!=G)for(var d=this._items,D=0;D<d.length;D++)if(w===d[D].id){var J=d.splice(D,1)[0];return this.fp(hf,G,d),J}},getItemById:function(x){if(x!=G)for(var b=this._items,X=0;X<b.length;X++){var S=b[X];if(x===S.id)return S}},setItemVisible:function(m,h){var i=this.getItemById(m);i&&(i.visible=h)},getItemInfos:function(){return this._30o},getItemInfoAt:function($){var w=this,J=0,d=w._30o,o=w.lp($),j=o.x,I=o.y;if(I>=0&&I<=w.getHeight())for(;J<d.size();J++){var K=d.get(J);if(K.startX<=j&&j<=K.endX)return K}return G},drawItem:function(m,q,b,F,L){if(q.visible===!1)return 0;if(em(q.visible)&&!q.visible())return 0;var Y=this,H=q.disabled;H&&(m.globalAlpha=Qp);var S=Y.drawItemImpl(m,q,b,F,L),J=Y._itemGap;return H&&(m.globalAlpha=1),this._currentItem!==q||"separator"===q||q.separator===!0||q.unfocusable||Wl(m,Y._separatorColor,b-J/2,0,S+J,F),S},drawItemImpl:function(U,O,u,d,N){var Q=this,_=Q._view,l=Q._itemGap,C=d/2,J=O.type,W=O.element,w=O.label;ed(W)&&(w=W,W=G);var t,x=Q.getLabelFont(O),K=Q.getLabelColor(O),p=O.selected,H=tn(O.icon),m=dq(H,O),Y=0,y=m+(w?uk(x,w).width:0);if("separator"===O||O.separator===!0)return Ye(U,Q._separatorColor,u,d/4,C),1;if(W){H&&Uo(U,H,u+m/2,C,O,Q),bl(U,w,x,K,u+m,0,0,d);var R=Zk(W);N||Q._90I.add(R),R.parentNode!==_&&Mk(_,R),W.iv&&W.iv(),W.validate&&W.validate();var e=R.getBoundingClientRect(),B=e.width,V=R.style;return _r(R),V.left=Q.tx()+u+y+un,V.top=(d-e.height)/2+un,y+B}return J===kc?t=tn(p?Bm:Lo):J===Pr&&(t=tn(p?Pr:qe)),t?(Y=dq(t,O),Uo(U,t,u+Y/2,C,O,Q),u+=Y,y+=Y):p&&Ig(U,u-l/2,0,y+l,d,Q.getSelectBackground(O)),H&&Uo(U,H,u+m/2,C,O,Q),bl(U,w,x,K,u+m,0,0,d),y},validateImpl:function(){var u=this,e=u._canvas,y=u.getWidth(),h=u.getHeight(),X=u._30o,K=u._items;Hp(e,y,h);var G=vd(e),g=u._itemGap,P=g/2;df(G,u.tx(),0,1),G.clearRect(0,0,y,h);var m=u._90I;u._90I=new fl,X.clear(),K.forEach(function(S){var n=u.drawItem(G,S,P,h);X.add({item:S,startX:P,endX:P+n,width:n}),n&&(P+=n+g)}),m.each(function(s){u._90I.contains(s)||Nl(s)});var U=u._64I;u._64I=W(0,P),G.restore(),u._stickToRight?(u._65O=0,G=vd(e),P=y-u._64I+g,df(G,0,0,1),G.clearRect(0,0,y,h),X.clear(),K.forEach(function(i){var q=u.drawItem(G,i,P,h,!0);X.add({item:i,startX:P,endX:P+q,width:q}),q&&(P+=q+g)}),G.restore()):u.tx(u.tx()),U!==u._64I&&u.onSumWidthChanged(U,u._64I)},onSumWidthChanged:function(){},handleClick:function(w,l){var U=this,f=w.type,M=w.action,k=w.groupId,t=w.selected;w.disabled||(k!=G?t||(w.selected=!0,this._items.forEach(function(L){L.groupId===k&&w!==L&&(L.selected=!1)}),M&&w.action(w,U,l)):f===Pr||"toggle"===f?(w.selected=!t,M&&w.action(w,U,l)):M&&w.action(w,U,l)),um(),U.iv()}});var pn=function(M){this.tb=M,this.addListeners()};ne(pn,m,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(c){this.handleScroll(c,10*(c.wheelDelta/40))},handle_DOMMouseScroll:function(p){this.handleScroll(p,10*-p.detail)},handleScroll:function(i,$){Jd(i);var A=this.tb;A.isScrollable()&&!A._stickToRight&&(A.tx(A.tx()+$),fg())},handle_mousemove:function(Z){var N=this;pj||N.setItem(Z)},handle_mouseout:function(V){var Z=this;V.target===Z.getView()?Z.tb.setCurrentItem(G):Z.handle_mousemove(V)},handle_mousedown:function(F){this.handle_mousemove(F),this.handle_touchstart(F)},handle_touchstart:function(o){var S=this,z=S.tb,x=o.target;Tl(o)&&(x===S.getView()||x===z._canvas)&&(Jd(o),z.setFocus(o)&&(this.setItem(o,!0),(z.isScrollable()||S.info&&!S.info.item.disabled)&&(S.x=Ac(o).x,S.tx=z.tx(),Hl(S,o))))},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(Y){var F=this,V=F.tb;if(!V._stickToRight){var K=Ac(Y).x-F.x;!F._25o&&D(K)>2&&V.isScrollable()&&(F._25o=1),F._25o&&V.tx(F.tx+K)}},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(j){var E=this,Y=E.tb,H=E.info,J=E.tb.getItemInfoAt(j);if(!E._25o&&H){var k=H.item;J&&J.item===k&&Y.handleClick(k,j)}E._25o=E.x=E.tx=G,E.setItem()},setItem:function(O,Q){var n=this,d=n.tb,b=n.info=O?d.getItemInfoAt(O):G,W=b?b.item:G;d.setCurrentItem(W),Q&&W&&em(W.onDown)&&W.onDown(O)}}),ee.BorderPane=function(){this._view=yn(1,this),this.iv()},hj("BorderPane",m,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(h,X){this._12o("leftView",h),X!=G&&this.setLeftWidth(X)},getRightView:function(){return this._rightView},setRightView:function(e,H){this._12o("rightView",e),H!=G&&this.setRightWidth(H)},getTopView:function(){return this._topView},setTopView:function(U,y){this._12o("topView",U),y!=G&&this.setTopHeight(y)},getBottomView:function(){return this._bottomView},setBottomView:function(E,I){this._12o("bottomView",E),I!=G&&this.setBottomHeight(I)},getCenterView:function(){return this._centerView},setCenterView:function(E){this._12o("centerView",E)},_12o:function(U,V){var s=this,W="_"+U,u=s._view,L=s[W];L!==V&&(L&&(L.getView?Nl(L.getView()):Nl(L)),s[W]=V,V&&(V.getView?Mk(u,V.getView(),1):Mk(u,V,1)),s.fp(U,L,V))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var h=this,i=h._topView,K=h._bottomView,C=h._leftView,T=h._rightView,n=h._centerView,R=h.getWidth(),r=h.getHeight(),I=0,j=0,P=R,p=r,$=0,y=0,s=0,X=0;i&&($=h._topHeight==G?Zd(i):h._topHeight,j=$),K&&(y=h._bottomHeight==G?Zd(K):h._bottomHeight,p=r-y),C&&(s=h._leftWidth==G?Qe(C):h._leftWidth,I=s),T&&(X=h._rightWidth==G?Qe(T):h._rightWidth,P=R-X);var z=W(0,P-I),Y=W(0,p-j);i&&op(i,0,0,R,$),K&&op(K,0,p,R,y),C&&op(C,0,j,s,Y),T&&op(T,P,j,X,Y),n&&op(n,I,j,z,Y)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);