!function(z,r,R){"use strict";var H=z.ht;H.Astar={},function(b){var g=b();z.AStar=g.astar,z.AStar.Graph=g.Graph}(function(){function T(u){for(var e=u,w=[];e.parent;)w.unshift(e),e=e.parent;return w}function i(){return new v(function(U){return U.f})}function M(n,C){C=C||{},this.nodes=[],this.diagonal=!!C.diagonal,this.grid=[];for(var y=0;y<n.length;y++){this.grid[y]=[];for(var l=0,f=n[y];l<f.length;l++){var s=new D(y,l,f[l]);this.grid[y][l]=s,this.nodes.push(s)}}this.$13x()}function D(E,n,g){this.x=E,this.y=n,this.weight=g}function v(g){this.content=[],this.scoreFunction=g}var c={search:function(_,u,P,D){_.$6x(),D=D||{};var r=D.heuristic;r||(r=_.diagonal?c.$4x.diagonal:c.$4x.manhattan);var B=D.closest||!1,R=D.punish,K=i(),h=u;for(u.h=r(u,P),_.$7x(u),K.push(u);K.size()>0;){var J=K.pop();if(J===P)return T(J);J.closed=!0;for(var F=_.neighbors(J),b=0,w=F.length;w>b;++b){var V=F[b];if(!V.closed&&!V.$9x()){var N=J.g+V.getCost(J,R),M=V.visited;(!M||N<V.g)&&(V.visited=!0,V.parent=J,V.h=V.h||r(V,P),V.g=N,V.f=V.g+V.h,_.$7x(V),B&&(V.h<h.h||V.h===h.h&&V.g<h.g)&&(h=V),M?K.$10x(V):K.push(V))}}}return B?T(h):[]},$4x:{manhattan:function(M,K){var X=Math.abs(K.x-M.x),G=Math.abs(K.y-M.y);return X+G},diagonal:function(g,W){var N=1,V=Math.sqrt(2),E=Math.abs(W.x-g.x),A=Math.abs(W.y-g.y);return N*(E+A)+(V-2*N)*Math.min(E,A)}},$5x:function(K){K.f=0,K.g=0,K.h=0,K.visited=!1,K.closed=!1,K.parent=null}};return M.prototype.$13x=function(){this.dirtyNodes=[];for(var l=0;l<this.nodes.length;l++)c.$5x(this.nodes[l])},M.prototype.$6x=function(){for(var s=0;s<this.dirtyNodes.length;s++)c.$5x(this.dirtyNodes[s]);this.dirtyNodes=[]},M.prototype.$7x=function(p){this.dirtyNodes.push(p)},M.prototype.neighbors=function(Q){var C=[],i=Q.x,x=Q.y,p=this.grid;return p[i-1]&&p[i-1][x]&&C.push(p[i-1][x]),p[i+1]&&p[i+1][x]&&C.push(p[i+1][x]),p[i]&&p[i][x-1]&&C.push(p[i][x-1]),p[i]&&p[i][x+1]&&C.push(p[i][x+1]),this.diagonal&&(p[i-1]&&p[i-1][x-1]&&C.push(p[i-1][x-1]),p[i+1]&&p[i+1][x-1]&&C.push(p[i+1][x-1]),p[i-1]&&p[i-1][x+1]&&C.push(p[i-1][x+1]),p[i+1]&&p[i+1][x+1]&&C.push(p[i+1][x+1])),C},M.prototype.toString=function(){for(var k=[],J=this.grid,s=0;s<J.length;s++){for(var i=[],M=J[s],E=0;E<M.length;E++)i.push(M[E].weight);k.push(i.join(" "))}return k.join("\n")},D.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},D.prototype.getCost=function(S,H){var $;if($=S&&S.x!=this.x&&S.y!=this.y?1.41421*this.weight:this.weight,H){var q=S;if(!q)return $;var m=q.parent;return m?Math.abs(m.x+this.x-2*q.x)>1e-5?$+H:Math.abs(m.y+this.y-2*q.y)>1e-5?$+H:$:$}},D.prototype.$9x=function(){return 0===this.weight},v.prototype={push:function(W){this.content.push(W),this.$11x(this.content.length-1)},pop:function(){var B=this.content[0],$=this.content.pop();return this.content.length>0&&(this.content[0]=$,this.$12x(0)),B},remove:function(T){var C=this.content.indexOf(T),u=this.content.pop();C!==this.content.length-1&&(this.content[C]=u,this.scoreFunction(u)<this.scoreFunction(T)?this.$11x(C):this.$12x(C))},size:function(){return this.content.length},$10x:function(a){this.$11x(this.content.indexOf(a))},$11x:function(O){for(var P=this.content[O];O>0;){var k=(O+1>>1)-1,$=this.content[k];if(!(this.scoreFunction(P)<this.scoreFunction($)))break;this.content[k]=P,this.content[O]=$,O=k}},$12x:function(e){for(var B=this.content.length,z=this.content[e],f=this.scoreFunction(z);;){var c,r=e+1<<1,p=r-1,L=null;if(B>p){var E=this.content[p];c=this.scoreFunction(E),f>c&&(L=p)}if(B>r){var X=this.content[r],g=this.scoreFunction(X);(null===L?f:c)>g&&(L=r)}if(null===L)break;this.content[e]=this.content[L],this.content[L]=z,e=L}}},{astar:c,Graph:M}});var O=H.Astar.Finder=function(T,i){var n=this;n.gv=T,n.$13x(i),n.refreshMap()};O.prototype={},O.prototype.constructor=O,r.defineProperties(O.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(n){this.gv._astarDebugInfo=n}}}),O.prototype.$13x=function(G){var r=this,Q=r.$14x={};G=G||{};var W=G.gridSize||10;Q.gridSizeX=G.gridSizeX||W,Q.gridSizeY=G.gridSizeY||W,Q.rect=G.rect,Q.filter=G.filter,Q.extendBlocks=G.extendBlocks||3,Q.fastOverlap=G.fastOverlap===R?!0:G.fastOverlap,Q.nodeRectExtend=G.nodeRectExtend||0,Q.diagonal=G.diagonal===R?!0:G.diagonal,Q.turnPunish=G.turnPunish===R?.1:G.turnPunish,Q.simplify=G.simplify===R?!0:G.simplify,Q.toGridCenter=G.toGridCenter===R?!1:G.toGridCenter,Q.closest=G.closest===R?!0:G.closest},O.prototype.refreshMap=function(){var i,q=this,u=q.$14x,B=u.gridSizeX,U=u.gridSizeY,C=u.extendBlocks;u.rect?i=u.rect:(i=q.$15x(),H.Default.grow(i,B*C,U*C)),H.Default.grow(i,B,U);var o=Math.floor(i.x/B)*B,N=Math.floor(i.y/U)*U,d=Math.ceil(i.width/B),p=Math.ceil(i.height/U),b=d*B,c=p*U;q.$16x={x:o,y:N,w:b,h:c,gridX:B,gridY:U,xLen:d,yLen:p},q.$17x(),q.$21x()},O.prototype.$15x=function(){var t=this.gv;if(t instanceof H.graph.GraphView)return t.getContentRect();var Y,c=H.Default.unionRect;return t.dm().each(function(r){t.isVisible(r)&&r.getRect&&(Y=c(Y,r.getRect()))}),Y},O.prototype.$17x=function(){var g,P,j,w,n=this,l=n.$16x,F=l.xLen,G=l.yLen;for(g=new Array(F),j=0;F>j;j++)for(g[j]=P=new Array(G),w=G;w--;)P[w]=1;var D=n.$14x.filter;for(n.gv.dm().each(function(Z){D&&D(Z)===!1||(!n._debugInfo||Z!==n._debugInfo.grid&&Z!=n._debugInfo.path)&&n.$1cw(g,Z)}),j=0;F>j;j++)g[j][0]=1,g[j][G-1]=1;for(w=0;G>w;w++)g[0][w]=1,g[F-1][w]=1;n.grid=g;var $=new AStar.Graph(g,{diagonal:n.$14x.diagonal});n.graph=$},O.prototype.$18x=function(N,j,V,R,z,F,T,$){var b=this.$19x,i=b(V-N,z-T,R-j,F-$);if(1e-6>=i&&i>=-1e-6)return!1;var q=b(z-N,z-T,F-j,F-$)/i;if(0>q||q>1)return!1;var C=b(V-N,z-N,R-j,F-j)/i;return 0>C||C>1?!1:!0},O.prototype.$19x=function(m,O,f,L){return m*L-O*f},O.prototype.$1aw=function(t,s,f,p){for(var G=[-(s[1]-t[1]),s[0]-t[0]],g=G[0]*(f[0]-t[0])+G[1]*(f[1]-t[1])>=0,Z=0,Y=p.length;Y>Z;Z+=2)if(G[0]*(p[Z]-t[0])+G[1]*(p[Z+1]-t[1])>=0===g)return!1;return!0},O.prototype.$1bw=function(A,J){for(var $,M,C=this,B=0,S=A.length;S>B;B+=2)if($=B===S-2?0:B+2,M=$===S-2?0:$+2,C.$1aw([A[B],A[B+1]],[A[$],A[$+1]],[A[M],A[M+1]],J))return!1;for(var B=0,S=J.length;S>B;B+=2)if($=B===S-2?0:B+2,M=$===S-2?0:$+2,C.$1aw([J[B],J[B+1]],[J[$],J[$+1]],[J[M],J[M+1]],A))return!1;return!0},O.prototype.$1cw=function(a,$){if($.getRect){var n=this,l=$.getRect();H.Default.grow(l,n.$14x.nodeRectExtend);var V,Q,L,t,s,Z,D,o,A,u,k,d=n.$1dw({x:l.x,y:l.y}),G=n.$1dw({x:l.x+l.width,y:l.y+l.height}),E=n.$14x.fastOverlap;if(!E){var B=$.getCorners();D=[],B.forEach(function(b){D.push(b.x,b.y)}),u=n.$14x.gridSizeX/2,k=n.$14x.gridSizeY/2}for(Q=Math.max(0,d.x),L=Math.min(G.x,a.length-1),s=Math.max(0,d.y),Z=Math.min(G.y,a.length?a[0].length-1:-1),V=Q;L>=V;V++)for(t=s;Z>=t;t++)if(E)a[V][t]=0;else{A=n.$1ew({x:V,y:t});var h=A.x-u,J=A.x+u,p=A.y-k,F=A.y+k;o=[h,p,h,F,J,F,J,p],n.$1bw(D,o)&&(a[V][t]=0)}}},O.prototype.$1dw=function(S,C){var H=this,F=H.$16x,i=(S.x-F.x)/F.gridX,O=(S.y-F.y)/F.gridY;return C!==!1&&(i=Math.round(i),O=Math.round(O)),{x:i,y:O}},O.prototype.$1ew=function(w){var T=this,R=T.$16x;return{x:w.x*R.gridX+R.x,y:w.y*R.gridY+R.y}},O.prototype.$1fw=function(M){var T=this,y=T.$16x,x=y.xLen,m=y.yLen;if(M.x>=0&&M.x<x&&M.y>=0&&M.y<m)return M;var n={x:M.x,y:M.y};return n.x<0?n.x=0:n.x>=x&&(n.x=x-1),n.y<0?n.y=0:n.y>=m&&(n.y=m-1),n},O.prototype.findPath=function(d,P){var u,X,r,S,O=this,A=O.$1dw(d),q=O.$1dw(P);if(r=O.$1fw(A),S=O.$1fw(q),r!==A&&S!==q){var Z=O.$16x,Y=Z.x-Z.gridX/2,b=Z.y-Z.gridY/2,v=Y+Z.gridX*Z.xLen,x=b+Z.gridY*Z.yLen;if(!(O.$18x(d.x,d.y,P.x,P.y,Y,b,v,b)||O.$18x(d.x,d.y,P.x,P.y,v,b,v,x)||O.$18x(d.x,d.y,P.x,P.y,v,x,Y,x)||O.$18x(d.x,d.y,P.x,P.y,Y,x,Y,b)))return[d,P]}r!==A&&(u=!0,A=r),S!==q&&(X=!0,q=S);var o=O.graph.grid[A.x][A.y],B=O.graph.grid[q.x][q.y],i=AStar.search(O.graph,o,B,{closest:O.$14x.closest,punish:O.$14x.turnPunish});if(!i||!i.length)return null;var L=[];L.push(d),u&&L.push(O.$1ew(i[0]));for(var l=1,G=i.length;G-1>l;l++)L.push(O.$1ew(i[l]));if(X)L.push(O.$1ew(i[G-1])),L.push(P);else{var M=i[G-1];q.x!==M.x||q.y!==M.y||O.$14x.toGridCenter?L.push(O.$1ew(M)):L.push(P)}return O.$14x.simplify&&(L=O.simplifyPath(L)),O.$20x=L,O.$21x(),L},O.prototype.debugOn=function(A){this.debugFlag=!0,this.debugSettings=A||{},this.$21x()},O.prototype.simplifyPath=function(H){var P=H.length;if(2>=P)return H;var y,D,l=[H[0],H[1]],k=l[0],Z=l[1],c=1e-5;for(y=2;P>y;y++)D=H[y],Math.abs((Z.x-k.x)*(D.y-k.y)-(Z.y-k.y)*(D.x-k.x))<c?Z=l[l.length-1]=D:(k=Z,Z=D,l.push(D));return l},O.prototype.$21x=function(){var G=this;if(G.$22x(),this.debugFlag){var w=G.grid;if(w){var L,x=G.gv;if(G.debugSettings.$16x!==!1){L=[];for(var d,u,n,M,a,k=[],E=G.$14x.gridSizeX/2,f=G.$14x.gridSizeY/2,A=w.length,O=A?w[0].length:0,R=1;A-1>R;R++)for(var j=1;O-1>j;j++)w[R][j]||(d=G.$1ew({x:R,y:j}),u=d.x-E,n=d.x+E,M=d.y-f,a=d.y+f,L.push({x:u,y:M},{x:u,y:a},{x:n,y:a},{x:n,y:M}),k.push(1,2,2,2,5));var T=new H.Shape;T.s("shape.border.color","rgba(50, 50, 50, 0.2)"),T.s("shape.border.width",1),T.s("shape.background","rgba(200, 50, 100, 0.2)"),T.s("2d.editable",!1),T.s("2d.selectable",!1),T.setPoints(L),T.setSegments(k),G._debugInfo={grid:T},x.dm().add(T)}G.debugSettings.path!==!1&&(L=new H.Shape,G.$20x&&(L.setPoints(G.$20x),L.s("shape.border.color","red"),L.s("shape.border.width",1),L.s("2d.editable",!1),L.s("2d.selectable",!1),L.s("shape.background",null),G._debugInfo||(G._debugInfo={}),G._debugInfo.path=L,x.dm().add(L)))}}},O.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},O.prototype.$22x=function(){var R=this;if(R._debugInfo){var V=R._debugInfo.grid,X=R._debugInfo.path,A=R.gv;V&&A.dm().remove(V),X&&A.dm().remove(X),R._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);