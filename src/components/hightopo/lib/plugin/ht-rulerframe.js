!function($,k){"use strict";var p="position",_="absolute",z="relative",u="px",f="left",L="right",o="top",O="bottom",h="display",v="none",A="block",W=ht.Default,R=W.getInternal(),S=Math.floor,r=Math.ceil,y=Math.PI,m=null,M=$.parseInt,C=function(A){return A.getContext("2d")},E=function(){return document},V=function(B){return E().createElement(B)},P=function(){return V("canvas")},i=function(W,B,w){W.style.setProperty(B,w,m)},j=function(k,f,Z){W.def(ht.widget[k],f,Z)},e=function(w,I){w.appendChild(I)},G=function(G,v){G.removeChild(v)},q=W.eventListenerOptionsFalse,N=(W.eventListenerOptionsTrue,function(X,T,l,B){X.addEventListener(T,l,B?q:q)}),t=function(R,T,P,V){R.removeEventListener(T,P,V?q:q)};ht.widget.RulerFrame=function(k){var U=this,w=U._view=R.createView(null,U),C=U.$1k=P(),l=U.$2k=P(),v=U.$3k=P(),r=U.$4k=P();U._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},U._topRulerConfig={visible:!0},U._rightRulerConfig={visible:!1},U._bottomRulerConfig={visible:!1},U._leftRulerConfig={visible:!0},e(w,C),e(w,v),e(w,l),e(w,r),i(w,p,z),i(w,"box-sizing","border-box"),i(w,"-moz-box-sizing","border-box"),i(C,p,_),i(l,p,_),i(v,p,_),i(r,p,_),U.$14k=function(){U.$13k=1,U.iv()},U.$15k=function(i){if(U._topRulerConfig.guideVisible||U._rightRulerConfig.guideVisible||U._bottomRulerConfig.guideVisible||U._leftRulerConfig.guideVisible||U._defaultRulerConfig.guideVisible||(U._topRulerConfig.guideTipVisible||U._rightRulerConfig.guideTipVisible||U._bottomRulerConfig.guideTipVisible||U._leftRulerConfig.guideTipVisible||U._defaultRulerConfig.guideTipVisible)&&U._component){var G=w.getBoundingClientRect();U.$16k={x:i.clientX-G.left,y:i.clientY-G.top},U.$5k()}},U.setComponent(k)},j("RulerFrame",k,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(W){var E=this,f=E._component,o=E.getView();if(o){if(E._component=W,E.fp("component",f,W),f){var j=E.getComponentView(f);G(o,j),t(o,"mousemove",E.$15k),E.removeComponentPropertyChangeListener(f,E.$14k)}if(W){var D=E.getComponentView(W);e(o,D),i(D,p,_),N(o,"mousemove",E.$15k),E.addComponentPropertyChangeListener(W,E.$14k)}}},addComponentPropertyChangeListener:function(I,v){I&&I.mp&&I.mp(v)},removeComponentPropertyChangeListener:function(o,y){o&&o.ump&&o.ump(y)},getComponentHZoom:function(z){return z&&z.getZoom?z.getZoom():1},getComponentVZoom:function(Z){return Z&&Z.getZoom?Z.getZoom():1},getComponentViewRect:function(x){return x&&x.getViewRect?x.getViewRect():void 0},getComponentView:function(z){return z&&z.getView?z.getView():z},invalidateComponent:function(w){w&&w.iv&&w.iv()},validateComponent:function(F){F&&F.validate&&F.validate()},$7k:function(D,Y,S,J,c,z,E,W,w,k,C,N){if(Y.visible){var V=this._defaultRulerConfig,Q="borderStyle",T="borderColor",b="borderWidth",O="background",q=Y[Q]||V[Q],M=Y[T]||V[T],Z=Y[b]||V[b],y=Y.size!=m?Y.size:V.size,P=Y[O]||V[O],L=y+Z,o=this.$6k(Z,q,M,D,S,c,L,E,W,w,k,C,N);i(D,c,"0px"),z?R.setCanvas(D,J-o,y):R.setCanvas(D,y,J-o),i(D,"background",P),i(D,h,A)}else i(D,h,v),i(this.getComponentView(this._component),c,"0px")},$6k:function(t,G,$,k,v,y,V,M,d,a,A,N,n){var h=0;return i(k,v,t+"px "+G+" "+$),i(this.getComponentView(this._component),y,V+u),M?(i(k,d,a+u),h+=a):i(k,d,"0px"),A?(i(k,N,n+u),h+=n):i(k,N,"0px"),h},validateImpl:function(){var G=this,k=G._component,v=G.$1k,y=G.$2k,V=G.$3k,d=G.$4k,s=G._view,B=G._defaultRulerConfig,M=G._topRulerConfig,t=G._rightRulerConfig,W=G._bottomRulerConfig,x=G._leftRulerConfig,n=B.size;if(s&&k){var j=M.size!=m?M.size:n,K=t.size!=m?t.size:n,F=W.size!=m?W.size:n,N=x.size!=m?x.size:n;G.$7k(v,M,"border-bottom",s.offsetWidth,o,!0,x.visible,f,N,t.visible,L,K),G.$7k(y,t,"border-left",s.offsetHeight,L,!1,M.visible,o,j,W.visible,O,F),G.$7k(V,W,"border-top",s.offsetWidth,O,!0,x.visible,f,N,t.visible,L,K),G.$7k(d,x,"border-right",s.offsetHeight,f,!1,M.visible,o,j,W.visible,O,F),G.$13k?delete G.$13k:G.invalidateComponent(k),G.validateComponent(k),G.$5k()}},$5k:function(){function r(o,a,e,D,r,O){if(a.visible){var I=C(o),K=a[d]||P,M=a[h]!=m?a[h]:s,H=a[n]||u,q=a[U]||$,Z=a.size!=m?a.size:G,Vp=a[J]||l,Cm=a[g]||y,Ho=a[w]||L,ee=a[S]!=m?a[S]:A,Jd=a[f]!=m?a[f]:V,bo=a[v]!=m?a[v]:x,Eh=a[T]!=m?a[T]:k,Je=a[Y]!=m?a[Y]:b,Cg=a[F]!=m?a[F]:Q,Hi=a[_]||lh,$n=a[B]||tp;M&&(K=j[O]=j.$8k(j[O]||K,a[R]||E,a[X]||N,D?W:c,Cm)),e.call(j,I,z,i,t,p,Z,D?W:c,K,H,q,r,Vp,Ho);var yh=j.$16k;(ee||Jd)&&yh&&(D?j.$9k(I,yh.x,Z,Hi,$n,ee,Jd,bo,Eh,Je,Cg):j.$10k(I,yh.y,Z,Hi,$n,ee,Jd,bo,Eh,Je,Cg,r))}}var j=this,M=j.$1k,a=j.$2k,O=j.$3k,D=j.$4k,I=j._topRulerConfig,q=j._rightRulerConfig,e=j._bottomRulerConfig,Z=j._leftRulerConfig,o=j._defaultRulerConfig,K=j._component,H=j.getComponentViewRect(K),W=j.getComponentHZoom(K),c=j.getComponentVZoom(K),z=H.x*W,t=z+H.width*W,i=H.y*c,p=i+H.height*c,G=j._defaultRulerConfig.size,d="defaultMajorTickSpacing",R="maxPhysicalMajorTickSpacing",X="minPhysicalMajorTickSpacing",h="tickSpacingAdaptable",n="majorTickTextFont",U="majorTickTextColor",J="majorTickColor",w="minorTickColor",S="guideVisible",f="guideTipVisible",v="guideTipBorderColor",T="guideTipTextColor",Y="guideTipTextFont",F="guideTipBackground",_="guideColor",B="guideWidth",g="minMajorTickSpacing",P=o[d],E=o[R],N=o[X],s=o[h],u=o[n],$=o[U],l=o[J],y=o[g],L=o[w],A=o[S],V=o[f],x=o[v],k=o[T],b=o[Y],Q=o[F],lh=o[_],tp=o[B];j._view&&K&&(r(M,I,j.$11k,!0,!1,"_currentTopMajorTickSpacing"),r(a,q,j.$12k,!1,!0,"_currentRightMajorTickSpacing"),r(O,e,j.$11k,!0,!0,"_currentBottomMajorTickSpacing"),r(D,Z,j.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(t,p,x,M,v){return x>t*M?t=S(p/M/v)*v:t*M>p&&(t=r(x/M/v)*v),t},getHTipText:function(G){var r=this,f=r._component,c=0,A=r._view.getBoundingClientRect();return f.lp?c=M(f.lp({x:G.x+A.left,y:G.y}).x):c-=M(this.getComponentView(f).style.left)||0,c},$9k:function(W,b,i,X,z,t,l,r,Z,_,H){var Q=this,u=Q._component;W.save(),R.translateAndScale(W,0,0,1);var G=b-(M(this.getComponentView(u).style.left)||0),C=0;if(b=Q.getHTipText(Q.$16k),t&&(W.beginPath(),W.fillStyle=X,W.rect(G,C,z,i),W.fill()),l){W.beginPath(),W.textAlign="center",W.textBaseline="middle",W.font=_;var k=W.measureText(b).width+6;W.fillStyle=H,W.rect(G-k/2,C,k,i),W.fill(),W.strokeStyle=r,W.stroke(),W.beginPath(),W.fillStyle=Z,W.fillText(b,G,C+i/2)}W.restore()},getVTipText:function(F){var e=this,z=e._component,j=0,S=e._view.getBoundingClientRect();return z.lp?j=M(z.lp({x:F.x,y:F.y+S.top}).y):j-=M(this.getComponentView(z).style.top)||0,j},formatScaleText:function(I){return Math.round(I)},$10k:function(_,F,p,C,b,B,d,f,r,X,P,o){var u=this,H=u._component;_.save(),R.translateAndScale(_,0,0,1);var T=p/2,c=F-(M(this.getComponentView(H).style.top)||0);if(F=u.getVTipText(u.$16k),B&&(_.beginPath(),_.fillStyle=C,_.rect(T-p/2,c,p,b),_.fill()),d){_.translate(T,c),_.rotate((o?90:-90)*y/180),_.translate(-T,-c),_.beginPath(),_.textAlign="center",_.textBaseline="middle",_.font=X;var U=_.measureText(F).width+6;_.fillStyle=P,_.rect(T-U/2,c-p/2,U,p),_.fill(),_.strokeStyle=f,_.stroke(),_.fillStyle=r,_.fillText(F,T,c)}_.restore()},$11k:function(X,V,A,W,j,h,I,B,O,N,w,Q,x){X.save(),A=0;var U=V,b=W,D=(U+b)/2;V=0,W=b-U,R.translateAndScale(X,0,0,1);var d=0,q=0,k=M(h/2),f=h-k,K=w?0:k,a=B*I,v=a/10;V-=a,W+=a,X.clearRect(V,0,W-V,h),X.beginPath(),X.fillStyle=x;var o=S(D/v)*v-U;for(d=o;W>d;d+=v)X.rect(d,A+K,1,f);for(d=o;d>V;d-=v)X.rect(d,A+K,1,f);for(X.fill(),K=w?0:1,X.beginPath(),X.fillStyle=Q,o=S(D/a)*a-U,d=o;W>d;d+=a)X.rect(d,A+K,1,h-1);for(d=o;d>V;d-=a)X.rect(d,A+K,1,h-1);X.fill();var F=M(/\d+px/.exec(O)[0]),e=(F||10)/2;X.textBaseline="middle",K=w?h-e-2:e+2,X.beginPath(),X.fillStyle=N,X.font=O;var $=S(D/a)*a/I;for(d=o,q=$;W>d;d+=a,q+=B){var J=this.getHScaleText?this.getHScaleText(d):q;X.fillText(this.formatScaleText(J),d+2,A+K)}for(d=o,q=$;d>V;d-=a,q-=B){var J=this.getHScaleText?this.getHScaleText(d):q;X.fillText(this.formatScaleText(J),d+2,A+K)}X.restore()},$12k:function(p,k,I,i,e,r,l,b,D,q,H,z,V){function f(q,i,R,M,U,u){U=m.getVScaleText?m.getVScaleText(R):U,U=m.formatScaleText(U),p.translate(q+i,R),p.rotate(-M),p.translate(-q-i,-R),p.fillText(U,q+i+(u?2:1),R),p.translate(q+i,R),p.rotate(M),p.translate(-q-i,-R)}p.save(),k=0;var W=I,A=e,F=(W+A)/2;I=0,e=A-W,R.translateAndScale(p,0,0,1);var g=0,m=this,G=0,N=M(r/2),s=r-N,Q=H?0:N,E=b*l,B=E/10;I-=E,e+=E,p.clearRect(k,0,r,e-I),p.beginPath(),p.fillStyle=V;var j=S(F/B)*B-W;for(g=j;e>g;g+=B)p.rect(k+Q,g,s,1);for(g=j;g>I;g-=B)p.rect(k+Q,g,s,1);for(p.fill(),Q=H?0:1,p.beginPath(),p.fillStyle=z,j=S(F/E)*E-W,g=j;e>g;g+=E)p.rect(k+Q,g,r-1,1);for(g=j;g>I;g-=E)p.rect(k+Q,g,r-1,1);p.fill();var C=M(/\d+px/.exec(D)[0]),U=(C||10)/2,c=90*y/180;p.textBaseline="middle",Q=H?r-U:U+2,c=H?-c:c,p.beginPath(),p.fillStyle=q,p.font=D;var u=S(F/E)*E/l;for(g=j,G=u;e>g;g+=E,G+=b)f(k,Q,g,c,G,H);for(g=j,G=u;g>I;g-=E,G-=b)f(k,Q,g,c,G,H);p.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var K=this,M=K._component,I=K._view;M&&K.removeComponentPropertyChangeListener(M,K.$14k),I&&(t(I,"mousemove",K.$15k),G(I.parentNode,I),K._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);