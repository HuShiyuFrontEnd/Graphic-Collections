!function(y){"use strict";function J(K){var Q,f,M,u,Z,F,n,g=[],L=0;Q=v.createDiv(),Q.style.overflow="hidden";var e=K.getView();e.insertBefore(Q,K.getCanvas()),f=G.Default.createDiv(),f.style.WebkitTransformStyle="preserve-3d",f.style.MozTransformStyle="preserve-3d",f.style.transformStyle="preserve-3d",Q.appendChild(f),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(w){var j=w.style;e.addEventListener(w.event,function(){Q.style.pointerEvents=j})}),this.updateWebView=function(){var e=K.getCanvas(),H=1*e.style.width.slice(0,-2),a=1*e.style.height.slice(0,-2);(g[0]!==H||g[1]!==a)&&(g[0]=H,g[1]=a,Q.style.width=H+"px",Q.style.height=a+"px",f.style.width=H+"px",f.style.height=a+"px");var o=K._projectMatrix[5]*g[1]/2;o!==M&&(M=o,Q.style.WebkitPerspective=M+"px",Q.style.MozPerspective=M+"px",Q.style.perspective=M+"px"),F="translateZ("+M+"px)"+W(K._viewMatrix);var A=F+"translate("+g[0]/2+"px,"+g[1]/2+"px)";u===A||Z||(f.style.WebkitTransform=A,f.style.MozTransform=A,f.style.transform=A,u=A),L++,n=!1,K.dm().each(function(M){M.isWebView&&j(M)});for(var C,m=f.children,r=[],h=0,S=m.length;S>h;h++)C=m[h],C._isHtWebView&&C._renderCookie!==L&&r.push(C);r.length&&r.forEach(function(h){f.removeChild(h)})};var s=new Array(16),j=function(w){var R=w.getAttach();if(R){R.parentElement!==f&&f.appendChild(R),R._renderCookie=L,n=!0;var t=w.getFinalScale3d(),V=w._prefrenceSize;V&&V[0]?V[1]||(V[1]=V[0]/t[0]*t[1]):V=[t[0],t[1]],R.style.width=V[0]+"px",R.style.height=V[1]+"px";var X=1/V[0],D=1/V[1],U=1,a=w.mat;s[0]=a[0]*X,s[1]=a[1]*X,s[2]=a[2]*X,s[3]=a[3]*X,s[4]=a[4]*D,s[5]=a[5]*D,s[6]=a[6]*D,s[7]=a[7]*D,s[8]=a[8]*U,s[9]=a[9]*U,s[10]=a[10]*U,s[11]=a[11]*U,s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15];var S=q(s,Z?"translate("+g[0]/2+"px,"+g[1]/2+"px)"+F:""),Y=R.$a2;Y!==S&&(R.$a2=S,R.style.WebkitTransform=S,R.style.MozTransform=S,R.style.transform=S)}}}function r(E){return Math.abs(E)<1e-10?0:E}function W(m){var b=m;return"matrix3d("+r(b[0])+","+r(-b[1])+","+r(b[2])+","+r(b[3])+","+r(b[4])+","+r(-b[5])+","+r(b[6])+","+r(b[7])+","+r(b[8])+","+r(-b[9])+","+r(b[10])+","+r(b[11])+","+r(b[12])+","+r(-b[13])+","+r(b[14])+","+r(b[15])+")"}function q(n,o){var G=n,u="matrix3d("+r(G[0])+","+r(G[1])+","+r(G[2])+","+r(G[3])+","+r(-G[4])+","+r(-G[5])+","+r(-G[6])+","+r(-G[7])+","+r(G[8])+","+r(G[9])+","+r(G[10])+","+r(G[11])+","+r(G[12])+","+r(G[13])+","+r(G[14])+","+r(G[15])+")";return"translate(-50%,-50%)"+(o||"")+u}var K="ht",G=y[K],v=G.Default,k=v.getInternal(),z=k.superCall,$=G.graph3d.Graph3dView,s=$.prototype.validateImpl;$.prototype.validateImpl=function(){s.call(this);var n=this._webViewRenderer;n||(n=this._webViewRenderer=new J(this)),n.updateWebView()};var V=G.WebView3d=function(){var w=this;z(V,w),w.s({shape3d:"billboard","shape3d.reverse.flip":!0})},N=[1,1,1,1],F=[0,0,0,0];v.def(K+"."+"WebView3d",G.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(Z,U,Q){if(!Z)return this.detachDOM();if("string"==typeof Z){var y=document.createElement("iframe");y.src=Z,Z=y}var s=Z.style;s.position="absolute",s.border=0,s.outline=0,s.padding=0,s.margin=0,Z._isHtWebView=!0,this.setAttach(Z),this._prefrenceSize=[U,Q],this.s("shape3d.blend",F)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(n){this.a("defaultBgColor",n),this.getAttach()||this.s("shape3d.blend",n)},getBgColor:function(){return this.a("defaultBgColor")||N}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);